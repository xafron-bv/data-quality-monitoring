<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models</title>
<!--Generated on Wed Aug 28 06:17:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="" lang="en" name="keywords"/>
<base href="/html/2405.07626v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S1" title="In AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S2" title="In AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S3" title="In AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S3.SS1" title="In 3. Preliminary ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Definition</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S3.SS2" title="In 3. Preliminary ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Overview of AnomalyLLM</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4" title="In AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS1" title="In 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Dynamic-aware Contrastive Pretraining</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS1.SSS1" title="In 4.1. Dynamic-aware Contrastive Pretraining ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Dynamic-aware Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS1.SSS2" title="In 4.1. Dynamic-aware Contrastive Pretraining ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Contrastive Learning-based Optimization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS2" title="In 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Reprogramming-based Modality Alignment</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS2.SSS1" title="In 4.2. Reprogramming-based Modality Alignment ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Text Prototype Reprogramming</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS2.SSS2" title="In 4.2. Reprogramming-based Modality Alignment ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Pseudo Label for Anomaly Fine-tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS3" title="In 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>In-Context Learning for Few-Shot Detection</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS3.SSS1" title="In 4.3. In-Context Learning for Few-Shot Detection ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Prompt Template Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS3.SSS2" title="In 4.3. In-Context Learning for Few-Shot Detection ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Few-shot anomaly detection</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS4" title="In 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Complexity Analysis of AnomalyLLM</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5" title="In AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS1" title="In 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Settings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS1.SSS1" title="In 5.1. Experimental Settings ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Data Descriptions.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS1.SSS2" title="In 5.1. Experimental Settings ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Experimental Protocol.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS1.SSS3" title="In 5.1. Experimental Settings ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span>Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS1.SSS4" title="In 5.1. Experimental Settings ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.4 </span>Hyperparameters setting.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS2" title="In 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Performance Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS3" title="In 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Efficiency Experiments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS4" title="In 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Ablation Results:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.SS5" title="In 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Performance on Real-World Labeled Dataset</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S6" title="In AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1" title="In AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS1" title="In Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Detail of Dynamic Encoder</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS1.SSS1" title="In A.1. Detail of Dynamic Encoder ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.1 </span>Calculation of Diffusion Matrix</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS1.SSS2" title="In A.1. Detail of Dynamic Encoder ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.2 </span>Node Encoding</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS2" title="In Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Detail of Prompt</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS3" title="In Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Complexity Analysis of Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS4" title="In Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Experiment Setting</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS4.SSS1" title="In A.4. Experiment Setting ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4.1 </span>Dataset Statistics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS4.SSS2" title="In A.4. Experiment Setting ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4.2 </span>Protocol</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS4.SSS3" title="In A.4. Experiment Setting ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4.3 </span>Compared baselines.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS5" title="In Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Sensitivity Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS6" title="In Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>Unsupervised Anomaly Detection</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno" lang="en">
<h1 class="ltx_title ltx_title_document">AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shuo Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">
Institute of Computing Technology, Chinese Academy of Sciences
<br class="ltx_break"/></span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2"></span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Di Yao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">
Institute of Computing Technology, Chinese Academy of Sciences
<br class="ltx_break"/></span><span class="ltx_text ltx_affiliation_country" id="id4.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yaodi@ict.ac.cn">yaodi@ict.ac.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lanting Fang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">
Beijing Institute of Technology
<br class="ltx_break"/></span><span class="ltx_text ltx_affiliation_country" id="id6.2.id2"></span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhetao Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">
Jinan University
<br class="ltx_break"/></span><span class="ltx_text ltx_affiliation_country" id="id8.2.id2"></span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenbin Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">
Institute of Computing Technology, Chinese Academy of Sciences
<br class="ltx_break"/></span><span class="ltx_text ltx_affiliation_country" id="id10.2.id2"></span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kaiyu Feng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id11.1.id1">
Beijing Institute of Technology
<br class="ltx_break"/></span><span class="ltx_text ltx_affiliation_country" id="id12.2.id2"></span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaowen Ji
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">
Southeast University
<br class="ltx_break"/></span><span class="ltx_text ltx_affiliation_country" id="id14.2.id2"></span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jingping Bi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id15.1.id1">
Institute of Computing Technology, Chinese Academy of Sciences
<br class="ltx_break"/></span><span class="ltx_text ltx_affiliation_country" id="id16.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:bjp@ict.ac.cn">bjp@ict.ac.cn</a>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id17.id1"><span class="ltx_text" id="id17.id1.1">Detecting anomaly edges for dynamic graphs aims to identify edges significantly deviating from the normal pattern and can be applied in various domains, such as cybersecurity, financial transactions and AIOps. With the evolving of time, the types of anomaly edges are emerging and the labeled anomaly samples are few for each type. Current methods are either designed to detect randomly inserted edges or require sufficient labeled data for model training, which harms their applicability for real-world applications. In this paper, we study this problem by cooperating with the rich knowledge encoded in large language models(LLMs) and propose a method, namely AnomalyLLM. To align the dynamic graph with LLMs, AnomalyLLM pre-trains a dynamic-aware encoder to generate the representations of edges and reprograms the edges using the prototypes of word embeddings. Along with the encoder, we design an in-context learning framework that integrates the information of a few labeled samples to achieve few-shot anomaly detection. Experiments on four datasets reveal that AnomalyLLM can not only significantly improve the performance of few-shot anomaly detection, but also achieve superior results on new anomalies without any update of model parameters.</span></p>
</div>
<div class="ltx_keywords">
<span class="ltx_text" id="id18.id1">Dynamic Graphs, Anomaly Detection, Few-Shot Learning, Large Language Models.</span>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The dynamic graph is a powerful data structure for modeling the evolving relationships among entities over time in many domains of applications, including recommender systems<cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib41" title="">2022</a>)</cite>, social networks<cite class="ltx_cite ltx_citemacro_citep">(Deng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib4" title="">2019</a>)</cite>, and data center DevOps<cite class="ltx_cite ltx_citemacro_citep">(John et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib16" title="">2017</a>)</cite>. Anomaly edges in dynamic graphs, which refer to the unexpected or unusual relationships between entities<cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib24" title="">2021</a>)</cite>, are valuable traces of almost all web applications, such as abnormal interactions between fraudsters and benign users or suspicious interactions between attacker nodes and user machines in computer networks. Due to the temporary nature of dynamics, the types of anomaly edges vary greatly, leading to the difficulty of acquiring sufficient labeled samples of new types. Therefore, detecting anomaly edges with few labeled samples plays a vital role in dynamic graph analysis and is of great importance for various applications, including network intrusions<cite class="ltx_cite ltx_citemacro_citep">(Wi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib40" title="">2022</a>; Balzarotti et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib2" title="">2008</a>)</cite>, financial fraud detection<cite class="ltx_cite ltx_citemacro_citep">(Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib14" title="">2022</a>; Lu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib23" title="">2022</a>)</cite>, and <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">etc.</em></p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recently, various techniques have been proposed to detect anomalies in dynamic graphs. Based on the usage of labeled information, existing solutions can be categorized into three groups: supervised methods, unsupervised methods, and semi-supervised methods. Supervised methods<cite class="ltx_cite ltx_citemacro_citep">(Meng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib25" title="">2021</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib7" title="">2021</a>; Wang and Qiao, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib38" title="">2019</a>; Miz et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib26" title="">2019</a>)</cite>utilize labeled training samples to build detectors that can identify anomalies from normal edges. Although they have demonstrated promising results, obtaining an adequate number of labeled anomaly edges for model training is challenging for dynamic graphs, which limits their scalability. Unsupervised methods<cite class="ltx_cite ltx_citemacro_citep">(Duan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib8" title="">2020a</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib19" title="">2022</a>; Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib3" title="">2021</a>; Ranshous et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib31" title="">2016</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib20" title="">2021b</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib48" title="">2019</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib44" title="">2020</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib5" title="">2019</a>)</cite> aim to identify anomalies in dynamic graphs without the use of label information. These approaches typically rely on statistical measures<cite class="ltx_cite ltx_citemacro_citep">(Duan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib8" title="">2020a</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib19" title="">2022</a>)</cite>, graph topology<cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib3" title="">2021</a>; Ranshous et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib31" title="">2016</a>)</cite>, or graph embedding techniques<cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib20" title="">2021b</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib48" title="">2019</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib44" title="">2020</a>)</cite> to capture deviations from normal patterns. Without label information, they are mainly designed to detect randomly inserted edges as anomalies and are hard to extend for other anomaly types. Only one work, namely SAD<cite class="ltx_cite ltx_citemacro_citep">(Tian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib36" title="">2023</a>)</cite>, tries to address the problem using semi-supervised learning. However, the training data used in SAD contains hundreds of labeled samples, which is also impractical in most cases. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, with the evolution of time, the anomaly edges may change and new types of anomaly edges would emerge. For these new types, only a few (less than 10) labeled samples are available for model training. Thus, the problem we aim to solve is to identify various types of anomaly edges in the dynamic graph with few labeled samples for each type. To the best of our knowledge, there is no existing work that can be directly used for this problem.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="217" id="S1.F1.g1" src="x1.png" width="398"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The motivation of AnomalyLLM. In the real world, edge anomaly types are diverse, evolving over time, and typically associated with limited labeled data.</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">With the rapid progress of foundation models, large language models (LLMs) show a remarkable capability of understanding graph data<cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib34" title="">2023</a>; Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib45" title="">2023</a>)</cite> and generalizability on new tasks<cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib32" title="">2023</a>)</cite>, which offers a promising path to achieve few shot anomaly edges detection for dynamic graphs. However, this task is also challenging in three aspects: (1) Representation of dynamic graph. Anomaly edges in dynamic graph are related to the changing of the graph topology. The edge representations should not only encode the information of adjacent topology but also be aware of the temporal dynamics. (2) Alignment between graph and neural language. LLMs operate on discrete tokens, whereas dynamic graphs change in continuous time. It remains an open challenge to align the semantics between dynamic graphs and word embeddings of LLMs. (3) Adaptation with few anomaly samples. To achieve few-shot detection, both LLMs and the anomaly detector should make full use of the label information of limited anomaly samples to identify different anomalies.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To solve the challenges, we proposed a novel method, namely AnomalyLLM, to integrate the power of LLMs and detect anomaly edges with few labeled samples. It is composed of three key modules, <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">i.e.</em>, dynamic-aware contrastive pretraining, reprogramming-based modality alignment, and in-context learning for few-shot detection. Without using the label information, AnomalyLLM first employs a novel structural-temporal sampler to organize triple-wise subgraphs and pre-trains a dynamic-aware encoder of edges with contrastive loss. To align the graph encoder to LLMs, we keep the LLMs intact and reprogram the edge embeddings by text prototypes before feeding them into the frozen LLMs. Along with the reprogrammed edges, a prompt strategy is proposed to enrich the input context and direct the ability of LLMs. Both the edge embeddings and the output of LLMs are fused to identify the normal/random sampled edges. Moreover, to achieve few-shot, we employ in-context learning framework and design a prompt template that is flexible enough to encode a few labeled samples of various anomaly types. In this way, AnomalyLLM is able to detect different types of anomalies without modifying the model parameters.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Compared to existing solutions, AnomalyLLM has the following attractive advantages: (1) <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Anomaly type-agnostic.</span> AnomalyLLM conducts the dynamic graph encoding and the modality alignment in an unsupervised manner. The information of anomaly type is only used to construct the prompt of in-context learning. For detecting different anomaly types, all we need is a new prompt, <em class="ltx_emph ltx_font_italic" id="S1.p5.1.2">i.e.</em> the model parameters are anomaly type-agnostic. (2) <span class="ltx_text ltx_font_bold" id="S1.p5.1.3">Fine-tuning free.</span> AnomalyLLM directly uses the pre-trained LLMs as the backbone and keeps it intact during the reprogramming-based modality alignment. The parameters in LLMs do not require expensive fine-tuning computations. (3) <span class="ltx_text ltx_font_bold" id="S1.p5.1.4">Simple to upgrade.</span> In AnomalyLLM, LLMs are only related to modality alignment parameters, and the training time for these parameters is not lengthy. If there is an alternative more powerful LLM, AnomalyLLM is simple to be upgraded by retraining the related parameters. The main contributions of this paper can be summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a novel method AnomalyLLM leveraging the advanced capabilities of LLMs for few-shot anomaly edge detection. To the best of our knowledge, this is the first work that integrates LLMs for anomaly detection of dynamic graphs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We introduce a reprogramming-based modality alignment technique, which represents the graph edge embeddings with some text prototypes, to bridge the gap between the dynamic-aware encoder and the LLMs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">An in-context learning strategy is designed to integrate the information of a few labeled samples, making AnomalyLLM adaptable to various anomaly types with minimal computational overhead.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">Extensive experiments on four datasets show that AnomalyLLM can not only consistently outperform all baselines in few-shot detection settings but also achieve high efficiency in both alignment tuning and inference.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="301" id="S2.F2.g1" src="x2.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Overview of AnomalyLLM. AnomalyLLM comprises three modules: Dynamic-aware Contrastive Pretraining, Reprogramming-based Modality Alignment, and In-Context Learning for Few-Shot Detection.</figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we provide an overview of existing studies related to AnomalyLLM from three perspectives: (1) graph anomaly detection (2) Large Language Models (3) few-shot learning.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Graph Anomaly Detection.</span> Existing graph anomaly detection methods can be broadly divided into three categories, supervised method, unsupervised method, and semi-supervised method. Most supervised methods <cite class="ltx_cite ltx_citemacro_citep">(Meng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib25" title="">2021</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib7" title="">2021</a>; Wang and Qiao, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib38" title="">2019</a>; Miz et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib26" title="">2019</a>)</cite> rely on labeled data to train anomaly detectors, which may result in poor performance due to the limited number of samples in real-world scenarios. Unsupervised methods <cite class="ltx_cite ltx_citemacro_citep">(Duan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib8" title="">2020a</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib19" title="">2022</a>; Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib3" title="">2021</a>; Ranshous et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib31" title="">2016</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib20" title="">2021b</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib48" title="">2019</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib44" title="">2020</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib5" title="">2019</a>)</cite> primarily identify anomalies based on statistical measures or graph topology. These techniques mainly rely on randomly-inserted edges<cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib46" title="">2018</a>)</cite> during training, which differs from actual anomalies. Recently, with the advancement of semi-supervised techniques, a hybrid methods like SAD <cite class="ltx_cite ltx_citemacro_citep">(Tian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib36" title="">2023</a>)</cite> have been proposed to incorporate both labeled and unlabeled data. However, these methods rely on a considerable amount of labeled samples. Nevertheless, all of these methods need the node attributes, which is not easy to obtained in dynamic graph data.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Large Language Models.</span> The emergence of large language models <cite class="ltx_cite ltx_citemacro_citep">(Pawelczyk et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib29" title="">2023</a>; Fifty et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib10" title="">2023</a>)</cite> has ushered in a new era of few-shot learning capabilities, exemplified by their application in In-Context reasoning with minimal examples. Many LLM-based methods <cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib34" title="">2023</a>; Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib45" title="">2023</a>)</cite> are proposed to graph analysis, primarily focusing on leveraging the rich textual attributes inherent in graphs. These techniques mainly rely on modality alignment between graph representations and textual properties. However, this reliance significantly limits their applicability in scenarios where textual attributes are absent. While some efforts <cite class="ltx_cite ltx_citemacro_citep">(Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib15" title="">2023</a>)</cite> have been made to enhance LLMs’ understanding of non-textual data like time-series, through reprogramming techniques, the application of these methodologies to graph data, especially dynamic graphs, remains largely unexplored.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">Few-shot Learning in Dynamic Graphs.</span> The challenge of limited labeled data is pervasive in real-world applications. Many studies have explored for few-shot learning, using techniques like meta-learning or contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib37" title="">2019</a>; Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib39" title="">2022</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib47" title="">2023</a>; Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib49" title="">2023</a>; Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib43" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib21" title="">2021a</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib6" title="">2020</a>)</cite>. However, these methods are generally tailored to static graphs or specific tasks <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib12" title="">2021</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib18" title="">2020</a>)</cite>, leaving a gap in anomaly edge detection for dynamic graphs. Our study addresses this gap by leveraging the potential of LLMs in a few-shot learning context for anomaly detection in dynamic graphs.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Preliminary</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Problem Definition</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.17">Let <math alttext="\mathcal{G}=[\mathcal{G}^{1},...,\mathcal{G}^{t},...,\mathcal{G}^{T}]" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.5"><semantics id="S3.SS1.p1.1.m1.5a"><mrow id="S3.SS1.p1.1.m1.5.5" xref="S3.SS1.p1.1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.5.5.5" xref="S3.SS1.p1.1.m1.5.5.5.cmml">𝒢</mi><mo id="S3.SS1.p1.1.m1.5.5.4" xref="S3.SS1.p1.1.m1.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.5.5.3.3" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml"><mo id="S3.SS1.p1.1.m1.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">[</mo><msup id="S3.SS1.p1.1.m1.3.3.1.1.1" xref="S3.SS1.p1.1.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3.1.1.1.2" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2.cmml">𝒢</mi><mn id="S3.SS1.p1.1.m1.3.3.1.1.1.3" xref="S3.SS1.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msup><mo id="S3.SS1.p1.1.m1.5.5.3.3.5" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.5.5.3.3.6" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msup id="S3.SS1.p1.1.m1.4.4.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.4.4.2.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.cmml">𝒢</mi><mi id="S3.SS1.p1.1.m1.4.4.2.2.2.3" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml">t</mi></msup><mo id="S3.SS1.p1.1.m1.5.5.3.3.7" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2" mathvariant="normal" xref="S3.SS1.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS1.p1.1.m1.5.5.3.3.8" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msup id="S3.SS1.p1.1.m1.5.5.3.3.3" xref="S3.SS1.p1.1.m1.5.5.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.5.5.3.3.3.2" xref="S3.SS1.p1.1.m1.5.5.3.3.3.2.cmml">𝒢</mi><mi id="S3.SS1.p1.1.m1.5.5.3.3.3.3" xref="S3.SS1.p1.1.m1.5.5.3.3.3.3.cmml">T</mi></msup><mo id="S3.SS1.p1.1.m1.5.5.3.3.9" stretchy="false" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.5b"><apply id="S3.SS1.p1.1.m1.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5"><eq id="S3.SS1.p1.1.m1.5.5.4.cmml" xref="S3.SS1.p1.1.m1.5.5.4"></eq><ci id="S3.SS1.p1.1.m1.5.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5.5">𝒢</ci><list id="S3.SS1.p1.1.m1.5.5.3.4.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3"><apply id="S3.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2">𝒢</ci><cn id="S3.SS1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.p1.1.m1.4.4.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2">𝒢</ci><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">…</ci><apply id="S3.SS1.p1.1.m1.5.5.3.3.3.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3.2">𝒢</ci><ci id="S3.SS1.p1.1.m1.5.5.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.5c">\mathcal{G}=[\mathcal{G}^{1},...,\mathcal{G}^{t},...,\mathcal{G}^{T}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.5d">caligraphic_G = [ caligraphic_G start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , caligraphic_G start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , … , caligraphic_G start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ]</annotation></semantics></math> denote a sequence of graph snapshots spanning timestamps <math alttext="1" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mn id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><cn id="S3.SS1.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">1</annotation></semantics></math> to <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_T</annotation></semantics></math>, where each snapshot <math alttext="\mathcal{G}^{t}=(\mathcal{V}^{t},\mathcal{E}^{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.2"><semantics id="S3.SS1.p1.4.m4.2a"><mrow id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml"><msup id="S3.SS1.p1.4.m4.2.2.4" xref="S3.SS1.p1.4.m4.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.2.2.4.2" xref="S3.SS1.p1.4.m4.2.2.4.2.cmml">𝒢</mi><mi id="S3.SS1.p1.4.m4.2.2.4.3" xref="S3.SS1.p1.4.m4.2.2.4.3.cmml">t</mi></msup><mo id="S3.SS1.p1.4.m4.2.2.3" xref="S3.SS1.p1.4.m4.2.2.3.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml"><mo id="S3.SS1.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml">(</mo><msup id="S3.SS1.p1.4.m4.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.2.cmml">𝒱</mi><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S3.SS1.p1.4.m4.2.2.2.2.4" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><msup id="S3.SS1.p1.4.m4.2.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.2.2.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.2.2.cmml">ℰ</mi><mi id="S3.SS1.p1.4.m4.2.2.2.2.2.3" xref="S3.SS1.p1.4.m4.2.2.2.2.2.3.cmml">t</mi></msup><mo id="S3.SS1.p1.4.m4.2.2.2.2.5" stretchy="false" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><apply id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2"><eq id="S3.SS1.p1.4.m4.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.3"></eq><apply id="S3.SS1.p1.4.m4.2.2.4.cmml" xref="S3.SS1.p1.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.4.1.cmml" xref="S3.SS1.p1.4.m4.2.2.4">superscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.4.2.cmml" xref="S3.SS1.p1.4.m4.2.2.4.2">𝒢</ci><ci id="S3.SS1.p1.4.m4.2.2.4.3.cmml" xref="S3.SS1.p1.4.m4.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.SS1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2"><apply id="S3.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.2">𝒱</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2.2">ℰ</ci><ci id="S3.SS1.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">\mathcal{G}^{t}=(\mathcal{V}^{t},\mathcal{E}^{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.2d">caligraphic_G start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = ( caligraphic_V start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , caligraphic_E start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math> represents the state of the graph at time <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_t</annotation></semantics></math> with <math alttext="\mathcal{V}^{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msup id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">𝒱</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝒱</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathcal{V}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">caligraphic_V start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> being the set of nodes and <math alttext="\mathcal{E}^{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msup id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">ℰ</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">ℰ</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathcal{E}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">caligraphic_E start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> the set of edges. An edge <math alttext="e_{i,j}^{t}=(v_{i}^{t},v_{j}^{t})\in\mathcal{E}^{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.4"><semantics id="S3.SS1.p1.8.m8.4a"><mrow id="S3.SS1.p1.8.m8.4.4" xref="S3.SS1.p1.8.m8.4.4.cmml"><msubsup id="S3.SS1.p1.8.m8.4.4.4" xref="S3.SS1.p1.8.m8.4.4.4.cmml"><mi id="S3.SS1.p1.8.m8.4.4.4.2.2" xref="S3.SS1.p1.8.m8.4.4.4.2.2.cmml">e</mi><mrow id="S3.SS1.p1.8.m8.2.2.2.4" xref="S3.SS1.p1.8.m8.2.2.2.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.8.m8.2.2.2.4.1" xref="S3.SS1.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.8.m8.2.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.2.cmml">j</mi></mrow><mi id="S3.SS1.p1.8.m8.4.4.4.3" xref="S3.SS1.p1.8.m8.4.4.4.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.8.m8.4.4.5" xref="S3.SS1.p1.8.m8.4.4.5.cmml">=</mo><mrow id="S3.SS1.p1.8.m8.4.4.2.2" xref="S3.SS1.p1.8.m8.4.4.2.3.cmml"><mo id="S3.SS1.p1.8.m8.4.4.2.2.3" stretchy="false" xref="S3.SS1.p1.8.m8.4.4.2.3.cmml">(</mo><msubsup id="S3.SS1.p1.8.m8.3.3.1.1.1" xref="S3.SS1.p1.8.m8.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.3.3.1.1.1.2.2" xref="S3.SS1.p1.8.m8.3.3.1.1.1.2.2.cmml">v</mi><mi id="S3.SS1.p1.8.m8.3.3.1.1.1.2.3" xref="S3.SS1.p1.8.m8.3.3.1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p1.8.m8.3.3.1.1.1.3" xref="S3.SS1.p1.8.m8.3.3.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.8.m8.4.4.2.2.4" xref="S3.SS1.p1.8.m8.4.4.2.3.cmml">,</mo><msubsup id="S3.SS1.p1.8.m8.4.4.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml">v</mi><mi id="S3.SS1.p1.8.m8.4.4.2.2.2.2.3" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.3.cmml">j</mi><mi id="S3.SS1.p1.8.m8.4.4.2.2.2.3" xref="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.8.m8.4.4.2.2.5" stretchy="false" xref="S3.SS1.p1.8.m8.4.4.2.3.cmml">)</mo></mrow><mo id="S3.SS1.p1.8.m8.4.4.6" xref="S3.SS1.p1.8.m8.4.4.6.cmml">∈</mo><msup id="S3.SS1.p1.8.m8.4.4.7" xref="S3.SS1.p1.8.m8.4.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.4.4.7.2" xref="S3.SS1.p1.8.m8.4.4.7.2.cmml">ℰ</mi><mi id="S3.SS1.p1.8.m8.4.4.7.3" xref="S3.SS1.p1.8.m8.4.4.7.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.4b"><apply id="S3.SS1.p1.8.m8.4.4.cmml" xref="S3.SS1.p1.8.m8.4.4"><and id="S3.SS1.p1.8.m8.4.4a.cmml" xref="S3.SS1.p1.8.m8.4.4"></and><apply id="S3.SS1.p1.8.m8.4.4b.cmml" xref="S3.SS1.p1.8.m8.4.4"><eq id="S3.SS1.p1.8.m8.4.4.5.cmml" xref="S3.SS1.p1.8.m8.4.4.5"></eq><apply id="S3.SS1.p1.8.m8.4.4.4.cmml" xref="S3.SS1.p1.8.m8.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.4.1.cmml" xref="S3.SS1.p1.8.m8.4.4.4">superscript</csymbol><apply id="S3.SS1.p1.8.m8.4.4.4.2.cmml" xref="S3.SS1.p1.8.m8.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.4.2.1.cmml" xref="S3.SS1.p1.8.m8.4.4.4">subscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.4.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.4.2.2">𝑒</ci><list id="S3.SS1.p1.8.m8.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.2.2.2.4"><ci id="S3.SS1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.8.m8.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2">𝑗</ci></list></apply><ci id="S3.SS1.p1.8.m8.4.4.4.3.cmml" xref="S3.SS1.p1.8.m8.4.4.4.3">𝑡</ci></apply><interval closure="open" id="S3.SS1.p1.8.m8.4.4.2.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2"><apply id="S3.SS1.p1.8.m8.3.3.1.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.8.m8.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.3.3.1.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.2.2">𝑣</ci><ci id="S3.SS1.p1.8.m8.3.3.1.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.8.m8.3.3.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.8.m8.4.4.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.8.m8.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2">𝑣</ci><ci id="S3.SS1.p1.8.m8.4.4.2.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.3">𝑗</ci></apply><ci id="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S3.SS1.p1.8.m8.4.4c.cmml" xref="S3.SS1.p1.8.m8.4.4"><in id="S3.SS1.p1.8.m8.4.4.6.cmml" xref="S3.SS1.p1.8.m8.4.4.6"></in><share href="https://arxiv.org/html/2405.07626v2#S3.SS1.p1.8.m8.4.4.2.cmml" id="S3.SS1.p1.8.m8.4.4d.cmml" xref="S3.SS1.p1.8.m8.4.4"></share><apply id="S3.SS1.p1.8.m8.4.4.7.cmml" xref="S3.SS1.p1.8.m8.4.4.7"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.7.1.cmml" xref="S3.SS1.p1.8.m8.4.4.7">superscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.7.2.cmml" xref="S3.SS1.p1.8.m8.4.4.7.2">ℰ</ci><ci id="S3.SS1.p1.8.m8.4.4.7.3.cmml" xref="S3.SS1.p1.8.m8.4.4.7.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.4c">e_{i,j}^{t}=(v_{i}^{t},v_{j}^{t})\in\mathcal{E}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.4d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) ∈ caligraphic_E start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> signifies an interaction between nodes <math alttext="v_{i}^{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><msubsup id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2.2" xref="S3.SS1.p1.9.m9.1.1.2.2.cmml">v</mi><mi id="S3.SS1.p1.9.m9.1.1.2.3" xref="S3.SS1.p1.9.m9.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">superscript</csymbol><apply id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2.2">𝑣</ci><ci id="S3.SS1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">v_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="v_{j}^{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><msubsup id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2.2" xref="S3.SS1.p1.10.m10.1.1.2.2.cmml">v</mi><mi id="S3.SS1.p1.10.m10.1.1.2.3" xref="S3.SS1.p1.10.m10.1.1.2.3.cmml">j</mi><mi id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">superscript</csymbol><apply id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2.2">𝑣</ci><ci id="S3.SS1.p1.10.m10.1.1.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.2.3">𝑗</ci></apply><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">v_{j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> at time <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_t</annotation></semantics></math>. The structure of each snapshot is encoded in a binary adjacency matrix <math alttext="\mathbf{A}^{t}\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><msup id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2.2" xref="S3.SS1.p1.12.m12.1.1.2.2.cmml">𝐀</mi><mi id="S3.SS1.p1.12.m12.1.1.2.3" xref="S3.SS1.p1.12.m12.1.1.2.3.cmml">t</mi></msup><mo id="S3.SS1.p1.12.m12.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.3.2" xref="S3.SS1.p1.12.m12.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.12.m12.1.1.3.3" xref="S3.SS1.p1.12.m12.1.1.3.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.3.3.2" xref="S3.SS1.p1.12.m12.1.1.3.3.2.cmml">n</mi><mo id="S3.SS1.p1.12.m12.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.12.m12.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.12.m12.1.1.3.3.3" xref="S3.SS1.p1.12.m12.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><in id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1"></in><apply id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2.2">𝐀</ci><ci id="S3.SS1.p1.12.m12.1.1.2.3.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.12.m12.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3"><times id="S3.SS1.p1.12.m12.1.1.3.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3.1"></times><ci id="S3.SS1.p1.12.m12.1.1.3.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3.2">𝑛</ci><ci id="S3.SS1.p1.12.m12.1.1.3.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\mathbf{A}^{t}\in\mathbb{R}^{n\times n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">bold_A start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\mathbf{A}^{t}_{i,j}=1" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.2"><semantics id="S3.SS1.p1.13.m13.2a"><mrow id="S3.SS1.p1.13.m13.2.3" xref="S3.SS1.p1.13.m13.2.3.cmml"><msubsup id="S3.SS1.p1.13.m13.2.3.2" xref="S3.SS1.p1.13.m13.2.3.2.cmml"><mi id="S3.SS1.p1.13.m13.2.3.2.2.2" xref="S3.SS1.p1.13.m13.2.3.2.2.2.cmml">𝐀</mi><mrow id="S3.SS1.p1.13.m13.2.2.2.4" xref="S3.SS1.p1.13.m13.2.2.2.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.13.m13.2.2.2.4.1" xref="S3.SS1.p1.13.m13.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.13.m13.2.2.2.2" xref="S3.SS1.p1.13.m13.2.2.2.2.cmml">j</mi></mrow><mi id="S3.SS1.p1.13.m13.2.3.2.2.3" xref="S3.SS1.p1.13.m13.2.3.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.13.m13.2.3.1" xref="S3.SS1.p1.13.m13.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.13.m13.2.3.3" xref="S3.SS1.p1.13.m13.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.2b"><apply id="S3.SS1.p1.13.m13.2.3.cmml" xref="S3.SS1.p1.13.m13.2.3"><eq id="S3.SS1.p1.13.m13.2.3.1.cmml" xref="S3.SS1.p1.13.m13.2.3.1"></eq><apply id="S3.SS1.p1.13.m13.2.3.2.cmml" xref="S3.SS1.p1.13.m13.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.2.3.2.1.cmml" xref="S3.SS1.p1.13.m13.2.3.2">subscript</csymbol><apply id="S3.SS1.p1.13.m13.2.3.2.2.cmml" xref="S3.SS1.p1.13.m13.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.2.3.2.2.1.cmml" xref="S3.SS1.p1.13.m13.2.3.2">superscript</csymbol><ci id="S3.SS1.p1.13.m13.2.3.2.2.2.cmml" xref="S3.SS1.p1.13.m13.2.3.2.2.2">𝐀</ci><ci id="S3.SS1.p1.13.m13.2.3.2.2.3.cmml" xref="S3.SS1.p1.13.m13.2.3.2.2.3">𝑡</ci></apply><list id="S3.SS1.p1.13.m13.2.2.2.3.cmml" xref="S3.SS1.p1.13.m13.2.2.2.4"><ci id="S3.SS1.p1.13.m13.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.13.m13.2.2.2.2.cmml" xref="S3.SS1.p1.13.m13.2.2.2.2">𝑗</ci></list></apply><cn id="S3.SS1.p1.13.m13.2.3.3.cmml" type="integer" xref="S3.SS1.p1.13.m13.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.2c">\mathbf{A}^{t}_{i,j}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.2d">bold_A start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = 1</annotation></semantics></math> if there is an edge between <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><msub id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">𝑣</ci><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><msub id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝑣</ci><ci id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> at timestamp <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1"><semantics id="S3.SS1.p1.16.m16.1a"><mi id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m16.1d">italic_t</annotation></semantics></math>, and <math alttext="\mathbf{A}^{t}_{i,j}=0" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m17.2"><semantics id="S3.SS1.p1.17.m17.2a"><mrow id="S3.SS1.p1.17.m17.2.3" xref="S3.SS1.p1.17.m17.2.3.cmml"><msubsup id="S3.SS1.p1.17.m17.2.3.2" xref="S3.SS1.p1.17.m17.2.3.2.cmml"><mi id="S3.SS1.p1.17.m17.2.3.2.2.2" xref="S3.SS1.p1.17.m17.2.3.2.2.2.cmml">𝐀</mi><mrow id="S3.SS1.p1.17.m17.2.2.2.4" xref="S3.SS1.p1.17.m17.2.2.2.3.cmml"><mi id="S3.SS1.p1.17.m17.1.1.1.1" xref="S3.SS1.p1.17.m17.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.17.m17.2.2.2.4.1" xref="S3.SS1.p1.17.m17.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.17.m17.2.2.2.2" xref="S3.SS1.p1.17.m17.2.2.2.2.cmml">j</mi></mrow><mi id="S3.SS1.p1.17.m17.2.3.2.2.3" xref="S3.SS1.p1.17.m17.2.3.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.17.m17.2.3.1" xref="S3.SS1.p1.17.m17.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.17.m17.2.3.3" xref="S3.SS1.p1.17.m17.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.2b"><apply id="S3.SS1.p1.17.m17.2.3.cmml" xref="S3.SS1.p1.17.m17.2.3"><eq id="S3.SS1.p1.17.m17.2.3.1.cmml" xref="S3.SS1.p1.17.m17.2.3.1"></eq><apply id="S3.SS1.p1.17.m17.2.3.2.cmml" xref="S3.SS1.p1.17.m17.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m17.2.3.2.1.cmml" xref="S3.SS1.p1.17.m17.2.3.2">subscript</csymbol><apply id="S3.SS1.p1.17.m17.2.3.2.2.cmml" xref="S3.SS1.p1.17.m17.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m17.2.3.2.2.1.cmml" xref="S3.SS1.p1.17.m17.2.3.2">superscript</csymbol><ci id="S3.SS1.p1.17.m17.2.3.2.2.2.cmml" xref="S3.SS1.p1.17.m17.2.3.2.2.2">𝐀</ci><ci id="S3.SS1.p1.17.m17.2.3.2.2.3.cmml" xref="S3.SS1.p1.17.m17.2.3.2.2.3">𝑡</ci></apply><list id="S3.SS1.p1.17.m17.2.2.2.3.cmml" xref="S3.SS1.p1.17.m17.2.2.2.4"><ci id="S3.SS1.p1.17.m17.1.1.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.17.m17.2.2.2.2.cmml" xref="S3.SS1.p1.17.m17.2.2.2.2">𝑗</ci></list></apply><cn id="S3.SS1.p1.17.m17.2.3.3.cmml" type="integer" xref="S3.SS1.p1.17.m17.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.2c">\mathbf{A}^{t}_{i,j}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.17.m17.2d">bold_A start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = 0</annotation></semantics></math> otherwise.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.7">Considering the high cost of acquiring large-scale labeled anomaly samples in real-world scenarios, we focus on detecting anomaly edges leveraging only a minimal amount of labeled data. Note that we assume the nodes in <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">caligraphic_G</annotation></semantics></math> are relatively stable. Given a specified anomaly type <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">caligraphic_T</annotation></semantics></math> and related set of few anomaly edges <math alttext="\mathcal{E}_{\mathcal{T}}=\{\mathcal{T}_{1},\cdots,\mathcal{T}_{a}\}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.3"><semantics id="S3.SS1.p2.3.m3.3a"><mrow id="S3.SS1.p2.3.m3.3.3" xref="S3.SS1.p2.3.m3.3.3.cmml"><msub id="S3.SS1.p2.3.m3.3.3.4" xref="S3.SS1.p2.3.m3.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.3.3.4.2" xref="S3.SS1.p2.3.m3.3.3.4.2.cmml">ℰ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.3.3.4.3" xref="S3.SS1.p2.3.m3.3.3.4.3.cmml">𝒯</mi></msub><mo id="S3.SS1.p2.3.m3.3.3.3" xref="S3.SS1.p2.3.m3.3.3.3.cmml">=</mo><mrow id="S3.SS1.p2.3.m3.3.3.2.2" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml"><mo id="S3.SS1.p2.3.m3.3.3.2.2.3" stretchy="false" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p2.3.m3.2.2.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.2.2.1.1.1.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml">𝒯</mi><mn id="S3.SS1.p2.3.m3.2.2.1.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.3.m3.3.3.2.2.4" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p2.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p2.3.m3.1.1.cmml">⋯</mi><mo id="S3.SS1.p2.3.m3.3.3.2.2.5" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.3.m3.3.3.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.3.3.2.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.2.cmml">𝒯</mi><mi id="S3.SS1.p2.3.m3.3.3.2.2.2.3" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3.cmml">a</mi></msub><mo id="S3.SS1.p2.3.m3.3.3.2.2.6" stretchy="false" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.3b"><apply id="S3.SS1.p2.3.m3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3"><eq id="S3.SS1.p2.3.m3.3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3.3"></eq><apply id="S3.SS1.p2.3.m3.3.3.4.cmml" xref="S3.SS1.p2.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.4.1.cmml" xref="S3.SS1.p2.3.m3.3.3.4">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.4.2.cmml" xref="S3.SS1.p2.3.m3.3.3.4.2">ℰ</ci><ci id="S3.SS1.p2.3.m3.3.3.4.3.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3">𝒯</ci></apply><set id="S3.SS1.p2.3.m3.3.3.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2"><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2">𝒯</ci><cn id="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">⋯</ci><apply id="S3.SS1.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.2">𝒯</ci><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3">𝑎</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.3c">\mathcal{E}_{\mathcal{T}}=\{\mathcal{T}_{1},\cdots,\mathcal{T}_{a}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.3d">caligraphic_E start_POSTSUBSCRIPT caligraphic_T end_POSTSUBSCRIPT = { caligraphic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , caligraphic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_a</annotation></semantics></math> is the number of anomaly edges, our objective is to detect whether edge <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.2"><semantics id="S3.SS1.p2.5.m5.2a"><msubsup id="S3.SS1.p2.5.m5.2.3" xref="S3.SS1.p2.5.m5.2.3.cmml"><mi id="S3.SS1.p2.5.m5.2.3.2.2" xref="S3.SS1.p2.5.m5.2.3.2.2.cmml">e</mi><mrow id="S3.SS1.p2.5.m5.2.2.2.4" xref="S3.SS1.p2.5.m5.2.2.2.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.5.m5.2.2.2.4.1" xref="S3.SS1.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.5.m5.2.2.2.2" xref="S3.SS1.p2.5.m5.2.2.2.2.cmml">j</mi></mrow><mi id="S3.SS1.p2.5.m5.2.3.3" xref="S3.SS1.p2.5.m5.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.2b"><apply id="S3.SS1.p2.5.m5.2.3.cmml" xref="S3.SS1.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.2.3.1.cmml" xref="S3.SS1.p2.5.m5.2.3">superscript</csymbol><apply id="S3.SS1.p2.5.m5.2.3.2.cmml" xref="S3.SS1.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.2.3.2.1.cmml" xref="S3.SS1.p2.5.m5.2.3">subscript</csymbol><ci id="S3.SS1.p2.5.m5.2.3.2.2.cmml" xref="S3.SS1.p2.5.m5.2.3.2.2">𝑒</ci><list id="S3.SS1.p2.5.m5.2.2.2.3.cmml" xref="S3.SS1.p2.5.m5.2.2.2.4"><ci id="S3.SS1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1">𝑖</ci><ci id="S3.SS1.p2.5.m5.2.2.2.2.cmml" xref="S3.SS1.p2.5.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S3.SS1.p2.5.m5.2.3.3.cmml" xref="S3.SS1.p2.5.m5.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> in <math alttext="\mathcal{G}^{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><msup id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">𝒢</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝒢</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathcal{G}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">caligraphic_G start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> is an anomaly edge of type <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">caligraphic_T</annotation></semantics></math> or not.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Overview of AnomalyLLM</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S2.F2" title="Figure 2 ‣ 2. Related Work ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, AnomalyLLM is a LLM enhanced few-shot anomaly detection framework. It consists of three key modules: dynamic-aware encoder, modality alignment and in-context learning for detection.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.5">Given an edge <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.2"><semantics id="S3.I1.i1.p1.1.m1.2a"><msubsup id="S3.I1.i1.p1.1.m1.2.3" xref="S3.I1.i1.p1.1.m1.2.3.cmml"><mi id="S3.I1.i1.p1.1.m1.2.3.2.2" xref="S3.I1.i1.p1.1.m1.2.3.2.2.cmml">e</mi><mrow id="S3.I1.i1.p1.1.m1.2.2.2.4" xref="S3.I1.i1.p1.1.m1.2.2.2.3.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.I1.i1.p1.1.m1.2.2.2.4.1" xref="S3.I1.i1.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.I1.i1.p1.1.m1.2.2.2.2" xref="S3.I1.i1.p1.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S3.I1.i1.p1.1.m1.2.3.3" xref="S3.I1.i1.p1.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.2b"><apply id="S3.I1.i1.p1.1.m1.2.3.cmml" xref="S3.I1.i1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.2.3.1.cmml" xref="S3.I1.i1.p1.1.m1.2.3">superscript</csymbol><apply id="S3.I1.i1.p1.1.m1.2.3.2.cmml" xref="S3.I1.i1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.2.3.2.1.cmml" xref="S3.I1.i1.p1.1.m1.2.3">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.2.3.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.3.2.2">𝑒</ci><list id="S3.I1.i1.p1.1.m1.2.2.2.3.cmml" xref="S3.I1.i1.p1.1.m1.2.2.2.4"><ci id="S3.I1.i1.p1.1.m1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S3.I1.i1.p1.1.m1.2.2.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S3.I1.i1.p1.1.m1.2.3.3.cmml" xref="S3.I1.i1.p1.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, the dynamic-aware encoder captures the related temporal and structure information from the dynamic graph, and encodes it into the edge representation. We construct a series of structural-temporal subgraphs <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.2"><semantics id="S3.I1.i1.p1.2.m2.2a"><msubsup id="S3.I1.i1.p1.2.m2.2.3" xref="S3.I1.i1.p1.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.2.m2.2.3.2.2" xref="S3.I1.i1.p1.2.m2.2.3.2.2.cmml">𝒮</mi><mrow id="S3.I1.i1.p1.2.m2.2.2.2.4" xref="S3.I1.i1.p1.2.m2.2.2.2.3.cmml"><mi id="S3.I1.i1.p1.2.m2.1.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.I1.i1.p1.2.m2.2.2.2.4.1" xref="S3.I1.i1.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.I1.i1.p1.2.m2.2.2.2.2" xref="S3.I1.i1.p1.2.m2.2.2.2.2.cmml">j</mi></mrow><mi id="S3.I1.i1.p1.2.m2.2.3.3" xref="S3.I1.i1.p1.2.m2.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.2b"><apply id="S3.I1.i1.p1.2.m2.2.3.cmml" xref="S3.I1.i1.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.2.3.1.cmml" xref="S3.I1.i1.p1.2.m2.2.3">superscript</csymbol><apply id="S3.I1.i1.p1.2.m2.2.3.2.cmml" xref="S3.I1.i1.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.2.3.2.1.cmml" xref="S3.I1.i1.p1.2.m2.2.3">subscript</csymbol><ci id="S3.I1.i1.p1.2.m2.2.3.2.2.cmml" xref="S3.I1.i1.p1.2.m2.2.3.2.2">𝒮</ci><list id="S3.I1.i1.p1.2.m2.2.2.2.3.cmml" xref="S3.I1.i1.p1.2.m2.2.2.2.4"><ci id="S3.I1.i1.p1.2.m2.1.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1">𝑖</ci><ci id="S3.I1.i1.p1.2.m2.2.2.2.2.cmml" xref="S3.I1.i1.p1.2.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S3.I1.i1.p1.2.m2.2.3.3.cmml" xref="S3.I1.i1.p1.2.m2.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.2.m2.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> of edge <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.3.m3.2"><semantics id="S3.I1.i1.p1.3.m3.2a"><msubsup id="S3.I1.i1.p1.3.m3.2.3" xref="S3.I1.i1.p1.3.m3.2.3.cmml"><mi id="S3.I1.i1.p1.3.m3.2.3.2.2" xref="S3.I1.i1.p1.3.m3.2.3.2.2.cmml">e</mi><mrow id="S3.I1.i1.p1.3.m3.2.2.2.4" xref="S3.I1.i1.p1.3.m3.2.2.2.3.cmml"><mi id="S3.I1.i1.p1.3.m3.1.1.1.1" xref="S3.I1.i1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.I1.i1.p1.3.m3.2.2.2.4.1" xref="S3.I1.i1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.I1.i1.p1.3.m3.2.2.2.2" xref="S3.I1.i1.p1.3.m3.2.2.2.2.cmml">j</mi></mrow><mi id="S3.I1.i1.p1.3.m3.2.3.3" xref="S3.I1.i1.p1.3.m3.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.2b"><apply id="S3.I1.i1.p1.3.m3.2.3.cmml" xref="S3.I1.i1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.3.m3.2.3.1.cmml" xref="S3.I1.i1.p1.3.m3.2.3">superscript</csymbol><apply id="S3.I1.i1.p1.3.m3.2.3.2.cmml" xref="S3.I1.i1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.3.m3.2.3.2.1.cmml" xref="S3.I1.i1.p1.3.m3.2.3">subscript</csymbol><ci id="S3.I1.i1.p1.3.m3.2.3.2.2.cmml" xref="S3.I1.i1.p1.3.m3.2.3.2.2">𝑒</ci><list id="S3.I1.i1.p1.3.m3.2.2.2.3.cmml" xref="S3.I1.i1.p1.3.m3.2.2.2.4"><ci id="S3.I1.i1.p1.3.m3.1.1.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1.1.1">𝑖</ci><ci id="S3.I1.i1.p1.3.m3.2.2.2.2.cmml" xref="S3.I1.i1.p1.3.m3.2.2.2.2">𝑗</ci></list></apply><ci id="S3.I1.i1.p1.3.m3.2.3.3.cmml" xref="S3.I1.i1.p1.3.m3.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.3.m3.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. Based on these subgraphs, AnomalyLLM generates the edge embedding <math alttext="\mathbf{r}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.4.m4.1"><semantics id="S3.I1.i1.p1.4.m4.1a"><mi id="S3.I1.i1.p1.4.m4.1.1" xref="S3.I1.i1.p1.4.m4.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.1b"><ci id="S3.I1.i1.p1.4.m4.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.1c">\mathbf{r}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.4.m4.1d">bold_r</annotation></semantics></math> by fusing all the related subgraphs in <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.5.m5.2"><semantics id="S3.I1.i1.p1.5.m5.2a"><msubsup id="S3.I1.i1.p1.5.m5.2.3" xref="S3.I1.i1.p1.5.m5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.5.m5.2.3.2.2" xref="S3.I1.i1.p1.5.m5.2.3.2.2.cmml">𝒮</mi><mrow id="S3.I1.i1.p1.5.m5.2.2.2.4" xref="S3.I1.i1.p1.5.m5.2.2.2.3.cmml"><mi id="S3.I1.i1.p1.5.m5.1.1.1.1" xref="S3.I1.i1.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.I1.i1.p1.5.m5.2.2.2.4.1" xref="S3.I1.i1.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.I1.i1.p1.5.m5.2.2.2.2" xref="S3.I1.i1.p1.5.m5.2.2.2.2.cmml">j</mi></mrow><mi id="S3.I1.i1.p1.5.m5.2.3.3" xref="S3.I1.i1.p1.5.m5.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.5.m5.2b"><apply id="S3.I1.i1.p1.5.m5.2.3.cmml" xref="S3.I1.i1.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.2.3.1.cmml" xref="S3.I1.i1.p1.5.m5.2.3">superscript</csymbol><apply id="S3.I1.i1.p1.5.m5.2.3.2.cmml" xref="S3.I1.i1.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.2.3.2.1.cmml" xref="S3.I1.i1.p1.5.m5.2.3">subscript</csymbol><ci id="S3.I1.i1.p1.5.m5.2.3.2.2.cmml" xref="S3.I1.i1.p1.5.m5.2.3.2.2">𝒮</ci><list id="S3.I1.i1.p1.5.m5.2.2.2.3.cmml" xref="S3.I1.i1.p1.5.m5.2.2.2.4"><ci id="S3.I1.i1.p1.5.m5.1.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S3.I1.i1.p1.5.m5.2.2.2.2.cmml" xref="S3.I1.i1.p1.5.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S3.I1.i1.p1.5.m5.2.3.3.cmml" xref="S3.I1.i1.p1.5.m5.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.5.m5.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.5.m5.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.4">Taking <math alttext="\mathbf{r}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">\mathbf{r}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">bold_r</annotation></semantics></math> as the input, we first select some dynamic graph-related words and cluster them into <math alttext="\textbf{V}^{\prime}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1"><semantics id="S3.I1.i2.p1.2.m2.1a"><msup id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2a.cmml">V</mtext><mo id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.I1.i2.p1.2.m2.1.1.2a.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">V</mtext></ci><ci id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">\textbf{V}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.1d">V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> prototypes. AnomalyLLM adopt self-attention to reprogram the edge embedding <math alttext="\mathbf{r}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.3.m3.1"><semantics id="S3.I1.i2.p1.3.m3.1a"><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">\mathbf{r}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.3.m3.1d">bold_r</annotation></semantics></math> with the textual prototype and obtain <math alttext="\mathbf{h}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.4.m4.1"><semantics id="S3.I1.i2.p1.4.m4.1a"><mi id="S3.I1.i2.p1.4.m4.1.1" xref="S3.I1.i2.p1.4.m4.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.4.m4.1b"><ci id="S3.I1.i2.p1.4.m4.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.4.m4.1c">\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.4.m4.1d">bold_h</annotation></semantics></math>. Both existing edges and randomly selected edges are employed to construct pseudo labels for alignment fine-tuning.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">For few-shot detection, we utilize in-context learning to encode the label information from a few anomaly samples. A prompt template consisting of role definition, task description, examples and questions is designed to
embed the edge representations <math alttext="\mathbf{h}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.1.m1.1"><semantics id="S3.I1.i3.p1.1.m1.1a"><mi id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><ci id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.1.m1.1d">bold_h</annotation></semantics></math> and detect various types of anomalies without any update of model parameters.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Methodology</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S2.F2" title="Figure 2 ‣ 2. Related Work ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, AnomalyLLM consists of three key modules, <em class="ltx_emph ltx_font_italic" id="S4.p1.1.1">i.e.</em>, dynamic-aware contrastive pretraining, reprogramming-based modality alignment, and in-context learning for few-shot detection. Next, we specify the details of each module respectively.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Dynamic-aware Contrastive Pretraining</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Dynamic graphs are changing over time, leading to the difficulty in representing the structure and temporal information of the edges. Existing solutions either focus on the structure information by averaging the context of adjacent nodes<cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib48" title="">2019</a>)</cite><cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib3" title="">2021</a>)</cite> or directly use sequential models to capture the temporal dynamics<cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib20" title="">2021b</a>)</cite><cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib46" title="">2018</a>)</cite>, which are not sufficient for the anomaly detection. In this section, we propose the dynamic-aware contrastive pretraining to systematically model both aspects and represent the edges with their adjacent subgraphs. The whole module consists of two subparts, <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.1.1">i.e.</em> dynamic-aware encoder and contrastive learning-based optimization.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span>Dynamic-aware Encoder</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.3">Given an edge <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.1.m1.2"><semantics id="S4.SS1.SSS1.p1.1.m1.2a"><msubsup id="S4.SS1.SSS1.p1.1.m1.2.3" xref="S4.SS1.SSS1.p1.1.m1.2.3.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.2.3.2.2" xref="S4.SS1.SSS1.p1.1.m1.2.3.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p1.1.m1.2.2.2.4" xref="S4.SS1.SSS1.p1.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p1.1.m1.2.2.2.4.1" xref="S4.SS1.SSS1.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p1.1.m1.2.2.2.2" xref="S4.SS1.SSS1.p1.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p1.1.m1.2.3.3" xref="S4.SS1.SSS1.p1.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.2b"><apply id="S4.SS1.SSS1.p1.1.m1.2.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p1.1.m1.2.3.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p1.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.3.2.2">𝑒</ci><list id="S4.SS1.SSS1.p1.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.2.2.4"><ci id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p1.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p1.1.m1.2.3.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.1.m1.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we first construct structrual-temporal subgraphs <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.2.m2.2"><semantics id="S4.SS1.SSS1.p1.2.m2.2a"><msubsup id="S4.SS1.SSS1.p1.2.m2.2.3" xref="S4.SS1.SSS1.p1.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p1.2.m2.2.3.2.2" xref="S4.SS1.SSS1.p1.2.m2.2.3.2.2.cmml">𝒮</mi><mrow id="S4.SS1.SSS1.p1.2.m2.2.2.2.4" xref="S4.SS1.SSS1.p1.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p1.2.m2.1.1.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p1.2.m2.2.2.2.4.1" xref="S4.SS1.SSS1.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p1.2.m2.2.2.2.2" xref="S4.SS1.SSS1.p1.2.m2.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p1.2.m2.2.3.3" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.2b"><apply id="S4.SS1.SSS1.p1.2.m2.2.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.2.m2.2.3.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p1.2.m2.2.3.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.2.m2.2.3.2.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p1.2.m2.2.3.2.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.2.2">𝒮</ci><list id="S4.SS1.SSS1.p1.2.m2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.2.2.4"><ci id="S4.SS1.SSS1.p1.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p1.2.m2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p1.2.m2.2.3.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.2.m2.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, then fed it into the subgarph-based edge encoder to obtain the edge representation <math alttext="\mathbf{r}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.3.m3.2"><semantics id="S4.SS1.SSS1.p1.3.m3.2a"><msubsup id="S4.SS1.SSS1.p1.3.m3.2.3" xref="S4.SS1.SSS1.p1.3.m3.2.3.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.2.3.2.2" xref="S4.SS1.SSS1.p1.3.m3.2.3.2.2.cmml">𝐫</mi><mrow id="S4.SS1.SSS1.p1.3.m3.2.2.2.4" xref="S4.SS1.SSS1.p1.3.m3.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.1.1.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p1.3.m3.2.2.2.4.1" xref="S4.SS1.SSS1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p1.3.m3.2.2.2.2" xref="S4.SS1.SSS1.p1.3.m3.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p1.3.m3.2.3.3" xref="S4.SS1.SSS1.p1.3.m3.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.3.m3.2b"><apply id="S4.SS1.SSS1.p1.3.m3.2.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.2.3.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p1.3.m3.2.3.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.2.3.2.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p1.3.m3.2.3.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.3.2.2">𝐫</ci><list id="S4.SS1.SSS1.p1.3.m3.2.2.2.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.2.2.4"><ci id="S4.SS1.SSS1.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p1.3.m3.2.2.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p1.3.m3.2.3.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.3.m3.2c">\mathbf{r}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.3.m3.2d">bold_r start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.6"><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p2.6.1">Structural-Temporal Subgraph Construction. </span>
For an edge <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.1.m1.2"><semantics id="S4.SS1.SSS1.p2.1.m1.2a"><msubsup id="S4.SS1.SSS1.p2.1.m1.2.3" xref="S4.SS1.SSS1.p2.1.m1.2.3.cmml"><mi id="S4.SS1.SSS1.p2.1.m1.2.3.2.2" xref="S4.SS1.SSS1.p2.1.m1.2.3.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p2.1.m1.2.2.2.4" xref="S4.SS1.SSS1.p2.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p2.1.m1.1.1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p2.1.m1.2.2.2.4.1" xref="S4.SS1.SSS1.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p2.1.m1.2.2.2.2" xref="S4.SS1.SSS1.p2.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p2.1.m1.2.3.3" xref="S4.SS1.SSS1.p2.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.2b"><apply id="S4.SS1.SSS1.p2.1.m1.2.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p2.1.m1.2.3.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p2.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.3.2.2">𝑒</ci><list id="S4.SS1.SSS1.p2.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.2.2.4"><ci id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p2.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p2.1.m1.2.3.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.1.m1.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we design to construct structural-temporal subgraphs for both source and target nodes.
Given an edge <math alttext="e_{i,j}^{t}=(v_{i}^{t},v_{j}^{t})\in\mathcal{E}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.2.m2.4"><semantics id="S4.SS1.SSS1.p2.2.m2.4a"><mrow id="S4.SS1.SSS1.p2.2.m2.4.4" xref="S4.SS1.SSS1.p2.2.m2.4.4.cmml"><msubsup id="S4.SS1.SSS1.p2.2.m2.4.4.4" xref="S4.SS1.SSS1.p2.2.m2.4.4.4.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.4.4.4.2.2" xref="S4.SS1.SSS1.p2.2.m2.4.4.4.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p2.2.m2.2.2.2.4" xref="S4.SS1.SSS1.p2.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.1.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p2.2.m2.2.2.2.4.1" xref="S4.SS1.SSS1.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p2.2.m2.2.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p2.2.m2.4.4.4.3" xref="S4.SS1.SSS1.p2.2.m2.4.4.4.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.4.4.5" xref="S4.SS1.SSS1.p2.2.m2.4.4.5.cmml">=</mo><mrow id="S4.SS1.SSS1.p2.2.m2.4.4.2.2" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.3.cmml"><mo id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.3" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.3.cmml">(</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.2" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.3" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.4" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.3.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.2.cmml">v</mi><mi id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.5" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.3.cmml">)</mo></mrow><mo id="S4.SS1.SSS1.p2.2.m2.4.4.6" xref="S4.SS1.SSS1.p2.2.m2.4.4.6.cmml">∈</mo><msup id="S4.SS1.SSS1.p2.2.m2.4.4.7" xref="S4.SS1.SSS1.p2.2.m2.4.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.2.m2.4.4.7.2" xref="S4.SS1.SSS1.p2.2.m2.4.4.7.2.cmml">ℰ</mi><mi id="S4.SS1.SSS1.p2.2.m2.4.4.7.3" xref="S4.SS1.SSS1.p2.2.m2.4.4.7.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.2.m2.4b"><apply id="S4.SS1.SSS1.p2.2.m2.4.4.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4"><and id="S4.SS1.SSS1.p2.2.m2.4.4a.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4"></and><apply id="S4.SS1.SSS1.p2.2.m2.4.4b.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4"><eq id="S4.SS1.SSS1.p2.2.m2.4.4.5.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.5"></eq><apply id="S4.SS1.SSS1.p2.2.m2.4.4.4.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.4.4.4.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.4">superscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.4.4.4.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.4.4.4.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.4">subscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.4.4.4.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.4.2.2">𝑒</ci><list id="S4.SS1.SSS1.p2.2.m2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.2.2.2.4"><ci id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p2.2.m2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p2.2.m2.4.4.4.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.4.3">𝑡</ci></apply><interval closure="open" id="S4.SS1.SSS1.p2.2.m2.4.4.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2"><apply id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.3.3.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2">superscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S4.SS1.SSS1.p2.2.m2.4.4c.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4"><in id="S4.SS1.SSS1.p2.2.m2.4.4.6.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.6"></in><share href="https://arxiv.org/html/2405.07626v2#S4.SS1.SSS1.p2.2.m2.4.4.2.cmml" id="S4.SS1.SSS1.p2.2.m2.4.4d.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4"></share><apply id="S4.SS1.SSS1.p2.2.m2.4.4.7.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.7"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.4.4.7.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.7">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.4.4.7.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.7.2">ℰ</ci><ci id="S4.SS1.SSS1.p2.2.m2.4.4.7.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4.7.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.2.m2.4c">e_{i,j}^{t}=(v_{i}^{t},v_{j}^{t})\in\mathcal{E}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.2.m2.4d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) ∈ caligraphic_E start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we first construct a diffusion matrix<cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib20" title="">2021b</a>)</cite> <math alttext="\textbf{D}^{t}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.3.m3.1"><semantics id="S4.SS1.SSS1.p2.3.m3.1a"><mrow id="S4.SS1.SSS1.p2.3.m3.1.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.cmml"><msup id="S4.SS1.SSS1.p2.3.m3.1.1.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS1.p2.3.m3.1.1.2.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.2a.cmml">D</mtext><mi id="S4.SS1.SSS1.p2.3.m3.1.1.2.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.3.cmml">t</mi></msup><mo id="S4.SS1.SSS1.p2.3.m3.1.1.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS1.p2.3.m3.1.1.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.cmml"><mi id="S4.SS1.SSS1.p2.3.m3.1.1.3.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS1.p2.3.m3.1.1.3.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.2.cmml">N</mi><mo id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.3.m3.1b"><apply id="S4.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1"><in id="S4.SS1.SSS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.1"></in><apply id="S4.SS1.SSS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2">superscript</csymbol><ci id="S4.SS1.SSS1.p2.3.m3.1.1.2.2a.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS1.p2.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.2">D</mtext></ci><ci id="S4.SS1.SSS1.p2.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3"><times id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.1"></times><ci id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.2">𝑁</ci><ci id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.3.m3.1c">\textbf{D}^{t}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.3.m3.1d">D start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> of <math alttext="\mathcal{E}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.4.m4.1"><semantics id="S4.SS1.SSS1.p2.4.m4.1a"><msup id="S4.SS1.SSS1.p2.4.m4.1.1" xref="S4.SS1.SSS1.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.4.m4.1.1.2" xref="S4.SS1.SSS1.p2.4.m4.1.1.2.cmml">ℰ</mi><mi id="S4.SS1.SSS1.p2.4.m4.1.1.3" xref="S4.SS1.SSS1.p2.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.4.m4.1b"><apply id="S4.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1.2">ℰ</ci><ci id="S4.SS1.SSS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.4.m4.1c">\mathcal{E}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.4.m4.1d">caligraphic_E start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> to select the structure context, where <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.5.m5.1"><semantics id="S4.SS1.SSS1.p2.5.m5.1a"><mi id="S4.SS1.SSS1.p2.5.m5.1.1" xref="S4.SS1.SSS1.p2.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.5.m5.1b"><ci id="S4.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.5.m5.1d">italic_N</annotation></semantics></math> represents the number of nodes in <math alttext="\mathcal{E}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.6.m6.1"><semantics id="S4.SS1.SSS1.p2.6.m6.1a"><msup id="S4.SS1.SSS1.p2.6.m6.1.1" xref="S4.SS1.SSS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.6.m6.1.1.2" xref="S4.SS1.SSS1.p2.6.m6.1.1.2.cmml">ℰ</mi><mi id="S4.SS1.SSS1.p2.6.m6.1.1.3" xref="S4.SS1.SSS1.p2.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.6.m6.1b"><apply id="S4.SS1.SSS1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.SSS1.p2.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.SSS1.p2.6.m6.1.1.2">ℰ</ci><ci id="S4.SS1.SSS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.SSS1.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.6.m6.1c">\mathcal{E}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.6.m6.1d">caligraphic_E start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p3">
<p class="ltx_p" id="S4.SS1.SSS1.p3.21">Each row <math alttext="d_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.1.m1.1"><semantics id="S4.SS1.SSS1.p3.1.m1.1a"><msubsup id="S4.SS1.SSS1.p3.1.m1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p3.1.m1.1.1.2.2" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.2.cmml">d</mi><mi id="S4.SS1.SSS1.p3.1.m1.1.1.2.3" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.1.m1.1.1.3" xref="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.1.m1.1b"><apply id="S4.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.2">𝑑</ci><ci id="S4.SS1.SSS1.p3.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.1.m1.1c">d_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> of <math alttext="\textbf{D}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.2.m2.1"><semantics id="S4.SS1.SSS1.p3.2.m2.1a"><msup id="S4.SS1.SSS1.p3.2.m2.1.1" xref="S4.SS1.SSS1.p3.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS1.p3.2.m2.1.1.2" xref="S4.SS1.SSS1.p3.2.m2.1.1.2a.cmml">D</mtext><mi id="S4.SS1.SSS1.p3.2.m2.1.1.3" xref="S4.SS1.SSS1.p3.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.2.m2.1b"><apply id="S4.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p3.2.m2.1.1.2a.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2">D</mtext></ci><ci id="S4.SS1.SSS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.2.m2.1c">\textbf{D}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.2.m2.1d">D start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> indicates the connectivity strength of the <math alttext="i-th" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.3.m3.1"><semantics id="S4.SS1.SSS1.p3.3.m3.1a"><mrow id="S4.SS1.SSS1.p3.3.m3.1.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p3.3.m3.1.1.2" xref="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml">i</mi><mo id="S4.SS1.SSS1.p3.3.m3.1.1.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.1.cmml">−</mo><mrow id="S4.SS1.SSS1.p3.3.m3.1.1.3" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.cmml"><mi id="S4.SS1.SSS1.p3.3.m3.1.1.3.2" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS1.p3.3.m3.1.1.3.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS1.p3.3.m3.1.1.3.3" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.3.m3.1b"><apply id="S4.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1"><minus id="S4.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.1"></minus><ci id="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.2">𝑖</ci><apply id="S4.SS1.SSS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.3"><times id="S4.SS1.SSS1.p3.3.m3.1.1.3.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.1"></times><ci id="S4.SS1.SSS1.p3.3.m3.1.1.3.2.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.2">𝑡</ci><ci id="S4.SS1.SSS1.p3.3.m3.1.1.3.3.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.3.m3.1c">i-th</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.3.m3.1d">italic_i - italic_t italic_h</annotation></semantics></math> node with all other nodes in the graph <math alttext="\mathcal{G}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.4.m4.1"><semantics id="S4.SS1.SSS1.p3.4.m4.1a"><msup id="S4.SS1.SSS1.p3.4.m4.1.1" xref="S4.SS1.SSS1.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.4.m4.1.1.2" xref="S4.SS1.SSS1.p3.4.m4.1.1.2.cmml">𝒢</mi><mi id="S4.SS1.SSS1.p3.4.m4.1.1.3" xref="S4.SS1.SSS1.p3.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.4.m4.1b"><apply id="S4.SS1.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1.2">𝒢</ci><ci id="S4.SS1.SSS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.4.m4.1c">\mathcal{G}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.4.m4.1d">caligraphic_G start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. For <math alttext="e_{i,j}^{t}=(v_{i}^{t},v_{j}^{t})" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.5.m5.4"><semantics id="S4.SS1.SSS1.p3.5.m5.4a"><mrow id="S4.SS1.SSS1.p3.5.m5.4.4" xref="S4.SS1.SSS1.p3.5.m5.4.4.cmml"><msubsup id="S4.SS1.SSS1.p3.5.m5.4.4.4" xref="S4.SS1.SSS1.p3.5.m5.4.4.4.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.4.4.4.2.2" xref="S4.SS1.SSS1.p3.5.m5.4.4.4.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p3.5.m5.2.2.2.4" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.1.1.1.1" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.1" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p3.5.m5.2.2.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p3.5.m5.4.4.4.3" xref="S4.SS1.SSS1.p3.5.m5.4.4.4.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.5.m5.4.4.3" xref="S4.SS1.SSS1.p3.5.m5.4.4.3.cmml">=</mo><mrow id="S4.SS1.SSS1.p3.5.m5.4.4.2.2" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.3.cmml"><mo id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.3" stretchy="false" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.3.cmml">(</mo><msubsup id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.2" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.3" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.3" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.4" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.3.cmml">,</mo><msubsup id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.2" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.2.cmml">v</mi><mi id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.3" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.3" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.5" stretchy="false" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.5.m5.4b"><apply id="S4.SS1.SSS1.p3.5.m5.4.4.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4"><eq id="S4.SS1.SSS1.p3.5.m5.4.4.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.3"></eq><apply id="S4.SS1.SSS1.p3.5.m5.4.4.4.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.4.4.4.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.4">superscript</csymbol><apply id="S4.SS1.SSS1.p3.5.m5.4.4.4.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.4.4.4.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.4">subscript</csymbol><ci id="S4.SS1.SSS1.p3.5.m5.4.4.4.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.4.2.2">𝑒</ci><list id="S4.SS1.SSS1.p3.5.m5.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4"><ci id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p3.5.m5.4.4.4.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.4.3">𝑡</ci></apply><interval closure="open" id="S4.SS1.SSS1.p3.5.m5.4.4.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2"><apply id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.3.3.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2">superscript</csymbol><apply id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.4.4.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.5.m5.4c">e_{i,j}^{t}=(v_{i}^{t},v_{j}^{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.5.m5.4d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math>, we utilize <math alttext="d_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.6.m6.1"><semantics id="S4.SS1.SSS1.p3.6.m6.1a"><msubsup id="S4.SS1.SSS1.p3.6.m6.1.1" xref="S4.SS1.SSS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.SSS1.p3.6.m6.1.1.2.2" xref="S4.SS1.SSS1.p3.6.m6.1.1.2.2.cmml">d</mi><mi id="S4.SS1.SSS1.p3.6.m6.1.1.2.3" xref="S4.SS1.SSS1.p3.6.m6.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.6.m6.1.1.3" xref="S4.SS1.SSS1.p3.6.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.6.m6.1b"><apply id="S4.SS1.SSS1.p3.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.6.m6.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.6.m6.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1.2.2">𝑑</ci><ci id="S4.SS1.SSS1.p3.6.m6.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.6.m6.1c">d_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="d_{j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.7.m7.1"><semantics id="S4.SS1.SSS1.p3.7.m7.1a"><msubsup id="S4.SS1.SSS1.p3.7.m7.1.1" xref="S4.SS1.SSS1.p3.7.m7.1.1.cmml"><mi id="S4.SS1.SSS1.p3.7.m7.1.1.2.2" xref="S4.SS1.SSS1.p3.7.m7.1.1.2.2.cmml">d</mi><mi id="S4.SS1.SSS1.p3.7.m7.1.1.2.3" xref="S4.SS1.SSS1.p3.7.m7.1.1.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p3.7.m7.1.1.3" xref="S4.SS1.SSS1.p3.7.m7.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.7.m7.1b"><apply id="S4.SS1.SSS1.p3.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.7.m7.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.7.m7.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1.2.2">𝑑</ci><ci id="S4.SS1.SSS1.p3.7.m7.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p3.7.m7.1.1.3.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.7.m7.1c">d_{j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.7.m7.1d">italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> to select the most significant top-<math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.8.m8.1"><semantics id="S4.SS1.SSS1.p3.8.m8.1a"><mi id="S4.SS1.SSS1.p3.8.m8.1.1" xref="S4.SS1.SSS1.p3.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.8.m8.1b"><ci id="S4.SS1.SSS1.p3.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p3.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.8.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.8.m8.1d">italic_K</annotation></semantics></math> adjacent nodes of <math alttext="\mathcal{V}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.9.m9.1"><semantics id="S4.SS1.SSS1.p3.9.m9.1a"><msup id="S4.SS1.SSS1.p3.9.m9.1.1" xref="S4.SS1.SSS1.p3.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.9.m9.1.1.2" xref="S4.SS1.SSS1.p3.9.m9.1.1.2.cmml">𝒱</mi><mi id="S4.SS1.SSS1.p3.9.m9.1.1.3" xref="S4.SS1.SSS1.p3.9.m9.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.9.m9.1b"><apply id="S4.SS1.SSS1.p3.9.m9.1.1.cmml" xref="S4.SS1.SSS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.9.m9.1.1.1.cmml" xref="S4.SS1.SSS1.p3.9.m9.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p3.9.m9.1.1.2.cmml" xref="S4.SS1.SSS1.p3.9.m9.1.1.2">𝒱</ci><ci id="S4.SS1.SSS1.p3.9.m9.1.1.3.cmml" xref="S4.SS1.SSS1.p3.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.9.m9.1c">\mathcal{V}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.9.m9.1d">caligraphic_V start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> to form <math alttext="\mathcal{V}_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.10.m10.1"><semantics id="S4.SS1.SSS1.p3.10.m10.1a"><msubsup id="S4.SS1.SSS1.p3.10.m10.1.1" xref="S4.SS1.SSS1.p3.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.10.m10.1.1.2.2" xref="S4.SS1.SSS1.p3.10.m10.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS1.p3.10.m10.1.1.2.3" xref="S4.SS1.SSS1.p3.10.m10.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.10.m10.1.1.3" xref="S4.SS1.SSS1.p3.10.m10.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.10.m10.1b"><apply id="S4.SS1.SSS1.p3.10.m10.1.1.cmml" xref="S4.SS1.SSS1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.10.m10.1.1.1.cmml" xref="S4.SS1.SSS1.p3.10.m10.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.10.m10.1.1.2.cmml" xref="S4.SS1.SSS1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.10.m10.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.10.m10.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.10.m10.1.1.2.2">𝒱</ci><ci id="S4.SS1.SSS1.p3.10.m10.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.10.m10.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.10.m10.1.1.3.cmml" xref="S4.SS1.SSS1.p3.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.10.m10.1c">\mathcal{V}_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.10.m10.1d">caligraphic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{V}_{j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.11.m11.1"><semantics id="S4.SS1.SSS1.p3.11.m11.1a"><msubsup id="S4.SS1.SSS1.p3.11.m11.1.1" xref="S4.SS1.SSS1.p3.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.11.m11.1.1.2.2" xref="S4.SS1.SSS1.p3.11.m11.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS1.p3.11.m11.1.1.2.3" xref="S4.SS1.SSS1.p3.11.m11.1.1.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p3.11.m11.1.1.3" xref="S4.SS1.SSS1.p3.11.m11.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.11.m11.1b"><apply id="S4.SS1.SSS1.p3.11.m11.1.1.cmml" xref="S4.SS1.SSS1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.11.m11.1.1.1.cmml" xref="S4.SS1.SSS1.p3.11.m11.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.11.m11.1.1.2.cmml" xref="S4.SS1.SSS1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.11.m11.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.11.m11.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.11.m11.1.1.2.2">𝒱</ci><ci id="S4.SS1.SSS1.p3.11.m11.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.11.m11.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p3.11.m11.1.1.3.cmml" xref="S4.SS1.SSS1.p3.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.11.m11.1c">\mathcal{V}_{j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.11.m11.1d">caligraphic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> as the subgraph nodes of the source node <math alttext="v_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.12.m12.1"><semantics id="S4.SS1.SSS1.p3.12.m12.1a"><msubsup id="S4.SS1.SSS1.p3.12.m12.1.1" xref="S4.SS1.SSS1.p3.12.m12.1.1.cmml"><mi id="S4.SS1.SSS1.p3.12.m12.1.1.2.2" xref="S4.SS1.SSS1.p3.12.m12.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS1.p3.12.m12.1.1.2.3" xref="S4.SS1.SSS1.p3.12.m12.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.12.m12.1.1.3" xref="S4.SS1.SSS1.p3.12.m12.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.12.m12.1b"><apply id="S4.SS1.SSS1.p3.12.m12.1.1.cmml" xref="S4.SS1.SSS1.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.12.m12.1.1.1.cmml" xref="S4.SS1.SSS1.p3.12.m12.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.12.m12.1.1.2.cmml" xref="S4.SS1.SSS1.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.12.m12.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.12.m12.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.12.m12.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p3.12.m12.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.12.m12.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.12.m12.1.1.3.cmml" xref="S4.SS1.SSS1.p3.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.12.m12.1c">v_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.12.m12.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and target node <math alttext="v_{j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.13.m13.1"><semantics id="S4.SS1.SSS1.p3.13.m13.1a"><msubsup id="S4.SS1.SSS1.p3.13.m13.1.1" xref="S4.SS1.SSS1.p3.13.m13.1.1.cmml"><mi id="S4.SS1.SSS1.p3.13.m13.1.1.2.2" xref="S4.SS1.SSS1.p3.13.m13.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS1.p3.13.m13.1.1.2.3" xref="S4.SS1.SSS1.p3.13.m13.1.1.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p3.13.m13.1.1.3" xref="S4.SS1.SSS1.p3.13.m13.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.13.m13.1b"><apply id="S4.SS1.SSS1.p3.13.m13.1.1.cmml" xref="S4.SS1.SSS1.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.13.m13.1.1.1.cmml" xref="S4.SS1.SSS1.p3.13.m13.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.13.m13.1.1.2.cmml" xref="S4.SS1.SSS1.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.13.m13.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.13.m13.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.13.m13.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p3.13.m13.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.13.m13.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p3.13.m13.1.1.3.cmml" xref="S4.SS1.SSS1.p3.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.13.m13.1c">v_{j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.13.m13.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> respectively. Then, we link the nodes in <math alttext="\mathcal{V}_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.14.m14.1"><semantics id="S4.SS1.SSS1.p3.14.m14.1a"><msubsup id="S4.SS1.SSS1.p3.14.m14.1.1" xref="S4.SS1.SSS1.p3.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.14.m14.1.1.2.2" xref="S4.SS1.SSS1.p3.14.m14.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS1.p3.14.m14.1.1.2.3" xref="S4.SS1.SSS1.p3.14.m14.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.14.m14.1.1.3" xref="S4.SS1.SSS1.p3.14.m14.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.14.m14.1b"><apply id="S4.SS1.SSS1.p3.14.m14.1.1.cmml" xref="S4.SS1.SSS1.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.14.m14.1.1.1.cmml" xref="S4.SS1.SSS1.p3.14.m14.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.14.m14.1.1.2.cmml" xref="S4.SS1.SSS1.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.14.m14.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.14.m14.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.14.m14.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.14.m14.1.1.2.2">𝒱</ci><ci id="S4.SS1.SSS1.p3.14.m14.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.14.m14.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.14.m14.1.1.3.cmml" xref="S4.SS1.SSS1.p3.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.14.m14.1c">\mathcal{V}_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.14.m14.1d">caligraphic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> to its related node <math alttext="v_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.15.m15.1"><semantics id="S4.SS1.SSS1.p3.15.m15.1a"><msubsup id="S4.SS1.SSS1.p3.15.m15.1.1" xref="S4.SS1.SSS1.p3.15.m15.1.1.cmml"><mi id="S4.SS1.SSS1.p3.15.m15.1.1.2.2" xref="S4.SS1.SSS1.p3.15.m15.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS1.p3.15.m15.1.1.2.3" xref="S4.SS1.SSS1.p3.15.m15.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.15.m15.1.1.3" xref="S4.SS1.SSS1.p3.15.m15.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.15.m15.1b"><apply id="S4.SS1.SSS1.p3.15.m15.1.1.cmml" xref="S4.SS1.SSS1.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.15.m15.1.1.1.cmml" xref="S4.SS1.SSS1.p3.15.m15.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.15.m15.1.1.2.cmml" xref="S4.SS1.SSS1.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.15.m15.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.15.m15.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.15.m15.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.15.m15.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p3.15.m15.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.15.m15.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.15.m15.1.1.3.cmml" xref="S4.SS1.SSS1.p3.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.15.m15.1c">v_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.15.m15.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> to generate <math alttext="\mathcal{E}_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.16.m16.1"><semantics id="S4.SS1.SSS1.p3.16.m16.1a"><msubsup id="S4.SS1.SSS1.p3.16.m16.1.1" xref="S4.SS1.SSS1.p3.16.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.16.m16.1.1.2.2" xref="S4.SS1.SSS1.p3.16.m16.1.1.2.2.cmml">ℰ</mi><mi id="S4.SS1.SSS1.p3.16.m16.1.1.2.3" xref="S4.SS1.SSS1.p3.16.m16.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.16.m16.1.1.3" xref="S4.SS1.SSS1.p3.16.m16.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.16.m16.1b"><apply id="S4.SS1.SSS1.p3.16.m16.1.1.cmml" xref="S4.SS1.SSS1.p3.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.16.m16.1.1.1.cmml" xref="S4.SS1.SSS1.p3.16.m16.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.16.m16.1.1.2.cmml" xref="S4.SS1.SSS1.p3.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.16.m16.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.16.m16.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.16.m16.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.16.m16.1.1.2.2">ℰ</ci><ci id="S4.SS1.SSS1.p3.16.m16.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.16.m16.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.16.m16.1.1.3.cmml" xref="S4.SS1.SSS1.p3.16.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.16.m16.1c">\mathcal{E}_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.16.m16.1d">caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and obtain the subgraphs <math alttext="\mathcal{g}_{i}^{t}=\{\mathcal{V}_{i}^{t},\mathcal{E}_{i}^{t}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.17.m17.2"><semantics id="S4.SS1.SSS1.p3.17.m17.2a"><mrow id="S4.SS1.SSS1.p3.17.m17.2.2" xref="S4.SS1.SSS1.p3.17.m17.2.2.cmml"><msubsup id="S4.SS1.SSS1.p3.17.m17.2.2.4" xref="S4.SS1.SSS1.p3.17.m17.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.17.m17.2.2.4.2.2" xref="S4.SS1.SSS1.p3.17.m17.2.2.4.2.2.cmml">ℊ</mi><mi id="S4.SS1.SSS1.p3.17.m17.2.2.4.2.3" xref="S4.SS1.SSS1.p3.17.m17.2.2.4.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.17.m17.2.2.4.3" xref="S4.SS1.SSS1.p3.17.m17.2.2.4.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.17.m17.2.2.3" xref="S4.SS1.SSS1.p3.17.m17.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS1.p3.17.m17.2.2.2.2" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.3.cmml"><mo id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.3.cmml">{</mo><msubsup id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.3" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.4" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.3.cmml">,</mo><msubsup id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.2" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.2.cmml">ℰ</mi><mi id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.3" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.3" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.17.m17.2b"><apply id="S4.SS1.SSS1.p3.17.m17.2.2.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2"><eq id="S4.SS1.SSS1.p3.17.m17.2.2.3.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.3"></eq><apply id="S4.SS1.SSS1.p3.17.m17.2.2.4.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.17.m17.2.2.4.1.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.4">superscript</csymbol><apply id="S4.SS1.SSS1.p3.17.m17.2.2.4.2.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.17.m17.2.2.4.2.1.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS1.p3.17.m17.2.2.4.2.2.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.4.2.2">ℊ</ci><ci id="S4.SS1.SSS1.p3.17.m17.2.2.4.2.3.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.4.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.17.m17.2.2.4.3.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.4.3">𝑡</ci></apply><set id="S4.SS1.SSS1.p3.17.m17.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2"><apply id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.2">𝒱</ci><ci id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.17.m17.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2">superscript</csymbol><apply id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.2">ℰ</ci><ci id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.17.m17.2.2.2.2.2.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.17.m17.2c">\mathcal{g}_{i}^{t}=\{\mathcal{V}_{i}^{t},\mathcal{E}_{i}^{t}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.17.m17.2d">caligraphic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = { caligraphic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT }</annotation></semantics></math>. Similar operations are conducted for the target node <math alttext="v_{j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.18.m18.1"><semantics id="S4.SS1.SSS1.p3.18.m18.1a"><msubsup id="S4.SS1.SSS1.p3.18.m18.1.1" xref="S4.SS1.SSS1.p3.18.m18.1.1.cmml"><mi id="S4.SS1.SSS1.p3.18.m18.1.1.2.2" xref="S4.SS1.SSS1.p3.18.m18.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS1.p3.18.m18.1.1.2.3" xref="S4.SS1.SSS1.p3.18.m18.1.1.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p3.18.m18.1.1.3" xref="S4.SS1.SSS1.p3.18.m18.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.18.m18.1b"><apply id="S4.SS1.SSS1.p3.18.m18.1.1.cmml" xref="S4.SS1.SSS1.p3.18.m18.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.18.m18.1.1.1.cmml" xref="S4.SS1.SSS1.p3.18.m18.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.18.m18.1.1.2.cmml" xref="S4.SS1.SSS1.p3.18.m18.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.18.m18.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.18.m18.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.18.m18.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.18.m18.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p3.18.m18.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.18.m18.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p3.18.m18.1.1.3.cmml" xref="S4.SS1.SSS1.p3.18.m18.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.18.m18.1c">v_{j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.18.m18.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> to obtain <math alttext="\mathcal{g}_{j}^{t}=\{\mathcal{V}_{j}^{t},\mathcal{E}_{j}^{t}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.19.m19.2"><semantics id="S4.SS1.SSS1.p3.19.m19.2a"><mrow id="S4.SS1.SSS1.p3.19.m19.2.2" xref="S4.SS1.SSS1.p3.19.m19.2.2.cmml"><msubsup id="S4.SS1.SSS1.p3.19.m19.2.2.4" xref="S4.SS1.SSS1.p3.19.m19.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.19.m19.2.2.4.2.2" xref="S4.SS1.SSS1.p3.19.m19.2.2.4.2.2.cmml">ℊ</mi><mi id="S4.SS1.SSS1.p3.19.m19.2.2.4.2.3" xref="S4.SS1.SSS1.p3.19.m19.2.2.4.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p3.19.m19.2.2.4.3" xref="S4.SS1.SSS1.p3.19.m19.2.2.4.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.19.m19.2.2.3" xref="S4.SS1.SSS1.p3.19.m19.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS1.p3.19.m19.2.2.2.2" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.3.cmml"><mo id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.3.cmml">{</mo><msubsup id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.3" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.4" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.3.cmml">,</mo><msubsup id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.2" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.2.cmml">ℰ</mi><mi id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.3" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.3" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.19.m19.2b"><apply id="S4.SS1.SSS1.p3.19.m19.2.2.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2"><eq id="S4.SS1.SSS1.p3.19.m19.2.2.3.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.3"></eq><apply id="S4.SS1.SSS1.p3.19.m19.2.2.4.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.19.m19.2.2.4.1.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.4">superscript</csymbol><apply id="S4.SS1.SSS1.p3.19.m19.2.2.4.2.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.19.m19.2.2.4.2.1.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS1.p3.19.m19.2.2.4.2.2.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.4.2.2">ℊ</ci><ci id="S4.SS1.SSS1.p3.19.m19.2.2.4.2.3.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.4.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p3.19.m19.2.2.4.3.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.4.3">𝑡</ci></apply><set id="S4.SS1.SSS1.p3.19.m19.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2"><apply id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.2">𝒱</ci><ci id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.19.m19.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2">superscript</csymbol><apply id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.2">ℰ</ci><ci id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.19.m19.2.2.2.2.2.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.19.m19.2c">\mathcal{g}_{j}^{t}=\{\mathcal{V}_{j}^{t},\mathcal{E}_{j}^{t}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.19.m19.2d">caligraphic_g start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = { caligraphic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , caligraphic_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT }</annotation></semantics></math>. In this way, both the source and the target in <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p3.20.m20.2"><semantics id="S4.SS1.SSS1.p3.20.m20.2a"><msubsup id="S4.SS1.SSS1.p3.20.m20.2.3" xref="S4.SS1.SSS1.p3.20.m20.2.3.cmml"><mi id="S4.SS1.SSS1.p3.20.m20.2.3.2.2" xref="S4.SS1.SSS1.p3.20.m20.2.3.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p3.20.m20.2.2.2.4" xref="S4.SS1.SSS1.p3.20.m20.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p3.20.m20.1.1.1.1" xref="S4.SS1.SSS1.p3.20.m20.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p3.20.m20.2.2.2.4.1" xref="S4.SS1.SSS1.p3.20.m20.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p3.20.m20.2.2.2.2" xref="S4.SS1.SSS1.p3.20.m20.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p3.20.m20.2.3.3" xref="S4.SS1.SSS1.p3.20.m20.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.20.m20.2b"><apply id="S4.SS1.SSS1.p3.20.m20.2.3.cmml" xref="S4.SS1.SSS1.p3.20.m20.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.20.m20.2.3.1.cmml" xref="S4.SS1.SSS1.p3.20.m20.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p3.20.m20.2.3.2.cmml" xref="S4.SS1.SSS1.p3.20.m20.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.20.m20.2.3.2.1.cmml" xref="S4.SS1.SSS1.p3.20.m20.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p3.20.m20.2.3.2.2.cmml" xref="S4.SS1.SSS1.p3.20.m20.2.3.2.2">𝑒</ci><list id="S4.SS1.SSS1.p3.20.m20.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.20.m20.2.2.2.4"><ci id="S4.SS1.SSS1.p3.20.m20.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.20.m20.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p3.20.m20.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.20.m20.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p3.20.m20.2.3.3.cmml" xref="S4.SS1.SSS1.p3.20.m20.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.20.m20.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.20.m20.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> can be represented by the relevant surrounding subgraphs <math alttext="\mathcal{g}_{i,j}^{t}=[\mathcal{g}_{i}^{t},\mathcal{g}_{j}^{t}" class="ltx_math_unparsed" display="inline" id="S4.SS1.SSS1.p3.21.m21.2"><semantics id="S4.SS1.SSS1.p3.21.m21.2a"><mrow id="S4.SS1.SSS1.p3.21.m21.2b"><msubsup id="S4.SS1.SSS1.p3.21.m21.2.3"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.21.m21.2.3.2.2">ℊ</mi><mrow id="S4.SS1.SSS1.p3.21.m21.2.2.2.4"><mi id="S4.SS1.SSS1.p3.21.m21.1.1.1.1">i</mi><mo id="S4.SS1.SSS1.p3.21.m21.2.2.2.4.1">,</mo><mi id="S4.SS1.SSS1.p3.21.m21.2.2.2.2">j</mi></mrow><mi id="S4.SS1.SSS1.p3.21.m21.2.3.3">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.21.m21.2.4">=</mo><mrow id="S4.SS1.SSS1.p3.21.m21.2.5"><mo id="S4.SS1.SSS1.p3.21.m21.2.5.1" stretchy="false">[</mo><msubsup id="S4.SS1.SSS1.p3.21.m21.2.5.2"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.21.m21.2.5.2.2.2">ℊ</mi><mi id="S4.SS1.SSS1.p3.21.m21.2.5.2.2.3">i</mi><mi id="S4.SS1.SSS1.p3.21.m21.2.5.2.3">t</mi></msubsup><mo id="S4.SS1.SSS1.p3.21.m21.2.5.3">,</mo><msubsup id="S4.SS1.SSS1.p3.21.m21.2.5.4"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p3.21.m21.2.5.4.2.2">ℊ</mi><mi id="S4.SS1.SSS1.p3.21.m21.2.5.4.2.3">j</mi><mi id="S4.SS1.SSS1.p3.21.m21.2.5.4.3">t</mi></msubsup></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.21.m21.2c">\mathcal{g}_{i,j}^{t}=[\mathcal{g}_{i}^{t},\mathcal{g}_{j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p3.21.m21.2d">caligraphic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = [ caligraphic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , caligraphic_g start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>].</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p4">
<p class="ltx_p" id="S4.SS1.SSS1.p4.5">To obtain the temporal context of <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p4.1.m1.2"><semantics id="S4.SS1.SSS1.p4.1.m1.2a"><msubsup id="S4.SS1.SSS1.p4.1.m1.2.3" xref="S4.SS1.SSS1.p4.1.m1.2.3.cmml"><mi id="S4.SS1.SSS1.p4.1.m1.2.3.2.2" xref="S4.SS1.SSS1.p4.1.m1.2.3.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p4.1.m1.2.2.2.4" xref="S4.SS1.SSS1.p4.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p4.1.m1.1.1.1.1" xref="S4.SS1.SSS1.p4.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p4.1.m1.2.2.2.4.1" xref="S4.SS1.SSS1.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p4.1.m1.2.2.2.2" xref="S4.SS1.SSS1.p4.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p4.1.m1.2.3.3" xref="S4.SS1.SSS1.p4.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p4.1.m1.2b"><apply id="S4.SS1.SSS1.p4.1.m1.2.3.cmml" xref="S4.SS1.SSS1.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.1.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p4.1.m1.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p4.1.m1.2.3.2.cmml" xref="S4.SS1.SSS1.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS1.p4.1.m1.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p4.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS1.p4.1.m1.2.3.2.2">𝑒</ci><list id="S4.SS1.SSS1.p4.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p4.1.m1.2.2.2.4"><ci id="S4.SS1.SSS1.p4.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p4.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p4.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p4.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p4.1.m1.2.3.3.cmml" xref="S4.SS1.SSS1.p4.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.1.m1.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.1.m1.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, AnomalyLLM utilizes a sliding window <math alttext="\Gamma" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p4.2.m2.1"><semantics id="S4.SS1.SSS1.p4.2.m2.1a"><mi id="S4.SS1.SSS1.p4.2.m2.1.1" mathvariant="normal" xref="S4.SS1.SSS1.p4.2.m2.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p4.2.m2.1b"><ci id="S4.SS1.SSS1.p4.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p4.2.m2.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.2.m2.1c">\Gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.2.m2.1d">roman_Γ</annotation></semantics></math> to filter a sequence of graph slices <math alttext="\mathcal{G}_{t}^{\Gamma}=\{\mathcal{G}_{t-\Gamma+1}," class="ltx_math_unparsed" display="inline" id="S4.SS1.SSS1.p4.3.m3.1"><semantics id="S4.SS1.SSS1.p4.3.m3.1a"><mrow id="S4.SS1.SSS1.p4.3.m3.1b"><msubsup id="S4.SS1.SSS1.p4.3.m3.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p4.3.m3.1.1.2.2">𝒢</mi><mi id="S4.SS1.SSS1.p4.3.m3.1.1.2.3">t</mi><mi id="S4.SS1.SSS1.p4.3.m3.1.1.3" mathvariant="normal">Γ</mi></msubsup><mo id="S4.SS1.SSS1.p4.3.m3.1.2">=</mo><mrow id="S4.SS1.SSS1.p4.3.m3.1.3"><mo id="S4.SS1.SSS1.p4.3.m3.1.3.1" stretchy="false">{</mo><msub id="S4.SS1.SSS1.p4.3.m3.1.3.2"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p4.3.m3.1.3.2.2">𝒢</mi><mrow id="S4.SS1.SSS1.p4.3.m3.1.3.2.3"><mrow id="S4.SS1.SSS1.p4.3.m3.1.3.2.3.2"><mi id="S4.SS1.SSS1.p4.3.m3.1.3.2.3.2.2">t</mi><mo id="S4.SS1.SSS1.p4.3.m3.1.3.2.3.2.1">−</mo><mi id="S4.SS1.SSS1.p4.3.m3.1.3.2.3.2.3" mathvariant="normal">Γ</mi></mrow><mo id="S4.SS1.SSS1.p4.3.m3.1.3.2.3.1">+</mo><mn id="S4.SS1.SSS1.p4.3.m3.1.3.2.3.3">1</mn></mrow></msub><mo id="S4.SS1.SSS1.p4.3.m3.1.3.3">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.3.m3.1c">\mathcal{G}_{t}^{\Gamma}=\{\mathcal{G}_{t-\Gamma+1},</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.3.m3.1d">caligraphic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_Γ end_POSTSUPERSCRIPT = { caligraphic_G start_POSTSUBSCRIPT italic_t - roman_Γ + 1 end_POSTSUBSCRIPT ,</annotation></semantics></math> <math alttext="\ldots,\mathcal{G}_{t}\}" class="ltx_math_unparsed" display="inline" id="S4.SS1.SSS1.p4.4.m4.1"><semantics id="S4.SS1.SSS1.p4.4.m4.1a"><mrow id="S4.SS1.SSS1.p4.4.m4.1b"><mi id="S4.SS1.SSS1.p4.4.m4.1.1" mathvariant="normal">…</mi><mo id="S4.SS1.SSS1.p4.4.m4.1.2">,</mo><msub id="S4.SS1.SSS1.p4.4.m4.1.3"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p4.4.m4.1.3.2">𝒢</mi><mi id="S4.SS1.SSS1.p4.4.m4.1.3.3">t</mi></msub><mo id="S4.SS1.SSS1.p4.4.m4.1.4" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.4.m4.1c">\ldots,\mathcal{G}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.4.m4.1d">… , caligraphic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>. For each graph slice, we use the described method to construct subgraphs. Therefore, a sequence of subgraph for <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p4.5.m5.2"><semantics id="S4.SS1.SSS1.p4.5.m5.2a"><msubsup id="S4.SS1.SSS1.p4.5.m5.2.3" xref="S4.SS1.SSS1.p4.5.m5.2.3.cmml"><mi id="S4.SS1.SSS1.p4.5.m5.2.3.2.2" xref="S4.SS1.SSS1.p4.5.m5.2.3.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p4.5.m5.2.2.2.4" xref="S4.SS1.SSS1.p4.5.m5.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p4.5.m5.1.1.1.1" xref="S4.SS1.SSS1.p4.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p4.5.m5.2.2.2.4.1" xref="S4.SS1.SSS1.p4.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p4.5.m5.2.2.2.2" xref="S4.SS1.SSS1.p4.5.m5.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p4.5.m5.2.3.3" xref="S4.SS1.SSS1.p4.5.m5.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p4.5.m5.2b"><apply id="S4.SS1.SSS1.p4.5.m5.2.3.cmml" xref="S4.SS1.SSS1.p4.5.m5.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.5.m5.2.3.1.cmml" xref="S4.SS1.SSS1.p4.5.m5.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p4.5.m5.2.3.2.cmml" xref="S4.SS1.SSS1.p4.5.m5.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.5.m5.2.3.2.1.cmml" xref="S4.SS1.SSS1.p4.5.m5.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p4.5.m5.2.3.2.2.cmml" xref="S4.SS1.SSS1.p4.5.m5.2.3.2.2">𝑒</ci><list id="S4.SS1.SSS1.p4.5.m5.2.2.2.3.cmml" xref="S4.SS1.SSS1.p4.5.m5.2.2.2.4"><ci id="S4.SS1.SSS1.p4.5.m5.1.1.1.1.cmml" xref="S4.SS1.SSS1.p4.5.m5.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p4.5.m5.2.2.2.2.cmml" xref="S4.SS1.SSS1.p4.5.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p4.5.m5.2.3.3.cmml" xref="S4.SS1.SSS1.p4.5.m5.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.5.m5.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.5.m5.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> can be constructed as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{S}_{i,j}^{t}=\{\mathcal{g}_{i,j}^{\tau}\}\quad\text{for }\tau=t-%
\Gamma+1,\ldots,t" class="ltx_Math" display="block" id="S4.Ex1.m1.8"><semantics id="S4.Ex1.m1.8a"><mrow id="S4.Ex1.m1.8.8.2" xref="S4.Ex1.m1.8.8.3.cmml"><mrow id="S4.Ex1.m1.7.7.1.1" xref="S4.Ex1.m1.7.7.1.1.cmml"><msubsup id="S4.Ex1.m1.7.7.1.1.3" xref="S4.Ex1.m1.7.7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.7.7.1.1.3.2.2" xref="S4.Ex1.m1.7.7.1.1.3.2.2.cmml">𝒮</mi><mrow id="S4.Ex1.m1.2.2.2.4" xref="S4.Ex1.m1.2.2.2.3.cmml"><mi id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex1.m1.2.2.2.4.1" xref="S4.Ex1.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.Ex1.m1.7.7.1.1.3.3" xref="S4.Ex1.m1.7.7.1.1.3.3.cmml">t</mi></msubsup><mo id="S4.Ex1.m1.7.7.1.1.2" xref="S4.Ex1.m1.7.7.1.1.2.cmml">=</mo><mrow id="S4.Ex1.m1.7.7.1.1.1.1" xref="S4.Ex1.m1.7.7.1.1.1.2.cmml"><mo id="S4.Ex1.m1.7.7.1.1.1.1.2" stretchy="false" xref="S4.Ex1.m1.7.7.1.1.1.2.cmml">{</mo><msubsup id="S4.Ex1.m1.7.7.1.1.1.1.1" xref="S4.Ex1.m1.7.7.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.7.7.1.1.1.1.1.2.2" xref="S4.Ex1.m1.7.7.1.1.1.1.1.2.2.cmml">ℊ</mi><mrow id="S4.Ex1.m1.4.4.2.4" xref="S4.Ex1.m1.4.4.2.3.cmml"><mi id="S4.Ex1.m1.3.3.1.1" xref="S4.Ex1.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex1.m1.4.4.2.4.1" xref="S4.Ex1.m1.4.4.2.3.cmml">,</mo><mi id="S4.Ex1.m1.4.4.2.2" xref="S4.Ex1.m1.4.4.2.2.cmml">j</mi></mrow><mi id="S4.Ex1.m1.7.7.1.1.1.1.1.3" xref="S4.Ex1.m1.7.7.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.Ex1.m1.7.7.1.1.1.1.3" stretchy="false" xref="S4.Ex1.m1.7.7.1.1.1.2.cmml">}</mo></mrow></mrow><mspace id="S4.Ex1.m1.8.8.2.3" width="1em" xref="S4.Ex1.m1.8.8.3a.cmml"></mspace><mrow id="S4.Ex1.m1.8.8.2.2" xref="S4.Ex1.m1.8.8.2.2.cmml"><mrow id="S4.Ex1.m1.8.8.2.2.3" xref="S4.Ex1.m1.8.8.2.2.3.cmml"><mtext id="S4.Ex1.m1.8.8.2.2.3.2" xref="S4.Ex1.m1.8.8.2.2.3.2a.cmml">for </mtext><mo id="S4.Ex1.m1.8.8.2.2.3.1" xref="S4.Ex1.m1.8.8.2.2.3.1.cmml">⁢</mo><mi id="S4.Ex1.m1.8.8.2.2.3.3" xref="S4.Ex1.m1.8.8.2.2.3.3.cmml">τ</mi></mrow><mo id="S4.Ex1.m1.8.8.2.2.2" xref="S4.Ex1.m1.8.8.2.2.2.cmml">=</mo><mrow id="S4.Ex1.m1.8.8.2.2.1.1" xref="S4.Ex1.m1.8.8.2.2.1.2.cmml"><mrow id="S4.Ex1.m1.8.8.2.2.1.1.1" xref="S4.Ex1.m1.8.8.2.2.1.1.1.cmml"><mrow id="S4.Ex1.m1.8.8.2.2.1.1.1.2" xref="S4.Ex1.m1.8.8.2.2.1.1.1.2.cmml"><mi id="S4.Ex1.m1.8.8.2.2.1.1.1.2.2" xref="S4.Ex1.m1.8.8.2.2.1.1.1.2.2.cmml">t</mi><mo id="S4.Ex1.m1.8.8.2.2.1.1.1.2.1" xref="S4.Ex1.m1.8.8.2.2.1.1.1.2.1.cmml">−</mo><mi id="S4.Ex1.m1.8.8.2.2.1.1.1.2.3" mathvariant="normal" xref="S4.Ex1.m1.8.8.2.2.1.1.1.2.3.cmml">Γ</mi></mrow><mo id="S4.Ex1.m1.8.8.2.2.1.1.1.1" xref="S4.Ex1.m1.8.8.2.2.1.1.1.1.cmml">+</mo><mn id="S4.Ex1.m1.8.8.2.2.1.1.1.3" xref="S4.Ex1.m1.8.8.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.Ex1.m1.8.8.2.2.1.1.2" xref="S4.Ex1.m1.8.8.2.2.1.2.cmml">,</mo><mi id="S4.Ex1.m1.5.5" mathvariant="normal" xref="S4.Ex1.m1.5.5.cmml">…</mi><mo id="S4.Ex1.m1.8.8.2.2.1.1.3" xref="S4.Ex1.m1.8.8.2.2.1.2.cmml">,</mo><mi id="S4.Ex1.m1.6.6" xref="S4.Ex1.m1.6.6.cmml">t</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.8b"><apply id="S4.Ex1.m1.8.8.3.cmml" xref="S4.Ex1.m1.8.8.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.3a.cmml" xref="S4.Ex1.m1.8.8.2.3">formulae-sequence</csymbol><apply id="S4.Ex1.m1.7.7.1.1.cmml" xref="S4.Ex1.m1.7.7.1.1"><eq id="S4.Ex1.m1.7.7.1.1.2.cmml" xref="S4.Ex1.m1.7.7.1.1.2"></eq><apply id="S4.Ex1.m1.7.7.1.1.3.cmml" xref="S4.Ex1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.7.7.1.1.3.1.cmml" xref="S4.Ex1.m1.7.7.1.1.3">superscript</csymbol><apply id="S4.Ex1.m1.7.7.1.1.3.2.cmml" xref="S4.Ex1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.7.7.1.1.3.2.1.cmml" xref="S4.Ex1.m1.7.7.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.7.7.1.1.3.2.2.cmml" xref="S4.Ex1.m1.7.7.1.1.3.2.2">𝒮</ci><list id="S4.Ex1.m1.2.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2.4"><ci id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex1.m1.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.Ex1.m1.7.7.1.1.3.3.cmml" xref="S4.Ex1.m1.7.7.1.1.3.3">𝑡</ci></apply><set id="S4.Ex1.m1.7.7.1.1.1.2.cmml" xref="S4.Ex1.m1.7.7.1.1.1.1"><apply id="S4.Ex1.m1.7.7.1.1.1.1.1.cmml" xref="S4.Ex1.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.7.7.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex1.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m1.7.7.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S4.Ex1.m1.7.7.1.1.1.1.1.2.2">ℊ</ci><list id="S4.Ex1.m1.4.4.2.3.cmml" xref="S4.Ex1.m1.4.4.2.4"><ci id="S4.Ex1.m1.3.3.1.1.cmml" xref="S4.Ex1.m1.3.3.1.1">𝑖</ci><ci id="S4.Ex1.m1.4.4.2.2.cmml" xref="S4.Ex1.m1.4.4.2.2">𝑗</ci></list></apply><ci id="S4.Ex1.m1.7.7.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.7.7.1.1.1.1.1.3">𝜏</ci></apply></set></apply><apply id="S4.Ex1.m1.8.8.2.2.cmml" xref="S4.Ex1.m1.8.8.2.2"><eq id="S4.Ex1.m1.8.8.2.2.2.cmml" xref="S4.Ex1.m1.8.8.2.2.2"></eq><apply id="S4.Ex1.m1.8.8.2.2.3.cmml" xref="S4.Ex1.m1.8.8.2.2.3"><times id="S4.Ex1.m1.8.8.2.2.3.1.cmml" xref="S4.Ex1.m1.8.8.2.2.3.1"></times><ci id="S4.Ex1.m1.8.8.2.2.3.2a.cmml" xref="S4.Ex1.m1.8.8.2.2.3.2"><mtext id="S4.Ex1.m1.8.8.2.2.3.2.cmml" xref="S4.Ex1.m1.8.8.2.2.3.2">for </mtext></ci><ci id="S4.Ex1.m1.8.8.2.2.3.3.cmml" xref="S4.Ex1.m1.8.8.2.2.3.3">𝜏</ci></apply><list id="S4.Ex1.m1.8.8.2.2.1.2.cmml" xref="S4.Ex1.m1.8.8.2.2.1.1"><apply id="S4.Ex1.m1.8.8.2.2.1.1.1.cmml" xref="S4.Ex1.m1.8.8.2.2.1.1.1"><plus id="S4.Ex1.m1.8.8.2.2.1.1.1.1.cmml" xref="S4.Ex1.m1.8.8.2.2.1.1.1.1"></plus><apply id="S4.Ex1.m1.8.8.2.2.1.1.1.2.cmml" xref="S4.Ex1.m1.8.8.2.2.1.1.1.2"><minus id="S4.Ex1.m1.8.8.2.2.1.1.1.2.1.cmml" xref="S4.Ex1.m1.8.8.2.2.1.1.1.2.1"></minus><ci id="S4.Ex1.m1.8.8.2.2.1.1.1.2.2.cmml" xref="S4.Ex1.m1.8.8.2.2.1.1.1.2.2">𝑡</ci><ci id="S4.Ex1.m1.8.8.2.2.1.1.1.2.3.cmml" xref="S4.Ex1.m1.8.8.2.2.1.1.1.2.3">Γ</ci></apply><cn id="S4.Ex1.m1.8.8.2.2.1.1.1.3.cmml" type="integer" xref="S4.Ex1.m1.8.8.2.2.1.1.1.3">1</cn></apply><ci id="S4.Ex1.m1.5.5.cmml" xref="S4.Ex1.m1.5.5">…</ci><ci id="S4.Ex1.m1.6.6.cmml" xref="S4.Ex1.m1.6.6">𝑡</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.8c">\mathcal{S}_{i,j}^{t}=\{\mathcal{g}_{i,j}^{\tau}\}\quad\text{for }\tau=t-%
\Gamma+1,\ldots,t</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.8d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = { caligraphic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT } for italic_τ = italic_t - roman_Γ + 1 , … , italic_t</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS1.p4.9"><math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p4.6.m1.2"><semantics id="S4.SS1.SSS1.p4.6.m1.2a"><msubsup id="S4.SS1.SSS1.p4.6.m1.2.3" xref="S4.SS1.SSS1.p4.6.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p4.6.m1.2.3.2.2" xref="S4.SS1.SSS1.p4.6.m1.2.3.2.2.cmml">𝒮</mi><mrow id="S4.SS1.SSS1.p4.6.m1.2.2.2.4" xref="S4.SS1.SSS1.p4.6.m1.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p4.6.m1.1.1.1.1" xref="S4.SS1.SSS1.p4.6.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p4.6.m1.2.2.2.4.1" xref="S4.SS1.SSS1.p4.6.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p4.6.m1.2.2.2.2" xref="S4.SS1.SSS1.p4.6.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p4.6.m1.2.3.3" xref="S4.SS1.SSS1.p4.6.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p4.6.m1.2b"><apply id="S4.SS1.SSS1.p4.6.m1.2.3.cmml" xref="S4.SS1.SSS1.p4.6.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.6.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p4.6.m1.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p4.6.m1.2.3.2.cmml" xref="S4.SS1.SSS1.p4.6.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.6.m1.2.3.2.1.cmml" xref="S4.SS1.SSS1.p4.6.m1.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p4.6.m1.2.3.2.2.cmml" xref="S4.SS1.SSS1.p4.6.m1.2.3.2.2">𝒮</ci><list id="S4.SS1.SSS1.p4.6.m1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p4.6.m1.2.2.2.4"><ci id="S4.SS1.SSS1.p4.6.m1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p4.6.m1.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p4.6.m1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p4.6.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p4.6.m1.2.3.3.cmml" xref="S4.SS1.SSS1.p4.6.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.6.m1.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.6.m1.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> contains not only the structure but also the temporal context of <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p4.7.m2.2"><semantics id="S4.SS1.SSS1.p4.7.m2.2a"><msubsup id="S4.SS1.SSS1.p4.7.m2.2.3" xref="S4.SS1.SSS1.p4.7.m2.2.3.cmml"><mi id="S4.SS1.SSS1.p4.7.m2.2.3.2.2" xref="S4.SS1.SSS1.p4.7.m2.2.3.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p4.7.m2.2.2.2.4" xref="S4.SS1.SSS1.p4.7.m2.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p4.7.m2.1.1.1.1" xref="S4.SS1.SSS1.p4.7.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p4.7.m2.2.2.2.4.1" xref="S4.SS1.SSS1.p4.7.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p4.7.m2.2.2.2.2" xref="S4.SS1.SSS1.p4.7.m2.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p4.7.m2.2.3.3" xref="S4.SS1.SSS1.p4.7.m2.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p4.7.m2.2b"><apply id="S4.SS1.SSS1.p4.7.m2.2.3.cmml" xref="S4.SS1.SSS1.p4.7.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.7.m2.2.3.1.cmml" xref="S4.SS1.SSS1.p4.7.m2.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p4.7.m2.2.3.2.cmml" xref="S4.SS1.SSS1.p4.7.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.7.m2.2.3.2.1.cmml" xref="S4.SS1.SSS1.p4.7.m2.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p4.7.m2.2.3.2.2.cmml" xref="S4.SS1.SSS1.p4.7.m2.2.3.2.2">𝑒</ci><list id="S4.SS1.SSS1.p4.7.m2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p4.7.m2.2.2.2.4"><ci id="S4.SS1.SSS1.p4.7.m2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p4.7.m2.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p4.7.m2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p4.7.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p4.7.m2.2.3.3.cmml" xref="S4.SS1.SSS1.p4.7.m2.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.7.m2.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.7.m2.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. The representation of <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p4.8.m3.2"><semantics id="S4.SS1.SSS1.p4.8.m3.2a"><msubsup id="S4.SS1.SSS1.p4.8.m3.2.3" xref="S4.SS1.SSS1.p4.8.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p4.8.m3.2.3.2.2" xref="S4.SS1.SSS1.p4.8.m3.2.3.2.2.cmml">𝒮</mi><mrow id="S4.SS1.SSS1.p4.8.m3.2.2.2.4" xref="S4.SS1.SSS1.p4.8.m3.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p4.8.m3.1.1.1.1" xref="S4.SS1.SSS1.p4.8.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p4.8.m3.2.2.2.4.1" xref="S4.SS1.SSS1.p4.8.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p4.8.m3.2.2.2.2" xref="S4.SS1.SSS1.p4.8.m3.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p4.8.m3.2.3.3" xref="S4.SS1.SSS1.p4.8.m3.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p4.8.m3.2b"><apply id="S4.SS1.SSS1.p4.8.m3.2.3.cmml" xref="S4.SS1.SSS1.p4.8.m3.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.8.m3.2.3.1.cmml" xref="S4.SS1.SSS1.p4.8.m3.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p4.8.m3.2.3.2.cmml" xref="S4.SS1.SSS1.p4.8.m3.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p4.8.m3.2.3.2.1.cmml" xref="S4.SS1.SSS1.p4.8.m3.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p4.8.m3.2.3.2.2.cmml" xref="S4.SS1.SSS1.p4.8.m3.2.3.2.2">𝒮</ci><list id="S4.SS1.SSS1.p4.8.m3.2.2.2.3.cmml" xref="S4.SS1.SSS1.p4.8.m3.2.2.2.4"><ci id="S4.SS1.SSS1.p4.8.m3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p4.8.m3.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p4.8.m3.2.2.2.2.cmml" xref="S4.SS1.SSS1.p4.8.m3.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p4.8.m3.2.3.3.cmml" xref="S4.SS1.SSS1.p4.8.m3.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.8.m3.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.8.m3.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> can be used to detect the anomaly in <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p4.9.m4.1"><semantics id="S4.SS1.SSS1.p4.9.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p4.9.m4.1.1" xref="S4.SS1.SSS1.p4.9.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p4.9.m4.1b"><ci id="S4.SS1.SSS1.p4.9.m4.1.1.cmml" xref="S4.SS1.SSS1.p4.9.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.9.m4.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p4.9.m4.1d">caligraphic_G</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p5">
<p class="ltx_p" id="S4.SS1.SSS1.p5.6"><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p5.6.1">Subgraph-based Edge Encoder. </span>
Given the subgraph sequence <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.1.m1.2"><semantics id="S4.SS1.SSS1.p5.1.m1.2a"><msubsup id="S4.SS1.SSS1.p5.1.m1.2.3" xref="S4.SS1.SSS1.p5.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p5.1.m1.2.3.2.2" xref="S4.SS1.SSS1.p5.1.m1.2.3.2.2.cmml">𝒮</mi><mrow id="S4.SS1.SSS1.p5.1.m1.2.2.2.4" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p5.1.m1.1.1.1.1" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.4.1" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p5.1.m1.2.3.3" xref="S4.SS1.SSS1.p5.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.1.m1.2b"><apply id="S4.SS1.SSS1.p5.1.m1.2.3.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.1.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p5.1.m1.2.3.2.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p5.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.3.2.2">𝒮</ci><list id="S4.SS1.SSS1.p5.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.4"><ci id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p5.1.m1.2.3.3.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.1.m1.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.1.m1.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> of edge <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.2.m2.2"><semantics id="S4.SS1.SSS1.p5.2.m2.2a"><msubsup id="S4.SS1.SSS1.p5.2.m2.2.3" xref="S4.SS1.SSS1.p5.2.m2.2.3.cmml"><mi id="S4.SS1.SSS1.p5.2.m2.2.3.2.2" xref="S4.SS1.SSS1.p5.2.m2.2.3.2.2.cmml">e</mi><mrow id="S4.SS1.SSS1.p5.2.m2.2.2.2.4" xref="S4.SS1.SSS1.p5.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p5.2.m2.1.1.1.1" xref="S4.SS1.SSS1.p5.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p5.2.m2.2.2.2.4.1" xref="S4.SS1.SSS1.p5.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p5.2.m2.2.2.2.2" xref="S4.SS1.SSS1.p5.2.m2.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p5.2.m2.2.3.3" xref="S4.SS1.SSS1.p5.2.m2.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.2.m2.2b"><apply id="S4.SS1.SSS1.p5.2.m2.2.3.cmml" xref="S4.SS1.SSS1.p5.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.2.m2.2.3.1.cmml" xref="S4.SS1.SSS1.p5.2.m2.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p5.2.m2.2.3.2.cmml" xref="S4.SS1.SSS1.p5.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.2.m2.2.3.2.1.cmml" xref="S4.SS1.SSS1.p5.2.m2.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p5.2.m2.2.3.2.2.cmml" xref="S4.SS1.SSS1.p5.2.m2.2.3.2.2">𝑒</ci><list id="S4.SS1.SSS1.p5.2.m2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p5.2.m2.2.2.2.4"><ci id="S4.SS1.SSS1.p5.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p5.2.m2.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p5.2.m2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p5.2.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p5.2.m2.2.3.3.cmml" xref="S4.SS1.SSS1.p5.2.m2.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.2.m2.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.2.m2.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we feed them into the subgraph-based edge encoder which synergizes the Transformer and Graph Neural Network (GNN) models to obtain edge representation <math alttext="\mathbf{r}_{i,j}^{t}\in\mathbb{R}^{d_{m}}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.3.m3.2"><semantics id="S4.SS1.SSS1.p5.3.m3.2a"><mrow id="S4.SS1.SSS1.p5.3.m3.2.3" xref="S4.SS1.SSS1.p5.3.m3.2.3.cmml"><msubsup id="S4.SS1.SSS1.p5.3.m3.2.3.2" xref="S4.SS1.SSS1.p5.3.m3.2.3.2.cmml"><mi id="S4.SS1.SSS1.p5.3.m3.2.3.2.2.2" xref="S4.SS1.SSS1.p5.3.m3.2.3.2.2.2.cmml">𝐫</mi><mrow id="S4.SS1.SSS1.p5.3.m3.2.2.2.4" xref="S4.SS1.SSS1.p5.3.m3.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p5.3.m3.1.1.1.1" xref="S4.SS1.SSS1.p5.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p5.3.m3.2.2.2.4.1" xref="S4.SS1.SSS1.p5.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p5.3.m3.2.2.2.2" xref="S4.SS1.SSS1.p5.3.m3.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p5.3.m3.2.3.2.3" xref="S4.SS1.SSS1.p5.3.m3.2.3.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p5.3.m3.2.3.1" xref="S4.SS1.SSS1.p5.3.m3.2.3.1.cmml">∈</mo><msup id="S4.SS1.SSS1.p5.3.m3.2.3.3" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.cmml"><mi id="S4.SS1.SSS1.p5.3.m3.2.3.3.2" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.2.cmml">ℝ</mi><msub id="S4.SS1.SSS1.p5.3.m3.2.3.3.3" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.3.cmml"><mi id="S4.SS1.SSS1.p5.3.m3.2.3.3.3.2" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.3.2.cmml">d</mi><mi id="S4.SS1.SSS1.p5.3.m3.2.3.3.3.3" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.3.3.cmml">m</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.3.m3.2b"><apply id="S4.SS1.SSS1.p5.3.m3.2.3.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3"><in id="S4.SS1.SSS1.p5.3.m3.2.3.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.1"></in><apply id="S4.SS1.SSS1.p5.3.m3.2.3.2.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.3.m3.2.3.2.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.2">superscript</csymbol><apply id="S4.SS1.SSS1.p5.3.m3.2.3.2.2.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.3.m3.2.3.2.2.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS1.p5.3.m3.2.3.2.2.2.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.2.2.2">𝐫</ci><list id="S4.SS1.SSS1.p5.3.m3.2.2.2.3.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.2.2.4"><ci id="S4.SS1.SSS1.p5.3.m3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p5.3.m3.2.2.2.2.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p5.3.m3.2.3.2.3.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p5.3.m3.2.3.3.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.3.m3.2.3.3.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.3">superscript</csymbol><ci id="S4.SS1.SSS1.p5.3.m3.2.3.3.2.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.2">ℝ</ci><apply id="S4.SS1.SSS1.p5.3.m3.2.3.3.3.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.3.m3.2.3.3.3.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS1.p5.3.m3.2.3.3.3.2.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.3.2">𝑑</ci><ci id="S4.SS1.SSS1.p5.3.m3.2.3.3.3.3.cmml" xref="S4.SS1.SSS1.p5.3.m3.2.3.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.3.m3.2c">\mathbf{r}_{i,j}^{t}\in\mathbb{R}^{d_{m}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.3.m3.2d">bold_r start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="d_{m}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.4.m4.1"><semantics id="S4.SS1.SSS1.p5.4.m4.1a"><msub id="S4.SS1.SSS1.p5.4.m4.1.1" xref="S4.SS1.SSS1.p5.4.m4.1.1.cmml"><mi id="S4.SS1.SSS1.p5.4.m4.1.1.2" xref="S4.SS1.SSS1.p5.4.m4.1.1.2.cmml">d</mi><mi id="S4.SS1.SSS1.p5.4.m4.1.1.3" xref="S4.SS1.SSS1.p5.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.4.m4.1b"><apply id="S4.SS1.SSS1.p5.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p5.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p5.4.m4.1.1.2">𝑑</ci><ci id="S4.SS1.SSS1.p5.4.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p5.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.4.m4.1c">d_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> represents the embedding dimension.
Following the same setting as Taddy<cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib20" title="">2021b</a>)</cite>, we assume the nodes in <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.5.m5.1"><semantics id="S4.SS1.SSS1.p5.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p5.5.m5.1.1" xref="S4.SS1.SSS1.p5.5.m5.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.5.m5.1b"><ci id="S4.SS1.SSS1.p5.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p5.5.m5.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.5.m5.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.5.m5.1d">caligraphic_G</annotation></semantics></math> are stable and conduct the following four steps on the input <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.6.m6.2"><semantics id="S4.SS1.SSS1.p5.6.m6.2a"><msubsup id="S4.SS1.SSS1.p5.6.m6.2.3" xref="S4.SS1.SSS1.p5.6.m6.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p5.6.m6.2.3.2.2" xref="S4.SS1.SSS1.p5.6.m6.2.3.2.2.cmml">𝒮</mi><mrow id="S4.SS1.SSS1.p5.6.m6.2.2.2.4" xref="S4.SS1.SSS1.p5.6.m6.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p5.6.m6.1.1.1.1" xref="S4.SS1.SSS1.p5.6.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p5.6.m6.2.2.2.4.1" xref="S4.SS1.SSS1.p5.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p5.6.m6.2.2.2.2" xref="S4.SS1.SSS1.p5.6.m6.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS1.p5.6.m6.2.3.3" xref="S4.SS1.SSS1.p5.6.m6.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.6.m6.2b"><apply id="S4.SS1.SSS1.p5.6.m6.2.3.cmml" xref="S4.SS1.SSS1.p5.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.6.m6.2.3.1.cmml" xref="S4.SS1.SSS1.p5.6.m6.2.3">superscript</csymbol><apply id="S4.SS1.SSS1.p5.6.m6.2.3.2.cmml" xref="S4.SS1.SSS1.p5.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.6.m6.2.3.2.1.cmml" xref="S4.SS1.SSS1.p5.6.m6.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p5.6.m6.2.3.2.2.cmml" xref="S4.SS1.SSS1.p5.6.m6.2.3.2.2">𝒮</ci><list id="S4.SS1.SSS1.p5.6.m6.2.2.2.3.cmml" xref="S4.SS1.SSS1.p5.6.m6.2.2.2.4"><ci id="S4.SS1.SSS1.p5.6.m6.1.1.1.1.cmml" xref="S4.SS1.SSS1.p5.6.m6.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p5.6.m6.2.2.2.2.cmml" xref="S4.SS1.SSS1.p5.6.m6.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS1.p5.6.m6.2.3.3.cmml" xref="S4.SS1.SSS1.p5.6.m6.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.6.m6.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.6.m6.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.10"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.10.1">Node Encoding.</span> For each node <math alttext="v_{l}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><msubsup id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2.2" xref="S4.I1.i1.p1.1.m1.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.1.m1.1.1.2.3" xref="S4.I1.i1.p1.1.m1.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.1.m1.1.1.2.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">v_{l}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> in every <math alttext="\mathcal{g}_{i}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><msubsup id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p1.2.m2.1.1.2.2" xref="S4.I1.i1.p1.2.m2.1.1.2.2.cmml">ℊ</mi><mi id="S4.I1.i1.p1.2.m2.1.1.2.3" xref="S4.I1.i1.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="S4.I1.i1.p1.2.m2.1.1.3" xref="S4.I1.i1.p1.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><apply id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.2.m2.1.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.2.m2.1.1.2.cmml" xref="S4.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.2.m2.1.1.2.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.2.m2.1.1.2.2.cmml" xref="S4.I1.i1.p1.2.m2.1.1.2.2">ℊ</ci><ci id="S4.I1.i1.p1.2.m2.1.1.2.3.cmml" xref="S4.I1.i1.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S4.I1.i1.p1.2.m2.1.1.3.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">\mathcal{g}_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">caligraphic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> within <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.2"><semantics id="S4.I1.i1.p1.3.m3.2a"><msubsup id="S4.I1.i1.p1.3.m3.2.3" xref="S4.I1.i1.p1.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p1.3.m3.2.3.2.2" xref="S4.I1.i1.p1.3.m3.2.3.2.2.cmml">𝒮</mi><mrow id="S4.I1.i1.p1.3.m3.2.2.2.4" xref="S4.I1.i1.p1.3.m3.2.2.2.3.cmml"><mi id="S4.I1.i1.p1.3.m3.1.1.1.1" xref="S4.I1.i1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.I1.i1.p1.3.m3.2.2.2.4.1" xref="S4.I1.i1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.I1.i1.p1.3.m3.2.2.2.2" xref="S4.I1.i1.p1.3.m3.2.2.2.2.cmml">j</mi></mrow><mi id="S4.I1.i1.p1.3.m3.2.3.3" xref="S4.I1.i1.p1.3.m3.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.2b"><apply id="S4.I1.i1.p1.3.m3.2.3.cmml" xref="S4.I1.i1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.2.3.1.cmml" xref="S4.I1.i1.p1.3.m3.2.3">superscript</csymbol><apply id="S4.I1.i1.p1.3.m3.2.3.2.cmml" xref="S4.I1.i1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.2.3.2.1.cmml" xref="S4.I1.i1.p1.3.m3.2.3">subscript</csymbol><ci id="S4.I1.i1.p1.3.m3.2.3.2.2.cmml" xref="S4.I1.i1.p1.3.m3.2.3.2.2">𝒮</ci><list id="S4.I1.i1.p1.3.m3.2.2.2.3.cmml" xref="S4.I1.i1.p1.3.m3.2.2.2.4"><ci id="S4.I1.i1.p1.3.m3.1.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1">𝑖</ci><ci id="S4.I1.i1.p1.3.m3.2.2.2.2.cmml" xref="S4.I1.i1.p1.3.m3.2.2.2.2">𝑗</ci></list></apply><ci id="S4.I1.i1.p1.3.m3.2.3.3.cmml" xref="S4.I1.i1.p1.3.m3.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we construct the node encoding using three aspects, <em class="ltx_emph ltx_font_italic" id="S4.I1.i1.p1.10.2">i.e.</em>, <math alttext="\mathbf{z}_{l}=\mathbf{z}_{\mathrm{diff}}(v_{l}^{\tau})+\mathbf{z}_{\mathrm{%
dist}}(v_{l}^{\tau})+\mathbf{z}_{\mathrm{temp}}(v_{l}^{\tau})\in\mathbb{R}^{d_%
{enc}}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.4.m4.3"><semantics id="S4.I1.i1.p1.4.m4.3a"><mrow id="S4.I1.i1.p1.4.m4.3.3" xref="S4.I1.i1.p1.4.m4.3.3.cmml"><msub id="S4.I1.i1.p1.4.m4.3.3.5" xref="S4.I1.i1.p1.4.m4.3.3.5.cmml"><mi id="S4.I1.i1.p1.4.m4.3.3.5.2" xref="S4.I1.i1.p1.4.m4.3.3.5.2.cmml">𝐳</mi><mi id="S4.I1.i1.p1.4.m4.3.3.5.3" xref="S4.I1.i1.p1.4.m4.3.3.5.3.cmml">l</mi></msub><mo id="S4.I1.i1.p1.4.m4.3.3.6" xref="S4.I1.i1.p1.4.m4.3.3.6.cmml">=</mo><mrow id="S4.I1.i1.p1.4.m4.3.3.3" xref="S4.I1.i1.p1.4.m4.3.3.3.cmml"><mrow id="S4.I1.i1.p1.4.m4.1.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.cmml"><msub id="S4.I1.i1.p1.4.m4.1.1.1.1.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.3.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.cmml">diff</mi></msub><mo id="S4.I1.i1.p1.4.m4.1.1.1.1.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml"><mo id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i1.p1.4.m4.3.3.3.4" xref="S4.I1.i1.p1.4.m4.3.3.3.4.cmml">+</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.cmml"><msub id="S4.I1.i1.p1.4.m4.2.2.2.2.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.3.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.3.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.3.2.cmml">𝐳</mi><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.3.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.3.3.cmml">dist</mi></msub><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml"><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i1.p1.4.m4.3.3.3.4a" xref="S4.I1.i1.p1.4.m4.3.3.3.4.cmml">+</mo><mrow id="S4.I1.i1.p1.4.m4.3.3.3.3" xref="S4.I1.i1.p1.4.m4.3.3.3.3.cmml"><msub id="S4.I1.i1.p1.4.m4.3.3.3.3.3" xref="S4.I1.i1.p1.4.m4.3.3.3.3.3.cmml"><mi id="S4.I1.i1.p1.4.m4.3.3.3.3.3.2" xref="S4.I1.i1.p1.4.m4.3.3.3.3.3.2.cmml">𝐳</mi><mi id="S4.I1.i1.p1.4.m4.3.3.3.3.3.3" xref="S4.I1.i1.p1.4.m4.3.3.3.3.3.3.cmml">temp</mi></msub><mo id="S4.I1.i1.p1.4.m4.3.3.3.3.2" xref="S4.I1.i1.p1.4.m4.3.3.3.3.2.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.cmml"><mo id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.cmml">(</mo><msubsup id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.cmml"><mi id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.2" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.3" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.3" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.3" stretchy="false" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i1.p1.4.m4.3.3.7" xref="S4.I1.i1.p1.4.m4.3.3.7.cmml">∈</mo><msup id="S4.I1.i1.p1.4.m4.3.3.8" xref="S4.I1.i1.p1.4.m4.3.3.8.cmml"><mi id="S4.I1.i1.p1.4.m4.3.3.8.2" xref="S4.I1.i1.p1.4.m4.3.3.8.2.cmml">ℝ</mi><msub id="S4.I1.i1.p1.4.m4.3.3.8.3" xref="S4.I1.i1.p1.4.m4.3.3.8.3.cmml"><mi id="S4.I1.i1.p1.4.m4.3.3.8.3.2" xref="S4.I1.i1.p1.4.m4.3.3.8.3.2.cmml">d</mi><mrow id="S4.I1.i1.p1.4.m4.3.3.8.3.3" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.cmml"><mi id="S4.I1.i1.p1.4.m4.3.3.8.3.3.2" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.2.cmml">e</mi><mo id="S4.I1.i1.p1.4.m4.3.3.8.3.3.1" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.1.cmml">⁢</mo><mi id="S4.I1.i1.p1.4.m4.3.3.8.3.3.3" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.3.cmml">n</mi><mo id="S4.I1.i1.p1.4.m4.3.3.8.3.3.1a" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.1.cmml">⁢</mo><mi id="S4.I1.i1.p1.4.m4.3.3.8.3.3.4" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.4.cmml">c</mi></mrow></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.3b"><apply id="S4.I1.i1.p1.4.m4.3.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3"><and id="S4.I1.i1.p1.4.m4.3.3a.cmml" xref="S4.I1.i1.p1.4.m4.3.3"></and><apply id="S4.I1.i1.p1.4.m4.3.3b.cmml" xref="S4.I1.i1.p1.4.m4.3.3"><eq id="S4.I1.i1.p1.4.m4.3.3.6.cmml" xref="S4.I1.i1.p1.4.m4.3.3.6"></eq><apply id="S4.I1.i1.p1.4.m4.3.3.5.cmml" xref="S4.I1.i1.p1.4.m4.3.3.5"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.3.3.5.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.5">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.3.3.5.2.cmml" xref="S4.I1.i1.p1.4.m4.3.3.5.2">𝐳</ci><ci id="S4.I1.i1.p1.4.m4.3.3.5.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.5.3">𝑙</ci></apply><apply id="S4.I1.i1.p1.4.m4.3.3.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3"><plus id="S4.I1.i1.p1.4.m4.3.3.3.4.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.4"></plus><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1"><times id="S4.I1.i1.p1.4.m4.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2"></times><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.1.1.1.1.3.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.3.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.2">𝐳</ci><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3">diff</ci></apply><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2"><times id="S4.I1.i1.p1.4.m4.2.2.2.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.2"></times><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.2.2.2.2.3.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.3">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.3.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.3.2">𝐳</ci><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.3.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.3.3">dist</ci></apply><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.3">𝜏</ci></apply></apply><apply id="S4.I1.i1.p1.4.m4.3.3.3.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3"><times id="S4.I1.i1.p1.4.m4.3.3.3.3.2.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.2"></times><apply id="S4.I1.i1.p1.4.m4.3.3.3.3.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.3.3.3.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.3">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.3.3.3.3.3.2.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.3.2">𝐳</ci><ci id="S4.I1.i1.p1.4.m4.3.3.3.3.3.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.3.3">temp</ci></apply><apply id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.2.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.3.1.1.1.3">𝜏</ci></apply></apply></apply></apply><apply id="S4.I1.i1.p1.4.m4.3.3c.cmml" xref="S4.I1.i1.p1.4.m4.3.3"><in id="S4.I1.i1.p1.4.m4.3.3.7.cmml" xref="S4.I1.i1.p1.4.m4.3.3.7"></in><share href="https://arxiv.org/html/2405.07626v2#S4.I1.i1.p1.4.m4.3.3.3.cmml" id="S4.I1.i1.p1.4.m4.3.3d.cmml" xref="S4.I1.i1.p1.4.m4.3.3"></share><apply id="S4.I1.i1.p1.4.m4.3.3.8.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.3.3.8.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8">superscript</csymbol><ci id="S4.I1.i1.p1.4.m4.3.3.8.2.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.2">ℝ</ci><apply id="S4.I1.i1.p1.4.m4.3.3.8.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.3.3.8.3.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.3">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.3.3.8.3.2.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.3.2">𝑑</ci><apply id="S4.I1.i1.p1.4.m4.3.3.8.3.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3"><times id="S4.I1.i1.p1.4.m4.3.3.8.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.1"></times><ci id="S4.I1.i1.p1.4.m4.3.3.8.3.3.2.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.2">𝑒</ci><ci id="S4.I1.i1.p1.4.m4.3.3.8.3.3.3.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.3">𝑛</ci><ci id="S4.I1.i1.p1.4.m4.3.3.8.3.3.4.cmml" xref="S4.I1.i1.p1.4.m4.3.3.8.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.3c">\mathbf{z}_{l}=\mathbf{z}_{\mathrm{diff}}(v_{l}^{\tau})+\mathbf{z}_{\mathrm{%
dist}}(v_{l}^{\tau})+\mathbf{z}_{\mathrm{temp}}(v_{l}^{\tau})\in\mathbb{R}^{d_%
{enc}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.4.m4.3d">bold_z start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = bold_z start_POSTSUBSCRIPT roman_diff end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) + bold_z start_POSTSUBSCRIPT roman_dist end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) + bold_z start_POSTSUBSCRIPT roman_temp end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Here, <math alttext="\mathbf{z}_{\mathrm{diff}}(v_{l}^{\tau})" class="ltx_Math" display="inline" id="S4.I1.i1.p1.5.m5.1"><semantics id="S4.I1.i1.p1.5.m5.1a"><mrow id="S4.I1.i1.p1.5.m5.1.1" xref="S4.I1.i1.p1.5.m5.1.1.cmml"><msub id="S4.I1.i1.p1.5.m5.1.1.3" xref="S4.I1.i1.p1.5.m5.1.1.3.cmml"><mi id="S4.I1.i1.p1.5.m5.1.1.3.2" xref="S4.I1.i1.p1.5.m5.1.1.3.2.cmml">𝐳</mi><mi id="S4.I1.i1.p1.5.m5.1.1.3.3" xref="S4.I1.i1.p1.5.m5.1.1.3.3.cmml">diff</mi></msub><mo id="S4.I1.i1.p1.5.m5.1.1.2" xref="S4.I1.i1.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i1.p1.5.m5.1.1.1.1" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml"><mo id="S4.I1.i1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml">(</mo><msubsup id="S4.I1.i1.p1.5.m5.1.1.1.1.1" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.2" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.3" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.5.m5.1.1.1.1.1.3" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.I1.i1.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.5.m5.1b"><apply id="S4.I1.i1.p1.5.m5.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1"><times id="S4.I1.i1.p1.5.m5.1.1.2.cmml" xref="S4.I1.i1.p1.5.m5.1.1.2"></times><apply id="S4.I1.i1.p1.5.m5.1.1.3.cmml" xref="S4.I1.i1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.5.m5.1.1.3.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.5.m5.1.1.3.2.cmml" xref="S4.I1.i1.p1.5.m5.1.1.3.2">𝐳</ci><ci id="S4.I1.i1.p1.5.m5.1.1.3.3.cmml" xref="S4.I1.i1.p1.5.m5.1.1.3.3">diff</ci></apply><apply id="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.5.m5.1c">\mathbf{z}_{\mathrm{diff}}(v_{l}^{\tau})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.5.m5.1d">bold_z start_POSTSUBSCRIPT roman_diff end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT )</annotation></semantics></math> represents the diffusion-based spatial encoding capturing the global structural role of node <math alttext="v_{l}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.6.m6.1"><semantics id="S4.I1.i1.p1.6.m6.1a"><msubsup id="S4.I1.i1.p1.6.m6.1.1" xref="S4.I1.i1.p1.6.m6.1.1.cmml"><mi id="S4.I1.i1.p1.6.m6.1.1.2.2" xref="S4.I1.i1.p1.6.m6.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.6.m6.1.1.2.3" xref="S4.I1.i1.p1.6.m6.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.6.m6.1.1.3" xref="S4.I1.i1.p1.6.m6.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.6.m6.1b"><apply id="S4.I1.i1.p1.6.m6.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.6.m6.1.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.6.m6.1.1.2.cmml" xref="S4.I1.i1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.6.m6.1.1.2.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.6.m6.1.1.2.2.cmml" xref="S4.I1.i1.p1.6.m6.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.6.m6.1.1.2.3.cmml" xref="S4.I1.i1.p1.6.m6.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.6.m6.1.1.3.cmml" xref="S4.I1.i1.p1.6.m6.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.6.m6.1c">v_{l}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}_{\mathrm{dist}}(v_{l}^{\tau})" class="ltx_Math" display="inline" id="S4.I1.i1.p1.7.m7.1"><semantics id="S4.I1.i1.p1.7.m7.1a"><mrow id="S4.I1.i1.p1.7.m7.1.1" xref="S4.I1.i1.p1.7.m7.1.1.cmml"><msub id="S4.I1.i1.p1.7.m7.1.1.3" xref="S4.I1.i1.p1.7.m7.1.1.3.cmml"><mi id="S4.I1.i1.p1.7.m7.1.1.3.2" xref="S4.I1.i1.p1.7.m7.1.1.3.2.cmml">𝐳</mi><mi id="S4.I1.i1.p1.7.m7.1.1.3.3" xref="S4.I1.i1.p1.7.m7.1.1.3.3.cmml">dist</mi></msub><mo id="S4.I1.i1.p1.7.m7.1.1.2" xref="S4.I1.i1.p1.7.m7.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i1.p1.7.m7.1.1.1.1" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.cmml"><mo id="S4.I1.i1.p1.7.m7.1.1.1.1.2" stretchy="false" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.cmml">(</mo><msubsup id="S4.I1.i1.p1.7.m7.1.1.1.1.1" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.cmml"><mi id="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.2" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.3" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.7.m7.1.1.1.1.1.3" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.I1.i1.p1.7.m7.1.1.1.1.3" stretchy="false" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.7.m7.1b"><apply id="S4.I1.i1.p1.7.m7.1.1.cmml" xref="S4.I1.i1.p1.7.m7.1.1"><times id="S4.I1.i1.p1.7.m7.1.1.2.cmml" xref="S4.I1.i1.p1.7.m7.1.1.2"></times><apply id="S4.I1.i1.p1.7.m7.1.1.3.cmml" xref="S4.I1.i1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.7.m7.1.1.3.1.cmml" xref="S4.I1.i1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.7.m7.1.1.3.2.cmml" xref="S4.I1.i1.p1.7.m7.1.1.3.2">𝐳</ci><ci id="S4.I1.i1.p1.7.m7.1.1.3.3.cmml" xref="S4.I1.i1.p1.7.m7.1.1.3.3">dist</ci></apply><apply id="S4.I1.i1.p1.7.m7.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.7.m7.1.1.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.2.cmml" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.3.cmml" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.7.m7.1.1.1.1.1.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.7.m7.1c">\mathbf{z}_{\mathrm{dist}}(v_{l}^{\tau})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.7.m7.1d">bold_z start_POSTSUBSCRIPT roman_dist end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT )</annotation></semantics></math> denotes the distance-based spatial encoding, reflecting the local structural context; and <math alttext="\mathbf{z}_{\mathrm{temp}}(v_{l}^{\tau})" class="ltx_Math" display="inline" id="S4.I1.i1.p1.8.m8.1"><semantics id="S4.I1.i1.p1.8.m8.1a"><mrow id="S4.I1.i1.p1.8.m8.1.1" xref="S4.I1.i1.p1.8.m8.1.1.cmml"><msub id="S4.I1.i1.p1.8.m8.1.1.3" xref="S4.I1.i1.p1.8.m8.1.1.3.cmml"><mi id="S4.I1.i1.p1.8.m8.1.1.3.2" xref="S4.I1.i1.p1.8.m8.1.1.3.2.cmml">𝐳</mi><mi id="S4.I1.i1.p1.8.m8.1.1.3.3" xref="S4.I1.i1.p1.8.m8.1.1.3.3.cmml">temp</mi></msub><mo id="S4.I1.i1.p1.8.m8.1.1.2" xref="S4.I1.i1.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i1.p1.8.m8.1.1.1.1" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.cmml"><mo id="S4.I1.i1.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.cmml">(</mo><msubsup id="S4.I1.i1.p1.8.m8.1.1.1.1.1" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.2" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.3" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.8.m8.1.1.1.1.1.3" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.I1.i1.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.8.m8.1b"><apply id="S4.I1.i1.p1.8.m8.1.1.cmml" xref="S4.I1.i1.p1.8.m8.1.1"><times id="S4.I1.i1.p1.8.m8.1.1.2.cmml" xref="S4.I1.i1.p1.8.m8.1.1.2"></times><apply id="S4.I1.i1.p1.8.m8.1.1.3.cmml" xref="S4.I1.i1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.8.m8.1.1.3.1.cmml" xref="S4.I1.i1.p1.8.m8.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.8.m8.1.1.3.2.cmml" xref="S4.I1.i1.p1.8.m8.1.1.3.2">𝐳</ci><ci id="S4.I1.i1.p1.8.m8.1.1.3.3.cmml" xref="S4.I1.i1.p1.8.m8.1.1.3.3">temp</ci></apply><apply id="S4.I1.i1.p1.8.m8.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.8.m8.1.1.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.8.m8.1.1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.2.cmml" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.8.m8.1.1.1.1.1.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.8.m8.1c">\mathbf{z}_{\mathrm{temp}}(v_{l}^{\tau})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.8.m8.1d">bold_z start_POSTSUBSCRIPT roman_temp end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT )</annotation></semantics></math> provides the relative temporal information of node <math alttext="v_{l}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.9.m9.1"><semantics id="S4.I1.i1.p1.9.m9.1a"><msubsup id="S4.I1.i1.p1.9.m9.1.1" xref="S4.I1.i1.p1.9.m9.1.1.cmml"><mi id="S4.I1.i1.p1.9.m9.1.1.2.2" xref="S4.I1.i1.p1.9.m9.1.1.2.2.cmml">v</mi><mi id="S4.I1.i1.p1.9.m9.1.1.2.3" xref="S4.I1.i1.p1.9.m9.1.1.2.3.cmml">l</mi><mi id="S4.I1.i1.p1.9.m9.1.1.3" xref="S4.I1.i1.p1.9.m9.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.9.m9.1b"><apply id="S4.I1.i1.p1.9.m9.1.1.cmml" xref="S4.I1.i1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.9.m9.1.1.1.cmml" xref="S4.I1.i1.p1.9.m9.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.9.m9.1.1.2.cmml" xref="S4.I1.i1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.9.m9.1.1.2.1.cmml" xref="S4.I1.i1.p1.9.m9.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.9.m9.1.1.2.2.cmml" xref="S4.I1.i1.p1.9.m9.1.1.2.2">𝑣</ci><ci id="S4.I1.i1.p1.9.m9.1.1.2.3.cmml" xref="S4.I1.i1.p1.9.m9.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i1.p1.9.m9.1.1.3.cmml" xref="S4.I1.i1.p1.9.m9.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.9.m9.1c">v_{l}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.9.m9.1d">italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> which is the same for all nodes at the time slice <math alttext="\tau" class="ltx_Math" display="inline" id="S4.I1.i1.p1.10.m10.1"><semantics id="S4.I1.i1.p1.10.m10.1a"><mi id="S4.I1.i1.p1.10.m10.1.1" xref="S4.I1.i1.p1.10.m10.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.10.m10.1b"><ci id="S4.I1.i1.p1.10.m10.1.1.cmml" xref="S4.I1.i1.p1.10.m10.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.10.m10.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.10.m10.1d">italic_τ</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.7"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.7.1">Temporal Encoding.</span> We model the temporal information of nodes in <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.2"><semantics id="S4.I1.i2.p1.1.m1.2a"><msubsup id="S4.I1.i2.p1.1.m1.2.3" xref="S4.I1.i2.p1.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.1.m1.2.3.2.2" xref="S4.I1.i2.p1.1.m1.2.3.2.2.cmml">𝒮</mi><mrow id="S4.I1.i2.p1.1.m1.2.2.2.4" xref="S4.I1.i2.p1.1.m1.2.2.2.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.I1.i2.p1.1.m1.2.2.2.4.1" xref="S4.I1.i2.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.I1.i2.p1.1.m1.2.2.2.2" xref="S4.I1.i2.p1.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.I1.i2.p1.1.m1.2.3.3" xref="S4.I1.i2.p1.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.2b"><apply id="S4.I1.i2.p1.1.m1.2.3.cmml" xref="S4.I1.i2.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.2.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3">superscript</csymbol><apply id="S4.I1.i2.p1.1.m1.2.3.2.cmml" xref="S4.I1.i2.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.2.3.2.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.2.3.2.2.cmml" xref="S4.I1.i2.p1.1.m1.2.3.2.2">𝒮</ci><list id="S4.I1.i2.p1.1.m1.2.2.2.3.cmml" xref="S4.I1.i2.p1.1.m1.2.2.2.4"><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.I1.i2.p1.1.m1.2.2.2.2.cmml" xref="S4.I1.i2.p1.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.I1.i2.p1.1.m1.2.3.3.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> by reorganizing the node encoding into an encoding sequence <math alttext="\mathbf{Z}_{e}=[[\mathbf{z}_{l}]_{v_{l}\in g_{i,j}^{\tau}}]_{g_{i,j}^{\tau}\in%
\mathcal{S}_{i,j}^{t}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.7"><semantics id="S4.I1.i2.p1.2.m2.7a"><mrow id="S4.I1.i2.p1.2.m2.7.7" xref="S4.I1.i2.p1.2.m2.7.7.cmml"><msub id="S4.I1.i2.p1.2.m2.7.7.3" xref="S4.I1.i2.p1.2.m2.7.7.3.cmml"><mi id="S4.I1.i2.p1.2.m2.7.7.3.2" xref="S4.I1.i2.p1.2.m2.7.7.3.2.cmml">𝐙</mi><mi id="S4.I1.i2.p1.2.m2.7.7.3.3" xref="S4.I1.i2.p1.2.m2.7.7.3.3.cmml">e</mi></msub><mo id="S4.I1.i2.p1.2.m2.7.7.2" xref="S4.I1.i2.p1.2.m2.7.7.2.cmml">=</mo><msub id="S4.I1.i2.p1.2.m2.7.7.1" xref="S4.I1.i2.p1.2.m2.7.7.1.cmml"><mrow id="S4.I1.i2.p1.2.m2.7.7.1.1.1" xref="S4.I1.i2.p1.2.m2.7.7.1.1.2.cmml"><mo id="S4.I1.i2.p1.2.m2.7.7.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.2.m2.7.7.1.1.2.1.cmml">[</mo><msub id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.cmml"><mrow id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.2.cmml"><mo id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.2.1.cmml">[</mo><msub id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.2" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.3" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S4.I1.i2.p1.2.m2.2.2.2" xref="S4.I1.i2.p1.2.m2.2.2.2.cmml"><msub id="S4.I1.i2.p1.2.m2.2.2.2.4" xref="S4.I1.i2.p1.2.m2.2.2.2.4.cmml"><mi id="S4.I1.i2.p1.2.m2.2.2.2.4.2" xref="S4.I1.i2.p1.2.m2.2.2.2.4.2.cmml">v</mi><mi id="S4.I1.i2.p1.2.m2.2.2.2.4.3" xref="S4.I1.i2.p1.2.m2.2.2.2.4.3.cmml">l</mi></msub><mo id="S4.I1.i2.p1.2.m2.2.2.2.3" xref="S4.I1.i2.p1.2.m2.2.2.2.3.cmml">∈</mo><msubsup id="S4.I1.i2.p1.2.m2.2.2.2.5" xref="S4.I1.i2.p1.2.m2.2.2.2.5.cmml"><mi id="S4.I1.i2.p1.2.m2.2.2.2.5.2.2" xref="S4.I1.i2.p1.2.m2.2.2.2.5.2.2.cmml">g</mi><mrow id="S4.I1.i2.p1.2.m2.2.2.2.2.2.4" xref="S4.I1.i2.p1.2.m2.2.2.2.2.2.3.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.1.1.1.1" xref="S4.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml">i</mi><mo id="S4.I1.i2.p1.2.m2.2.2.2.2.2.4.1" xref="S4.I1.i2.p1.2.m2.2.2.2.2.2.3.cmml">,</mo><mi id="S4.I1.i2.p1.2.m2.2.2.2.2.2.2" xref="S4.I1.i2.p1.2.m2.2.2.2.2.2.2.cmml">j</mi></mrow><mi id="S4.I1.i2.p1.2.m2.2.2.2.5.3" xref="S4.I1.i2.p1.2.m2.2.2.2.5.3.cmml">τ</mi></msubsup></mrow></msub><mo id="S4.I1.i2.p1.2.m2.7.7.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.2.m2.7.7.1.1.2.1.cmml">]</mo></mrow><mrow id="S4.I1.i2.p1.2.m2.6.6.4" xref="S4.I1.i2.p1.2.m2.6.6.4.cmml"><msubsup id="S4.I1.i2.p1.2.m2.6.6.4.6" xref="S4.I1.i2.p1.2.m2.6.6.4.6.cmml"><mi id="S4.I1.i2.p1.2.m2.6.6.4.6.2.2" xref="S4.I1.i2.p1.2.m2.6.6.4.6.2.2.cmml">g</mi><mrow id="S4.I1.i2.p1.2.m2.4.4.2.2.2.4" xref="S4.I1.i2.p1.2.m2.4.4.2.2.2.3.cmml"><mi id="S4.I1.i2.p1.2.m2.3.3.1.1.1.1" xref="S4.I1.i2.p1.2.m2.3.3.1.1.1.1.cmml">i</mi><mo id="S4.I1.i2.p1.2.m2.4.4.2.2.2.4.1" xref="S4.I1.i2.p1.2.m2.4.4.2.2.2.3.cmml">,</mo><mi id="S4.I1.i2.p1.2.m2.4.4.2.2.2.2" xref="S4.I1.i2.p1.2.m2.4.4.2.2.2.2.cmml">j</mi></mrow><mi id="S4.I1.i2.p1.2.m2.6.6.4.6.3" xref="S4.I1.i2.p1.2.m2.6.6.4.6.3.cmml">τ</mi></msubsup><mo id="S4.I1.i2.p1.2.m2.6.6.4.5" xref="S4.I1.i2.p1.2.m2.6.6.4.5.cmml">∈</mo><msubsup id="S4.I1.i2.p1.2.m2.6.6.4.7" xref="S4.I1.i2.p1.2.m2.6.6.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.2.m2.6.6.4.7.2.2" xref="S4.I1.i2.p1.2.m2.6.6.4.7.2.2.cmml">𝒮</mi><mrow id="S4.I1.i2.p1.2.m2.6.6.4.4.2.4" xref="S4.I1.i2.p1.2.m2.6.6.4.4.2.3.cmml"><mi id="S4.I1.i2.p1.2.m2.5.5.3.3.1.1" xref="S4.I1.i2.p1.2.m2.5.5.3.3.1.1.cmml">i</mi><mo id="S4.I1.i2.p1.2.m2.6.6.4.4.2.4.1" xref="S4.I1.i2.p1.2.m2.6.6.4.4.2.3.cmml">,</mo><mi id="S4.I1.i2.p1.2.m2.6.6.4.4.2.2" xref="S4.I1.i2.p1.2.m2.6.6.4.4.2.2.cmml">j</mi></mrow><mi id="S4.I1.i2.p1.2.m2.6.6.4.7.3" xref="S4.I1.i2.p1.2.m2.6.6.4.7.3.cmml">t</mi></msubsup></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.7b"><apply id="S4.I1.i2.p1.2.m2.7.7.cmml" xref="S4.I1.i2.p1.2.m2.7.7"><eq id="S4.I1.i2.p1.2.m2.7.7.2.cmml" xref="S4.I1.i2.p1.2.m2.7.7.2"></eq><apply id="S4.I1.i2.p1.2.m2.7.7.3.cmml" xref="S4.I1.i2.p1.2.m2.7.7.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.7.7.3.1.cmml" xref="S4.I1.i2.p1.2.m2.7.7.3">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.7.7.3.2.cmml" xref="S4.I1.i2.p1.2.m2.7.7.3.2">𝐙</ci><ci id="S4.I1.i2.p1.2.m2.7.7.3.3.cmml" xref="S4.I1.i2.p1.2.m2.7.7.3.3">𝑒</ci></apply><apply id="S4.I1.i2.p1.2.m2.7.7.1.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.7.7.1.2.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1">subscript</csymbol><apply id="S4.I1.i2.p1.2.m2.7.7.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.2.m2.7.7.1.1.2.1.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.2">delimited-[]</csymbol><apply id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1">subscript</csymbol><apply id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.2.1.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.2.m2.7.7.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.I1.i2.p1.2.m2.2.2.2.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2"><in id="S4.I1.i2.p1.2.m2.2.2.2.3.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.3"></in><apply id="S4.I1.i2.p1.2.m2.2.2.2.4.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.4"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.2.2.2.4.1.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.4">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.2.2.2.4.2.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.4.2">𝑣</ci><ci id="S4.I1.i2.p1.2.m2.2.2.2.4.3.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.4.3">𝑙</ci></apply><apply id="S4.I1.i2.p1.2.m2.2.2.2.5.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.5"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.2.2.2.5.1.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.5">superscript</csymbol><apply id="S4.I1.i2.p1.2.m2.2.2.2.5.2.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.5"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.2.2.2.5.2.1.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.5">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.2.2.2.5.2.2.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.5.2.2">𝑔</ci><list id="S4.I1.i2.p1.2.m2.2.2.2.2.2.3.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.2.2.4"><ci id="S4.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.1.1.1.1">𝑖</ci><ci id="S4.I1.i2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.2.2.2">𝑗</ci></list></apply><ci id="S4.I1.i2.p1.2.m2.2.2.2.5.3.cmml" xref="S4.I1.i2.p1.2.m2.2.2.2.5.3">𝜏</ci></apply></apply></apply></apply><apply id="S4.I1.i2.p1.2.m2.6.6.4.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4"><in id="S4.I1.i2.p1.2.m2.6.6.4.5.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.5"></in><apply id="S4.I1.i2.p1.2.m2.6.6.4.6.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.6"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.6.6.4.6.1.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.6">superscript</csymbol><apply id="S4.I1.i2.p1.2.m2.6.6.4.6.2.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.6"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.6.6.4.6.2.1.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.6">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.6.6.4.6.2.2.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.6.2.2">𝑔</ci><list id="S4.I1.i2.p1.2.m2.4.4.2.2.2.3.cmml" xref="S4.I1.i2.p1.2.m2.4.4.2.2.2.4"><ci id="S4.I1.i2.p1.2.m2.3.3.1.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.3.3.1.1.1.1">𝑖</ci><ci id="S4.I1.i2.p1.2.m2.4.4.2.2.2.2.cmml" xref="S4.I1.i2.p1.2.m2.4.4.2.2.2.2">𝑗</ci></list></apply><ci id="S4.I1.i2.p1.2.m2.6.6.4.6.3.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.6.3">𝜏</ci></apply><apply id="S4.I1.i2.p1.2.m2.6.6.4.7.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.7"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.6.6.4.7.1.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.7">superscript</csymbol><apply id="S4.I1.i2.p1.2.m2.6.6.4.7.2.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.7"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.6.6.4.7.2.1.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.7">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.6.6.4.7.2.2.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.7.2.2">𝒮</ci><list id="S4.I1.i2.p1.2.m2.6.6.4.4.2.3.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.4.2.4"><ci id="S4.I1.i2.p1.2.m2.5.5.3.3.1.1.cmml" xref="S4.I1.i2.p1.2.m2.5.5.3.3.1.1">𝑖</ci><ci id="S4.I1.i2.p1.2.m2.6.6.4.4.2.2.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.4.2.2">𝑗</ci></list></apply><ci id="S4.I1.i2.p1.2.m2.6.6.4.7.3.cmml" xref="S4.I1.i2.p1.2.m2.6.6.4.7.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.7c">\mathbf{Z}_{e}=[[\mathbf{z}_{l}]_{v_{l}\in g_{i,j}^{\tau}}]_{g_{i,j}^{\tau}\in%
\mathcal{S}_{i,j}^{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.7d">bold_Z start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT = [ [ bold_z start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ italic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ∈ caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, with the dimension of <math alttext="\mathbf{Z}_{e}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><msub id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml">𝐙</mi><mi id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">𝐙</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">\mathbf{Z}_{e}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.1d">bold_Z start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> being <math alttext="\mathbb{R}^{(2(K+1)\cdot\Gamma)\times d_{enc}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.1"><semantics id="S4.I1.i2.p1.4.m4.1a"><msup id="S4.I1.i2.p1.4.m4.1.2" xref="S4.I1.i2.p1.4.m4.1.2.cmml"><mi id="S4.I1.i2.p1.4.m4.1.2.2" xref="S4.I1.i2.p1.4.m4.1.2.2.cmml">ℝ</mi><mrow id="S4.I1.i2.p1.4.m4.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.cmml"><mrow id="S4.I1.i2.p1.4.m4.1.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml"><mo id="S4.I1.i2.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml"><mrow id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.cmml"><mn id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.cmml">2</mn><mo id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mo id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.2" rspace="0.222em" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.2.cmml">⋅</mo><mi id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.3" mathvariant="normal" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.3.cmml">Γ</mi></mrow><mo id="S4.I1.i2.p1.4.m4.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.I1.i2.p1.4.m4.1.1.1.2" rspace="0.222em" xref="S4.I1.i2.p1.4.m4.1.1.1.2.cmml">×</mo><msub id="S4.I1.i2.p1.4.m4.1.1.1.3" xref="S4.I1.i2.p1.4.m4.1.1.1.3.cmml"><mi id="S4.I1.i2.p1.4.m4.1.1.1.3.2" xref="S4.I1.i2.p1.4.m4.1.1.1.3.2.cmml">d</mi><mrow id="S4.I1.i2.p1.4.m4.1.1.1.3.3" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.cmml"><mi id="S4.I1.i2.p1.4.m4.1.1.1.3.3.2" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.2.cmml">e</mi><mo id="S4.I1.i2.p1.4.m4.1.1.1.3.3.1" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.4.m4.1.1.1.3.3.3" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.3.cmml">n</mi><mo id="S4.I1.i2.p1.4.m4.1.1.1.3.3.1a" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.4.m4.1.1.1.3.3.4" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.4.cmml">c</mi></mrow></msub></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.1b"><apply id="S4.I1.i2.p1.4.m4.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.1.2.1.cmml" xref="S4.I1.i2.p1.4.m4.1.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.1.2.2.cmml" xref="S4.I1.i2.p1.4.m4.1.2.2">ℝ</ci><apply id="S4.I1.i2.p1.4.m4.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1"><times id="S4.I1.i2.p1.4.m4.1.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.2"></times><apply id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1"><ci id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.2">⋅</ci><apply id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1"><times id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2"></times><cn id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3">2</cn><apply id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1"><plus id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2">𝐾</ci><cn id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><ci id="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1.1.1.3">Γ</ci></apply><apply id="S4.I1.i2.p1.4.m4.1.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.1.1.1.3.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.3">subscript</csymbol><ci id="S4.I1.i2.p1.4.m4.1.1.1.3.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.3.2">𝑑</ci><apply id="S4.I1.i2.p1.4.m4.1.1.1.3.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3"><times id="S4.I1.i2.p1.4.m4.1.1.1.3.3.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.1"></times><ci id="S4.I1.i2.p1.4.m4.1.1.1.3.3.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.2">𝑒</ci><ci id="S4.I1.i2.p1.4.m4.1.1.1.3.3.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.3">𝑛</ci><ci id="S4.I1.i2.p1.4.m4.1.1.1.3.3.4.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.3.3.4">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.1c">\mathbb{R}^{(2(K+1)\cdot\Gamma)\times d_{enc}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.1d">blackboard_R start_POSTSUPERSCRIPT ( 2 ( italic_K + 1 ) ⋅ roman_Γ ) × italic_d start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. We feed <math alttext="\mathbf{Z}_{e}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.5.m5.1"><semantics id="S4.I1.i2.p1.5.m5.1a"><msub id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.2" xref="S4.I1.i2.p1.5.m5.1.1.2.cmml">𝐙</mi><mi id="S4.I1.i2.p1.5.m5.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><apply id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.5.m5.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.5.m5.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.2">𝐙</ci><ci id="S4.I1.i2.p1.5.m5.1.1.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">\mathbf{Z}_{e}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.5.m5.1d">bold_Z start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> into a vanilla Transformer block to obtain the node embeddings <math alttext="\textbf{N}_{e}=\rm Transformer(\mathbf{Z}_{e})" class="ltx_Math" display="inline" id="S4.I1.i2.p1.6.m6.1"><semantics id="S4.I1.i2.p1.6.m6.1a"><mrow id="S4.I1.i2.p1.6.m6.1.1" xref="S4.I1.i2.p1.6.m6.1.1.cmml"><msub id="S4.I1.i2.p1.6.m6.1.1.3" xref="S4.I1.i2.p1.6.m6.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I1.i2.p1.6.m6.1.1.3.2" xref="S4.I1.i2.p1.6.m6.1.1.3.2a.cmml">N</mtext><mi id="S4.I1.i2.p1.6.m6.1.1.3.3" xref="S4.I1.i2.p1.6.m6.1.1.3.3.cmml">e</mi></msub><mo id="S4.I1.i2.p1.6.m6.1.1.2" xref="S4.I1.i2.p1.6.m6.1.1.2.cmml">=</mo><mrow id="S4.I1.i2.p1.6.m6.1.1.1" xref="S4.I1.i2.p1.6.m6.1.1.1.cmml"><mi id="S4.I1.i2.p1.6.m6.1.1.1.3" xref="S4.I1.i2.p1.6.m6.1.1.1.3.cmml">Transformer</mi><mo id="S4.I1.i2.p1.6.m6.1.1.1.2" xref="S4.I1.i2.p1.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i2.p1.6.m6.1.1.1.1.1" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml"><mo id="S4.I1.i2.p1.6.m6.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml">(</mo><msub id="S4.I1.i2.p1.6.m6.1.1.1.1.1.1" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.2" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.2.cmml">𝐙</mi><mi id="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.3" mathvariant="normal" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S4.I1.i2.p1.6.m6.1.1.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.6.m6.1b"><apply id="S4.I1.i2.p1.6.m6.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1"><eq id="S4.I1.i2.p1.6.m6.1.1.2.cmml" xref="S4.I1.i2.p1.6.m6.1.1.2"></eq><apply id="S4.I1.i2.p1.6.m6.1.1.3.cmml" xref="S4.I1.i2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.6.m6.1.1.3.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S4.I1.i2.p1.6.m6.1.1.3.2a.cmml" xref="S4.I1.i2.p1.6.m6.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S4.I1.i2.p1.6.m6.1.1.3.2.cmml" xref="S4.I1.i2.p1.6.m6.1.1.3.2">N</mtext></ci><ci id="S4.I1.i2.p1.6.m6.1.1.3.3.cmml" xref="S4.I1.i2.p1.6.m6.1.1.3.3">𝑒</ci></apply><apply id="S4.I1.i2.p1.6.m6.1.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1.1"><times id="S4.I1.i2.p1.6.m6.1.1.1.2.cmml" xref="S4.I1.i2.p1.6.m6.1.1.1.2"></times><ci id="S4.I1.i2.p1.6.m6.1.1.1.3.cmml" xref="S4.I1.i2.p1.6.m6.1.1.1.3">Transformer</ci><apply id="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.2">𝐙</ci><ci id="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.6.m6.1.1.1.1.1.1.3">e</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.6.m6.1c">\textbf{N}_{e}=\rm Transformer(\mathbf{Z}_{e})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.6.m6.1d">N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT = roman_Transformer ( bold_Z start_POSTSUBSCRIPT roman_e end_POSTSUBSCRIPT )</annotation></semantics></math>. The dimension of node embedding, <math alttext="d{enc}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.7.m7.1"><semantics id="S4.I1.i2.p1.7.m7.1a"><mrow id="S4.I1.i2.p1.7.m7.1.1" xref="S4.I1.i2.p1.7.m7.1.1.cmml"><mi id="S4.I1.i2.p1.7.m7.1.1.2" xref="S4.I1.i2.p1.7.m7.1.1.2.cmml">d</mi><mo id="S4.I1.i2.p1.7.m7.1.1.1" xref="S4.I1.i2.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.7.m7.1.1.3" xref="S4.I1.i2.p1.7.m7.1.1.3.cmml">e</mi><mo id="S4.I1.i2.p1.7.m7.1.1.1a" xref="S4.I1.i2.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.7.m7.1.1.4" xref="S4.I1.i2.p1.7.m7.1.1.4.cmml">n</mi><mo id="S4.I1.i2.p1.7.m7.1.1.1b" xref="S4.I1.i2.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.7.m7.1.1.5" xref="S4.I1.i2.p1.7.m7.1.1.5.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.7.m7.1b"><apply id="S4.I1.i2.p1.7.m7.1.1.cmml" xref="S4.I1.i2.p1.7.m7.1.1"><times id="S4.I1.i2.p1.7.m7.1.1.1.cmml" xref="S4.I1.i2.p1.7.m7.1.1.1"></times><ci id="S4.I1.i2.p1.7.m7.1.1.2.cmml" xref="S4.I1.i2.p1.7.m7.1.1.2">𝑑</ci><ci id="S4.I1.i2.p1.7.m7.1.1.3.cmml" xref="S4.I1.i2.p1.7.m7.1.1.3">𝑒</ci><ci id="S4.I1.i2.p1.7.m7.1.1.4.cmml" xref="S4.I1.i2.p1.7.m7.1.1.4">𝑛</ci><ci id="S4.I1.i2.p1.7.m7.1.1.5.cmml" xref="S4.I1.i2.p1.7.m7.1.1.5">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.7.m7.1c">d{enc}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.7.m7.1d">italic_d italic_e italic_n italic_c</annotation></semantics></math>, is specified here.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.9"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.9.1">Subgraph Encoding.</span> Additionally, we employ GNN to generate the graph representations of all related subgraphs in <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.2"><semantics id="S4.I1.i3.p1.1.m1.2a"><msubsup id="S4.I1.i3.p1.1.m1.2.3" xref="S4.I1.i3.p1.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i3.p1.1.m1.2.3.2.2" xref="S4.I1.i3.p1.1.m1.2.3.2.2.cmml">𝒮</mi><mrow id="S4.I1.i3.p1.1.m1.2.2.2.4" xref="S4.I1.i3.p1.1.m1.2.2.2.3.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.I1.i3.p1.1.m1.2.2.2.4.1" xref="S4.I1.i3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.I1.i3.p1.1.m1.2.2.2.2" xref="S4.I1.i3.p1.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.I1.i3.p1.1.m1.2.3.3" xref="S4.I1.i3.p1.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.2b"><apply id="S4.I1.i3.p1.1.m1.2.3.cmml" xref="S4.I1.i3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.2.3.1.cmml" xref="S4.I1.i3.p1.1.m1.2.3">superscript</csymbol><apply id="S4.I1.i3.p1.1.m1.2.3.2.cmml" xref="S4.I1.i3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.2.3.2.1.cmml" xref="S4.I1.i3.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.2.3.2.2.cmml" xref="S4.I1.i3.p1.1.m1.2.3.2.2">𝒮</ci><list id="S4.I1.i3.p1.1.m1.2.2.2.3.cmml" xref="S4.I1.i3.p1.1.m1.2.2.2.4"><ci id="S4.I1.i3.p1.1.m1.1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.I1.i3.p1.1.m1.2.2.2.2.cmml" xref="S4.I1.i3.p1.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.I1.i3.p1.1.m1.2.3.3.cmml" xref="S4.I1.i3.p1.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. For each subgraph <math alttext="g_{i}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.1"><semantics id="S4.I1.i3.p1.2.m2.1a"><msubsup id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml"><mi id="S4.I1.i3.p1.2.m2.1.1.2.2" xref="S4.I1.i3.p1.2.m2.1.1.2.2.cmml">g</mi><mi id="S4.I1.i3.p1.2.m2.1.1.2.3" xref="S4.I1.i3.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="S4.I1.i3.p1.2.m2.1.1.3" xref="S4.I1.i3.p1.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><apply id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.2.m2.1.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">superscript</csymbol><apply id="S4.I1.i3.p1.2.m2.1.1.2.cmml" xref="S4.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.2.m2.1.1.2.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.2.m2.1.1.2.2.cmml" xref="S4.I1.i3.p1.2.m2.1.1.2.2">𝑔</ci><ci id="S4.I1.i3.p1.2.m2.1.1.2.3.cmml" xref="S4.I1.i3.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S4.I1.i3.p1.2.m2.1.1.3.cmml" xref="S4.I1.i3.p1.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">g_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>, we extract the related node embeddings <math alttext="\textbf{N}_{i}^{t}\in\mathbb{R}^{(K+1)\times d_{enc}}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.3.m3.1"><semantics id="S4.I1.i3.p1.3.m3.1a"><mrow id="S4.I1.i3.p1.3.m3.1.2" xref="S4.I1.i3.p1.3.m3.1.2.cmml"><msubsup id="S4.I1.i3.p1.3.m3.1.2.2" xref="S4.I1.i3.p1.3.m3.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I1.i3.p1.3.m3.1.2.2.2.2" xref="S4.I1.i3.p1.3.m3.1.2.2.2.2a.cmml">N</mtext><mi id="S4.I1.i3.p1.3.m3.1.2.2.2.3" xref="S4.I1.i3.p1.3.m3.1.2.2.2.3.cmml">i</mi><mi id="S4.I1.i3.p1.3.m3.1.2.2.3" xref="S4.I1.i3.p1.3.m3.1.2.2.3.cmml">t</mi></msubsup><mo id="S4.I1.i3.p1.3.m3.1.2.1" xref="S4.I1.i3.p1.3.m3.1.2.1.cmml">∈</mo><msup id="S4.I1.i3.p1.3.m3.1.2.3" xref="S4.I1.i3.p1.3.m3.1.2.3.cmml"><mi id="S4.I1.i3.p1.3.m3.1.2.3.2" xref="S4.I1.i3.p1.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S4.I1.i3.p1.3.m3.1.1.1" xref="S4.I1.i3.p1.3.m3.1.1.1.cmml"><mrow id="S4.I1.i3.p1.3.m3.1.1.1.1.1" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S4.I1.i3.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.3.m3.1.1.1.1.1.1" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.2" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.2.cmml">K</mi><mo id="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.1" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.3" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I1.i3.p1.3.m3.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.I1.i3.p1.3.m3.1.1.1.2" rspace="0.222em" xref="S4.I1.i3.p1.3.m3.1.1.1.2.cmml">×</mo><msub id="S4.I1.i3.p1.3.m3.1.1.1.3" xref="S4.I1.i3.p1.3.m3.1.1.1.3.cmml"><mi id="S4.I1.i3.p1.3.m3.1.1.1.3.2" xref="S4.I1.i3.p1.3.m3.1.1.1.3.2.cmml">d</mi><mrow id="S4.I1.i3.p1.3.m3.1.1.1.3.3" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.cmml"><mi id="S4.I1.i3.p1.3.m3.1.1.1.3.3.2" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.2.cmml">e</mi><mo id="S4.I1.i3.p1.3.m3.1.1.1.3.3.1" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.3.m3.1.1.1.3.3.3" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.3.cmml">n</mi><mo id="S4.I1.i3.p1.3.m3.1.1.1.3.3.1a" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.3.m3.1.1.1.3.3.4" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.4.cmml">c</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><apply id="S4.I1.i3.p1.3.m3.1.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2"><in id="S4.I1.i3.p1.3.m3.1.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.1"></in><apply id="S4.I1.i3.p1.3.m3.1.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.2.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2">superscript</csymbol><apply id="S4.I1.i3.p1.3.m3.1.2.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.2.2.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2">subscript</csymbol><ci id="S4.I1.i3.p1.3.m3.1.2.2.2.2a.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I1.i3.p1.3.m3.1.2.2.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.2.2">N</mtext></ci><ci id="S4.I1.i3.p1.3.m3.1.2.2.2.3.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.2.3">𝑖</ci></apply><ci id="S4.I1.i3.p1.3.m3.1.2.2.3.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.3">𝑡</ci></apply><apply id="S4.I1.i3.p1.3.m3.1.2.3.cmml" xref="S4.I1.i3.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.2.3.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.3">superscript</csymbol><ci id="S4.I1.i3.p1.3.m3.1.2.3.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.3.2">ℝ</ci><apply id="S4.I1.i3.p1.3.m3.1.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1"><times id="S4.I1.i3.p1.3.m3.1.1.1.2.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.2"></times><apply id="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1"><plus id="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.1"></plus><ci id="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.2">𝐾</ci><cn id="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I1.i3.p1.3.m3.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.I1.i3.p1.3.m3.1.1.1.3.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.1.1.3.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.3">subscript</csymbol><ci id="S4.I1.i3.p1.3.m3.1.1.1.3.2.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.3.2">𝑑</ci><apply id="S4.I1.i3.p1.3.m3.1.1.1.3.3.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3"><times id="S4.I1.i3.p1.3.m3.1.1.1.3.3.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.1"></times><ci id="S4.I1.i3.p1.3.m3.1.1.1.3.3.2.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.2">𝑒</ci><ci id="S4.I1.i3.p1.3.m3.1.1.1.3.3.3.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.3">𝑛</ci><ci id="S4.I1.i3.p1.3.m3.1.1.1.3.3.4.cmml" xref="S4.I1.i3.p1.3.m3.1.1.1.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">\textbf{N}_{i}^{t}\in\mathbb{R}^{(K+1)\times d_{enc}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.3.m3.1d">N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_K + 1 ) × italic_d start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="\textbf{N}_{e}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.4.m4.1"><semantics id="S4.I1.i3.p1.4.m4.1a"><msub id="S4.I1.i3.p1.4.m4.1.1" xref="S4.I1.i3.p1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I1.i3.p1.4.m4.1.1.2" xref="S4.I1.i3.p1.4.m4.1.1.2a.cmml">N</mtext><mi id="S4.I1.i3.p1.4.m4.1.1.3" xref="S4.I1.i3.p1.4.m4.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m4.1b"><apply id="S4.I1.i3.p1.4.m4.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.4.m4.1.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.4.m4.1.1.2a.cmml" xref="S4.I1.i3.p1.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.I1.i3.p1.4.m4.1.1.2.cmml" xref="S4.I1.i3.p1.4.m4.1.1.2">N</mtext></ci><ci id="S4.I1.i3.p1.4.m4.1.1.3.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m4.1c">\textbf{N}_{e}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.4.m4.1d">N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and utilize GNN to obtain the embedding of node <math alttext="v_{l}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.5.m5.1"><semantics id="S4.I1.i3.p1.5.m5.1a"><msubsup id="S4.I1.i3.p1.5.m5.1.1" xref="S4.I1.i3.p1.5.m5.1.1.cmml"><mi id="S4.I1.i3.p1.5.m5.1.1.2.2" xref="S4.I1.i3.p1.5.m5.1.1.2.2.cmml">v</mi><mi id="S4.I1.i3.p1.5.m5.1.1.2.3" xref="S4.I1.i3.p1.5.m5.1.1.2.3.cmml">l</mi><mi id="S4.I1.i3.p1.5.m5.1.1.3" xref="S4.I1.i3.p1.5.m5.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.5.m5.1b"><apply id="S4.I1.i3.p1.5.m5.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.5.m5.1.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1">superscript</csymbol><apply id="S4.I1.i3.p1.5.m5.1.1.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.5.m5.1.1.2.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.5.m5.1.1.2.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2.2">𝑣</ci><ci id="S4.I1.i3.p1.5.m5.1.1.2.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i3.p1.5.m5.1.1.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.5.m5.1c">v_{l}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> as the subgraph embedding <math alttext="\textbf{s}_{i}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.6.m6.1"><semantics id="S4.I1.i3.p1.6.m6.1a"><msubsup id="S4.I1.i3.p1.6.m6.1.1" xref="S4.I1.i3.p1.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I1.i3.p1.6.m6.1.1.2.2" xref="S4.I1.i3.p1.6.m6.1.1.2.2a.cmml">s</mtext><mi id="S4.I1.i3.p1.6.m6.1.1.2.3" xref="S4.I1.i3.p1.6.m6.1.1.2.3.cmml">i</mi><mi id="S4.I1.i3.p1.6.m6.1.1.3" xref="S4.I1.i3.p1.6.m6.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.6.m6.1b"><apply id="S4.I1.i3.p1.6.m6.1.1.cmml" xref="S4.I1.i3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.6.m6.1.1.1.cmml" xref="S4.I1.i3.p1.6.m6.1.1">superscript</csymbol><apply id="S4.I1.i3.p1.6.m6.1.1.2.cmml" xref="S4.I1.i3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.6.m6.1.1.2.1.cmml" xref="S4.I1.i3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.6.m6.1.1.2.2a.cmml" xref="S4.I1.i3.p1.6.m6.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I1.i3.p1.6.m6.1.1.2.2.cmml" xref="S4.I1.i3.p1.6.m6.1.1.2.2">s</mtext></ci><ci id="S4.I1.i3.p1.6.m6.1.1.2.3.cmml" xref="S4.I1.i3.p1.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S4.I1.i3.p1.6.m6.1.1.3.cmml" xref="S4.I1.i3.p1.6.m6.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.6.m6.1c">\textbf{s}_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.6.m6.1d">s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>. To fuse the information on different timesteps, we stack the <math alttext="\Gamma" class="ltx_Math" display="inline" id="S4.I1.i3.p1.7.m7.1"><semantics id="S4.I1.i3.p1.7.m7.1a"><mi id="S4.I1.i3.p1.7.m7.1.1" mathvariant="normal" xref="S4.I1.i3.p1.7.m7.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.7.m7.1b"><ci id="S4.I1.i3.p1.7.m7.1.1.cmml" xref="S4.I1.i3.p1.7.m7.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.7.m7.1c">\Gamma</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.7.m7.1d">roman_Γ</annotation></semantics></math> embeddings of <math alttext="v_{l}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.8.m8.1"><semantics id="S4.I1.i3.p1.8.m8.1a"><msubsup id="S4.I1.i3.p1.8.m8.1.1" xref="S4.I1.i3.p1.8.m8.1.1.cmml"><mi id="S4.I1.i3.p1.8.m8.1.1.2.2" xref="S4.I1.i3.p1.8.m8.1.1.2.2.cmml">v</mi><mi id="S4.I1.i3.p1.8.m8.1.1.2.3" xref="S4.I1.i3.p1.8.m8.1.1.2.3.cmml">l</mi><mi id="S4.I1.i3.p1.8.m8.1.1.3" xref="S4.I1.i3.p1.8.m8.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.8.m8.1b"><apply id="S4.I1.i3.p1.8.m8.1.1.cmml" xref="S4.I1.i3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.8.m8.1.1.1.cmml" xref="S4.I1.i3.p1.8.m8.1.1">superscript</csymbol><apply id="S4.I1.i3.p1.8.m8.1.1.2.cmml" xref="S4.I1.i3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.8.m8.1.1.2.1.cmml" xref="S4.I1.i3.p1.8.m8.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.8.m8.1.1.2.2.cmml" xref="S4.I1.i3.p1.8.m8.1.1.2.2">𝑣</ci><ci id="S4.I1.i3.p1.8.m8.1.1.2.3.cmml" xref="S4.I1.i3.p1.8.m8.1.1.2.3">𝑙</ci></apply><ci id="S4.I1.i3.p1.8.m8.1.1.3.cmml" xref="S4.I1.i3.p1.8.m8.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.8.m8.1c">v_{l}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.8.m8.1d">italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> to generate <math alttext="\textbf{s}_{i}^{\tau}\in\mathbb{R}^{(K+1)\times d_{enc}}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.9.m9.1"><semantics id="S4.I1.i3.p1.9.m9.1a"><mrow id="S4.I1.i3.p1.9.m9.1.2" xref="S4.I1.i3.p1.9.m9.1.2.cmml"><msubsup id="S4.I1.i3.p1.9.m9.1.2.2" xref="S4.I1.i3.p1.9.m9.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I1.i3.p1.9.m9.1.2.2.2.2" xref="S4.I1.i3.p1.9.m9.1.2.2.2.2a.cmml">s</mtext><mi id="S4.I1.i3.p1.9.m9.1.2.2.2.3" xref="S4.I1.i3.p1.9.m9.1.2.2.2.3.cmml">i</mi><mi id="S4.I1.i3.p1.9.m9.1.2.2.3" xref="S4.I1.i3.p1.9.m9.1.2.2.3.cmml">τ</mi></msubsup><mo id="S4.I1.i3.p1.9.m9.1.2.1" xref="S4.I1.i3.p1.9.m9.1.2.1.cmml">∈</mo><msup id="S4.I1.i3.p1.9.m9.1.2.3" xref="S4.I1.i3.p1.9.m9.1.2.3.cmml"><mi id="S4.I1.i3.p1.9.m9.1.2.3.2" xref="S4.I1.i3.p1.9.m9.1.2.3.2.cmml">ℝ</mi><mrow id="S4.I1.i3.p1.9.m9.1.1.1" xref="S4.I1.i3.p1.9.m9.1.1.1.cmml"><mrow id="S4.I1.i3.p1.9.m9.1.1.1.1.1" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.cmml"><mo id="S4.I1.i3.p1.9.m9.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.9.m9.1.1.1.1.1.1" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.cmml"><mi id="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.2" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.2.cmml">K</mi><mo id="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.1" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.3" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I1.i3.p1.9.m9.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.I1.i3.p1.9.m9.1.1.1.2" rspace="0.222em" xref="S4.I1.i3.p1.9.m9.1.1.1.2.cmml">×</mo><msub id="S4.I1.i3.p1.9.m9.1.1.1.3" xref="S4.I1.i3.p1.9.m9.1.1.1.3.cmml"><mi id="S4.I1.i3.p1.9.m9.1.1.1.3.2" xref="S4.I1.i3.p1.9.m9.1.1.1.3.2.cmml">d</mi><mrow id="S4.I1.i3.p1.9.m9.1.1.1.3.3" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.cmml"><mi id="S4.I1.i3.p1.9.m9.1.1.1.3.3.2" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.2.cmml">e</mi><mo id="S4.I1.i3.p1.9.m9.1.1.1.3.3.1" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.9.m9.1.1.1.3.3.3" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.3.cmml">n</mi><mo id="S4.I1.i3.p1.9.m9.1.1.1.3.3.1a" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.9.m9.1.1.1.3.3.4" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.4.cmml">c</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.9.m9.1b"><apply id="S4.I1.i3.p1.9.m9.1.2.cmml" xref="S4.I1.i3.p1.9.m9.1.2"><in id="S4.I1.i3.p1.9.m9.1.2.1.cmml" xref="S4.I1.i3.p1.9.m9.1.2.1"></in><apply id="S4.I1.i3.p1.9.m9.1.2.2.cmml" xref="S4.I1.i3.p1.9.m9.1.2.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.9.m9.1.2.2.1.cmml" xref="S4.I1.i3.p1.9.m9.1.2.2">superscript</csymbol><apply id="S4.I1.i3.p1.9.m9.1.2.2.2.cmml" xref="S4.I1.i3.p1.9.m9.1.2.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.9.m9.1.2.2.2.1.cmml" xref="S4.I1.i3.p1.9.m9.1.2.2">subscript</csymbol><ci id="S4.I1.i3.p1.9.m9.1.2.2.2.2a.cmml" xref="S4.I1.i3.p1.9.m9.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I1.i3.p1.9.m9.1.2.2.2.2.cmml" xref="S4.I1.i3.p1.9.m9.1.2.2.2.2">s</mtext></ci><ci id="S4.I1.i3.p1.9.m9.1.2.2.2.3.cmml" xref="S4.I1.i3.p1.9.m9.1.2.2.2.3">𝑖</ci></apply><ci id="S4.I1.i3.p1.9.m9.1.2.2.3.cmml" xref="S4.I1.i3.p1.9.m9.1.2.2.3">𝜏</ci></apply><apply id="S4.I1.i3.p1.9.m9.1.2.3.cmml" xref="S4.I1.i3.p1.9.m9.1.2.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.9.m9.1.2.3.1.cmml" xref="S4.I1.i3.p1.9.m9.1.2.3">superscript</csymbol><ci id="S4.I1.i3.p1.9.m9.1.2.3.2.cmml" xref="S4.I1.i3.p1.9.m9.1.2.3.2">ℝ</ci><apply id="S4.I1.i3.p1.9.m9.1.1.1.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1"><times id="S4.I1.i3.p1.9.m9.1.1.1.2.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.2"></times><apply id="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1"><plus id="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.1"></plus><ci id="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.2">𝐾</ci><cn id="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I1.i3.p1.9.m9.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.I1.i3.p1.9.m9.1.1.1.3.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.9.m9.1.1.1.3.1.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.3">subscript</csymbol><ci id="S4.I1.i3.p1.9.m9.1.1.1.3.2.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.3.2">𝑑</ci><apply id="S4.I1.i3.p1.9.m9.1.1.1.3.3.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3"><times id="S4.I1.i3.p1.9.m9.1.1.1.3.3.1.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.1"></times><ci id="S4.I1.i3.p1.9.m9.1.1.1.3.3.2.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.2">𝑒</ci><ci id="S4.I1.i3.p1.9.m9.1.1.1.3.3.3.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.3">𝑛</ci><ci id="S4.I1.i3.p1.9.m9.1.1.1.3.3.4.cmml" xref="S4.I1.i3.p1.9.m9.1.1.1.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.9.m9.1c">\textbf{s}_{i}^{\tau}\in\mathbb{R}^{(K+1)\times d_{enc}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.9.m9.1d">s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_K + 1 ) × italic_d start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.5"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.5.1">Edge Encoding.</span> To obtain the representation of <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.1.m1.2"><semantics id="S4.I1.i4.p1.1.m1.2a"><msubsup id="S4.I1.i4.p1.1.m1.2.3" xref="S4.I1.i4.p1.1.m1.2.3.cmml"><mi id="S4.I1.i4.p1.1.m1.2.3.2.2" xref="S4.I1.i4.p1.1.m1.2.3.2.2.cmml">e</mi><mrow id="S4.I1.i4.p1.1.m1.2.2.2.4" xref="S4.I1.i4.p1.1.m1.2.2.2.3.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.I1.i4.p1.1.m1.2.2.2.4.1" xref="S4.I1.i4.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.I1.i4.p1.1.m1.2.2.2.2" xref="S4.I1.i4.p1.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.I1.i4.p1.1.m1.2.3.3" xref="S4.I1.i4.p1.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.2b"><apply id="S4.I1.i4.p1.1.m1.2.3.cmml" xref="S4.I1.i4.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.2.3.1.cmml" xref="S4.I1.i4.p1.1.m1.2.3">superscript</csymbol><apply id="S4.I1.i4.p1.1.m1.2.3.2.cmml" xref="S4.I1.i4.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.2.3.2.1.cmml" xref="S4.I1.i4.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I1.i4.p1.1.m1.2.3.2.2.cmml" xref="S4.I1.i4.p1.1.m1.2.3.2.2">𝑒</ci><list id="S4.I1.i4.p1.1.m1.2.2.2.3.cmml" xref="S4.I1.i4.p1.1.m1.2.2.2.4"><ci id="S4.I1.i4.p1.1.m1.1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.I1.i4.p1.1.m1.2.2.2.2.cmml" xref="S4.I1.i4.p1.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.I1.i4.p1.1.m1.2.3.3.cmml" xref="S4.I1.i4.p1.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.1.m1.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we first conduct average pooling on the related subgraph embeddings <math alttext="\mathbf{s}_{i}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.2.m2.1"><semantics id="S4.I1.i4.p1.2.m2.1a"><msubsup id="S4.I1.i4.p1.2.m2.1.1" xref="S4.I1.i4.p1.2.m2.1.1.cmml"><mi id="S4.I1.i4.p1.2.m2.1.1.2.2" xref="S4.I1.i4.p1.2.m2.1.1.2.2.cmml">𝐬</mi><mi id="S4.I1.i4.p1.2.m2.1.1.2.3" xref="S4.I1.i4.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="S4.I1.i4.p1.2.m2.1.1.3" xref="S4.I1.i4.p1.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.2.m2.1b"><apply id="S4.I1.i4.p1.2.m2.1.1.cmml" xref="S4.I1.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.2.m2.1.1.1.cmml" xref="S4.I1.i4.p1.2.m2.1.1">superscript</csymbol><apply id="S4.I1.i4.p1.2.m2.1.1.2.cmml" xref="S4.I1.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.2.m2.1.1.2.1.cmml" xref="S4.I1.i4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.2.m2.1.1.2.2.cmml" xref="S4.I1.i4.p1.2.m2.1.1.2.2">𝐬</ci><ci id="S4.I1.i4.p1.2.m2.1.1.2.3.cmml" xref="S4.I1.i4.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S4.I1.i4.p1.2.m2.1.1.3.cmml" xref="S4.I1.i4.p1.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.2.m2.1c">\mathbf{s}_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.2.m2.1d">bold_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{s}_{j}^{\tau}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.3.m3.1"><semantics id="S4.I1.i4.p1.3.m3.1a"><msubsup id="S4.I1.i4.p1.3.m3.1.1" xref="S4.I1.i4.p1.3.m3.1.1.cmml"><mi id="S4.I1.i4.p1.3.m3.1.1.2.2" xref="S4.I1.i4.p1.3.m3.1.1.2.2.cmml">𝐬</mi><mi id="S4.I1.i4.p1.3.m3.1.1.2.3" xref="S4.I1.i4.p1.3.m3.1.1.2.3.cmml">j</mi><mi id="S4.I1.i4.p1.3.m3.1.1.3" xref="S4.I1.i4.p1.3.m3.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.3.m3.1b"><apply id="S4.I1.i4.p1.3.m3.1.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.3.m3.1.1.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1">superscript</csymbol><apply id="S4.I1.i4.p1.3.m3.1.1.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.3.m3.1.1.2.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.3.m3.1.1.2.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2.2">𝐬</ci><ci id="S4.I1.i4.p1.3.m3.1.1.2.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2.3">𝑗</ci></apply><ci id="S4.I1.i4.p1.3.m3.1.1.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.3.m3.1c">\mathbf{s}_{j}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.3.m3.1d">bold_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>. Subsequently, we concatenate the resulting vectors and project the concatenated vector into the LLM’s hidden dimension <math alttext="d" class="ltx_Math" display="inline" id="S4.I1.i4.p1.4.m4.1"><semantics id="S4.I1.i4.p1.4.m4.1a"><mi id="S4.I1.i4.p1.4.m4.1.1" xref="S4.I1.i4.p1.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.4.m4.1b"><ci id="S4.I1.i4.p1.4.m4.1.1.cmml" xref="S4.I1.i4.p1.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.4.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.4.m4.1d">italic_d</annotation></semantics></math> using a fully connected layer. The final representation of <math alttext="\mathbf{r}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.5.m5.2"><semantics id="S4.I1.i4.p1.5.m5.2a"><msubsup id="S4.I1.i4.p1.5.m5.2.3" xref="S4.I1.i4.p1.5.m5.2.3.cmml"><mi id="S4.I1.i4.p1.5.m5.2.3.2.2" xref="S4.I1.i4.p1.5.m5.2.3.2.2.cmml">𝐫</mi><mrow id="S4.I1.i4.p1.5.m5.2.2.2.4" xref="S4.I1.i4.p1.5.m5.2.2.2.3.cmml"><mi id="S4.I1.i4.p1.5.m5.1.1.1.1" xref="S4.I1.i4.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.I1.i4.p1.5.m5.2.2.2.4.1" xref="S4.I1.i4.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.I1.i4.p1.5.m5.2.2.2.2" xref="S4.I1.i4.p1.5.m5.2.2.2.2.cmml">j</mi></mrow><mi id="S4.I1.i4.p1.5.m5.2.3.3" xref="S4.I1.i4.p1.5.m5.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.5.m5.2b"><apply id="S4.I1.i4.p1.5.m5.2.3.cmml" xref="S4.I1.i4.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S4.I1.i4.p1.5.m5.2.3.1.cmml" xref="S4.I1.i4.p1.5.m5.2.3">superscript</csymbol><apply id="S4.I1.i4.p1.5.m5.2.3.2.cmml" xref="S4.I1.i4.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S4.I1.i4.p1.5.m5.2.3.2.1.cmml" xref="S4.I1.i4.p1.5.m5.2.3">subscript</csymbol><ci id="S4.I1.i4.p1.5.m5.2.3.2.2.cmml" xref="S4.I1.i4.p1.5.m5.2.3.2.2">𝐫</ci><list id="S4.I1.i4.p1.5.m5.2.2.2.3.cmml" xref="S4.I1.i4.p1.5.m5.2.2.2.4"><ci id="S4.I1.i4.p1.5.m5.1.1.1.1.cmml" xref="S4.I1.i4.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S4.I1.i4.p1.5.m5.2.2.2.2.cmml" xref="S4.I1.i4.p1.5.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S4.I1.i4.p1.5.m5.2.3.3.cmml" xref="S4.I1.i4.p1.5.m5.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.5.m5.2c">\mathbf{r}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.5.m5.2d">bold_r start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> is thus given by</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{r}_{i,j}^{t}=\text{fc}(\text{concat}(\text{AvgPool}(\mathbf{s}_{i}^{%
\tau}),\text{AvgPool}(\mathbf{s}_{j}^{\tau})))\quad\text{for }\tau=t-\Gamma+1,%
\ldots,t" class="ltx_Math" display="block" id="S4.Ex2.m1.6"><semantics id="S4.Ex2.m1.6a"><mrow id="S4.Ex2.m1.6.6.2" xref="S4.Ex2.m1.6.6.3.cmml"><mrow id="S4.Ex2.m1.5.5.1.1" xref="S4.Ex2.m1.5.5.1.1.cmml"><msubsup id="S4.Ex2.m1.5.5.1.1.3" xref="S4.Ex2.m1.5.5.1.1.3.cmml"><mi id="S4.Ex2.m1.5.5.1.1.3.2.2" xref="S4.Ex2.m1.5.5.1.1.3.2.2.cmml">𝐫</mi><mrow id="S4.Ex2.m1.2.2.2.4" xref="S4.Ex2.m1.2.2.2.3.cmml"><mi id="S4.Ex2.m1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex2.m1.2.2.2.4.1" xref="S4.Ex2.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex2.m1.2.2.2.2" xref="S4.Ex2.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.Ex2.m1.5.5.1.1.3.3" xref="S4.Ex2.m1.5.5.1.1.3.3.cmml">t</mi></msubsup><mo id="S4.Ex2.m1.5.5.1.1.2" xref="S4.Ex2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S4.Ex2.m1.5.5.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.cmml"><mtext id="S4.Ex2.m1.5.5.1.1.1.3" xref="S4.Ex2.m1.5.5.1.1.1.3a.cmml">fc</mtext><mo id="S4.Ex2.m1.5.5.1.1.1.2" xref="S4.Ex2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.cmml"><mtext id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4a.cmml">concat</mtext><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3a.cmml">AvgPool</mtext><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐬</mi><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.4" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mtext id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.3a.cmml">AvgPool</mtext><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><msubsup id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">𝐬</mi><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml">j</mi><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">τ</mi></msubsup><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="S4.Ex2.m1.6.6.2.3" width="1em" xref="S4.Ex2.m1.6.6.3a.cmml"></mspace><mrow id="S4.Ex2.m1.6.6.2.2" xref="S4.Ex2.m1.6.6.2.2.cmml"><mrow id="S4.Ex2.m1.6.6.2.2.3" xref="S4.Ex2.m1.6.6.2.2.3.cmml"><mtext id="S4.Ex2.m1.6.6.2.2.3.2" xref="S4.Ex2.m1.6.6.2.2.3.2a.cmml">for </mtext><mo id="S4.Ex2.m1.6.6.2.2.3.1" xref="S4.Ex2.m1.6.6.2.2.3.1.cmml">⁢</mo><mi id="S4.Ex2.m1.6.6.2.2.3.3" xref="S4.Ex2.m1.6.6.2.2.3.3.cmml">τ</mi></mrow><mo id="S4.Ex2.m1.6.6.2.2.2" xref="S4.Ex2.m1.6.6.2.2.2.cmml">=</mo><mrow id="S4.Ex2.m1.6.6.2.2.1.1" xref="S4.Ex2.m1.6.6.2.2.1.2.cmml"><mrow id="S4.Ex2.m1.6.6.2.2.1.1.1" xref="S4.Ex2.m1.6.6.2.2.1.1.1.cmml"><mrow id="S4.Ex2.m1.6.6.2.2.1.1.1.2" xref="S4.Ex2.m1.6.6.2.2.1.1.1.2.cmml"><mi id="S4.Ex2.m1.6.6.2.2.1.1.1.2.2" xref="S4.Ex2.m1.6.6.2.2.1.1.1.2.2.cmml">t</mi><mo id="S4.Ex2.m1.6.6.2.2.1.1.1.2.1" xref="S4.Ex2.m1.6.6.2.2.1.1.1.2.1.cmml">−</mo><mi id="S4.Ex2.m1.6.6.2.2.1.1.1.2.3" mathvariant="normal" xref="S4.Ex2.m1.6.6.2.2.1.1.1.2.3.cmml">Γ</mi></mrow><mo id="S4.Ex2.m1.6.6.2.2.1.1.1.1" xref="S4.Ex2.m1.6.6.2.2.1.1.1.1.cmml">+</mo><mn id="S4.Ex2.m1.6.6.2.2.1.1.1.3" xref="S4.Ex2.m1.6.6.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.Ex2.m1.6.6.2.2.1.1.2" xref="S4.Ex2.m1.6.6.2.2.1.2.cmml">,</mo><mi id="S4.Ex2.m1.3.3" mathvariant="normal" xref="S4.Ex2.m1.3.3.cmml">…</mi><mo id="S4.Ex2.m1.6.6.2.2.1.1.3" xref="S4.Ex2.m1.6.6.2.2.1.2.cmml">,</mo><mi id="S4.Ex2.m1.4.4" xref="S4.Ex2.m1.4.4.cmml">t</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.6b"><apply id="S4.Ex2.m1.6.6.3.cmml" xref="S4.Ex2.m1.6.6.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.6.6.3a.cmml" xref="S4.Ex2.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S4.Ex2.m1.5.5.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1"><eq id="S4.Ex2.m1.5.5.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.2"></eq><apply id="S4.Ex2.m1.5.5.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.3.1.cmml" xref="S4.Ex2.m1.5.5.1.1.3">superscript</csymbol><apply id="S4.Ex2.m1.5.5.1.1.3.2.cmml" xref="S4.Ex2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.3.2.1.cmml" xref="S4.Ex2.m1.5.5.1.1.3">subscript</csymbol><ci id="S4.Ex2.m1.5.5.1.1.3.2.2.cmml" xref="S4.Ex2.m1.5.5.1.1.3.2.2">𝐫</ci><list id="S4.Ex2.m1.2.2.2.3.cmml" xref="S4.Ex2.m1.2.2.2.4"><ci id="S4.Ex2.m1.1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex2.m1.2.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.Ex2.m1.5.5.1.1.3.3.cmml" xref="S4.Ex2.m1.5.5.1.1.3.3">𝑡</ci></apply><apply id="S4.Ex2.m1.5.5.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1"><times id="S4.Ex2.m1.5.5.1.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.2"></times><ci id="S4.Ex2.m1.5.5.1.1.1.3a.cmml" xref="S4.Ex2.m1.5.5.1.1.1.3"><mtext id="S4.Ex2.m1.5.5.1.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.3">fc</mtext></ci><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1"><times id="S4.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.3"></times><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4a.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4"><mtext id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4">concat</mtext></ci><interval closure="open" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2"><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1"><times id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3"><mtext id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3">AvgPool</mtext></ci><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐬</ci><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2"><times id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.2"></times><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.3a.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.3"><mtext id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.3">AvgPool</mtext></ci><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1">superscript</csymbol><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1">subscript</csymbol><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.2">𝐬</ci><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.2.3">𝑗</ci></apply><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.3">𝜏</ci></apply></apply></interval></apply></apply></apply><apply id="S4.Ex2.m1.6.6.2.2.cmml" xref="S4.Ex2.m1.6.6.2.2"><eq id="S4.Ex2.m1.6.6.2.2.2.cmml" xref="S4.Ex2.m1.6.6.2.2.2"></eq><apply id="S4.Ex2.m1.6.6.2.2.3.cmml" xref="S4.Ex2.m1.6.6.2.2.3"><times id="S4.Ex2.m1.6.6.2.2.3.1.cmml" xref="S4.Ex2.m1.6.6.2.2.3.1"></times><ci id="S4.Ex2.m1.6.6.2.2.3.2a.cmml" xref="S4.Ex2.m1.6.6.2.2.3.2"><mtext id="S4.Ex2.m1.6.6.2.2.3.2.cmml" xref="S4.Ex2.m1.6.6.2.2.3.2">for </mtext></ci><ci id="S4.Ex2.m1.6.6.2.2.3.3.cmml" xref="S4.Ex2.m1.6.6.2.2.3.3">𝜏</ci></apply><list id="S4.Ex2.m1.6.6.2.2.1.2.cmml" xref="S4.Ex2.m1.6.6.2.2.1.1"><apply id="S4.Ex2.m1.6.6.2.2.1.1.1.cmml" xref="S4.Ex2.m1.6.6.2.2.1.1.1"><plus id="S4.Ex2.m1.6.6.2.2.1.1.1.1.cmml" xref="S4.Ex2.m1.6.6.2.2.1.1.1.1"></plus><apply id="S4.Ex2.m1.6.6.2.2.1.1.1.2.cmml" xref="S4.Ex2.m1.6.6.2.2.1.1.1.2"><minus id="S4.Ex2.m1.6.6.2.2.1.1.1.2.1.cmml" xref="S4.Ex2.m1.6.6.2.2.1.1.1.2.1"></minus><ci id="S4.Ex2.m1.6.6.2.2.1.1.1.2.2.cmml" xref="S4.Ex2.m1.6.6.2.2.1.1.1.2.2">𝑡</ci><ci id="S4.Ex2.m1.6.6.2.2.1.1.1.2.3.cmml" xref="S4.Ex2.m1.6.6.2.2.1.1.1.2.3">Γ</ci></apply><cn id="S4.Ex2.m1.6.6.2.2.1.1.1.3.cmml" type="integer" xref="S4.Ex2.m1.6.6.2.2.1.1.1.3">1</cn></apply><ci id="S4.Ex2.m1.3.3.cmml" xref="S4.Ex2.m1.3.3">…</ci><ci id="S4.Ex2.m1.4.4.cmml" xref="S4.Ex2.m1.4.4">𝑡</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.6c">\mathbf{r}_{i,j}^{t}=\text{fc}(\text{concat}(\text{AvgPool}(\mathbf{s}_{i}^{%
\tau}),\text{AvgPool}(\mathbf{s}_{j}^{\tau})))\quad\text{for }\tau=t-\Gamma+1,%
\ldots,t</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.6d">bold_r start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = fc ( concat ( AvgPool ( bold_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) , AvgPool ( bold_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) ) ) for italic_τ = italic_t - roman_Γ + 1 , … , italic_t</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS1.SSS1.p5.7">By incorporating this step, AnomalyLLM can systematically model the structural and temporal dynamics. More details of the subgraph-based edge encoder can be found in the Appendix   <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS3" title="A.3. Complexity Analysis of Training ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span>Contrastive Learning-based Optimization</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">AnomalyLLM employs contrastive learning to optimize the parameters in the dynamic-aware encoder. To obtain negative samples and achieve anomaly detection, we follow two principles in sampling: (1) edges with different subgraphs of related nodes should not have similar embeddings; (2) the embeddings between existing edges and randomly sampled edges should be distinguishable.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="159" id="S4.F3.g1" src="x3.png" width="332"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Sample process of contrastive training triplet</figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.SSS2.p2">
<p class="ltx_p" id="S4.SS1.SSS2.p2.9">For edge <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.1.m1.2"><semantics id="S4.SS1.SSS2.p2.1.m1.2a"><msubsup id="S4.SS1.SSS2.p2.1.m1.2.3" xref="S4.SS1.SSS2.p2.1.m1.2.3.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.2.3.2.2" xref="S4.SS1.SSS2.p2.1.m1.2.3.2.2.cmml">e</mi><mrow id="S4.SS1.SSS2.p2.1.m1.2.2.2.4" xref="S4.SS1.SSS2.p2.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.1.1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS2.p2.1.m1.2.2.2.4.1" xref="S4.SS1.SSS2.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS2.p2.1.m1.2.2.2.2" xref="S4.SS1.SSS2.p2.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS2.p2.1.m1.2.3.3" xref="S4.SS1.SSS2.p2.1.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.1.m1.2b"><apply id="S4.SS1.SSS2.p2.1.m1.2.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.2.3.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.3">superscript</csymbol><apply id="S4.SS1.SSS2.p2.1.m1.2.3.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.3">subscript</csymbol><ci id="S4.SS1.SSS2.p2.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.3.2.2">𝑒</ci><list id="S4.SS1.SSS2.p2.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.2.4"><ci id="S4.SS1.SSS2.p2.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS2.p2.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS2.p2.1.m1.2.3.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.1.m1.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.1.m1.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we check its adjacent graphs, <math alttext="\mathcal{G}^{t-1}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.2.m2.1"><semantics id="S4.SS1.SSS2.p2.2.m2.1a"><msup id="S4.SS1.SSS2.p2.2.m2.1.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p2.2.m2.1.1.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml">𝒢</mi><mrow id="S4.SS1.SSS2.p2.2.m2.1.1.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.1.1.3.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS2.p2.2.m2.1.1.3.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.1.cmml">−</mo><mn id="S4.SS1.SSS2.p2.2.m2.1.1.3.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.2.m2.1b"><apply id="S4.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2">𝒢</ci><apply id="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3"><minus id="S4.SS1.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.1"></minus><ci id="S4.SS1.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.2">𝑡</ci><cn id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.2.m2.1c">\mathcal{G}^{t-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.2.m2.1d">caligraphic_G start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{G}^{t+1}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.3.m3.1"><semantics id="S4.SS1.SSS2.p2.3.m3.1a"><msup id="S4.SS1.SSS2.p2.3.m3.1.1" xref="S4.SS1.SSS2.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p2.3.m3.1.1.2" xref="S4.SS1.SSS2.p2.3.m3.1.1.2.cmml">𝒢</mi><mrow id="S4.SS1.SSS2.p2.3.m3.1.1.3" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS1.SSS2.p2.3.m3.1.1.3.2" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS2.p2.3.m3.1.1.3.1" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.1.cmml">+</mo><mn id="S4.SS1.SSS2.p2.3.m3.1.1.3.3" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.3.m3.1b"><apply id="S4.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1.2">𝒢</ci><apply id="S4.SS1.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1.3"><plus id="S4.SS1.SSS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.1"></plus><ci id="S4.SS1.SSS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.2">𝑡</ci><cn id="S4.SS1.SSS2.p2.3.m3.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.3.m3.1c">\mathcal{G}^{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.3.m3.1d">caligraphic_G start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT</annotation></semantics></math>. The sampling should include two levels, <em class="ltx_emph ltx_font_italic" id="S4.SS1.SSS2.p2.9.1">i.e.</em> edge level and subgraph level. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.F3" title="Figure 3 ‣ 4.1.2. Contrastive Learning-based Optimization ‣ 4.1. Dynamic-aware Contrastive Pretraining ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, we randomly sample a node <math alttext="\hat{v}^{\omega},\text{ where }\omega=t\pm 1" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.4.m4.2"><semantics id="S4.SS1.SSS2.p2.4.m4.2a"><mrow id="S4.SS1.SSS2.p2.4.m4.2.2" xref="S4.SS1.SSS2.p2.4.m4.2.2.cmml"><mrow id="S4.SS1.SSS2.p2.4.m4.2.2.2.2" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.3.cmml"><msup id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.cmml"><mi id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.2" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.2.cmml">v</mi><mo id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.1" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.3" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.3.cmml">ω</mi></msup><mo id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.3" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.cmml"><mtext id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.2" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.2a.cmml"> where </mtext><mo id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.1" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.3" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.3.cmml">ω</mi></mrow></mrow><mo id="S4.SS1.SSS2.p2.4.m4.2.2.3" xref="S4.SS1.SSS2.p2.4.m4.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS2.p2.4.m4.2.2.4" xref="S4.SS1.SSS2.p2.4.m4.2.2.4.cmml"><mi id="S4.SS1.SSS2.p2.4.m4.2.2.4.2" xref="S4.SS1.SSS2.p2.4.m4.2.2.4.2.cmml">t</mi><mo id="S4.SS1.SSS2.p2.4.m4.2.2.4.1" xref="S4.SS1.SSS2.p2.4.m4.2.2.4.1.cmml">±</mo><mn id="S4.SS1.SSS2.p2.4.m4.2.2.4.3" xref="S4.SS1.SSS2.p2.4.m4.2.2.4.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.4.m4.2b"><apply id="S4.SS1.SSS2.p2.4.m4.2.2.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2"><eq id="S4.SS1.SSS2.p2.4.m4.2.2.3.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.3"></eq><list id="S4.SS1.SSS2.p2.4.m4.2.2.2.3.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2"><apply id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2"><ci id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.1">^</ci><ci id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.2.2">𝑣</ci></apply><ci id="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p2.4.m4.1.1.1.1.1.3">𝜔</ci></apply><apply id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2"><times id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.1"></times><ci id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.2a.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.2"><mtext id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.2"> where </mtext></ci><ci id="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.2.2.2.3">𝜔</ci></apply></list><apply id="S4.SS1.SSS2.p2.4.m4.2.2.4.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.4"><csymbol cd="latexml" id="S4.SS1.SSS2.p2.4.m4.2.2.4.1.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.4.1">plus-or-minus</csymbol><ci id="S4.SS1.SSS2.p2.4.m4.2.2.4.2.cmml" xref="S4.SS1.SSS2.p2.4.m4.2.2.4.2">𝑡</ci><cn id="S4.SS1.SSS2.p2.4.m4.2.2.4.3.cmml" type="integer" xref="S4.SS1.SSS2.p2.4.m4.2.2.4.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.4.m4.2c">\hat{v}^{\omega},\text{ where }\omega=t\pm 1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.4.m4.2d">over^ start_ARG italic_v end_ARG start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT , where italic_ω = italic_t ± 1</annotation></semantics></math> not directly connected to <math alttext="v_{i}^{\omega}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.5.m5.1"><semantics id="S4.SS1.SSS2.p2.5.m5.1a"><msubsup id="S4.SS1.SSS2.p2.5.m5.1.1" xref="S4.SS1.SSS2.p2.5.m5.1.1.cmml"><mi id="S4.SS1.SSS2.p2.5.m5.1.1.2.2" xref="S4.SS1.SSS2.p2.5.m5.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS2.p2.5.m5.1.1.2.3" xref="S4.SS1.SSS2.p2.5.m5.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS2.p2.5.m5.1.1.3" xref="S4.SS1.SSS2.p2.5.m5.1.1.3.cmml">ω</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.5.m5.1b"><apply id="S4.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.5.m5.1.1.1.cmml" xref="S4.SS1.SSS2.p2.5.m5.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p2.5.m5.1.1.2.cmml" xref="S4.SS1.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.5.m5.1.1.2.1.cmml" xref="S4.SS1.SSS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p2.5.m5.1.1.2.2.cmml" xref="S4.SS1.SSS2.p2.5.m5.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS2.p2.5.m5.1.1.2.3.cmml" xref="S4.SS1.SSS2.p2.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS2.p2.5.m5.1.1.3.cmml" xref="S4.SS1.SSS2.p2.5.m5.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.5.m5.1c">v_{i}^{\omega}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT</annotation></semantics></math> and generate the edge embedding <math alttext="\hat{\mathbf{r}}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.6.m6.2"><semantics id="S4.SS1.SSS2.p2.6.m6.2a"><msubsup id="S4.SS1.SSS2.p2.6.m6.2.3" xref="S4.SS1.SSS2.p2.6.m6.2.3.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.6.m6.2.3.2.2" xref="S4.SS1.SSS2.p2.6.m6.2.3.2.2.cmml"><mi id="S4.SS1.SSS2.p2.6.m6.2.3.2.2.2" xref="S4.SS1.SSS2.p2.6.m6.2.3.2.2.2.cmml">𝐫</mi><mo id="S4.SS1.SSS2.p2.6.m6.2.3.2.2.1" xref="S4.SS1.SSS2.p2.6.m6.2.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS1.SSS2.p2.6.m6.2.2.2.4" xref="S4.SS1.SSS2.p2.6.m6.2.2.2.3.cmml"><mi id="S4.SS1.SSS2.p2.6.m6.1.1.1.1" xref="S4.SS1.SSS2.p2.6.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS2.p2.6.m6.2.2.2.4.1" xref="S4.SS1.SSS2.p2.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS2.p2.6.m6.2.2.2.2" xref="S4.SS1.SSS2.p2.6.m6.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS2.p2.6.m6.2.3.3" xref="S4.SS1.SSS2.p2.6.m6.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.6.m6.2b"><apply id="S4.SS1.SSS2.p2.6.m6.2.3.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.6.m6.2.3.1.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.3">superscript</csymbol><apply id="S4.SS1.SSS2.p2.6.m6.2.3.2.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.6.m6.2.3.2.1.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.3">subscript</csymbol><apply id="S4.SS1.SSS2.p2.6.m6.2.3.2.2.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.3.2.2"><ci id="S4.SS1.SSS2.p2.6.m6.2.3.2.2.1.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.3.2.2.1">^</ci><ci id="S4.SS1.SSS2.p2.6.m6.2.3.2.2.2.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.3.2.2.2">𝐫</ci></apply><list id="S4.SS1.SSS2.p2.6.m6.2.2.2.3.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.2.2.4"><ci id="S4.SS1.SSS2.p2.6.m6.1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.6.m6.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS2.p2.6.m6.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS2.p2.6.m6.2.3.3.cmml" xref="S4.SS1.SSS2.p2.6.m6.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.6.m6.2c">\hat{\mathbf{r}}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.6.m6.2d">over^ start_ARG bold_r end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> for the edge <math alttext="&lt;v_{i}^{\omega},\hat{v}^{\omega}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS1.SSS2.p2.7.m7.1"><semantics id="S4.SS1.SSS2.p2.7.m7.1a"><mrow id="S4.SS1.SSS2.p2.7.m7.1b"><mo id="S4.SS1.SSS2.p2.7.m7.1.1">&lt;</mo><msubsup id="S4.SS1.SSS2.p2.7.m7.1.2"><mi id="S4.SS1.SSS2.p2.7.m7.1.2.2.2">v</mi><mi id="S4.SS1.SSS2.p2.7.m7.1.2.2.3">i</mi><mi id="S4.SS1.SSS2.p2.7.m7.1.2.3">ω</mi></msubsup><mo id="S4.SS1.SSS2.p2.7.m7.1.3">,</mo><msup id="S4.SS1.SSS2.p2.7.m7.1.4"><mover accent="true" id="S4.SS1.SSS2.p2.7.m7.1.4.2"><mi id="S4.SS1.SSS2.p2.7.m7.1.4.2.2">v</mi><mo id="S4.SS1.SSS2.p2.7.m7.1.4.2.1">^</mo></mover><mi id="S4.SS1.SSS2.p2.7.m7.1.4.3">ω</mi></msup><mo id="S4.SS1.SSS2.p2.7.m7.1.5">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.7.m7.1c">&lt;v_{i}^{\omega},\hat{v}^{\omega}&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.7.m7.1d">&lt; italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT , over^ start_ARG italic_v end_ARG start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT &gt;</annotation></semantics></math>. At the edge level, we employ a Multilayer Perceptron (MLP) layer as the anomaly detector to identify whether the input edge is randomly sampled. Here, we feed the embeddings of <math alttext="\mathbf{r}_{i,j}^{\omega}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.8.m8.2"><semantics id="S4.SS1.SSS2.p2.8.m8.2a"><msubsup id="S4.SS1.SSS2.p2.8.m8.2.3" xref="S4.SS1.SSS2.p2.8.m8.2.3.cmml"><mi id="S4.SS1.SSS2.p2.8.m8.2.3.2.2" xref="S4.SS1.SSS2.p2.8.m8.2.3.2.2.cmml">𝐫</mi><mrow id="S4.SS1.SSS2.p2.8.m8.2.2.2.4" xref="S4.SS1.SSS2.p2.8.m8.2.2.2.3.cmml"><mi id="S4.SS1.SSS2.p2.8.m8.1.1.1.1" xref="S4.SS1.SSS2.p2.8.m8.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS2.p2.8.m8.2.2.2.4.1" xref="S4.SS1.SSS2.p2.8.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS2.p2.8.m8.2.2.2.2" xref="S4.SS1.SSS2.p2.8.m8.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS2.p2.8.m8.2.3.3" xref="S4.SS1.SSS2.p2.8.m8.2.3.3.cmml">ω</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.8.m8.2b"><apply id="S4.SS1.SSS2.p2.8.m8.2.3.cmml" xref="S4.SS1.SSS2.p2.8.m8.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.8.m8.2.3.1.cmml" xref="S4.SS1.SSS2.p2.8.m8.2.3">superscript</csymbol><apply id="S4.SS1.SSS2.p2.8.m8.2.3.2.cmml" xref="S4.SS1.SSS2.p2.8.m8.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.8.m8.2.3.2.1.cmml" xref="S4.SS1.SSS2.p2.8.m8.2.3">subscript</csymbol><ci id="S4.SS1.SSS2.p2.8.m8.2.3.2.2.cmml" xref="S4.SS1.SSS2.p2.8.m8.2.3.2.2">𝐫</ci><list id="S4.SS1.SSS2.p2.8.m8.2.2.2.3.cmml" xref="S4.SS1.SSS2.p2.8.m8.2.2.2.4"><ci id="S4.SS1.SSS2.p2.8.m8.1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.8.m8.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS2.p2.8.m8.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.8.m8.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS2.p2.8.m8.2.3.3.cmml" xref="S4.SS1.SSS2.p2.8.m8.2.3.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.8.m8.2c">\mathbf{r}_{i,j}^{\omega}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.8.m8.2d">bold_r start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\hat{\mathbf{r}}_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.9.m9.2"><semantics id="S4.SS1.SSS2.p2.9.m9.2a"><msubsup id="S4.SS1.SSS2.p2.9.m9.2.3" xref="S4.SS1.SSS2.p2.9.m9.2.3.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.9.m9.2.3.2.2" xref="S4.SS1.SSS2.p2.9.m9.2.3.2.2.cmml"><mi id="S4.SS1.SSS2.p2.9.m9.2.3.2.2.2" xref="S4.SS1.SSS2.p2.9.m9.2.3.2.2.2.cmml">𝐫</mi><mo id="S4.SS1.SSS2.p2.9.m9.2.3.2.2.1" xref="S4.SS1.SSS2.p2.9.m9.2.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS1.SSS2.p2.9.m9.2.2.2.4" xref="S4.SS1.SSS2.p2.9.m9.2.2.2.3.cmml"><mi id="S4.SS1.SSS2.p2.9.m9.1.1.1.1" xref="S4.SS1.SSS2.p2.9.m9.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS2.p2.9.m9.2.2.2.4.1" xref="S4.SS1.SSS2.p2.9.m9.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS2.p2.9.m9.2.2.2.2" xref="S4.SS1.SSS2.p2.9.m9.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS1.SSS2.p2.9.m9.2.3.3" xref="S4.SS1.SSS2.p2.9.m9.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.9.m9.2b"><apply id="S4.SS1.SSS2.p2.9.m9.2.3.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.9.m9.2.3.1.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.3">superscript</csymbol><apply id="S4.SS1.SSS2.p2.9.m9.2.3.2.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.9.m9.2.3.2.1.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.3">subscript</csymbol><apply id="S4.SS1.SSS2.p2.9.m9.2.3.2.2.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.3.2.2"><ci id="S4.SS1.SSS2.p2.9.m9.2.3.2.2.1.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.3.2.2.1">^</ci><ci id="S4.SS1.SSS2.p2.9.m9.2.3.2.2.2.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.3.2.2.2">𝐫</ci></apply><list id="S4.SS1.SSS2.p2.9.m9.2.2.2.3.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.2.2.4"><ci id="S4.SS1.SSS2.p2.9.m9.1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.9.m9.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS2.p2.9.m9.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.SSS2.p2.9.m9.2.3.3.cmml" xref="S4.SS1.SSS2.p2.9.m9.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.9.m9.2c">\hat{\mathbf{r}}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.9.m9.2d">over^ start_ARG bold_r end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> into the detector and employ binary cross-entropy loss to make them distinguishable:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{BCE}=-\log(1-\rm{MLP}(\mathbf{r}_{i,j}^{t}))+\log(\rm{MLP}(%
\mathbf{r}_{i,j}^{t}))" class="ltx_Math" display="block" id="S4.Ex3.m1.8"><semantics id="S4.Ex3.m1.8a"><mrow id="S4.Ex3.m1.8.8" xref="S4.Ex3.m1.8.8.cmml"><msub id="S4.Ex3.m1.8.8.4" xref="S4.Ex3.m1.8.8.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m1.8.8.4.2" xref="S4.Ex3.m1.8.8.4.2.cmml">ℒ</mi><mrow id="S4.Ex3.m1.8.8.4.3" xref="S4.Ex3.m1.8.8.4.3.cmml"><mi id="S4.Ex3.m1.8.8.4.3.2" xref="S4.Ex3.m1.8.8.4.3.2.cmml">B</mi><mo id="S4.Ex3.m1.8.8.4.3.1" xref="S4.Ex3.m1.8.8.4.3.1.cmml">⁢</mo><mi id="S4.Ex3.m1.8.8.4.3.3" xref="S4.Ex3.m1.8.8.4.3.3.cmml">C</mi><mo id="S4.Ex3.m1.8.8.4.3.1a" xref="S4.Ex3.m1.8.8.4.3.1.cmml">⁢</mo><mi id="S4.Ex3.m1.8.8.4.3.4" xref="S4.Ex3.m1.8.8.4.3.4.cmml">E</mi></mrow></msub><mo id="S4.Ex3.m1.8.8.3" xref="S4.Ex3.m1.8.8.3.cmml">=</mo><mrow id="S4.Ex3.m1.8.8.2" xref="S4.Ex3.m1.8.8.2.cmml"><mrow id="S4.Ex3.m1.7.7.1.1" xref="S4.Ex3.m1.7.7.1.1.cmml"><mo id="S4.Ex3.m1.7.7.1.1a" rspace="0.167em" xref="S4.Ex3.m1.7.7.1.1.cmml">−</mo><mrow id="S4.Ex3.m1.7.7.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.2.cmml"><mi id="S4.Ex3.m1.5.5" xref="S4.Ex3.m1.5.5.cmml">log</mi><mo id="S4.Ex3.m1.7.7.1.1.1.1a" xref="S4.Ex3.m1.7.7.1.1.1.2.cmml">⁡</mo><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.2.cmml"><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.2" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.1.2.cmml">(</mo><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.7.7.1.1.1.1.1.1.3" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.cmml">1</mn><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.1.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.3" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.3.cmml">MLP</mi><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐫</mi><mrow id="S4.Ex3.m1.2.2.2.4" xref="S4.Ex3.m1.2.2.2.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex3.m1.2.2.2.4.1" xref="S4.Ex3.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex3.m1.2.2.2.2" mathvariant="normal" xref="S4.Ex3.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.3" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex3.m1.8.8.2.3" xref="S4.Ex3.m1.8.8.2.3.cmml">+</mo><mrow id="S4.Ex3.m1.8.8.2.2.1" xref="S4.Ex3.m1.8.8.2.2.2.cmml"><mi id="S4.Ex3.m1.6.6" xref="S4.Ex3.m1.6.6.cmml">log</mi><mo id="S4.Ex3.m1.8.8.2.2.1a" xref="S4.Ex3.m1.8.8.2.2.2.cmml">⁡</mo><mrow id="S4.Ex3.m1.8.8.2.2.1.1" xref="S4.Ex3.m1.8.8.2.2.2.cmml"><mo id="S4.Ex3.m1.8.8.2.2.1.1.2" stretchy="false" xref="S4.Ex3.m1.8.8.2.2.2.cmml">(</mo><mrow id="S4.Ex3.m1.8.8.2.2.1.1.1" xref="S4.Ex3.m1.8.8.2.2.1.1.1.cmml"><mi id="S4.Ex3.m1.8.8.2.2.1.1.1.3" xref="S4.Ex3.m1.8.8.2.2.1.1.1.3.cmml">MLP</mi><mo id="S4.Ex3.m1.8.8.2.2.1.1.1.2" xref="S4.Ex3.m1.8.8.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.2.2" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.2.2.cmml">𝐫</mi><mrow id="S4.Ex3.m1.4.4.2.4" xref="S4.Ex3.m1.4.4.2.3.cmml"><mi id="S4.Ex3.m1.3.3.1.1" mathvariant="normal" xref="S4.Ex3.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex3.m1.4.4.2.4.1" xref="S4.Ex3.m1.4.4.2.3.cmml">,</mo><mi id="S4.Ex3.m1.4.4.2.2" mathvariant="normal" xref="S4.Ex3.m1.4.4.2.2.cmml">j</mi></mrow><mi id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.3" mathvariant="normal" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m1.8.8.2.2.1.1.3" stretchy="false" xref="S4.Ex3.m1.8.8.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.8b"><apply id="S4.Ex3.m1.8.8.cmml" xref="S4.Ex3.m1.8.8"><eq id="S4.Ex3.m1.8.8.3.cmml" xref="S4.Ex3.m1.8.8.3"></eq><apply id="S4.Ex3.m1.8.8.4.cmml" xref="S4.Ex3.m1.8.8.4"><csymbol cd="ambiguous" id="S4.Ex3.m1.8.8.4.1.cmml" xref="S4.Ex3.m1.8.8.4">subscript</csymbol><ci id="S4.Ex3.m1.8.8.4.2.cmml" xref="S4.Ex3.m1.8.8.4.2">ℒ</ci><apply id="S4.Ex3.m1.8.8.4.3.cmml" xref="S4.Ex3.m1.8.8.4.3"><times id="S4.Ex3.m1.8.8.4.3.1.cmml" xref="S4.Ex3.m1.8.8.4.3.1"></times><ci id="S4.Ex3.m1.8.8.4.3.2.cmml" xref="S4.Ex3.m1.8.8.4.3.2">𝐵</ci><ci id="S4.Ex3.m1.8.8.4.3.3.cmml" xref="S4.Ex3.m1.8.8.4.3.3">𝐶</ci><ci id="S4.Ex3.m1.8.8.4.3.4.cmml" xref="S4.Ex3.m1.8.8.4.3.4">𝐸</ci></apply></apply><apply id="S4.Ex3.m1.8.8.2.cmml" xref="S4.Ex3.m1.8.8.2"><plus id="S4.Ex3.m1.8.8.2.3.cmml" xref="S4.Ex3.m1.8.8.2.3"></plus><apply id="S4.Ex3.m1.7.7.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1"><minus id="S4.Ex3.m1.7.7.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1"></minus><apply id="S4.Ex3.m1.7.7.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1"><log id="S4.Ex3.m1.5.5.cmml" xref="S4.Ex3.m1.5.5"></log><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1"><minus id="S4.Ex3.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.2"></minus><cn id="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.3">1</cn><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1"><times id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.3">MLP</ci><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2">𝐫</ci><list id="S4.Ex3.m1.2.2.2.3.cmml" xref="S4.Ex3.m1.2.2.2.4"><ci id="S4.Ex3.m1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1">i</ci><ci id="S4.Ex3.m1.2.2.2.2.cmml" xref="S4.Ex3.m1.2.2.2.2">j</ci></list></apply><ci id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">t</ci></apply></apply></apply></apply></apply><apply id="S4.Ex3.m1.8.8.2.2.2.cmml" xref="S4.Ex3.m1.8.8.2.2.1"><log id="S4.Ex3.m1.6.6.cmml" xref="S4.Ex3.m1.6.6"></log><apply id="S4.Ex3.m1.8.8.2.2.1.1.1.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1"><times id="S4.Ex3.m1.8.8.2.2.1.1.1.2.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1.2"></times><ci id="S4.Ex3.m1.8.8.2.2.1.1.1.3.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1.3">MLP</ci><apply id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.2.2">𝐫</ci><list id="S4.Ex3.m1.4.4.2.3.cmml" xref="S4.Ex3.m1.4.4.2.4"><ci id="S4.Ex3.m1.3.3.1.1.cmml" xref="S4.Ex3.m1.3.3.1.1">i</ci><ci id="S4.Ex3.m1.4.4.2.2.cmml" xref="S4.Ex3.m1.4.4.2.2">j</ci></list></apply><ci id="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.8.8.2.2.1.1.1.1.1.1.3">t</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.8c">\mathcal{L}_{BCE}=-\log(1-\rm{MLP}(\mathbf{r}_{i,j}^{t}))+\log(\rm{MLP}(%
\mathbf{r}_{i,j}^{t}))</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.8d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_C italic_E end_POSTSUBSCRIPT = - roman_log ( 1 - roman_MLP ( bold_r start_POSTSUBSCRIPT roman_i , roman_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_t end_POSTSUPERSCRIPT ) ) + roman_log ( roman_MLP ( bold_r start_POSTSUBSCRIPT roman_i , roman_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_t end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.SSS2.p3">
<p class="ltx_p" id="S4.SS1.SSS2.p3.4">At the subgraph level, we consider the subgraph of <math alttext="\hat{v}^{\omega}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p3.1.m1.1"><semantics id="S4.SS1.SSS2.p3.1.m1.1a"><msup id="S4.SS1.SSS2.p3.1.m1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.SSS2.p3.1.m1.1.1.2" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml"><mi id="S4.SS1.SSS2.p3.1.m1.1.1.2.2" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.2.cmml">v</mi><mo id="S4.SS1.SSS2.p3.1.m1.1.1.2.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.SSS2.p3.1.m1.1.1.3" xref="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml">ω</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.1.m1.1b"><apply id="S4.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.2"><ci id="S4.SS1.SSS2.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.1">^</ci><ci id="S4.SS1.SSS2.p3.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.2">𝑣</ci></apply><ci id="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.1.m1.1c">\hat{v}^{\omega}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p3.1.m1.1d">over^ start_ARG italic_v end_ARG start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT</annotation></semantics></math> as the negative sample of subgraph of <math alttext="v_{i}^{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p3.2.m2.1"><semantics id="S4.SS1.SSS2.p3.2.m2.1a"><msubsup id="S4.SS1.SSS2.p3.2.m2.1.1" xref="S4.SS1.SSS2.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p3.2.m2.1.1.2.2" xref="S4.SS1.SSS2.p3.2.m2.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS2.p3.2.m2.1.1.2.3" xref="S4.SS1.SSS2.p3.2.m2.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS2.p3.2.m2.1.1.3" xref="S4.SS1.SSS2.p3.2.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.2.m2.1b"><apply id="S4.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS2.p3.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.2.m2.1c">v_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p3.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and utilize the subgraph of <math alttext="v_{i}^{\omega}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p3.3.m3.1"><semantics id="S4.SS1.SSS2.p3.3.m3.1a"><msubsup id="S4.SS1.SSS2.p3.3.m3.1.1" xref="S4.SS1.SSS2.p3.3.m3.1.1.cmml"><mi id="S4.SS1.SSS2.p3.3.m3.1.1.2.2" xref="S4.SS1.SSS2.p3.3.m3.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS2.p3.3.m3.1.1.2.3" xref="S4.SS1.SSS2.p3.3.m3.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS2.p3.3.m3.1.1.3" xref="S4.SS1.SSS2.p3.3.m3.1.1.3.cmml">ω</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.3.m3.1b"><apply id="S4.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS2.p3.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.3.m3.1c">v_{i}^{\omega}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p3.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT</annotation></semantics></math> in different timestamps as the positive sample to construct a triplet. As shown in the right part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.F3" title="Figure 3 ‣ 4.1.2. Contrastive Learning-based Optimization ‣ 4.1. Dynamic-aware Contrastive Pretraining ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, we sample negative subgraph and contrastive training triplet for node <math alttext="v_{i}^{\omega}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p3.4.m4.1"><semantics id="S4.SS1.SSS2.p3.4.m4.1a"><msubsup id="S4.SS1.SSS2.p3.4.m4.1.1" xref="S4.SS1.SSS2.p3.4.m4.1.1.cmml"><mi id="S4.SS1.SSS2.p3.4.m4.1.1.2.2" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.2.cmml">v</mi><mi id="S4.SS1.SSS2.p3.4.m4.1.1.2.3" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS2.p3.4.m4.1.1.3" xref="S4.SS1.SSS2.p3.4.m4.1.1.3.cmml">ω</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.4.m4.1b"><apply id="S4.SS1.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.4.m4.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.4.m4.1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS2.p3.4.m4.1.1.2.3.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS2.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.4.m4.1c">v_{i}^{\omega}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p3.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT</annotation></semantics></math>. Since the edge embeddings are concatenations of subgraph embeddings, AnomalyLLM employ contrastive loss to enlarge the dissimilarity between subgraph embeddings, and the pretraining loss is the combination of both edge level loss and subgraph level loss.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{con}" class="ltx_Math" display="inline" id="S4.E1.m1.1"><semantics id="S4.E1.m1.1a"><msub id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.2" xref="S4.E1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.E1.m1.1.1.3" xref="S4.E1.m1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.3.2" xref="S4.E1.m1.1.1.3.2.cmml">c</mi><mo id="S4.E1.m1.1.1.3.1" xref="S4.E1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E1.m1.1.1.3.3" xref="S4.E1.m1.1.1.3.3.cmml">o</mi><mo id="S4.E1.m1.1.1.3.1a" xref="S4.E1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E1.m1.1.1.3.4" xref="S4.E1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.2.cmml" xref="S4.E1.m1.1.1.2">ℒ</ci><apply id="S4.E1.m1.1.1.3.cmml" xref="S4.E1.m1.1.1.3"><times id="S4.E1.m1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.3.1"></times><ci id="S4.E1.m1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.3.2">𝑐</ci><ci id="S4.E1.m1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.3.3">𝑜</ci><ci id="S4.E1.m1.1.1.3.4.cmml" xref="S4.E1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\displaystyle\mathcal{L}_{con}</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_c italic_o italic_n end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\log\frac{\exp(\cos(\textbf{s}_{a},\textbf{s}_{p})/\delta)}{%
\exp(\cos(\textbf{s}_{a},\textbf{s}_{p})/\delta)+\exp(\cos(\textbf{s}_{a},%
\textbf{s}_{n})/\delta)}" class="ltx_Math" display="inline" id="S4.E1.m2.9"><semantics id="S4.E1.m2.9a"><mrow id="S4.E1.m2.9.10" xref="S4.E1.m2.9.10.cmml"><mi id="S4.E1.m2.9.10.2" xref="S4.E1.m2.9.10.2.cmml"></mi><mo id="S4.E1.m2.9.10.1" xref="S4.E1.m2.9.10.1.cmml">=</mo><mrow id="S4.E1.m2.9.10.3" xref="S4.E1.m2.9.10.3.cmml"><mo id="S4.E1.m2.9.10.3a" rspace="0.167em" xref="S4.E1.m2.9.10.3.cmml">−</mo><mrow id="S4.E1.m2.9.10.3.2" xref="S4.E1.m2.9.10.3.2.cmml"><mi id="S4.E1.m2.9.10.3.2.1" xref="S4.E1.m2.9.10.3.2.1.cmml">log</mi><mo id="S4.E1.m2.9.10.3.2a" lspace="0.167em" xref="S4.E1.m2.9.10.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S4.E1.m2.9.9" xref="S4.E1.m2.9.9.cmml"><mfrac id="S4.E1.m2.9.9a" xref="S4.E1.m2.9.9.cmml"><mrow id="S4.E1.m2.3.3.3.3" xref="S4.E1.m2.3.3.3.4.cmml"><mi id="S4.E1.m2.2.2.2.2" xref="S4.E1.m2.2.2.2.2.cmml">exp</mi><mo id="S4.E1.m2.3.3.3.3a" xref="S4.E1.m2.3.3.3.4.cmml">⁡</mo><mrow id="S4.E1.m2.3.3.3.3.1" xref="S4.E1.m2.3.3.3.4.cmml"><mo id="S4.E1.m2.3.3.3.3.1.2" stretchy="false" xref="S4.E1.m2.3.3.3.4.cmml">(</mo><mrow id="S4.E1.m2.3.3.3.3.1.1" xref="S4.E1.m2.3.3.3.3.1.1.cmml"><mrow id="S4.E1.m2.3.3.3.3.1.1.2.2" xref="S4.E1.m2.3.3.3.3.1.1.2.3.cmml"><mi id="S4.E1.m2.1.1.1.1" xref="S4.E1.m2.1.1.1.1.cmml">cos</mi><mo id="S4.E1.m2.3.3.3.3.1.1.2.2a" xref="S4.E1.m2.3.3.3.3.1.1.2.3.cmml">⁡</mo><mrow id="S4.E1.m2.3.3.3.3.1.1.2.2.2" xref="S4.E1.m2.3.3.3.3.1.1.2.3.cmml"><mo id="S4.E1.m2.3.3.3.3.1.1.2.2.2.3" stretchy="false" xref="S4.E1.m2.3.3.3.3.1.1.2.3.cmml">(</mo><msub id="S4.E1.m2.3.3.3.3.1.1.1.1.1.1" xref="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.2" xref="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.2a.cmml">s</mtext><mi id="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.3" xref="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.E1.m2.3.3.3.3.1.1.2.2.2.4" xref="S4.E1.m2.3.3.3.3.1.1.2.3.cmml">,</mo><msub id="S4.E1.m2.3.3.3.3.1.1.2.2.2.2" xref="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.2" xref="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.2a.cmml">s</mtext><mi id="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.3" xref="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.E1.m2.3.3.3.3.1.1.2.2.2.5" stretchy="false" xref="S4.E1.m2.3.3.3.3.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m2.3.3.3.3.1.1.3" xref="S4.E1.m2.3.3.3.3.1.1.3.cmml">/</mo><mi id="S4.E1.m2.3.3.3.3.1.1.4" xref="S4.E1.m2.3.3.3.3.1.1.4.cmml">δ</mi></mrow><mo id="S4.E1.m2.3.3.3.3.1.3" stretchy="false" xref="S4.E1.m2.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S4.E1.m2.9.9.9" xref="S4.E1.m2.9.9.9.cmml"><mrow id="S4.E1.m2.8.8.8.5.1" xref="S4.E1.m2.8.8.8.5.2.cmml"><mi id="S4.E1.m2.5.5.5.2" xref="S4.E1.m2.5.5.5.2.cmml">exp</mi><mo id="S4.E1.m2.8.8.8.5.1a" xref="S4.E1.m2.8.8.8.5.2.cmml">⁡</mo><mrow id="S4.E1.m2.8.8.8.5.1.1" xref="S4.E1.m2.8.8.8.5.2.cmml"><mo id="S4.E1.m2.8.8.8.5.1.1.2" stretchy="false" xref="S4.E1.m2.8.8.8.5.2.cmml">(</mo><mrow id="S4.E1.m2.8.8.8.5.1.1.1" xref="S4.E1.m2.8.8.8.5.1.1.1.cmml"><mrow id="S4.E1.m2.8.8.8.5.1.1.1.2.2" xref="S4.E1.m2.8.8.8.5.1.1.1.2.3.cmml"><mi id="S4.E1.m2.4.4.4.1" xref="S4.E1.m2.4.4.4.1.cmml">cos</mi><mo id="S4.E1.m2.8.8.8.5.1.1.1.2.2a" xref="S4.E1.m2.8.8.8.5.1.1.1.2.3.cmml">⁡</mo><mrow id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2" xref="S4.E1.m2.8.8.8.5.1.1.1.2.3.cmml"><mo id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.3" stretchy="false" xref="S4.E1.m2.8.8.8.5.1.1.1.2.3.cmml">(</mo><msub id="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1" xref="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.2" xref="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.2a.cmml">s</mtext><mi id="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.3" xref="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.4" xref="S4.E1.m2.8.8.8.5.1.1.1.2.3.cmml">,</mo><msub id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.2" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.2a.cmml">s</mtext><mi id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.3" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.5" stretchy="false" xref="S4.E1.m2.8.8.8.5.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m2.8.8.8.5.1.1.1.3" xref="S4.E1.m2.8.8.8.5.1.1.1.3.cmml">/</mo><mi id="S4.E1.m2.8.8.8.5.1.1.1.4" xref="S4.E1.m2.8.8.8.5.1.1.1.4.cmml">δ</mi></mrow><mo id="S4.E1.m2.8.8.8.5.1.1.3" stretchy="false" xref="S4.E1.m2.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="S4.E1.m2.9.9.9.7" xref="S4.E1.m2.9.9.9.7.cmml">+</mo><mrow id="S4.E1.m2.9.9.9.6.1" xref="S4.E1.m2.9.9.9.6.2.cmml"><mi id="S4.E1.m2.7.7.7.4" xref="S4.E1.m2.7.7.7.4.cmml">exp</mi><mo id="S4.E1.m2.9.9.9.6.1a" xref="S4.E1.m2.9.9.9.6.2.cmml">⁡</mo><mrow id="S4.E1.m2.9.9.9.6.1.1" xref="S4.E1.m2.9.9.9.6.2.cmml"><mo id="S4.E1.m2.9.9.9.6.1.1.2" stretchy="false" xref="S4.E1.m2.9.9.9.6.2.cmml">(</mo><mrow id="S4.E1.m2.9.9.9.6.1.1.1" xref="S4.E1.m2.9.9.9.6.1.1.1.cmml"><mrow id="S4.E1.m2.9.9.9.6.1.1.1.2.2" xref="S4.E1.m2.9.9.9.6.1.1.1.2.3.cmml"><mi id="S4.E1.m2.6.6.6.3" xref="S4.E1.m2.6.6.6.3.cmml">cos</mi><mo id="S4.E1.m2.9.9.9.6.1.1.1.2.2a" xref="S4.E1.m2.9.9.9.6.1.1.1.2.3.cmml">⁡</mo><mrow id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2" xref="S4.E1.m2.9.9.9.6.1.1.1.2.3.cmml"><mo id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.3" stretchy="false" xref="S4.E1.m2.9.9.9.6.1.1.1.2.3.cmml">(</mo><msub id="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1" xref="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.2" xref="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.2a.cmml">s</mtext><mi id="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.3" xref="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.4" xref="S4.E1.m2.9.9.9.6.1.1.1.2.3.cmml">,</mo><msub id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.2" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.2a.cmml">s</mtext><mi id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.3" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.3.cmml">n</mi></msub><mo id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.5" stretchy="false" xref="S4.E1.m2.9.9.9.6.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m2.9.9.9.6.1.1.1.3" xref="S4.E1.m2.9.9.9.6.1.1.1.3.cmml">/</mo><mi id="S4.E1.m2.9.9.9.6.1.1.1.4" xref="S4.E1.m2.9.9.9.6.1.1.1.4.cmml">δ</mi></mrow><mo id="S4.E1.m2.9.9.9.6.1.1.3" stretchy="false" xref="S4.E1.m2.9.9.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m2.9b"><apply id="S4.E1.m2.9.10.cmml" xref="S4.E1.m2.9.10"><eq id="S4.E1.m2.9.10.1.cmml" xref="S4.E1.m2.9.10.1"></eq><csymbol cd="latexml" id="S4.E1.m2.9.10.2.cmml" xref="S4.E1.m2.9.10.2">absent</csymbol><apply id="S4.E1.m2.9.10.3.cmml" xref="S4.E1.m2.9.10.3"><minus id="S4.E1.m2.9.10.3.1.cmml" xref="S4.E1.m2.9.10.3"></minus><apply id="S4.E1.m2.9.10.3.2.cmml" xref="S4.E1.m2.9.10.3.2"><log id="S4.E1.m2.9.10.3.2.1.cmml" xref="S4.E1.m2.9.10.3.2.1"></log><apply id="S4.E1.m2.9.9.cmml" xref="S4.E1.m2.9.9"><divide id="S4.E1.m2.9.9.10.cmml" xref="S4.E1.m2.9.9"></divide><apply id="S4.E1.m2.3.3.3.4.cmml" xref="S4.E1.m2.3.3.3.3"><exp id="S4.E1.m2.2.2.2.2.cmml" xref="S4.E1.m2.2.2.2.2"></exp><apply id="S4.E1.m2.3.3.3.3.1.1.cmml" xref="S4.E1.m2.3.3.3.3.1.1"><divide id="S4.E1.m2.3.3.3.3.1.1.3.cmml" xref="S4.E1.m2.3.3.3.3.1.1.3"></divide><apply id="S4.E1.m2.3.3.3.3.1.1.2.3.cmml" xref="S4.E1.m2.3.3.3.3.1.1.2.2"><cos id="S4.E1.m2.1.1.1.1.cmml" xref="S4.E1.m2.1.1.1.1"></cos><apply id="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E1.m2.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.2a.cmml" xref="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.2">s</mtext></ci><ci id="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E1.m2.3.3.3.3.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.cmml" xref="S4.E1.m2.3.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E1.m2.3.3.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.2a.cmml" xref="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.2">s</mtext></ci><ci id="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E1.m2.3.3.3.3.1.1.2.2.2.2.3">𝑝</ci></apply></apply><ci id="S4.E1.m2.3.3.3.3.1.1.4.cmml" xref="S4.E1.m2.3.3.3.3.1.1.4">𝛿</ci></apply></apply><apply id="S4.E1.m2.9.9.9.cmml" xref="S4.E1.m2.9.9.9"><plus id="S4.E1.m2.9.9.9.7.cmml" xref="S4.E1.m2.9.9.9.7"></plus><apply id="S4.E1.m2.8.8.8.5.2.cmml" xref="S4.E1.m2.8.8.8.5.1"><exp id="S4.E1.m2.5.5.5.2.cmml" xref="S4.E1.m2.5.5.5.2"></exp><apply id="S4.E1.m2.8.8.8.5.1.1.1.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1"><divide id="S4.E1.m2.8.8.8.5.1.1.1.3.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.3"></divide><apply id="S4.E1.m2.8.8.8.5.1.1.1.2.3.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2"><cos id="S4.E1.m2.4.4.4.1.cmml" xref="S4.E1.m2.4.4.4.1"></cos><apply id="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.2a.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.2">s</mtext></ci><ci id="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.1.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.2a.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.2.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.2">s</mtext></ci><ci id="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.3.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.2.2.2.2.3">𝑝</ci></apply></apply><ci id="S4.E1.m2.8.8.8.5.1.1.1.4.cmml" xref="S4.E1.m2.8.8.8.5.1.1.1.4">𝛿</ci></apply></apply><apply id="S4.E1.m2.9.9.9.6.2.cmml" xref="S4.E1.m2.9.9.9.6.1"><exp id="S4.E1.m2.7.7.7.4.cmml" xref="S4.E1.m2.7.7.7.4"></exp><apply id="S4.E1.m2.9.9.9.6.1.1.1.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1"><divide id="S4.E1.m2.9.9.9.6.1.1.1.3.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.3"></divide><apply id="S4.E1.m2.9.9.9.6.1.1.1.2.3.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2"><cos id="S4.E1.m2.6.6.6.3.cmml" xref="S4.E1.m2.6.6.6.3"></cos><apply id="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.2a.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.2">s</mtext></ci><ci id="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.1.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.2a.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.2.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.2">s</mtext></ci><ci id="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.3.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.2.2.2.2.3">𝑛</ci></apply></apply><ci id="S4.E1.m2.9.9.9.6.1.1.1.4.cmml" xref="S4.E1.m2.9.9.9.6.1.1.1.4">𝛿</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m2.9c">\displaystyle=-\log\frac{\exp(\cos(\textbf{s}_{a},\textbf{s}_{p})/\delta)}{%
\exp(\cos(\textbf{s}_{a},\textbf{s}_{p})/\delta)+\exp(\cos(\textbf{s}_{a},%
\textbf{s}_{n})/\delta)}</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m2.9d">= - roman_log divide start_ARG roman_exp ( roman_cos ( s start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , s start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) / italic_δ ) end_ARG start_ARG roman_exp ( roman_cos ( s start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , s start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) / italic_δ ) + roman_exp ( roman_cos ( s start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) / italic_δ ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}" class="ltx_Math" display="inline" id="S4.E2.m1.1"><semantics id="S4.E2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\displaystyle\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{L}_{BCE}+\mathcal{L}_{con}" class="ltx_Math" display="inline" id="S4.E2.m2.1"><semantics id="S4.E2.m2.1a"><mrow id="S4.E2.m2.1.1" xref="S4.E2.m2.1.1.cmml"><mi id="S4.E2.m2.1.1.2" xref="S4.E2.m2.1.1.2.cmml"></mi><mo id="S4.E2.m2.1.1.1" xref="S4.E2.m2.1.1.1.cmml">=</mo><mrow id="S4.E2.m2.1.1.3" xref="S4.E2.m2.1.1.3.cmml"><msub id="S4.E2.m2.1.1.3.2" xref="S4.E2.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m2.1.1.3.2.2" xref="S4.E2.m2.1.1.3.2.2.cmml">ℒ</mi><mrow id="S4.E2.m2.1.1.3.2.3" xref="S4.E2.m2.1.1.3.2.3.cmml"><mi id="S4.E2.m2.1.1.3.2.3.2" xref="S4.E2.m2.1.1.3.2.3.2.cmml">B</mi><mo id="S4.E2.m2.1.1.3.2.3.1" xref="S4.E2.m2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E2.m2.1.1.3.2.3.3" xref="S4.E2.m2.1.1.3.2.3.3.cmml">C</mi><mo id="S4.E2.m2.1.1.3.2.3.1a" xref="S4.E2.m2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E2.m2.1.1.3.2.3.4" xref="S4.E2.m2.1.1.3.2.3.4.cmml">E</mi></mrow></msub><mo id="S4.E2.m2.1.1.3.1" xref="S4.E2.m2.1.1.3.1.cmml">+</mo><msub id="S4.E2.m2.1.1.3.3" xref="S4.E2.m2.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m2.1.1.3.3.2" xref="S4.E2.m2.1.1.3.3.2.cmml">ℒ</mi><mrow id="S4.E2.m2.1.1.3.3.3" xref="S4.E2.m2.1.1.3.3.3.cmml"><mi id="S4.E2.m2.1.1.3.3.3.2" xref="S4.E2.m2.1.1.3.3.3.2.cmml">c</mi><mo id="S4.E2.m2.1.1.3.3.3.1" xref="S4.E2.m2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E2.m2.1.1.3.3.3.3" xref="S4.E2.m2.1.1.3.3.3.3.cmml">o</mi><mo id="S4.E2.m2.1.1.3.3.3.1a" xref="S4.E2.m2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E2.m2.1.1.3.3.3.4" xref="S4.E2.m2.1.1.3.3.3.4.cmml">n</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m2.1b"><apply id="S4.E2.m2.1.1.cmml" xref="S4.E2.m2.1.1"><eq id="S4.E2.m2.1.1.1.cmml" xref="S4.E2.m2.1.1.1"></eq><csymbol cd="latexml" id="S4.E2.m2.1.1.2.cmml" xref="S4.E2.m2.1.1.2">absent</csymbol><apply id="S4.E2.m2.1.1.3.cmml" xref="S4.E2.m2.1.1.3"><plus id="S4.E2.m2.1.1.3.1.cmml" xref="S4.E2.m2.1.1.3.1"></plus><apply id="S4.E2.m2.1.1.3.2.cmml" xref="S4.E2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E2.m2.1.1.3.2.1.cmml" xref="S4.E2.m2.1.1.3.2">subscript</csymbol><ci id="S4.E2.m2.1.1.3.2.2.cmml" xref="S4.E2.m2.1.1.3.2.2">ℒ</ci><apply id="S4.E2.m2.1.1.3.2.3.cmml" xref="S4.E2.m2.1.1.3.2.3"><times id="S4.E2.m2.1.1.3.2.3.1.cmml" xref="S4.E2.m2.1.1.3.2.3.1"></times><ci id="S4.E2.m2.1.1.3.2.3.2.cmml" xref="S4.E2.m2.1.1.3.2.3.2">𝐵</ci><ci id="S4.E2.m2.1.1.3.2.3.3.cmml" xref="S4.E2.m2.1.1.3.2.3.3">𝐶</ci><ci id="S4.E2.m2.1.1.3.2.3.4.cmml" xref="S4.E2.m2.1.1.3.2.3.4">𝐸</ci></apply></apply><apply id="S4.E2.m2.1.1.3.3.cmml" xref="S4.E2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.E2.m2.1.1.3.3.1.cmml" xref="S4.E2.m2.1.1.3.3">subscript</csymbol><ci id="S4.E2.m2.1.1.3.3.2.cmml" xref="S4.E2.m2.1.1.3.3.2">ℒ</ci><apply id="S4.E2.m2.1.1.3.3.3.cmml" xref="S4.E2.m2.1.1.3.3.3"><times id="S4.E2.m2.1.1.3.3.3.1.cmml" xref="S4.E2.m2.1.1.3.3.3.1"></times><ci id="S4.E2.m2.1.1.3.3.3.2.cmml" xref="S4.E2.m2.1.1.3.3.3.2">𝑐</ci><ci id="S4.E2.m2.1.1.3.3.3.3.cmml" xref="S4.E2.m2.1.1.3.3.3.3">𝑜</ci><ci id="S4.E2.m2.1.1.3.3.3.4.cmml" xref="S4.E2.m2.1.1.3.3.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m2.1c">\displaystyle=\mathcal{L}_{BCE}+\mathcal{L}_{con}</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m2.1d">= caligraphic_L start_POSTSUBSCRIPT italic_B italic_C italic_E end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_c italic_o italic_n end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS2.p3.7">where <math alttext="\textbf{s}_{a},\textbf{s}_{p},\textbf{s}_{n}\in\mathbb{R}^{d_{emb}}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p3.5.m1.3"><semantics id="S4.SS1.SSS2.p3.5.m1.3a"><mrow id="S4.SS1.SSS2.p3.5.m1.3.3" xref="S4.SS1.SSS2.p3.5.m1.3.3.cmml"><mrow id="S4.SS1.SSS2.p3.5.m1.3.3.3.3" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.4.cmml"><msub id="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1" xref="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.2" xref="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.2a.cmml">s</mtext><mi id="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.3" xref="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.4" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.4.cmml">,</mo><msub id="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2" xref="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.2" xref="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.2a.cmml">s</mtext><mi id="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.3" xref="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.5" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.4.cmml">,</mo><msub id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.2" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.2a.cmml">s</mtext><mi id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.3" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.3.cmml">n</mi></msub></mrow><mo id="S4.SS1.SSS2.p3.5.m1.3.3.4" xref="S4.SS1.SSS2.p3.5.m1.3.3.4.cmml">∈</mo><msup id="S4.SS1.SSS2.p3.5.m1.3.3.5" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.cmml"><mi id="S4.SS1.SSS2.p3.5.m1.3.3.5.2" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.2.cmml">ℝ</mi><msub id="S4.SS1.SSS2.p3.5.m1.3.3.5.3" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.cmml"><mi id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.2" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.2.cmml">d</mi><mrow id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.cmml"><mi id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.2" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.2.cmml">e</mi><mo id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.1" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.3" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.3.cmml">m</mi><mo id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.1a" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.4" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.4.cmml">b</mi></mrow></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.5.m1.3b"><apply id="S4.SS1.SSS2.p3.5.m1.3.3.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3"><in id="S4.SS1.SSS2.p3.5.m1.3.3.4.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.4"></in><list id="S4.SS1.SSS2.p3.5.m1.3.3.3.4.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3"><apply id="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.2a.cmml" xref="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.2">s</mtext></ci><ci id="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p3.5.m1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.cmml" xref="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.2a.cmml" xref="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.2">s</mtext></ci><ci id="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS2.p3.5.m1.2.2.2.2.2.3">𝑝</ci></apply><apply id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.1.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.2a.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.2.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.2">s</mtext></ci><ci id="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.3.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.3.3.3.3">𝑛</ci></apply></list><apply id="S4.SS1.SSS2.p3.5.m1.3.3.5.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.5.m1.3.3.5.1.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5">superscript</csymbol><ci id="S4.SS1.SSS2.p3.5.m1.3.3.5.2.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.2">ℝ</ci><apply id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.1.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3">subscript</csymbol><ci id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.2.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.2">𝑑</ci><apply id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3"><times id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.1.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.1"></times><ci id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.2.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.2">𝑒</ci><ci id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.3.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.3">𝑚</ci><ci id="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.4.cmml" xref="S4.SS1.SSS2.p3.5.m1.3.3.5.3.3.4">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.5.m1.3c">\textbf{s}_{a},\textbf{s}_{p},\textbf{s}_{n}\in\mathbb{R}^{d_{emb}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p3.5.m1.3d">s start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , s start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_e italic_m italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> represent the subgraph embeddings for the anchor, positive, and negative samples in the triplet. <math alttext="\cos()" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p3.6.m2.1"><semantics id="S4.SS1.SSS2.p3.6.m2.1a"><mrow id="S4.SS1.SSS2.p3.6.m2.1.1" xref="S4.SS1.SSS2.p3.6.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p3.6.m2.1.1.2" xref="S4.SS1.SSS2.p3.6.m2.1.1.2.cmml">cos</mi><mo id="S4.SS1.SSS2.p3.6.m2.1.1.1" xref="S4.SS1.SSS2.p3.6.m2.1.1.1.cmml">⁢</mo><mrow id="S4.SS1.SSS2.p3.6.m2.1.1.3.2" xref="S4.SS1.SSS2.p3.6.m2.1.1.cmml"><mo id="S4.SS1.SSS2.p3.6.m2.1.1.3.2.1" stretchy="false" xref="S4.SS1.SSS2.p3.6.m2.1.1.3.1.cmml">(</mo><mo id="S4.SS1.SSS2.p3.6.m2.1.1.3.2.2" stretchy="false" xref="S4.SS1.SSS2.p3.6.m2.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.6.m2.1b"><apply id="S4.SS1.SSS2.p3.6.m2.1.1.cmml" xref="S4.SS1.SSS2.p3.6.m2.1.1"><times id="S4.SS1.SSS2.p3.6.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p3.6.m2.1.1.1"></times><cos id="S4.SS1.SSS2.p3.6.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p3.6.m2.1.1.2"></cos><list id="S4.SS1.SSS2.p3.6.m2.1.1.3.1.cmml" xref="S4.SS1.SSS2.p3.6.m2.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.6.m2.1c">\cos()</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p3.6.m2.1d">roman_cos ( )</annotation></semantics></math> denotes the cosine similarity between two sample embeddings, and <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p3.7.m3.1"><semantics id="S4.SS1.SSS2.p3.7.m3.1a"><mi id="S4.SS1.SSS2.p3.7.m3.1.1" xref="S4.SS1.SSS2.p3.7.m3.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.7.m3.1b"><ci id="S4.SS1.SSS2.p3.7.m3.1.1.cmml" xref="S4.SS1.SSS2.p3.7.m3.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.7.m3.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p3.7.m3.1d">italic_δ</annotation></semantics></math> is a temperature parameter that controls the scale of the similarity scores.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Reprogramming-based Modality Alignment</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.5">For few-shot detection, the representations of edges should be general enough to be adapted to various anomaly types with few labeled samples. AnomalyLLM employs LLMs as the backbone to enhance the generalization ability of edge embeddings output by the dynamic-aware encoder. This is rather challenging because of the modality difference between dynamic graphs and neural languages. Thus, we propose reprogramming-based modality alignment techniques to bridge the gap. For simplicity, we omit the subscript and note the edge embedding with <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.p1.5.1">r</span>. Taking the <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.p1.5.2">r</span> as input, AnomalyLLM first reprograms it with the prototype of the word embeddings and feeds the reprogramed vector into LLMs to generate <math alttext="\textbf{h}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2a.cmml">h</mtext><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS2.p1.3.m3.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><in id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></in><ci id="S4.SS2.p1.3.m3.1.1.2a.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">h</mtext></ci><apply id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.2">ℝ</ci><ci id="S4.SS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\textbf{h}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">h ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Both <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.p1.5.3">r</span> and <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.p1.5.4">h</span> are fused as the final edge embedding to input to the LLM for anomaly detection.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span>Text Prototype Reprogramming</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.1">Although LLMs are trained with neural languages, the learned parameters contain the knowledge of almost all domains and can be viewed as a world model<cite class="ltx_cite ltx_citemacro_citep">(Hao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib13" title="">2023</a>)</cite>. To leverage the capability of LLM for dynamic graph analysis, we first select a subset of word embeddings and cluster them as text prototypes for reprogramming edge embeddings.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.2">Specifically, given the pre-trained word embeddings of LLMs, we refine a subset of words <math alttext="\textbf{W}\in\mathbb{R}^{V\times d}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.1.m1.1"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mrow id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.1.m1.1.1.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.2a.cmml">W</mtext><mo id="S4.SS2.SSS1.p2.1.m1.1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS1.p2.1.m1.1.1.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.1.m1.1.1.3.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS1.p2.1.m1.1.1.3.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.SSS1.p2.1.m1.1.1.3.3.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3.2.cmml">V</mi><mo id="S4.SS2.SSS1.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS1.p2.1.m1.1.1.3.3.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><apply id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1"><in id="S4.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1"></in><ci id="S4.SS2.SSS1.p2.1.m1.1.1.2a.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.2">W</mtext></ci><apply id="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS2.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3"><times id="S4.SS2.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS2.SSS1.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3.2">𝑉</ci><ci id="S4.SS2.SSS1.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">\textbf{W}\in\mathbb{R}^{V\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.1.m1.1d">W ∈ blackboard_R start_POSTSUPERSCRIPT italic_V × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> related to dynamic graphs to generate text prototypes. In practice, we prompt the LLM with a question, <em class="ltx_emph ltx_font_italic" id="S4.SS2.SSS1.p2.2.1">i.e.</em> <span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS1.p2.2.2">Please generate a list of words related to dynamic graphs to align dynamic graph data with natural language vocabulary</span>. The full version of this question can be found in the Appendix  <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS2" title="A.2. Detail of Prompt ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">A.2</span></a>. The output words in different rounds are combined to obtain <math alttext="V" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.2.m2.1"><semantics id="S4.SS2.SSS1.p2.2.m2.1a"><mi id="S4.SS2.SSS1.p2.2.m2.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.2.m2.1b"><ci id="S4.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.2.m2.1d">italic_V</annotation></semantics></math> related words. Based on these words, we construct the text prototype with liner transformation:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{W}^{\prime}=\textbf{M}\cdot\textbf{W}" class="ltx_Math" display="block" id="S4.Ex4.m1.1"><semantics id="S4.Ex4.m1.1a"><mrow id="S4.Ex4.m1.1.1" xref="S4.Ex4.m1.1.1.cmml"><msup id="S4.Ex4.m1.1.1.2" xref="S4.Ex4.m1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex4.m1.1.1.2.2" xref="S4.Ex4.m1.1.1.2.2a.cmml">W</mtext><mo id="S4.Ex4.m1.1.1.2.3" xref="S4.Ex4.m1.1.1.2.3.cmml">′</mo></msup><mo id="S4.Ex4.m1.1.1.1" xref="S4.Ex4.m1.1.1.1.cmml">=</mo><mrow id="S4.Ex4.m1.1.1.3" xref="S4.Ex4.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex4.m1.1.1.3.2" xref="S4.Ex4.m1.1.1.3.2a.cmml">M</mtext><mo id="S4.Ex4.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex4.m1.1.1.3.1.cmml">⋅</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex4.m1.1.1.3.3" xref="S4.Ex4.m1.1.1.3.3a.cmml">W</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.1b"><apply id="S4.Ex4.m1.1.1.cmml" xref="S4.Ex4.m1.1.1"><eq id="S4.Ex4.m1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1"></eq><apply id="S4.Ex4.m1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.2.1.cmml" xref="S4.Ex4.m1.1.1.2">superscript</csymbol><ci id="S4.Ex4.m1.1.1.2.2a.cmml" xref="S4.Ex4.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex4.m1.1.1.2.2.cmml" xref="S4.Ex4.m1.1.1.2.2">W</mtext></ci><ci id="S4.Ex4.m1.1.1.2.3.cmml" xref="S4.Ex4.m1.1.1.2.3">′</ci></apply><apply id="S4.Ex4.m1.1.1.3.cmml" xref="S4.Ex4.m1.1.1.3"><ci id="S4.Ex4.m1.1.1.3.1.cmml" xref="S4.Ex4.m1.1.1.3.1">⋅</ci><ci id="S4.Ex4.m1.1.1.3.2a.cmml" xref="S4.Ex4.m1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex4.m1.1.1.3.2.cmml" xref="S4.Ex4.m1.1.1.3.2">M</mtext></ci><ci id="S4.Ex4.m1.1.1.3.3a.cmml" xref="S4.Ex4.m1.1.1.3.3"><mtext class="ltx_mathvariant_bold" id="S4.Ex4.m1.1.1.3.3.cmml" xref="S4.Ex4.m1.1.1.3.3">W</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.1c">\textbf{W}^{\prime}=\textbf{M}\cdot\textbf{W}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m1.1d">W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = M ⋅ W</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS1.p2.12">where <math alttext="\textbf{M}\in\mathbb{R}^{V^{\prime}\times V}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.3.m1.1"><semantics id="S4.SS2.SSS1.p2.3.m1.1a"><mrow id="S4.SS2.SSS1.p2.3.m1.1.1" xref="S4.SS2.SSS1.p2.3.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.3.m1.1.1.2" xref="S4.SS2.SSS1.p2.3.m1.1.1.2a.cmml">M</mtext><mo id="S4.SS2.SSS1.p2.3.m1.1.1.1" xref="S4.SS2.SSS1.p2.3.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS1.p2.3.m1.1.1.3" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.3.m1.1.1.3.2" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS1.p2.3.m1.1.1.3.3" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.cmml"><msup id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.cmml"><mi id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.2" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.2.cmml">V</mi><mo id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.3" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.3.cmml">′</mo></msup><mo id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.3" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.3.cmml">V</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.3.m1.1b"><apply id="S4.SS2.SSS1.p2.3.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1"><in id="S4.SS2.SSS1.p2.3.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.1"></in><ci id="S4.SS2.SSS1.p2.3.m1.1.1.2a.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.3.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.2">M</mtext></ci><apply id="S4.SS2.SSS1.p2.3.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.3.m1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p2.3.m1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.2">ℝ</ci><apply id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3"><times id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.1"></times><apply id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.1.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2">superscript</csymbol><ci id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.2.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.2">𝑉</ci><ci id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.3.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.2.3">′</ci></apply><ci id="S4.SS2.SSS1.p2.3.m1.1.1.3.3.3.cmml" xref="S4.SS2.SSS1.p2.3.m1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.3.m1.1c">\textbf{M}\in\mathbb{R}^{V^{\prime}\times V}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.3.m1.1d">M ∈ blackboard_R start_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_V end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="V^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.4.m2.1"><semantics id="S4.SS2.SSS1.p2.4.m2.1a"><msup id="S4.SS2.SSS1.p2.4.m2.1.1" xref="S4.SS2.SSS1.p2.4.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p2.4.m2.1.1.2" xref="S4.SS2.SSS1.p2.4.m2.1.1.2.cmml">V</mi><mo id="S4.SS2.SSS1.p2.4.m2.1.1.3" xref="S4.SS2.SSS1.p2.4.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.4.m2.1b"><apply id="S4.SS2.SSS1.p2.4.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1.2">𝑉</ci><ci id="S4.SS2.SSS1.p2.4.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p2.4.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.4.m2.1c">V^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.4.m2.1d">italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the number of prototypes. Given an edge embedding <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS1.p2.12.1">r</span>, AnomalyLLM utilize multi-head cross-attention to conduct reprogramming. We use <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS1.p2.12.2">r</span> as the query vector and employ <math alttext="\textbf{W}^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.7.m5.1"><semantics id="S4.SS2.SSS1.p2.7.m5.1a"><msup id="S4.SS2.SSS1.p2.7.m5.1.1" xref="S4.SS2.SSS1.p2.7.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.7.m5.1.1.2" xref="S4.SS2.SSS1.p2.7.m5.1.1.2a.cmml">W</mtext><mo id="S4.SS2.SSS1.p2.7.m5.1.1.3" xref="S4.SS2.SSS1.p2.7.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.7.m5.1b"><apply id="S4.SS2.SSS1.p2.7.m5.1.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.7.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p2.7.m5.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p2.7.m5.1.1.2a.cmml" xref="S4.SS2.SSS1.p2.7.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.7.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p2.7.m5.1.1.2">W</mtext></ci><ci id="S4.SS2.SSS1.p2.7.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p2.7.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.7.m5.1c">\textbf{W}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.7.m5.1d">W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as the key and value matrices. For each attention head <math alttext="c" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.8.m6.1"><semantics id="S4.SS2.SSS1.p2.8.m6.1a"><mi id="S4.SS2.SSS1.p2.8.m6.1.1" xref="S4.SS2.SSS1.p2.8.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.8.m6.1b"><ci id="S4.SS2.SSS1.p2.8.m6.1.1.cmml" xref="S4.SS2.SSS1.p2.8.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.8.m6.1c">c</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.8.m6.1d">italic_c</annotation></semantics></math> in <math alttext="\{1,\ldots,C\}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.9.m7.3"><semantics id="S4.SS2.SSS1.p2.9.m7.3a"><mrow id="S4.SS2.SSS1.p2.9.m7.3.4.2" xref="S4.SS2.SSS1.p2.9.m7.3.4.1.cmml"><mo id="S4.SS2.SSS1.p2.9.m7.3.4.2.1" stretchy="false" xref="S4.SS2.SSS1.p2.9.m7.3.4.1.cmml">{</mo><mn id="S4.SS2.SSS1.p2.9.m7.1.1" xref="S4.SS2.SSS1.p2.9.m7.1.1.cmml">1</mn><mo id="S4.SS2.SSS1.p2.9.m7.3.4.2.2" xref="S4.SS2.SSS1.p2.9.m7.3.4.1.cmml">,</mo><mi id="S4.SS2.SSS1.p2.9.m7.2.2" mathvariant="normal" xref="S4.SS2.SSS1.p2.9.m7.2.2.cmml">…</mi><mo id="S4.SS2.SSS1.p2.9.m7.3.4.2.3" xref="S4.SS2.SSS1.p2.9.m7.3.4.1.cmml">,</mo><mi id="S4.SS2.SSS1.p2.9.m7.3.3" xref="S4.SS2.SSS1.p2.9.m7.3.3.cmml">C</mi><mo id="S4.SS2.SSS1.p2.9.m7.3.4.2.4" stretchy="false" xref="S4.SS2.SSS1.p2.9.m7.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.9.m7.3b"><set id="S4.SS2.SSS1.p2.9.m7.3.4.1.cmml" xref="S4.SS2.SSS1.p2.9.m7.3.4.2"><cn id="S4.SS2.SSS1.p2.9.m7.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p2.9.m7.1.1">1</cn><ci id="S4.SS2.SSS1.p2.9.m7.2.2.cmml" xref="S4.SS2.SSS1.p2.9.m7.2.2">…</ci><ci id="S4.SS2.SSS1.p2.9.m7.3.3.cmml" xref="S4.SS2.SSS1.p2.9.m7.3.3">𝐶</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.9.m7.3c">\{1,\ldots,C\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.9.m7.3d">{ 1 , … , italic_C }</annotation></semantics></math>, we compute the related query, key and value matrices, <em class="ltx_emph ltx_font_italic" id="S4.SS2.SSS1.p2.12.3">i.e.</em>, <math alttext="\textbf{Q}_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.10.m8.1"><semantics id="S4.SS2.SSS1.p2.10.m8.1a"><msub id="S4.SS2.SSS1.p2.10.m8.1.1" xref="S4.SS2.SSS1.p2.10.m8.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.10.m8.1.1.2" xref="S4.SS2.SSS1.p2.10.m8.1.1.2a.cmml">Q</mtext><mi id="S4.SS2.SSS1.p2.10.m8.1.1.3" xref="S4.SS2.SSS1.p2.10.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.10.m8.1b"><apply id="S4.SS2.SSS1.p2.10.m8.1.1.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.10.m8.1.1.1.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.10.m8.1.1.2a.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.10.m8.1.1.2.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1.2">Q</mtext></ci><ci id="S4.SS2.SSS1.p2.10.m8.1.1.3.cmml" xref="S4.SS2.SSS1.p2.10.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.10.m8.1c">\textbf{Q}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.10.m8.1d">Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\textbf{K}_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.11.m9.1"><semantics id="S4.SS2.SSS1.p2.11.m9.1a"><msub id="S4.SS2.SSS1.p2.11.m9.1.1" xref="S4.SS2.SSS1.p2.11.m9.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.11.m9.1.1.2" xref="S4.SS2.SSS1.p2.11.m9.1.1.2a.cmml">K</mtext><mi id="S4.SS2.SSS1.p2.11.m9.1.1.3" xref="S4.SS2.SSS1.p2.11.m9.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.11.m9.1b"><apply id="S4.SS2.SSS1.p2.11.m9.1.1.cmml" xref="S4.SS2.SSS1.p2.11.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.11.m9.1.1.1.cmml" xref="S4.SS2.SSS1.p2.11.m9.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.11.m9.1.1.2a.cmml" xref="S4.SS2.SSS1.p2.11.m9.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.11.m9.1.1.2.cmml" xref="S4.SS2.SSS1.p2.11.m9.1.1.2">K</mtext></ci><ci id="S4.SS2.SSS1.p2.11.m9.1.1.3.cmml" xref="S4.SS2.SSS1.p2.11.m9.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.11.m9.1c">\textbf{K}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.11.m9.1d">K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\textbf{V}_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.12.m10.1"><semantics id="S4.SS2.SSS1.p2.12.m10.1a"><msub id="S4.SS2.SSS1.p2.12.m10.1.1" xref="S4.SS2.SSS1.p2.12.m10.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.12.m10.1.1.2" xref="S4.SS2.SSS1.p2.12.m10.1.1.2a.cmml">V</mtext><mi id="S4.SS2.SSS1.p2.12.m10.1.1.3" xref="S4.SS2.SSS1.p2.12.m10.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.12.m10.1b"><apply id="S4.SS2.SSS1.p2.12.m10.1.1.cmml" xref="S4.SS2.SSS1.p2.12.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.12.m10.1.1.1.cmml" xref="S4.SS2.SSS1.p2.12.m10.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.12.m10.1.1.2a.cmml" xref="S4.SS2.SSS1.p2.12.m10.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p2.12.m10.1.1.2.cmml" xref="S4.SS2.SSS1.p2.12.m10.1.1.2">V</mtext></ci><ci id="S4.SS2.SSS1.p2.12.m10.1.1.3.cmml" xref="S4.SS2.SSS1.p2.12.m10.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.12.m10.1c">\textbf{V}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.12.m10.1d">V start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>. The attention operation for each head is formalized as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S4.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\textbf{z}_{c}=\text{A\scalebox{0.8}{TTENTION}}(\textbf{Q}_{c},%
\textbf{K}_{c},\textbf{V}_{c})" class="ltx_Math" display="inline" id="S4.Ex5.m1.3"><semantics id="S4.Ex5.m1.3a"><mrow id="S4.Ex5.m1.3.3" xref="S4.Ex5.m1.3.3.cmml"><msub id="S4.Ex5.m1.3.3.5" xref="S4.Ex5.m1.3.3.5.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex5.m1.3.3.5.2" xref="S4.Ex5.m1.3.3.5.2a.cmml">z</mtext><mi id="S4.Ex5.m1.3.3.5.3" xref="S4.Ex5.m1.3.3.5.3.cmml">c</mi></msub><mo id="S4.Ex5.m1.3.3.4" xref="S4.Ex5.m1.3.3.4.cmml">=</mo><mrow id="S4.Ex5.m1.3.3.3" xref="S4.Ex5.m1.3.3.3.cmml"><mrow id="S4.Ex5.m1.3.3.3.5" xref="S4.Ex5.m1.3.3.3.5e.cmml"><mtext id="S4.Ex5.m1.3.3.3.5a" xref="S4.Ex5.m1.3.3.3.5e.cmml">A</mtext><mtext id="S4.Ex5.m1.3.3.3.5b" xref="S4.Ex5.m1.3.3.3.5e.cmml">
<div class="ltx_inline-block ltx_transformed_outer" id="S4.Ex5.m1.3.3.3.5.1nest" style="width:43.9pt;height:5.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-5.5pt,0.7pt) scale(0.8,0.8) ;">
<p class="ltx_p" id="S4.Ex5.m1.3.3.3.5.1.1nest">TTENTION</p>
</span></div></mtext></mrow><mo id="S4.Ex5.m1.3.3.3.4" xref="S4.Ex5.m1.3.3.3.4.cmml">⁢</mo><mrow id="S4.Ex5.m1.3.3.3.3.3" xref="S4.Ex5.m1.3.3.3.3.4.cmml"><mo id="S4.Ex5.m1.3.3.3.3.3.4" stretchy="false" xref="S4.Ex5.m1.3.3.3.3.4.cmml">(</mo><msub id="S4.Ex5.m1.1.1.1.1.1.1" xref="S4.Ex5.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex5.m1.1.1.1.1.1.1.2" xref="S4.Ex5.m1.1.1.1.1.1.1.2a.cmml">Q</mtext><mi id="S4.Ex5.m1.1.1.1.1.1.1.3" xref="S4.Ex5.m1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S4.Ex5.m1.3.3.3.3.3.5" xref="S4.Ex5.m1.3.3.3.3.4.cmml">,</mo><msub id="S4.Ex5.m1.2.2.2.2.2.2" xref="S4.Ex5.m1.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex5.m1.2.2.2.2.2.2.2" xref="S4.Ex5.m1.2.2.2.2.2.2.2a.cmml">K</mtext><mi id="S4.Ex5.m1.2.2.2.2.2.2.3" xref="S4.Ex5.m1.2.2.2.2.2.2.3.cmml">c</mi></msub><mo id="S4.Ex5.m1.3.3.3.3.3.6" xref="S4.Ex5.m1.3.3.3.3.4.cmml">,</mo><msub id="S4.Ex5.m1.3.3.3.3.3.3" xref="S4.Ex5.m1.3.3.3.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex5.m1.3.3.3.3.3.3.2" xref="S4.Ex5.m1.3.3.3.3.3.3.2a.cmml">V</mtext><mi id="S4.Ex5.m1.3.3.3.3.3.3.3" xref="S4.Ex5.m1.3.3.3.3.3.3.3.cmml">c</mi></msub><mo id="S4.Ex5.m1.3.3.3.3.3.7" stretchy="false" xref="S4.Ex5.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex5.m1.3b"><apply id="S4.Ex5.m1.3.3.cmml" xref="S4.Ex5.m1.3.3"><eq id="S4.Ex5.m1.3.3.4.cmml" xref="S4.Ex5.m1.3.3.4"></eq><apply id="S4.Ex5.m1.3.3.5.cmml" xref="S4.Ex5.m1.3.3.5"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.5.1.cmml" xref="S4.Ex5.m1.3.3.5">subscript</csymbol><ci id="S4.Ex5.m1.3.3.5.2a.cmml" xref="S4.Ex5.m1.3.3.5.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex5.m1.3.3.5.2.cmml" xref="S4.Ex5.m1.3.3.5.2">z</mtext></ci><ci id="S4.Ex5.m1.3.3.5.3.cmml" xref="S4.Ex5.m1.3.3.5.3">𝑐</ci></apply><apply id="S4.Ex5.m1.3.3.3.cmml" xref="S4.Ex5.m1.3.3.3"><times id="S4.Ex5.m1.3.3.3.4.cmml" xref="S4.Ex5.m1.3.3.3.4"></times><ci id="S4.Ex5.m1.3.3.3.5e.cmml" xref="S4.Ex5.m1.3.3.3.5"><mrow id="S4.Ex5.m1.3.3.3.5.cmml" xref="S4.Ex5.m1.3.3.3.5"><mtext id="S4.Ex5.m1.3.3.3.5a.cmml" xref="S4.Ex5.m1.3.3.3.5">A</mtext><mtext id="S4.Ex5.m1.3.3.3.5b.cmml" xref="S4.Ex5.m1.3.3.3.5">
<div class="ltx_inline-block ltx_transformed_outer" id="S4.Ex5.m1.3.3.3.5.1anest" style="width:43.9pt;height:5.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-5.5pt,0.7pt) scale(0.8,0.8) ;">
<p class="ltx_p" id="S4.Ex5.m1.3.3.3.5.1.1anest">TTENTION</p>
</span></div></mtext></mrow></ci><vector id="S4.Ex5.m1.3.3.3.3.4.cmml" xref="S4.Ex5.m1.3.3.3.3.3"><apply id="S4.Ex5.m1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex5.m1.1.1.1.1.1.1.2a.cmml" xref="S4.Ex5.m1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex5.m1.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.1.1.1.1.1.1.2">Q</mtext></ci><ci id="S4.Ex5.m1.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.Ex5.m1.2.2.2.2.2.2.cmml" xref="S4.Ex5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.2.2.2.2.2.2.1.cmml" xref="S4.Ex5.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.Ex5.m1.2.2.2.2.2.2.2a.cmml" xref="S4.Ex5.m1.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex5.m1.2.2.2.2.2.2.2.cmml" xref="S4.Ex5.m1.2.2.2.2.2.2.2">K</mtext></ci><ci id="S4.Ex5.m1.2.2.2.2.2.2.3.cmml" xref="S4.Ex5.m1.2.2.2.2.2.2.3">𝑐</ci></apply><apply id="S4.Ex5.m1.3.3.3.3.3.3.cmml" xref="S4.Ex5.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.3.3.3.3.1.cmml" xref="S4.Ex5.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S4.Ex5.m1.3.3.3.3.3.3.2a.cmml" xref="S4.Ex5.m1.3.3.3.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex5.m1.3.3.3.3.3.3.2.cmml" xref="S4.Ex5.m1.3.3.3.3.3.3.2">V</mtext></ci><ci id="S4.Ex5.m1.3.3.3.3.3.3.3.cmml" xref="S4.Ex5.m1.3.3.3.3.3.3.3">𝑐</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex5.m1.3c">\displaystyle\textbf{z}_{c}=\text{A\scalebox{0.8}{TTENTION}}(\textbf{Q}_{c},%
\textbf{K}_{c},\textbf{V}_{c})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex5.m1.3d">z start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = A ( Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , V start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p3">
<p class="ltx_p" id="S4.SS2.SSS1.p3.5">The outputs from all heads are aggregated to obtain <math alttext="\textbf{z}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.1.m1.1"><semantics id="S4.SS2.SSS1.p3.1.m1.1a"><mrow id="S4.SS2.SSS1.p3.1.m1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p3.1.m1.1.1.2" xref="S4.SS2.SSS1.p3.1.m1.1.1.2a.cmml">z</mtext><mo id="S4.SS2.SSS1.p3.1.m1.1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS1.p3.1.m1.1.1.3" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p3.1.m1.1.1.3.2" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS2.SSS1.p3.1.m1.1.1.3.3" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.1.m1.1b"><apply id="S4.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1"><in id="S4.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.1"></in><ci id="S4.SS2.SSS1.p3.1.m1.1.1.2a.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.2">z</mtext></ci><apply id="S4.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.2">ℝ</ci><ci id="S4.SS2.SSS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.1.m1.1c">\textbf{z}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.1.m1.1d">z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. We then add <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS1.p3.5.1">z</span> to the edge embedding <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS1.p3.5.2">r</span> to obtain the reprogramed representation <math alttext="\textbf{m}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.4.m4.1"><semantics id="S4.SS2.SSS1.p3.4.m4.1a"><mrow id="S4.SS2.SSS1.p3.4.m4.1.1" xref="S4.SS2.SSS1.p3.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p3.4.m4.1.1.2" xref="S4.SS2.SSS1.p3.4.m4.1.1.2a.cmml">m</mtext><mo id="S4.SS2.SSS1.p3.4.m4.1.1.1" xref="S4.SS2.SSS1.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS1.p3.4.m4.1.1.3" xref="S4.SS2.SSS1.p3.4.m4.1.1.3.cmml"><mi id="S4.SS2.SSS1.p3.4.m4.1.1.3.2" xref="S4.SS2.SSS1.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS2.SSS1.p3.4.m4.1.1.3.3" xref="S4.SS2.SSS1.p3.4.m4.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.4.m4.1b"><apply id="S4.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1"><in id="S4.SS2.SSS1.p3.4.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.1"></in><ci id="S4.SS2.SSS1.p3.4.m4.1.1.2a.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS1.p3.4.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.2">m</mtext></ci><apply id="S4.SS2.SSS1.p3.4.m4.1.1.3.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p3.4.m4.1.1.3.2.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.3.2">ℝ</ci><ci id="S4.SS2.SSS1.p3.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.4.m4.1c">\textbf{m}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.4.m4.1d">m ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> of the given edge <math alttext="e_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.5.m5.2"><semantics id="S4.SS2.SSS1.p3.5.m5.2a"><msubsup id="S4.SS2.SSS1.p3.5.m5.2.3" xref="S4.SS2.SSS1.p3.5.m5.2.3.cmml"><mi id="S4.SS2.SSS1.p3.5.m5.2.3.2.2" xref="S4.SS2.SSS1.p3.5.m5.2.3.2.2.cmml">e</mi><mrow id="S4.SS2.SSS1.p3.5.m5.2.2.2.4" xref="S4.SS2.SSS1.p3.5.m5.2.2.2.3.cmml"><mi id="S4.SS2.SSS1.p3.5.m5.1.1.1.1" xref="S4.SS2.SSS1.p3.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.SS2.SSS1.p3.5.m5.2.2.2.4.1" xref="S4.SS2.SSS1.p3.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS1.p3.5.m5.2.2.2.2" xref="S4.SS2.SSS1.p3.5.m5.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS2.SSS1.p3.5.m5.2.3.3" xref="S4.SS2.SSS1.p3.5.m5.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.5.m5.2b"><apply id="S4.SS2.SSS1.p3.5.m5.2.3.cmml" xref="S4.SS2.SSS1.p3.5.m5.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.m5.2.3.1.cmml" xref="S4.SS2.SSS1.p3.5.m5.2.3">superscript</csymbol><apply id="S4.SS2.SSS1.p3.5.m5.2.3.2.cmml" xref="S4.SS2.SSS1.p3.5.m5.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.m5.2.3.2.1.cmml" xref="S4.SS2.SSS1.p3.5.m5.2.3">subscript</csymbol><ci id="S4.SS2.SSS1.p3.5.m5.2.3.2.2.cmml" xref="S4.SS2.SSS1.p3.5.m5.2.3.2.2">𝑒</ci><list id="S4.SS2.SSS1.p3.5.m5.2.2.2.3.cmml" xref="S4.SS2.SSS1.p3.5.m5.2.2.2.4"><ci id="S4.SS2.SSS1.p3.5.m5.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.5.m5.1.1.1.1">𝑖</ci><ci id="S4.SS2.SSS1.p3.5.m5.2.2.2.2.cmml" xref="S4.SS2.SSS1.p3.5.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS2.SSS1.p3.5.m5.2.3.3.cmml" xref="S4.SS2.SSS1.p3.5.m5.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.5.m5.2c">e_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.5.m5.2d">italic_e start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span>Pseudo Label for Anomaly Fine-tuning</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.1">In AnomalyLLM, the backbone LLM takes the reprogrammed input <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS2.p1.1.1">m</span> as input to generate the final representation vector for anomaly detection. Since the parameters of LLMs are intact, the representation of LLM may not contain the information on edge anomalies and may not suit for few-shot detection. Therefore, we utilize the randomly sampled edges (detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS1.SSS2" title="4.1.2. Contrastive Learning-based Optimization ‣ 4.1. Dynamic-aware Contrastive Pretraining ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">4.1.2</span></a>) as pseudo anomaly labels to fine-tune the parameters of the dynamic-aware encoder and anomaly detector.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<p class="ltx_p" id="S4.SS2.SSS2.p2.3">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.F4" title="Figure 4 ‣ 4.3. In-Context Learning for Few-Shot Detection ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, we design a template of prompt for both alignment fine-tuning and in-context learning detection. The template consists of four aspects: role definition, task description, examples and questions, where ¡Edge¿ is a mask token for the input edge embedding. We detail the prompt in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.SS3.SSS1" title="4.3.1. Prompt Template Construction ‣ 4.3. In-Context Learning for Few-Shot Detection ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">4.3.1</span></a>.
The instruction is fed into the LLM and the hidden state of the ¡Edge¿ token is selected as the final representation vector of edge <math alttext="e" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.1.m1.1"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><mi id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.1b"><ci id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.1c">e</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.1.m1.1d">italic_e</annotation></semantics></math>. For conciseness, we use <math alttext="v" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.2.m2.1"><semantics id="S4.SS2.SSS2.p2.2.m2.1a"><mi id="S4.SS2.SSS2.p2.2.m2.1.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m2.1b"><ci id="S4.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.2.m2.1d">italic_v</annotation></semantics></math> to represent <math alttext="v_{i,j}^{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.3.m3.2"><semantics id="S4.SS2.SSS2.p2.3.m3.2a"><msubsup id="S4.SS2.SSS2.p2.3.m3.2.3" xref="S4.SS2.SSS2.p2.3.m3.2.3.cmml"><mi id="S4.SS2.SSS2.p2.3.m3.2.3.2.2" xref="S4.SS2.SSS2.p2.3.m3.2.3.2.2.cmml">v</mi><mrow id="S4.SS2.SSS2.p2.3.m3.2.2.2.4" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.3.cmml"><mi id="S4.SS2.SSS2.p2.3.m3.1.1.1.1" xref="S4.SS2.SSS2.p2.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS2.SSS2.p2.3.m3.2.2.2.4.1" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS2.p2.3.m3.2.2.2.2" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS2.SSS2.p2.3.m3.2.3.3" xref="S4.SS2.SSS2.p2.3.m3.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.3.m3.2b"><apply id="S4.SS2.SSS2.p2.3.m3.2.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.3.m3.2.3.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3">superscript</csymbol><apply id="S4.SS2.SSS2.p2.3.m3.2.3.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.3.m3.2.3.2.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3">subscript</csymbol><ci id="S4.SS2.SSS2.p2.3.m3.2.3.2.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3.2.2">𝑣</ci><list id="S4.SS2.SSS2.p2.3.m3.2.2.2.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.4"><ci id="S4.SS2.SSS2.p2.3.m3.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.1.1">𝑖</ci><ci id="S4.SS2.SSS2.p2.3.m3.2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS2.SSS2.p2.3.m3.2.3.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.3.m3.2c">v_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.3.m3.2d">italic_v start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. This procedure can be formalized as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{H}=\textbf{LLM}([\mathbf{u},\textbf{m}])" class="ltx_Math" display="block" id="S4.Ex6.m1.3"><semantics id="S4.Ex6.m1.3a"><mrow id="S4.Ex6.m1.3.3" xref="S4.Ex6.m1.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex6.m1.3.3.3" xref="S4.Ex6.m1.3.3.3a.cmml">H</mtext><mo id="S4.Ex6.m1.3.3.2" xref="S4.Ex6.m1.3.3.2.cmml">=</mo><mrow id="S4.Ex6.m1.3.3.1" xref="S4.Ex6.m1.3.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex6.m1.3.3.1.3" xref="S4.Ex6.m1.3.3.1.3a.cmml">LLM</mtext><mo id="S4.Ex6.m1.3.3.1.2" xref="S4.Ex6.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.Ex6.m1.3.3.1.1.1" xref="S4.Ex6.m1.3.3.1.cmml"><mo id="S4.Ex6.m1.3.3.1.1.1.2" stretchy="false" xref="S4.Ex6.m1.3.3.1.cmml">(</mo><mrow id="S4.Ex6.m1.3.3.1.1.1.1.2" xref="S4.Ex6.m1.3.3.1.1.1.1.1.cmml"><mo id="S4.Ex6.m1.3.3.1.1.1.1.2.1" stretchy="false" xref="S4.Ex6.m1.3.3.1.1.1.1.1.cmml">[</mo><mi id="S4.Ex6.m1.1.1" xref="S4.Ex6.m1.1.1.cmml">𝐮</mi><mo id="S4.Ex6.m1.3.3.1.1.1.1.2.2" xref="S4.Ex6.m1.3.3.1.1.1.1.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex6.m1.2.2" xref="S4.Ex6.m1.2.2a.cmml">m</mtext><mo id="S4.Ex6.m1.3.3.1.1.1.1.2.3" stretchy="false" xref="S4.Ex6.m1.3.3.1.1.1.1.1.cmml">]</mo></mrow><mo id="S4.Ex6.m1.3.3.1.1.1.3" stretchy="false" xref="S4.Ex6.m1.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex6.m1.3b"><apply id="S4.Ex6.m1.3.3.cmml" xref="S4.Ex6.m1.3.3"><eq id="S4.Ex6.m1.3.3.2.cmml" xref="S4.Ex6.m1.3.3.2"></eq><ci id="S4.Ex6.m1.3.3.3a.cmml" xref="S4.Ex6.m1.3.3.3"><mtext class="ltx_mathvariant_bold" id="S4.Ex6.m1.3.3.3.cmml" xref="S4.Ex6.m1.3.3.3">H</mtext></ci><apply id="S4.Ex6.m1.3.3.1.cmml" xref="S4.Ex6.m1.3.3.1"><times id="S4.Ex6.m1.3.3.1.2.cmml" xref="S4.Ex6.m1.3.3.1.2"></times><ci id="S4.Ex6.m1.3.3.1.3a.cmml" xref="S4.Ex6.m1.3.3.1.3"><mtext class="ltx_mathvariant_bold" id="S4.Ex6.m1.3.3.1.3.cmml" xref="S4.Ex6.m1.3.3.1.3">LLM</mtext></ci><interval closure="closed" id="S4.Ex6.m1.3.3.1.1.1.1.1.cmml" xref="S4.Ex6.m1.3.3.1.1.1.1.2"><ci id="S4.Ex6.m1.1.1.cmml" xref="S4.Ex6.m1.1.1">𝐮</ci><ci id="S4.Ex6.m1.2.2a.cmml" xref="S4.Ex6.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex6.m1.2.2.cmml" xref="S4.Ex6.m1.2.2">m</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex6.m1.3c">\textbf{H}=\textbf{LLM}([\mathbf{u},\textbf{m}])</annotation><annotation encoding="application/x-llamapun" id="S4.Ex6.m1.3d">H = LLM ( [ bold_u , m ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p2.9">where <math alttext="\mathbf{u}\in\mathbb{R}^{L\times d}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.4.m1.1"><semantics id="S4.SS2.SSS2.p2.4.m1.1a"><mrow id="S4.SS2.SSS2.p2.4.m1.1.1" xref="S4.SS2.SSS2.p2.4.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.4.m1.1.1.2" xref="S4.SS2.SSS2.p2.4.m1.1.1.2.cmml">𝐮</mi><mo id="S4.SS2.SSS2.p2.4.m1.1.1.1" xref="S4.SS2.SSS2.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS2.p2.4.m1.1.1.3" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p2.4.m1.1.1.3.2" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS2.p2.4.m1.1.1.3.3" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.3.cmml"><mi id="S4.SS2.SSS2.p2.4.m1.1.1.3.3.2" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.3.2.cmml">L</mi><mo id="S4.SS2.SSS2.p2.4.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS2.p2.4.m1.1.1.3.3.3" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.4.m1.1b"><apply id="S4.SS2.SSS2.p2.4.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1"><in id="S4.SS2.SSS2.p2.4.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.1"></in><ci id="S4.SS2.SSS2.p2.4.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.2">𝐮</ci><apply id="S4.SS2.SSS2.p2.4.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.4.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS2.p2.4.m1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.2">ℝ</ci><apply id="S4.SS2.SSS2.p2.4.m1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.3"><times id="S4.SS2.SSS2.p2.4.m1.1.1.3.3.1.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.3.1"></times><ci id="S4.SS2.SSS2.p2.4.m1.1.1.3.3.2.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.3.2">𝐿</ci><ci id="S4.SS2.SSS2.p2.4.m1.1.1.3.3.3.cmml" xref="S4.SS2.SSS2.p2.4.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.4.m1.1c">\mathbf{u}\in\mathbb{R}^{L\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.4.m1.1d">bold_u ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the related embeddings of instruction templates and <math alttext="\textbf{H}\in\mathbb{R}^{(L+1)\times d}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.5.m2.1"><semantics id="S4.SS2.SSS2.p2.5.m2.1a"><mrow id="S4.SS2.SSS2.p2.5.m2.1.2" xref="S4.SS2.SSS2.p2.5.m2.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS2.p2.5.m2.1.2.2" xref="S4.SS2.SSS2.p2.5.m2.1.2.2a.cmml">H</mtext><mo id="S4.SS2.SSS2.p2.5.m2.1.2.1" xref="S4.SS2.SSS2.p2.5.m2.1.2.1.cmml">∈</mo><msup id="S4.SS2.SSS2.p2.5.m2.1.2.3" xref="S4.SS2.SSS2.p2.5.m2.1.2.3.cmml"><mi id="S4.SS2.SSS2.p2.5.m2.1.2.3.2" xref="S4.SS2.SSS2.p2.5.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS2.p2.5.m2.1.1.1" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.cmml"><mrow id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.2.cmml">L</mi><mo id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS2.p2.5.m2.1.1.1.2" rspace="0.222em" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.2.cmml">×</mo><mi id="S4.SS2.SSS2.p2.5.m2.1.1.1.3" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.5.m2.1b"><apply id="S4.SS2.SSS2.p2.5.m2.1.2.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.2"><in id="S4.SS2.SSS2.p2.5.m2.1.2.1.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.2.1"></in><ci id="S4.SS2.SSS2.p2.5.m2.1.2.2a.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS2.p2.5.m2.1.2.2.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.2.2">H</mtext></ci><apply id="S4.SS2.SSS2.p2.5.m2.1.2.3.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.5.m2.1.2.3.1.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.2.3">superscript</csymbol><ci id="S4.SS2.SSS2.p2.5.m2.1.2.3.2.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.2.3.2">ℝ</ci><apply id="S4.SS2.SSS2.p2.5.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.1.1"><times id="S4.SS2.SSS2.p2.5.m2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.2"></times><apply id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1"><plus id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.1"></plus><ci id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.2">𝐿</ci><cn id="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.1.1.1.3">1</cn></apply><ci id="S4.SS2.SSS2.p2.5.m2.1.1.1.3.cmml" xref="S4.SS2.SSS2.p2.5.m2.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.5.m2.1c">\textbf{H}\in\mathbb{R}^{(L+1)\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.5.m2.1d">H ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_L + 1 ) × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the last hidden layer output of the LLM. We utilize the last position of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS2.p2.9.1">H</span>, <em class="ltx_emph ltx_font_italic" id="S4.SS2.SSS2.p2.9.2">i.e.</em> <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS2.p2.9.3">h</span> for detection. Note that our backbone LLM employs causal attention to compute <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS2.p2.9.4">h</span>. Thus, for different edges, the front parts of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS2.p2.9.5">h</span> are the same. We can use this character to further reduce the computation workload in the pre-training procedure.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p3">
<p class="ltx_p" id="S4.SS2.SSS2.p3.5">As described in Section <span class="ltx_ref ltx_nolink ltx_ref_self"><span class="ltx_text ltx_ref_tag">4.1.2</span></span>, an MLP layer is employed to detect the randomly selected anomalies and output an anomaly score for input edge embedding. In this module, we reuse the MLP detector and replace the input edge embedding <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS2.p3.5.1">r</span> with the reprogramed edge embedding <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.SSS2.p3.5.2">r</span>. The anomaly score for an edge <math alttext="e" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.3.m3.1"><semantics id="S4.SS2.SSS2.p3.3.m3.1a"><mi id="S4.SS2.SSS2.p3.3.m3.1.1" xref="S4.SS2.SSS2.p3.3.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.3.m3.1b"><ci id="S4.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.3.m3.1c">e</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.3.m3.1d">italic_e</annotation></semantics></math> is computed with <math alttext="f(e)=\rm MLP(\textbf{h})" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.4.m4.2"><semantics id="S4.SS2.SSS2.p3.4.m4.2a"><mrow id="S4.SS2.SSS2.p3.4.m4.2.3" xref="S4.SS2.SSS2.p3.4.m4.2.3.cmml"><mrow id="S4.SS2.SSS2.p3.4.m4.2.3.2" xref="S4.SS2.SSS2.p3.4.m4.2.3.2.cmml"><mi id="S4.SS2.SSS2.p3.4.m4.2.3.2.2" xref="S4.SS2.SSS2.p3.4.m4.2.3.2.2.cmml">f</mi><mo id="S4.SS2.SSS2.p3.4.m4.2.3.2.1" xref="S4.SS2.SSS2.p3.4.m4.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p3.4.m4.2.3.2.3.2" xref="S4.SS2.SSS2.p3.4.m4.2.3.2.cmml"><mo id="S4.SS2.SSS2.p3.4.m4.2.3.2.3.2.1" stretchy="false" xref="S4.SS2.SSS2.p3.4.m4.2.3.2.cmml">(</mo><mi id="S4.SS2.SSS2.p3.4.m4.1.1" xref="S4.SS2.SSS2.p3.4.m4.1.1.cmml">e</mi><mo id="S4.SS2.SSS2.p3.4.m4.2.3.2.3.2.2" stretchy="false" xref="S4.SS2.SSS2.p3.4.m4.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS2.p3.4.m4.2.3.1" xref="S4.SS2.SSS2.p3.4.m4.2.3.1.cmml">=</mo><mrow id="S4.SS2.SSS2.p3.4.m4.2.3.3" xref="S4.SS2.SSS2.p3.4.m4.2.3.3.cmml"><mi id="S4.SS2.SSS2.p3.4.m4.2.3.3.2" xref="S4.SS2.SSS2.p3.4.m4.2.3.3.2.cmml">MLP</mi><mo id="S4.SS2.SSS2.p3.4.m4.2.3.3.1" xref="S4.SS2.SSS2.p3.4.m4.2.3.3.1.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p3.4.m4.2.3.3.3.2" xref="S4.SS2.SSS2.p3.4.m4.2.2a.cmml"><mo id="S4.SS2.SSS2.p3.4.m4.2.3.3.3.2.1" stretchy="false" xref="S4.SS2.SSS2.p3.4.m4.2.2a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS2.p3.4.m4.2.2" xref="S4.SS2.SSS2.p3.4.m4.2.2.cmml">h</mtext><mo id="S4.SS2.SSS2.p3.4.m4.2.3.3.3.2.2" stretchy="false" xref="S4.SS2.SSS2.p3.4.m4.2.2a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.4.m4.2b"><apply id="S4.SS2.SSS2.p3.4.m4.2.3.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3"><eq id="S4.SS2.SSS2.p3.4.m4.2.3.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3.1"></eq><apply id="S4.SS2.SSS2.p3.4.m4.2.3.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3.2"><times id="S4.SS2.SSS2.p3.4.m4.2.3.2.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3.2.1"></times><ci id="S4.SS2.SSS2.p3.4.m4.2.3.2.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3.2.2">𝑓</ci><ci id="S4.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.1.1">𝑒</ci></apply><apply id="S4.SS2.SSS2.p3.4.m4.2.3.3.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3.3"><times id="S4.SS2.SSS2.p3.4.m4.2.3.3.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3.3.1"></times><ci id="S4.SS2.SSS2.p3.4.m4.2.3.3.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3.3.2">MLP</ci><ci id="S4.SS2.SSS2.p3.4.m4.2.2a.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.SSS2.p3.4.m4.2.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2">h</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.4.m4.2c">f(e)=\rm MLP(\textbf{h})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.4.m4.2d">italic_f ( italic_e ) = roman_MLP ( h )</annotation></semantics></math>. We also used the randomly selected edges as negative samples and the existing edges as positive samples to construct pseudo labels. A binary cross-entropy (BCE) loss of pseudo labels is employed to optimize the parameters of the dynamic-aware encoder and the detector. <math alttext="\mathcal{L}_{BCE}=-\log(1-f(e))+\log(f(e))" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.5.m5.6"><semantics id="S4.SS2.SSS2.p3.5.m5.6a"><mrow id="S4.SS2.SSS2.p3.5.m5.6.6" xref="S4.SS2.SSS2.p3.5.m5.6.6.cmml"><msub id="S4.SS2.SSS2.p3.5.m5.6.6.4" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.5.m5.6.6.4.2" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.2.cmml">ℒ</mi><mrow id="S4.SS2.SSS2.p3.5.m5.6.6.4.3" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.cmml"><mi id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.2" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.2.cmml">B</mi><mo id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.1" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.3" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.3.cmml">C</mi><mo id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.1a" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.4" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.4.cmml">E</mi></mrow></msub><mo id="S4.SS2.SSS2.p3.5.m5.6.6.3" xref="S4.SS2.SSS2.p3.5.m5.6.6.3.cmml">=</mo><mrow id="S4.SS2.SSS2.p3.5.m5.6.6.2" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.cmml"><mrow id="S4.SS2.SSS2.p3.5.m5.5.5.1.1" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.cmml"><mo id="S4.SS2.SSS2.p3.5.m5.5.5.1.1a" rspace="0.167em" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.cmml">−</mo><mrow id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.2.cmml"><mi id="S4.SS2.SSS2.p3.5.m5.2.2" xref="S4.SS2.SSS2.p3.5.m5.2.2.cmml">log</mi><mo id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1a" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.2.cmml"><mo id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.2.cmml">(</mo><mrow id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.cmml"><mn id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.2" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.2.cmml">f</mi><mo id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.1" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.3.2" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.cmml"><mo id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.SS2.SSS2.p3.5.m5.1.1" xref="S4.SS2.SSS2.p3.5.m5.1.1.cmml">e</mi><mo id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS2.SSS2.p3.5.m5.6.6.2.3" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.3.cmml">+</mo><mrow id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.2.cmml"><mi id="S4.SS2.SSS2.p3.5.m5.4.4" xref="S4.SS2.SSS2.p3.5.m5.4.4.cmml">log</mi><mo id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1a" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.2.cmml">⁡</mo><mrow id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.2.cmml"><mo id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.2.cmml">(</mo><mrow id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.2" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.2.cmml">f</mi><mo id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.1" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.3.2" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.cmml"><mo id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.cmml">(</mo><mi id="S4.SS2.SSS2.p3.5.m5.3.3" xref="S4.SS2.SSS2.p3.5.m5.3.3.cmml">e</mi><mo id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.3" stretchy="false" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.5.m5.6b"><apply id="S4.SS2.SSS2.p3.5.m5.6.6.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6"><eq id="S4.SS2.SSS2.p3.5.m5.6.6.3.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.3"></eq><apply id="S4.SS2.SSS2.p3.5.m5.6.6.4.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.4"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.5.m5.6.6.4.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.4">subscript</csymbol><ci id="S4.SS2.SSS2.p3.5.m5.6.6.4.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.2">ℒ</ci><apply id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3"><times id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.1"></times><ci id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.2">𝐵</ci><ci id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.3.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.3">𝐶</ci><ci id="S4.SS2.SSS2.p3.5.m5.6.6.4.3.4.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.4.3.4">𝐸</ci></apply></apply><apply id="S4.SS2.SSS2.p3.5.m5.6.6.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.2"><plus id="S4.SS2.SSS2.p3.5.m5.6.6.2.3.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.3"></plus><apply id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1"><minus id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1"></minus><apply id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1"><log id="S4.SS2.SSS2.p3.5.m5.2.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.2.2"></log><apply id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1"><minus id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.1"></minus><cn id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.2">1</cn><apply id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3"><times id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.1"></times><ci id="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.5.5.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S4.SS2.SSS2.p3.5.m5.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.1.1">𝑒</ci></apply></apply></apply></apply><apply id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1"><log id="S4.SS2.SSS2.p3.5.m5.4.4.cmml" xref="S4.SS2.SSS2.p3.5.m5.4.4"></log><apply id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1"><times id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.1"></times><ci id="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.6.6.2.2.1.1.1.2">𝑓</ci><ci id="S4.SS2.SSS2.p3.5.m5.3.3.cmml" xref="S4.SS2.SSS2.p3.5.m5.3.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.5.m5.6c">\mathcal{L}_{BCE}=-\log(1-f(e))+\log(f(e))</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.5.m5.6d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_C italic_E end_POSTSUBSCRIPT = - roman_log ( 1 - italic_f ( italic_e ) ) + roman_log ( italic_f ( italic_e ) )</annotation></semantics></math>
Note that the MLP detector is optimized in both pre-training and alignment fine-tuning. In few-shot anomaly detection, the MLP detector cooperates with the in-context learning strategy to detect various types of anomalies. During the whole procedure, the parameters of LLM are intact.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>In-Context Learning for Few-Shot Detection</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.6">Given a set of anomaly edges <math alttext="\mathcal{E}_{\mathcal{T}}=\{\mathcal{T}_{1},\cdots,\mathcal{T}_{a}\}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.3"><semantics id="S4.SS3.p1.1.m1.3a"><mrow id="S4.SS3.p1.1.m1.3.3" xref="S4.SS3.p1.1.m1.3.3.cmml"><msub id="S4.SS3.p1.1.m1.3.3.4" xref="S4.SS3.p1.1.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.1.m1.3.3.4.2" xref="S4.SS3.p1.1.m1.3.3.4.2.cmml">ℰ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.1.m1.3.3.4.3" xref="S4.SS3.p1.1.m1.3.3.4.3.cmml">𝒯</mi></msub><mo id="S4.SS3.p1.1.m1.3.3.3" xref="S4.SS3.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S4.SS3.p1.1.m1.3.3.2.2" xref="S4.SS3.p1.1.m1.3.3.2.3.cmml"><mo id="S4.SS3.p1.1.m1.3.3.2.2.3" stretchy="false" xref="S4.SS3.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="S4.SS3.p1.1.m1.2.2.1.1.1" xref="S4.SS3.p1.1.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.1.m1.2.2.1.1.1.2" xref="S4.SS3.p1.1.m1.2.2.1.1.1.2.cmml">𝒯</mi><mn id="S4.SS3.p1.1.m1.2.2.1.1.1.3" xref="S4.SS3.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p1.1.m1.3.3.2.2.4" xref="S4.SS3.p1.1.m1.3.3.2.3.cmml">,</mo><mi id="S4.SS3.p1.1.m1.1.1" mathvariant="normal" xref="S4.SS3.p1.1.m1.1.1.cmml">⋯</mi><mo id="S4.SS3.p1.1.m1.3.3.2.2.5" xref="S4.SS3.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S4.SS3.p1.1.m1.3.3.2.2.2" xref="S4.SS3.p1.1.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.1.m1.3.3.2.2.2.2" xref="S4.SS3.p1.1.m1.3.3.2.2.2.2.cmml">𝒯</mi><mi id="S4.SS3.p1.1.m1.3.3.2.2.2.3" xref="S4.SS3.p1.1.m1.3.3.2.2.2.3.cmml">a</mi></msub><mo id="S4.SS3.p1.1.m1.3.3.2.2.6" stretchy="false" xref="S4.SS3.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.3b"><apply id="S4.SS3.p1.1.m1.3.3.cmml" xref="S4.SS3.p1.1.m1.3.3"><eq id="S4.SS3.p1.1.m1.3.3.3.cmml" xref="S4.SS3.p1.1.m1.3.3.3"></eq><apply id="S4.SS3.p1.1.m1.3.3.4.cmml" xref="S4.SS3.p1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.3.3.4.1.cmml" xref="S4.SS3.p1.1.m1.3.3.4">subscript</csymbol><ci id="S4.SS3.p1.1.m1.3.3.4.2.cmml" xref="S4.SS3.p1.1.m1.3.3.4.2">ℰ</ci><ci id="S4.SS3.p1.1.m1.3.3.4.3.cmml" xref="S4.SS3.p1.1.m1.3.3.4.3">𝒯</ci></apply><set id="S4.SS3.p1.1.m1.3.3.2.3.cmml" xref="S4.SS3.p1.1.m1.3.3.2.2"><apply id="S4.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1.1.2">𝒯</ci><cn id="S4.SS3.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">⋯</ci><apply id="S4.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S4.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS3.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS3.p1.1.m1.3.3.2.2.2.2">𝒯</ci><ci id="S4.SS3.p1.1.m1.3.3.2.2.2.3.cmml" xref="S4.SS3.p1.1.m1.3.3.2.2.2.3">𝑎</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.3c">\mathcal{E}_{\mathcal{T}}=\{\mathcal{T}_{1},\cdots,\mathcal{T}_{a}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.3d">caligraphic_E start_POSTSUBSCRIPT caligraphic_T end_POSTSUBSCRIPT = { caligraphic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , caligraphic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT }</annotation></semantics></math> of anomaly type <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">caligraphic_T</annotation></semantics></math>, AnomalyLLM aim to detect whether the new edge <math alttext="e" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">e</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_e</annotation></semantics></math> is an anomaly edge of <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">caligraphic_T</annotation></semantics></math> or not. Considering that the pretraining procedure of AnomalyLLM has no information about the anomaly type, we need to make full use of the labeled information of <math alttext="\mathcal{E}_{\mathcal{T}}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><msub id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">ℰ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">𝒯</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">ℰ</ci><ci id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\mathcal{E}_{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">caligraphic_E start_POSTSUBSCRIPT caligraphic_T end_POSTSUBSCRIPT</annotation></semantics></math>. In this paper, we proposed to use in-context learning that encodes edges in <math alttext="\mathcal{E}_{\mathcal{T}}" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m6.1"><semantics id="S4.SS3.p1.6.m6.1a"><msub id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.6.m6.1.1.2" xref="S4.SS3.p1.6.m6.1.1.2.cmml">ℰ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml">𝒯</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">ℰ</ci><ci id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">\mathcal{E}_{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m6.1d">caligraphic_E start_POSTSUBSCRIPT caligraphic_T end_POSTSUBSCRIPT</annotation></semantics></math>. Next, we introduce the construction of the prompt template and few-shot anomaly detection respectively.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="192" id="S4.F4.g1" src="x4.png" width="407"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>The prompt of In-Context Learning</figcaption>
</figure>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1. </span>Prompt Template Construction</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">The ability of LLMs on downstream tasks can be unleashed by in-context learning which learns from the context provided by a prompt without any additional external data or explicit retraining. Thus, how to construct the prompt template is a critical problem. In AnomalyLLM, we argue that the prompt should contain the information of four aspects: role definition, task description, examples and question.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.5">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S4.F4" title="Figure 4 ‣ 4.3. In-Context Learning for Few-Shot Detection ‣ 4. Methodology ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, the prompt first defines the role of LLM as a few-shot anomaly detector followed by the description of anomaly type <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.1.m1.1"><semantics id="S4.SS3.SSS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.1.m1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.1.m1.1b"><ci id="S4.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.1.m1.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.1.m1.1d">caligraphic_T</annotation></semantics></math>. For the example part, we select the same number of edges <math alttext="\mathcal{E}^{\prime}/\mathcal{E}_{\mathcal{T}}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.2.m2.1"><semantics id="S4.SS3.SSS1.p2.2.m2.1a"><mrow id="S4.SS3.SSS1.p2.2.m2.1.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.cmml"><msup id="S4.SS3.SSS1.p2.2.m2.1.1.2" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.2.m2.1.1.2.2" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.2.cmml">ℰ</mi><mo id="S4.SS3.SSS1.p2.2.m2.1.1.2.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3.cmml">′</mo></msup><mo id="S4.SS3.SSS1.p2.2.m2.1.1.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.1.cmml">/</mo><msubsup id="S4.SS3.SSS1.p2.2.m2.1.1.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.2.m2.1.1.3.2.2" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.2.2.cmml">ℰ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.2.m2.1.1.3.2.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.2.3.cmml">𝒯</mi><msup id="S4.SS3.SSS1.p2.2.m2.1.1.3.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS3.SSS1.p2.2.m2.1.1.3.3a" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.3.cmml"></mi><mo id="S4.SS3.SSS1.p2.2.m2.1.1.3.3.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.3.1.cmml">′</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.2.m2.1b"><apply id="S4.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1"><divide id="S4.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.1"></divide><apply id="S4.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS3.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.2">ℰ</ci><ci id="S4.SS3.SSS1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3">′</ci></apply><apply id="S4.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3">superscript</csymbol><apply id="S4.SS3.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.2.m2.1.1.3.2.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS1.p2.2.m2.1.1.3.2.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.2.2">ℰ</ci><ci id="S4.SS3.SSS1.p2.2.m2.1.1.3.2.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.2.3">𝒯</ci></apply><apply id="S4.SS3.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.3"><ci id="S4.SS3.SSS1.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.3.1">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.2.m2.1c">\mathcal{E}^{\prime}/\mathcal{E}_{\mathcal{T}}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.2.m2.1d">caligraphic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT / caligraphic_E start_POSTSUBSCRIPT caligraphic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="\mathcal{E}/\mathcal{E}_{\mathcal{T}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.3.m3.1"><semantics id="S4.SS3.SSS1.p2.3.m3.1a"><mrow id="S4.SS3.SSS1.p2.3.m3.1.1" xref="S4.SS3.SSS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.3.m3.1.1.2" xref="S4.SS3.SSS1.p2.3.m3.1.1.2.cmml">ℰ</mi><mo id="S4.SS3.SSS1.p2.3.m3.1.1.1" xref="S4.SS3.SSS1.p2.3.m3.1.1.1.cmml">/</mo><msub id="S4.SS3.SSS1.p2.3.m3.1.1.3" xref="S4.SS3.SSS1.p2.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.3.m3.1.1.3.2" xref="S4.SS3.SSS1.p2.3.m3.1.1.3.2.cmml">ℰ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.3.m3.1.1.3.3" xref="S4.SS3.SSS1.p2.3.m3.1.1.3.3.cmml">𝒯</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.3.m3.1b"><apply id="S4.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1"><divide id="S4.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1.1"></divide><ci id="S4.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1.2">ℰ</ci><apply id="S4.SS3.SSS1.p2.3.m3.1.1.3.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1.3.2">ℰ</ci><ci id="S4.SS3.SSS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1.3.3">𝒯</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.3.m3.1c">\mathcal{E}/\mathcal{E}_{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.3.m3.1d">caligraphic_E / caligraphic_E start_POSTSUBSCRIPT caligraphic_T end_POSTSUBSCRIPT</annotation></semantics></math> as the normal and anomaly samples and generate the embedding of edges in <math alttext="\mathcal{E}^{\prime}\cup\mathcal{E}^{{}^{\prime}}_{\mathcal{T}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.4.m4.1"><semantics id="S4.SS3.SSS1.p2.4.m4.1a"><mrow id="S4.SS3.SSS1.p2.4.m4.1.1" xref="S4.SS3.SSS1.p2.4.m4.1.1.cmml"><msup id="S4.SS3.SSS1.p2.4.m4.1.1.2" xref="S4.SS3.SSS1.p2.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.4.m4.1.1.2.2" xref="S4.SS3.SSS1.p2.4.m4.1.1.2.2.cmml">ℰ</mi><mo id="S4.SS3.SSS1.p2.4.m4.1.1.2.3" xref="S4.SS3.SSS1.p2.4.m4.1.1.2.3.cmml">′</mo></msup><mo id="S4.SS3.SSS1.p2.4.m4.1.1.1" xref="S4.SS3.SSS1.p2.4.m4.1.1.1.cmml">∪</mo><msubsup id="S4.SS3.SSS1.p2.4.m4.1.1.3" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.2" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.2.2.cmml">ℰ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p2.4.m4.1.1.3.3" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.3.cmml">𝒯</mi><msup id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3.cmml"><mi id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3a" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3.cmml"></mi><mo id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3.1" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3.1.cmml">′</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.4.m4.1b"><apply id="S4.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1"><union id="S4.SS3.SSS1.p2.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.1"></union><apply id="S4.SS3.SSS1.p2.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.4.m4.1.1.2.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.2">superscript</csymbol><ci id="S4.SS3.SSS1.p2.4.m4.1.1.2.2.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.2.2">ℰ</ci><ci id="S4.SS3.SSS1.p2.4.m4.1.1.2.3.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.2.3">′</ci></apply><apply id="S4.SS3.SSS1.p2.4.m4.1.1.3.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3">subscript</csymbol><apply id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.2.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.2.2">ℰ</ci><apply id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3"><ci id="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.2.3.1">′</ci></apply></apply><ci id="S4.SS3.SSS1.p2.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.3">𝒯</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.4.m4.1c">\mathcal{E}^{\prime}\cup\mathcal{E}^{{}^{\prime}}_{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.4.m4.1d">caligraphic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∪ caligraphic_E start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_T end_POSTSUBSCRIPT</annotation></semantics></math> with dynamic-aware encoder denoted by <math alttext="\textbf{M}^{ICL}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.5.m5.1"><semantics id="S4.SS3.SSS1.p2.5.m5.1a"><msup id="S4.SS3.SSS1.p2.5.m5.1.1" xref="S4.SS3.SSS1.p2.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS1.p2.5.m5.1.1.2" xref="S4.SS3.SSS1.p2.5.m5.1.1.2a.cmml">M</mtext><mrow id="S4.SS3.SSS1.p2.5.m5.1.1.3" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.cmml"><mi id="S4.SS3.SSS1.p2.5.m5.1.1.3.2" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.2.cmml">I</mi><mo id="S4.SS3.SSS1.p2.5.m5.1.1.3.1" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.5.m5.1.1.3.3" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.3.cmml">C</mi><mo id="S4.SS3.SSS1.p2.5.m5.1.1.3.1a" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.5.m5.1.1.3.4" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.4.cmml">L</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.5.m5.1b"><apply id="S4.SS3.SSS1.p2.5.m5.1.1.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.5.m5.1.1.1.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p2.5.m5.1.1.2a.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS1.p2.5.m5.1.1.2.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.2">M</mtext></ci><apply id="S4.SS3.SSS1.p2.5.m5.1.1.3.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.3"><times id="S4.SS3.SSS1.p2.5.m5.1.1.3.1.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.1"></times><ci id="S4.SS3.SSS1.p2.5.m5.1.1.3.2.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.2">𝐼</ci><ci id="S4.SS3.SSS1.p2.5.m5.1.1.3.3.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.3">𝐶</ci><ci id="S4.SS3.SSS1.p2.5.m5.1.1.3.4.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.5.m5.1c">\textbf{M}^{ICL}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.5.m5.1d">M start_POSTSUPERSCRIPT italic_I italic_C italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>. These edges are then processed through the reprogramming module for modality alignment and to build the prompt examples.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S4.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\textbf{M}^{ICL}" class="ltx_Math" display="inline" id="S4.Ex7.m1.1"><semantics id="S4.Ex7.m1.1a"><msup id="S4.Ex7.m1.1.1" xref="S4.Ex7.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m1.1.1.2" xref="S4.Ex7.m1.1.1.2a.cmml">M</mtext><mrow id="S4.Ex7.m1.1.1.3" xref="S4.Ex7.m1.1.1.3.cmml"><mi id="S4.Ex7.m1.1.1.3.2" xref="S4.Ex7.m1.1.1.3.2.cmml">I</mi><mo id="S4.Ex7.m1.1.1.3.1" xref="S4.Ex7.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.Ex7.m1.1.1.3.3" xref="S4.Ex7.m1.1.1.3.3.cmml">C</mi><mo id="S4.Ex7.m1.1.1.3.1a" xref="S4.Ex7.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.Ex7.m1.1.1.3.4" xref="S4.Ex7.m1.1.1.3.4.cmml">L</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.Ex7.m1.1b"><apply id="S4.Ex7.m1.1.1.cmml" xref="S4.Ex7.m1.1.1"><csymbol cd="ambiguous" id="S4.Ex7.m1.1.1.1.cmml" xref="S4.Ex7.m1.1.1">superscript</csymbol><ci id="S4.Ex7.m1.1.1.2a.cmml" xref="S4.Ex7.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m1.1.1.2.cmml" xref="S4.Ex7.m1.1.1.2">M</mtext></ci><apply id="S4.Ex7.m1.1.1.3.cmml" xref="S4.Ex7.m1.1.1.3"><times id="S4.Ex7.m1.1.1.3.1.cmml" xref="S4.Ex7.m1.1.1.3.1"></times><ci id="S4.Ex7.m1.1.1.3.2.cmml" xref="S4.Ex7.m1.1.1.3.2">𝐼</ci><ci id="S4.Ex7.m1.1.1.3.3.cmml" xref="S4.Ex7.m1.1.1.3.3">𝐶</ci><ci id="S4.Ex7.m1.1.1.3.4.cmml" xref="S4.Ex7.m1.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex7.m1.1c">\displaystyle\textbf{M}^{ICL}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex7.m1.1d">M start_POSTSUPERSCRIPT italic_I italic_C italic_L end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\{\textbf{m}^{pos}_{1},\ldots,\textbf{m}^{pos}_{n},\textbf{m}^{%
neg}_{1},\ldots,\textbf{m}^{neg}_{P},\textbf{m}^{new}\}" class="ltx_Math" display="inline" id="S4.Ex7.m2.7"><semantics id="S4.Ex7.m2.7a"><mrow id="S4.Ex7.m2.7.7" xref="S4.Ex7.m2.7.7.cmml"><mi id="S4.Ex7.m2.7.7.7" xref="S4.Ex7.m2.7.7.7.cmml"></mi><mo id="S4.Ex7.m2.7.7.6" xref="S4.Ex7.m2.7.7.6.cmml">=</mo><mrow id="S4.Ex7.m2.7.7.5.5" xref="S4.Ex7.m2.7.7.5.6.cmml"><mo id="S4.Ex7.m2.7.7.5.5.6" stretchy="false" xref="S4.Ex7.m2.7.7.5.6.cmml">{</mo><msubsup id="S4.Ex7.m2.3.3.1.1.1" xref="S4.Ex7.m2.3.3.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.3.3.1.1.1.2.2" xref="S4.Ex7.m2.3.3.1.1.1.2.2a.cmml">m</mtext><mn id="S4.Ex7.m2.3.3.1.1.1.3" xref="S4.Ex7.m2.3.3.1.1.1.3.cmml">1</mn><mrow id="S4.Ex7.m2.3.3.1.1.1.2.3" xref="S4.Ex7.m2.3.3.1.1.1.2.3.cmml"><mi id="S4.Ex7.m2.3.3.1.1.1.2.3.2" xref="S4.Ex7.m2.3.3.1.1.1.2.3.2.cmml">p</mi><mo id="S4.Ex7.m2.3.3.1.1.1.2.3.1" xref="S4.Ex7.m2.3.3.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.3.3.1.1.1.2.3.3" xref="S4.Ex7.m2.3.3.1.1.1.2.3.3.cmml">o</mi><mo id="S4.Ex7.m2.3.3.1.1.1.2.3.1a" xref="S4.Ex7.m2.3.3.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.3.3.1.1.1.2.3.4" xref="S4.Ex7.m2.3.3.1.1.1.2.3.4.cmml">s</mi></mrow></msubsup><mo id="S4.Ex7.m2.7.7.5.5.7" xref="S4.Ex7.m2.7.7.5.6.cmml">,</mo><mi id="S4.Ex7.m2.1.1" mathvariant="normal" xref="S4.Ex7.m2.1.1.cmml">…</mi><mo id="S4.Ex7.m2.7.7.5.5.8" xref="S4.Ex7.m2.7.7.5.6.cmml">,</mo><msubsup id="S4.Ex7.m2.4.4.2.2.2" xref="S4.Ex7.m2.4.4.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.4.4.2.2.2.2.2" xref="S4.Ex7.m2.4.4.2.2.2.2.2a.cmml">m</mtext><mi id="S4.Ex7.m2.4.4.2.2.2.3" xref="S4.Ex7.m2.4.4.2.2.2.3.cmml">n</mi><mrow id="S4.Ex7.m2.4.4.2.2.2.2.3" xref="S4.Ex7.m2.4.4.2.2.2.2.3.cmml"><mi id="S4.Ex7.m2.4.4.2.2.2.2.3.2" xref="S4.Ex7.m2.4.4.2.2.2.2.3.2.cmml">p</mi><mo id="S4.Ex7.m2.4.4.2.2.2.2.3.1" xref="S4.Ex7.m2.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.4.4.2.2.2.2.3.3" xref="S4.Ex7.m2.4.4.2.2.2.2.3.3.cmml">o</mi><mo id="S4.Ex7.m2.4.4.2.2.2.2.3.1a" xref="S4.Ex7.m2.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.4.4.2.2.2.2.3.4" xref="S4.Ex7.m2.4.4.2.2.2.2.3.4.cmml">s</mi></mrow></msubsup><mo id="S4.Ex7.m2.7.7.5.5.9" xref="S4.Ex7.m2.7.7.5.6.cmml">,</mo><msubsup id="S4.Ex7.m2.5.5.3.3.3" xref="S4.Ex7.m2.5.5.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.5.5.3.3.3.2.2" xref="S4.Ex7.m2.5.5.3.3.3.2.2a.cmml">m</mtext><mn id="S4.Ex7.m2.5.5.3.3.3.3" xref="S4.Ex7.m2.5.5.3.3.3.3.cmml">1</mn><mrow id="S4.Ex7.m2.5.5.3.3.3.2.3" xref="S4.Ex7.m2.5.5.3.3.3.2.3.cmml"><mi id="S4.Ex7.m2.5.5.3.3.3.2.3.2" xref="S4.Ex7.m2.5.5.3.3.3.2.3.2.cmml">n</mi><mo id="S4.Ex7.m2.5.5.3.3.3.2.3.1" xref="S4.Ex7.m2.5.5.3.3.3.2.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.5.5.3.3.3.2.3.3" xref="S4.Ex7.m2.5.5.3.3.3.2.3.3.cmml">e</mi><mo id="S4.Ex7.m2.5.5.3.3.3.2.3.1a" xref="S4.Ex7.m2.5.5.3.3.3.2.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.5.5.3.3.3.2.3.4" xref="S4.Ex7.m2.5.5.3.3.3.2.3.4.cmml">g</mi></mrow></msubsup><mo id="S4.Ex7.m2.7.7.5.5.10" xref="S4.Ex7.m2.7.7.5.6.cmml">,</mo><mi id="S4.Ex7.m2.2.2" mathvariant="normal" xref="S4.Ex7.m2.2.2.cmml">…</mi><mo id="S4.Ex7.m2.7.7.5.5.11" xref="S4.Ex7.m2.7.7.5.6.cmml">,</mo><msubsup id="S4.Ex7.m2.6.6.4.4.4" xref="S4.Ex7.m2.6.6.4.4.4.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.6.6.4.4.4.2.2" xref="S4.Ex7.m2.6.6.4.4.4.2.2a.cmml">m</mtext><mi id="S4.Ex7.m2.6.6.4.4.4.3" xref="S4.Ex7.m2.6.6.4.4.4.3.cmml">P</mi><mrow id="S4.Ex7.m2.6.6.4.4.4.2.3" xref="S4.Ex7.m2.6.6.4.4.4.2.3.cmml"><mi id="S4.Ex7.m2.6.6.4.4.4.2.3.2" xref="S4.Ex7.m2.6.6.4.4.4.2.3.2.cmml">n</mi><mo id="S4.Ex7.m2.6.6.4.4.4.2.3.1" xref="S4.Ex7.m2.6.6.4.4.4.2.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.6.6.4.4.4.2.3.3" xref="S4.Ex7.m2.6.6.4.4.4.2.3.3.cmml">e</mi><mo id="S4.Ex7.m2.6.6.4.4.4.2.3.1a" xref="S4.Ex7.m2.6.6.4.4.4.2.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.6.6.4.4.4.2.3.4" xref="S4.Ex7.m2.6.6.4.4.4.2.3.4.cmml">g</mi></mrow></msubsup><mo id="S4.Ex7.m2.7.7.5.5.12" xref="S4.Ex7.m2.7.7.5.6.cmml">,</mo><msup id="S4.Ex7.m2.7.7.5.5.5" xref="S4.Ex7.m2.7.7.5.5.5.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.7.7.5.5.5.2" xref="S4.Ex7.m2.7.7.5.5.5.2a.cmml">m</mtext><mrow id="S4.Ex7.m2.7.7.5.5.5.3" xref="S4.Ex7.m2.7.7.5.5.5.3.cmml"><mi id="S4.Ex7.m2.7.7.5.5.5.3.2" xref="S4.Ex7.m2.7.7.5.5.5.3.2.cmml">n</mi><mo id="S4.Ex7.m2.7.7.5.5.5.3.1" xref="S4.Ex7.m2.7.7.5.5.5.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.7.7.5.5.5.3.3" xref="S4.Ex7.m2.7.7.5.5.5.3.3.cmml">e</mi><mo id="S4.Ex7.m2.7.7.5.5.5.3.1a" xref="S4.Ex7.m2.7.7.5.5.5.3.1.cmml">⁢</mo><mi id="S4.Ex7.m2.7.7.5.5.5.3.4" xref="S4.Ex7.m2.7.7.5.5.5.3.4.cmml">w</mi></mrow></msup><mo id="S4.Ex7.m2.7.7.5.5.13" stretchy="false" xref="S4.Ex7.m2.7.7.5.6.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex7.m2.7b"><apply id="S4.Ex7.m2.7.7.cmml" xref="S4.Ex7.m2.7.7"><eq id="S4.Ex7.m2.7.7.6.cmml" xref="S4.Ex7.m2.7.7.6"></eq><csymbol cd="latexml" id="S4.Ex7.m2.7.7.7.cmml" xref="S4.Ex7.m2.7.7.7">absent</csymbol><set id="S4.Ex7.m2.7.7.5.6.cmml" xref="S4.Ex7.m2.7.7.5.5"><apply id="S4.Ex7.m2.3.3.1.1.1.cmml" xref="S4.Ex7.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex7.m2.3.3.1.1.1.1.cmml" xref="S4.Ex7.m2.3.3.1.1.1">subscript</csymbol><apply id="S4.Ex7.m2.3.3.1.1.1.2.cmml" xref="S4.Ex7.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex7.m2.3.3.1.1.1.2.1.cmml" xref="S4.Ex7.m2.3.3.1.1.1">superscript</csymbol><ci id="S4.Ex7.m2.3.3.1.1.1.2.2a.cmml" xref="S4.Ex7.m2.3.3.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.3.3.1.1.1.2.2.cmml" xref="S4.Ex7.m2.3.3.1.1.1.2.2">m</mtext></ci><apply id="S4.Ex7.m2.3.3.1.1.1.2.3.cmml" xref="S4.Ex7.m2.3.3.1.1.1.2.3"><times id="S4.Ex7.m2.3.3.1.1.1.2.3.1.cmml" xref="S4.Ex7.m2.3.3.1.1.1.2.3.1"></times><ci id="S4.Ex7.m2.3.3.1.1.1.2.3.2.cmml" xref="S4.Ex7.m2.3.3.1.1.1.2.3.2">𝑝</ci><ci id="S4.Ex7.m2.3.3.1.1.1.2.3.3.cmml" xref="S4.Ex7.m2.3.3.1.1.1.2.3.3">𝑜</ci><ci id="S4.Ex7.m2.3.3.1.1.1.2.3.4.cmml" xref="S4.Ex7.m2.3.3.1.1.1.2.3.4">𝑠</ci></apply></apply><cn id="S4.Ex7.m2.3.3.1.1.1.3.cmml" type="integer" xref="S4.Ex7.m2.3.3.1.1.1.3">1</cn></apply><ci id="S4.Ex7.m2.1.1.cmml" xref="S4.Ex7.m2.1.1">…</ci><apply id="S4.Ex7.m2.4.4.2.2.2.cmml" xref="S4.Ex7.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.Ex7.m2.4.4.2.2.2.1.cmml" xref="S4.Ex7.m2.4.4.2.2.2">subscript</csymbol><apply id="S4.Ex7.m2.4.4.2.2.2.2.cmml" xref="S4.Ex7.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.Ex7.m2.4.4.2.2.2.2.1.cmml" xref="S4.Ex7.m2.4.4.2.2.2">superscript</csymbol><ci id="S4.Ex7.m2.4.4.2.2.2.2.2a.cmml" xref="S4.Ex7.m2.4.4.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.4.4.2.2.2.2.2.cmml" xref="S4.Ex7.m2.4.4.2.2.2.2.2">m</mtext></ci><apply id="S4.Ex7.m2.4.4.2.2.2.2.3.cmml" xref="S4.Ex7.m2.4.4.2.2.2.2.3"><times id="S4.Ex7.m2.4.4.2.2.2.2.3.1.cmml" xref="S4.Ex7.m2.4.4.2.2.2.2.3.1"></times><ci id="S4.Ex7.m2.4.4.2.2.2.2.3.2.cmml" xref="S4.Ex7.m2.4.4.2.2.2.2.3.2">𝑝</ci><ci id="S4.Ex7.m2.4.4.2.2.2.2.3.3.cmml" xref="S4.Ex7.m2.4.4.2.2.2.2.3.3">𝑜</ci><ci id="S4.Ex7.m2.4.4.2.2.2.2.3.4.cmml" xref="S4.Ex7.m2.4.4.2.2.2.2.3.4">𝑠</ci></apply></apply><ci id="S4.Ex7.m2.4.4.2.2.2.3.cmml" xref="S4.Ex7.m2.4.4.2.2.2.3">𝑛</ci></apply><apply id="S4.Ex7.m2.5.5.3.3.3.cmml" xref="S4.Ex7.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S4.Ex7.m2.5.5.3.3.3.1.cmml" xref="S4.Ex7.m2.5.5.3.3.3">subscript</csymbol><apply id="S4.Ex7.m2.5.5.3.3.3.2.cmml" xref="S4.Ex7.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S4.Ex7.m2.5.5.3.3.3.2.1.cmml" xref="S4.Ex7.m2.5.5.3.3.3">superscript</csymbol><ci id="S4.Ex7.m2.5.5.3.3.3.2.2a.cmml" xref="S4.Ex7.m2.5.5.3.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.5.5.3.3.3.2.2.cmml" xref="S4.Ex7.m2.5.5.3.3.3.2.2">m</mtext></ci><apply id="S4.Ex7.m2.5.5.3.3.3.2.3.cmml" xref="S4.Ex7.m2.5.5.3.3.3.2.3"><times id="S4.Ex7.m2.5.5.3.3.3.2.3.1.cmml" xref="S4.Ex7.m2.5.5.3.3.3.2.3.1"></times><ci id="S4.Ex7.m2.5.5.3.3.3.2.3.2.cmml" xref="S4.Ex7.m2.5.5.3.3.3.2.3.2">𝑛</ci><ci id="S4.Ex7.m2.5.5.3.3.3.2.3.3.cmml" xref="S4.Ex7.m2.5.5.3.3.3.2.3.3">𝑒</ci><ci id="S4.Ex7.m2.5.5.3.3.3.2.3.4.cmml" xref="S4.Ex7.m2.5.5.3.3.3.2.3.4">𝑔</ci></apply></apply><cn id="S4.Ex7.m2.5.5.3.3.3.3.cmml" type="integer" xref="S4.Ex7.m2.5.5.3.3.3.3">1</cn></apply><ci id="S4.Ex7.m2.2.2.cmml" xref="S4.Ex7.m2.2.2">…</ci><apply id="S4.Ex7.m2.6.6.4.4.4.cmml" xref="S4.Ex7.m2.6.6.4.4.4"><csymbol cd="ambiguous" id="S4.Ex7.m2.6.6.4.4.4.1.cmml" xref="S4.Ex7.m2.6.6.4.4.4">subscript</csymbol><apply id="S4.Ex7.m2.6.6.4.4.4.2.cmml" xref="S4.Ex7.m2.6.6.4.4.4"><csymbol cd="ambiguous" id="S4.Ex7.m2.6.6.4.4.4.2.1.cmml" xref="S4.Ex7.m2.6.6.4.4.4">superscript</csymbol><ci id="S4.Ex7.m2.6.6.4.4.4.2.2a.cmml" xref="S4.Ex7.m2.6.6.4.4.4.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.6.6.4.4.4.2.2.cmml" xref="S4.Ex7.m2.6.6.4.4.4.2.2">m</mtext></ci><apply id="S4.Ex7.m2.6.6.4.4.4.2.3.cmml" xref="S4.Ex7.m2.6.6.4.4.4.2.3"><times id="S4.Ex7.m2.6.6.4.4.4.2.3.1.cmml" xref="S4.Ex7.m2.6.6.4.4.4.2.3.1"></times><ci id="S4.Ex7.m2.6.6.4.4.4.2.3.2.cmml" xref="S4.Ex7.m2.6.6.4.4.4.2.3.2">𝑛</ci><ci id="S4.Ex7.m2.6.6.4.4.4.2.3.3.cmml" xref="S4.Ex7.m2.6.6.4.4.4.2.3.3">𝑒</ci><ci id="S4.Ex7.m2.6.6.4.4.4.2.3.4.cmml" xref="S4.Ex7.m2.6.6.4.4.4.2.3.4">𝑔</ci></apply></apply><ci id="S4.Ex7.m2.6.6.4.4.4.3.cmml" xref="S4.Ex7.m2.6.6.4.4.4.3">𝑃</ci></apply><apply id="S4.Ex7.m2.7.7.5.5.5.cmml" xref="S4.Ex7.m2.7.7.5.5.5"><csymbol cd="ambiguous" id="S4.Ex7.m2.7.7.5.5.5.1.cmml" xref="S4.Ex7.m2.7.7.5.5.5">superscript</csymbol><ci id="S4.Ex7.m2.7.7.5.5.5.2a.cmml" xref="S4.Ex7.m2.7.7.5.5.5.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex7.m2.7.7.5.5.5.2.cmml" xref="S4.Ex7.m2.7.7.5.5.5.2">m</mtext></ci><apply id="S4.Ex7.m2.7.7.5.5.5.3.cmml" xref="S4.Ex7.m2.7.7.5.5.5.3"><times id="S4.Ex7.m2.7.7.5.5.5.3.1.cmml" xref="S4.Ex7.m2.7.7.5.5.5.3.1"></times><ci id="S4.Ex7.m2.7.7.5.5.5.3.2.cmml" xref="S4.Ex7.m2.7.7.5.5.5.3.2">𝑛</ci><ci id="S4.Ex7.m2.7.7.5.5.5.3.3.cmml" xref="S4.Ex7.m2.7.7.5.5.5.3.3">𝑒</ci><ci id="S4.Ex7.m2.7.7.5.5.5.3.4.cmml" xref="S4.Ex7.m2.7.7.5.5.5.3.4">𝑤</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex7.m2.7c">\displaystyle=\{\textbf{m}^{pos}_{1},\ldots,\textbf{m}^{pos}_{n},\textbf{m}^{%
neg}_{1},\ldots,\textbf{m}^{neg}_{P},\textbf{m}^{new}\}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex7.m2.7d">= { m start_POSTSUPERSCRIPT italic_p italic_o italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , m start_POSTSUPERSCRIPT italic_p italic_o italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , m start_POSTSUPERSCRIPT italic_n italic_e italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , m start_POSTSUPERSCRIPT italic_n italic_e italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT , m start_POSTSUPERSCRIPT italic_n italic_e italic_w end_POSTSUPERSCRIPT }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\textbf{h}_{ICL}" class="ltx_Math" display="inline" id="S4.Ex8.m1.1"><semantics id="S4.Ex8.m1.1a"><msub id="S4.Ex8.m1.1.1" xref="S4.Ex8.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex8.m1.1.1.2" xref="S4.Ex8.m1.1.1.2a.cmml">h</mtext><mrow id="S4.Ex8.m1.1.1.3" xref="S4.Ex8.m1.1.1.3.cmml"><mi id="S4.Ex8.m1.1.1.3.2" xref="S4.Ex8.m1.1.1.3.2.cmml">I</mi><mo id="S4.Ex8.m1.1.1.3.1" xref="S4.Ex8.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.Ex8.m1.1.1.3.3" xref="S4.Ex8.m1.1.1.3.3.cmml">C</mi><mo id="S4.Ex8.m1.1.1.3.1a" xref="S4.Ex8.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.Ex8.m1.1.1.3.4" xref="S4.Ex8.m1.1.1.3.4.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.Ex8.m1.1b"><apply id="S4.Ex8.m1.1.1.cmml" xref="S4.Ex8.m1.1.1"><csymbol cd="ambiguous" id="S4.Ex8.m1.1.1.1.cmml" xref="S4.Ex8.m1.1.1">subscript</csymbol><ci id="S4.Ex8.m1.1.1.2a.cmml" xref="S4.Ex8.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex8.m1.1.1.2.cmml" xref="S4.Ex8.m1.1.1.2">h</mtext></ci><apply id="S4.Ex8.m1.1.1.3.cmml" xref="S4.Ex8.m1.1.1.3"><times id="S4.Ex8.m1.1.1.3.1.cmml" xref="S4.Ex8.m1.1.1.3.1"></times><ci id="S4.Ex8.m1.1.1.3.2.cmml" xref="S4.Ex8.m1.1.1.3.2">𝐼</ci><ci id="S4.Ex8.m1.1.1.3.3.cmml" xref="S4.Ex8.m1.1.1.3.3">𝐶</ci><ci id="S4.Ex8.m1.1.1.3.4.cmml" xref="S4.Ex8.m1.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex8.m1.1c">\displaystyle\textbf{h}_{ICL}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex8.m1.1d">h start_POSTSUBSCRIPT italic_I italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{LLM}([\textbf{u}_{ICL},\textbf{M}^{ICL}])[:-1];\ f(e^{%
new})=\rm MLP(\textbf{h}_{ICL})" class="ltx_math_unparsed" display="inline" id="S4.Ex8.m2.1"><semantics id="S4.Ex8.m2.1a"><mrow id="S4.Ex8.m2.1b"><mo id="S4.Ex8.m2.1.1">=</mo><mi id="S4.Ex8.m2.1.2">𝐋𝐋𝐌</mi><mrow id="S4.Ex8.m2.1.3"><mo id="S4.Ex8.m2.1.3.1" stretchy="false">(</mo><mrow id="S4.Ex8.m2.1.3.2"><mo id="S4.Ex8.m2.1.3.2.1" stretchy="false">[</mo><msub id="S4.Ex8.m2.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex8.m2.1.3.2.2.2">u</mtext><mrow id="S4.Ex8.m2.1.3.2.2.3"><mi id="S4.Ex8.m2.1.3.2.2.3.2">I</mi><mo id="S4.Ex8.m2.1.3.2.2.3.1">⁢</mo><mi id="S4.Ex8.m2.1.3.2.2.3.3">C</mi><mo id="S4.Ex8.m2.1.3.2.2.3.1a">⁢</mo><mi id="S4.Ex8.m2.1.3.2.2.3.4">L</mi></mrow></msub><mo id="S4.Ex8.m2.1.3.2.3">,</mo><msup id="S4.Ex8.m2.1.3.2.4"><mtext class="ltx_mathvariant_bold" id="S4.Ex8.m2.1.3.2.4.2">M</mtext><mrow id="S4.Ex8.m2.1.3.2.4.3"><mi id="S4.Ex8.m2.1.3.2.4.3.2">I</mi><mo id="S4.Ex8.m2.1.3.2.4.3.1">⁢</mo><mi id="S4.Ex8.m2.1.3.2.4.3.3">C</mi><mo id="S4.Ex8.m2.1.3.2.4.3.1a">⁢</mo><mi id="S4.Ex8.m2.1.3.2.4.3.4">L</mi></mrow></msup><mo id="S4.Ex8.m2.1.3.2.5" stretchy="false">]</mo></mrow><mo id="S4.Ex8.m2.1.3.3" stretchy="false">)</mo></mrow><mrow id="S4.Ex8.m2.1.4"><mo id="S4.Ex8.m2.1.4.1" stretchy="false">[</mo><mo id="S4.Ex8.m2.1.4.2" rspace="0em">:</mo><mo id="S4.Ex8.m2.1.4.3" lspace="0em">−</mo><mn id="S4.Ex8.m2.1.4.4">1</mn><mo id="S4.Ex8.m2.1.4.5" stretchy="false">]</mo></mrow><mo id="S4.Ex8.m2.1.5" rspace="0.667em">;</mo><mi id="S4.Ex8.m2.1.6">f</mi><mrow id="S4.Ex8.m2.1.7"><mo id="S4.Ex8.m2.1.7.1" stretchy="false">(</mo><msup id="S4.Ex8.m2.1.7.2"><mi id="S4.Ex8.m2.1.7.2.2">e</mi><mrow id="S4.Ex8.m2.1.7.2.3"><mi id="S4.Ex8.m2.1.7.2.3.2">n</mi><mo id="S4.Ex8.m2.1.7.2.3.1">⁢</mo><mi id="S4.Ex8.m2.1.7.2.3.3">e</mi><mo id="S4.Ex8.m2.1.7.2.3.1a">⁢</mo><mi id="S4.Ex8.m2.1.7.2.3.4">w</mi></mrow></msup><mo id="S4.Ex8.m2.1.7.3" stretchy="false">)</mo></mrow><mo id="S4.Ex8.m2.1.8">=</mo><mi id="S4.Ex8.m2.1.9">MLP</mi><mrow id="S4.Ex8.m2.1.10"><mo id="S4.Ex8.m2.1.10.1" stretchy="false">(</mo><msub id="S4.Ex8.m2.1.10.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex8.m2.1.10.2.2">h</mtext><mi id="S4.Ex8.m2.1.10.2.3">ICL</mi></msub><mo id="S4.Ex8.m2.1.10.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex8.m2.1c">\displaystyle=\mathbf{LLM}([\textbf{u}_{ICL},\textbf{M}^{ICL}])[:-1];\ f(e^{%
new})=\rm MLP(\textbf{h}_{ICL})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex8.m2.1d">= bold_LLM ( [ u start_POSTSUBSCRIPT italic_I italic_C italic_L end_POSTSUBSCRIPT , M start_POSTSUPERSCRIPT italic_I italic_C italic_L end_POSTSUPERSCRIPT ] ) [ : - 1 ] ; italic_f ( italic_e start_POSTSUPERSCRIPT italic_n italic_e italic_w end_POSTSUPERSCRIPT ) = roman_MLP ( h start_POSTSUBSCRIPT roman_ICL end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS1.p2.9">where <math alttext="\textbf{m}^{pos}_{u},\textbf{m}^{neg}_{u}\in\mathbb{R}^{d_{m}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.6.m1.2"><semantics id="S4.SS3.SSS1.p2.6.m1.2a"><mrow id="S4.SS3.SSS1.p2.6.m1.2.2" xref="S4.SS3.SSS1.p2.6.m1.2.2.cmml"><mrow id="S4.SS3.SSS1.p2.6.m1.2.2.2.2" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.3.cmml"><msubsup id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.2" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.2a.cmml">m</mtext><mi id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.3" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.3.cmml">u</mi><mrow id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.2" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.2.cmml">p</mi><mo id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.1" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.3" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.1a" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.4" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.4.cmml">s</mi></mrow></msubsup><mo id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.3" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.3.cmml">,</mo><msubsup id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.2" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.2a.cmml">m</mtext><mi id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.3" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.3.cmml">u</mi><mrow id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.2" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.2.cmml">n</mi><mo id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.1" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.3" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.3.cmml">e</mi><mo id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.1a" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.4" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.4.cmml">g</mi></mrow></msubsup></mrow><mo id="S4.SS3.SSS1.p2.6.m1.2.2.3" xref="S4.SS3.SSS1.p2.6.m1.2.2.3.cmml">∈</mo><msup id="S4.SS3.SSS1.p2.6.m1.2.2.4" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.cmml"><mi id="S4.SS3.SSS1.p2.6.m1.2.2.4.2" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.2.cmml">ℝ</mi><msub id="S4.SS3.SSS1.p2.6.m1.2.2.4.3" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.3.cmml"><mi id="S4.SS3.SSS1.p2.6.m1.2.2.4.3.2" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.3.2.cmml">d</mi><mi id="S4.SS3.SSS1.p2.6.m1.2.2.4.3.3" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.3.3.cmml">m</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.6.m1.2b"><apply id="S4.SS3.SSS1.p2.6.m1.2.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2"><in id="S4.SS3.SSS1.p2.6.m1.2.2.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.3"></in><list id="S4.SS3.SSS1.p2.6.m1.2.2.2.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2"><apply id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.2a.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.2">m</mtext></ci><apply id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3"><times id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.1"></times><ci id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.3">𝑜</ci><ci id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.4.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2">subscript</csymbol><apply id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2">superscript</csymbol><ci id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.2a.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.2">m</mtext></ci><apply id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3"><times id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.1"></times><ci id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.2">𝑛</ci><ci id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.3">𝑒</ci><ci id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.4.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.2.3.4">𝑔</ci></apply></apply><ci id="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.2.2.2.3">𝑢</ci></apply></list><apply id="S4.SS3.SSS1.p2.6.m1.2.2.4.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.6.m1.2.2.4.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.4">superscript</csymbol><ci id="S4.SS3.SSS1.p2.6.m1.2.2.4.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.2">ℝ</ci><apply id="S4.SS3.SSS1.p2.6.m1.2.2.4.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.6.m1.2.2.4.3.1.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.3">subscript</csymbol><ci id="S4.SS3.SSS1.p2.6.m1.2.2.4.3.2.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.3.2">𝑑</ci><ci id="S4.SS3.SSS1.p2.6.m1.2.2.4.3.3.cmml" xref="S4.SS3.SSS1.p2.6.m1.2.2.4.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.6.m1.2c">\textbf{m}^{pos}_{u},\textbf{m}^{neg}_{u}\in\mathbb{R}^{d_{m}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.6.m1.2d">m start_POSTSUPERSCRIPT italic_p italic_o italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , m start_POSTSUPERSCRIPT italic_n italic_e italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are the reprogrammed embeddings of the <math alttext="u" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.7.m2.1"><semantics id="S4.SS3.SSS1.p2.7.m2.1a"><mi id="S4.SS3.SSS1.p2.7.m2.1.1" xref="S4.SS3.SSS1.p2.7.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.7.m2.1b"><ci id="S4.SS3.SSS1.p2.7.m2.1.1.cmml" xref="S4.SS3.SSS1.p2.7.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.7.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.7.m2.1d">italic_u</annotation></semantics></math>-th positive and negative edge examples, respectively, and <math alttext="\textbf{m}^{new}\in\mathbb{R}^{d_{m}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.8.m3.1"><semantics id="S4.SS3.SSS1.p2.8.m3.1a"><mrow id="S4.SS3.SSS1.p2.8.m3.1.1" xref="S4.SS3.SSS1.p2.8.m3.1.1.cmml"><msup id="S4.SS3.SSS1.p2.8.m3.1.1.2" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS1.p2.8.m3.1.1.2.2" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.2a.cmml">m</mtext><mrow id="S4.SS3.SSS1.p2.8.m3.1.1.2.3" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.cmml"><mi id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.2" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.2.cmml">n</mi><mo id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.1" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.3" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.3.cmml">e</mi><mo id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.1a" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.4" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.4.cmml">w</mi></mrow></msup><mo id="S4.SS3.SSS1.p2.8.m3.1.1.1" xref="S4.SS3.SSS1.p2.8.m3.1.1.1.cmml">∈</mo><msup id="S4.SS3.SSS1.p2.8.m3.1.1.3" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.cmml"><mi id="S4.SS3.SSS1.p2.8.m3.1.1.3.2" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS3.SSS1.p2.8.m3.1.1.3.3" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.3.cmml"><mi id="S4.SS3.SSS1.p2.8.m3.1.1.3.3.2" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.3.2.cmml">d</mi><mi id="S4.SS3.SSS1.p2.8.m3.1.1.3.3.3" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.3.3.cmml">m</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.8.m3.1b"><apply id="S4.SS3.SSS1.p2.8.m3.1.1.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1"><in id="S4.SS3.SSS1.p2.8.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.1"></in><apply id="S4.SS3.SSS1.p2.8.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.8.m3.1.1.2.1.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2">superscript</csymbol><ci id="S4.SS3.SSS1.p2.8.m3.1.1.2.2a.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS1.p2.8.m3.1.1.2.2.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.2">m</mtext></ci><apply id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3"><times id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.1.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.1"></times><ci id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.2.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.2">𝑛</ci><ci id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.3.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.3">𝑒</ci><ci id="S4.SS3.SSS1.p2.8.m3.1.1.2.3.4.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.2.3.4">𝑤</ci></apply></apply><apply id="S4.SS3.SSS1.p2.8.m3.1.1.3.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.8.m3.1.1.3.1.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS1.p2.8.m3.1.1.3.2.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.2">ℝ</ci><apply id="S4.SS3.SSS1.p2.8.m3.1.1.3.3.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.8.m3.1.1.3.3.1.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.3">subscript</csymbol><ci id="S4.SS3.SSS1.p2.8.m3.1.1.3.3.2.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.3.2">𝑑</ci><ci id="S4.SS3.SSS1.p2.8.m3.1.1.3.3.3.cmml" xref="S4.SS3.SSS1.p2.8.m3.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.8.m3.1c">\textbf{m}^{new}\in\mathbb{R}^{d_{m}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.8.m3.1d">m start_POSTSUPERSCRIPT italic_n italic_e italic_w end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the reprogrammed embedding of the edge under investigation. In the prompt template, we employ mask token ¡Edge¿ to represent the location of edge embeddings and each example has a related label tag to make use of the given few labeled data. Given a new edge <math alttext="e^{new}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.9.m4.1"><semantics id="S4.SS3.SSS1.p2.9.m4.1a"><msup id="S4.SS3.SSS1.p2.9.m4.1.1" xref="S4.SS3.SSS1.p2.9.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p2.9.m4.1.1.2" xref="S4.SS3.SSS1.p2.9.m4.1.1.2.cmml">e</mi><mrow id="S4.SS3.SSS1.p2.9.m4.1.1.3" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.cmml"><mi id="S4.SS3.SSS1.p2.9.m4.1.1.3.2" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.2.cmml">n</mi><mo id="S4.SS3.SSS1.p2.9.m4.1.1.3.1" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.9.m4.1.1.3.3" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.3.cmml">e</mi><mo id="S4.SS3.SSS1.p2.9.m4.1.1.3.1a" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.9.m4.1.1.3.4" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.4.cmml">w</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.9.m4.1b"><apply id="S4.SS3.SSS1.p2.9.m4.1.1.cmml" xref="S4.SS3.SSS1.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.9.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p2.9.m4.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p2.9.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p2.9.m4.1.1.2">𝑒</ci><apply id="S4.SS3.SSS1.p2.9.m4.1.1.3.cmml" xref="S4.SS3.SSS1.p2.9.m4.1.1.3"><times id="S4.SS3.SSS1.p2.9.m4.1.1.3.1.cmml" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.1"></times><ci id="S4.SS3.SSS1.p2.9.m4.1.1.3.2.cmml" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.2">𝑛</ci><ci id="S4.SS3.SSS1.p2.9.m4.1.1.3.3.cmml" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.3">𝑒</ci><ci id="S4.SS3.SSS1.p2.9.m4.1.1.3.4.cmml" xref="S4.SS3.SSS1.p2.9.m4.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.9.m4.1c">e^{new}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.9.m4.1d">italic_e start_POSTSUPERSCRIPT italic_n italic_e italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> needed to be detected, we conduct the same operations of examples to obtain the edge embedding.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2. </span>Few-shot anomaly detection</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.5">Using AnomalyLLM, we can conduct few-shot anomaly edge detection for various anomaly types without any update of parameters. For a specific anomaly type <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.1.m1.1"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><ci id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.1.m1.1d">caligraphic_T</annotation></semantics></math>, the ICL template can be constructed in advance. Assuming <math alttext="e^{new}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.2.m2.1"><semantics id="S4.SS3.SSS2.p1.2.m2.1a"><msup id="S4.SS3.SSS2.p1.2.m2.1.1" xref="S4.SS3.SSS2.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS2.p1.2.m2.1.1.2" xref="S4.SS3.SSS2.p1.2.m2.1.1.2.cmml">e</mi><mrow id="S4.SS3.SSS2.p1.2.m2.1.1.3" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS2.p1.2.m2.1.1.3.2" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.2.cmml">n</mi><mo id="S4.SS3.SSS2.p1.2.m2.1.1.3.1" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p1.2.m2.1.1.3.3" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.3.cmml">e</mi><mo id="S4.SS3.SSS2.p1.2.m2.1.1.3.1a" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p1.2.m2.1.1.3.4" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.4.cmml">w</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.2.m2.1b"><apply id="S4.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1.2">𝑒</ci><apply id="S4.SS3.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1.3"><times id="S4.SS3.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.1"></times><ci id="S4.SS3.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.2">𝑛</ci><ci id="S4.SS3.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.3">𝑒</ci><ci id="S4.SS3.SSS2.p1.2.m2.1.1.3.4.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.2.m2.1c">e^{new}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.2.m2.1d">italic_e start_POSTSUPERSCRIPT italic_n italic_e italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> is a new edge to be detected, AnomalyLLM utilize the dynamic-aware encoder to obtain an intermediate vector and reprogram it with text prototypes. By embedding the reprogrammed vector into the ICL template, we obtain the input of LLM to generate the edge embedding <math alttext="\mathbf{h}_{ICL}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.3.m3.1"><semantics id="S4.SS3.SSS2.p1.3.m3.1a"><msub id="S4.SS3.SSS2.p1.3.m3.1.1" xref="S4.SS3.SSS2.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS2.p1.3.m3.1.1.2" xref="S4.SS3.SSS2.p1.3.m3.1.1.2.cmml">𝐡</mi><mrow id="S4.SS3.SSS2.p1.3.m3.1.1.3" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.cmml"><mi id="S4.SS3.SSS2.p1.3.m3.1.1.3.2" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.2.cmml">I</mi><mo id="S4.SS3.SSS2.p1.3.m3.1.1.3.1" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p1.3.m3.1.1.3.3" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.3.cmml">C</mi><mo id="S4.SS3.SSS2.p1.3.m3.1.1.3.1a" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p1.3.m3.1.1.3.4" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.4.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.3.m3.1b"><apply id="S4.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1.2">𝐡</ci><apply id="S4.SS3.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1.3"><times id="S4.SS3.SSS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.1"></times><ci id="S4.SS3.SSS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.2">𝐼</ci><ci id="S4.SS3.SSS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.3">𝐶</ci><ci id="S4.SS3.SSS2.p1.3.m3.1.1.3.4.cmml" xref="S4.SS3.SSS2.p1.3.m3.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.3.m3.1c">\mathbf{h}_{ICL}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.3.m3.1d">bold_h start_POSTSUBSCRIPT italic_I italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math>. Then, the edge embedding is fed into the pre-trained anomaly decoder, <em class="ltx_emph ltx_font_italic" id="S4.SS3.SSS2.p1.5.1">i.e.</em> the MLP layer, to calculate the probability of <math alttext="e^{new}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.4.m4.1"><semantics id="S4.SS3.SSS2.p1.4.m4.1a"><msup id="S4.SS3.SSS2.p1.4.m4.1.1" xref="S4.SS3.SSS2.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS2.p1.4.m4.1.1.2" xref="S4.SS3.SSS2.p1.4.m4.1.1.2.cmml">e</mi><mrow id="S4.SS3.SSS2.p1.4.m4.1.1.3" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.SSS2.p1.4.m4.1.1.3.2" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.2.cmml">n</mi><mo id="S4.SS3.SSS2.p1.4.m4.1.1.3.1" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p1.4.m4.1.1.3.3" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.3.cmml">e</mi><mo id="S4.SS3.SSS2.p1.4.m4.1.1.3.1a" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p1.4.m4.1.1.3.4" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.4.cmml">w</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.4.m4.1b"><apply id="S4.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1.2">𝑒</ci><apply id="S4.SS3.SSS2.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1.3"><times id="S4.SS3.SSS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.1"></times><ci id="S4.SS3.SSS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.2">𝑛</ci><ci id="S4.SS3.SSS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.3">𝑒</ci><ci id="S4.SS3.SSS2.p1.4.m4.1.1.3.4.cmml" xref="S4.SS3.SSS2.p1.4.m4.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.4.m4.1c">e^{new}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.4.m4.1d">italic_e start_POSTSUPERSCRIPT italic_n italic_e italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> to be an anomaly of <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.5.m5.1"><semantics id="S4.SS3.SSS2.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.p1.5.m5.1.1" xref="S4.SS3.SSS2.p1.5.m5.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.5.m5.1b"><ci id="S4.SS3.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS2.p1.5.m5.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.5.m5.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.5.m5.1d">caligraphic_T</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(e^{new})=\rm MLP(\mathbf{h}_{ICL})" class="ltx_Math" display="block" id="S4.Ex9.m1.2"><semantics id="S4.Ex9.m1.2a"><mrow id="S4.Ex9.m1.2.2" xref="S4.Ex9.m1.2.2.cmml"><mrow id="S4.Ex9.m1.1.1.1" xref="S4.Ex9.m1.1.1.1.cmml"><mi id="S4.Ex9.m1.1.1.1.3" xref="S4.Ex9.m1.1.1.1.3.cmml">f</mi><mo id="S4.Ex9.m1.1.1.1.2" xref="S4.Ex9.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex9.m1.1.1.1.1.1" xref="S4.Ex9.m1.1.1.1.1.1.1.cmml"><mo id="S4.Ex9.m1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex9.m1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.Ex9.m1.1.1.1.1.1.1" xref="S4.Ex9.m1.1.1.1.1.1.1.cmml"><mi id="S4.Ex9.m1.1.1.1.1.1.1.2" xref="S4.Ex9.m1.1.1.1.1.1.1.2.cmml">e</mi><mrow id="S4.Ex9.m1.1.1.1.1.1.1.3" xref="S4.Ex9.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex9.m1.1.1.1.1.1.1.3.2" xref="S4.Ex9.m1.1.1.1.1.1.1.3.2.cmml">n</mi><mo id="S4.Ex9.m1.1.1.1.1.1.1.3.1" xref="S4.Ex9.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.Ex9.m1.1.1.1.1.1.1.3.3" xref="S4.Ex9.m1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="S4.Ex9.m1.1.1.1.1.1.1.3.1a" xref="S4.Ex9.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.Ex9.m1.1.1.1.1.1.1.3.4" xref="S4.Ex9.m1.1.1.1.1.1.1.3.4.cmml">w</mi></mrow></msup><mo id="S4.Ex9.m1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex9.m1.2.2.3" xref="S4.Ex9.m1.2.2.3.cmml">=</mo><mrow id="S4.Ex9.m1.2.2.2" xref="S4.Ex9.m1.2.2.2.cmml"><mi id="S4.Ex9.m1.2.2.2.3" xref="S4.Ex9.m1.2.2.2.3.cmml">MLP</mi><mo id="S4.Ex9.m1.2.2.2.2" xref="S4.Ex9.m1.2.2.2.2.cmml">⁢</mo><mrow id="S4.Ex9.m1.2.2.2.1.1" xref="S4.Ex9.m1.2.2.2.1.1.1.cmml"><mo id="S4.Ex9.m1.2.2.2.1.1.2" stretchy="false" xref="S4.Ex9.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S4.Ex9.m1.2.2.2.1.1.1" xref="S4.Ex9.m1.2.2.2.1.1.1.cmml"><mi id="S4.Ex9.m1.2.2.2.1.1.1.2" xref="S4.Ex9.m1.2.2.2.1.1.1.2.cmml">𝐡</mi><mi id="S4.Ex9.m1.2.2.2.1.1.1.3" xref="S4.Ex9.m1.2.2.2.1.1.1.3.cmml">ICL</mi></msub><mo id="S4.Ex9.m1.2.2.2.1.1.3" stretchy="false" xref="S4.Ex9.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex9.m1.2b"><apply id="S4.Ex9.m1.2.2.cmml" xref="S4.Ex9.m1.2.2"><eq id="S4.Ex9.m1.2.2.3.cmml" xref="S4.Ex9.m1.2.2.3"></eq><apply id="S4.Ex9.m1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1"><times id="S4.Ex9.m1.1.1.1.2.cmml" xref="S4.Ex9.m1.1.1.1.2"></times><ci id="S4.Ex9.m1.1.1.1.3.cmml" xref="S4.Ex9.m1.1.1.1.3">𝑓</ci><apply id="S4.Ex9.m1.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex9.m1.1.1.1.1.1.1.2.cmml" xref="S4.Ex9.m1.1.1.1.1.1.1.2">𝑒</ci><apply id="S4.Ex9.m1.1.1.1.1.1.1.3.cmml" xref="S4.Ex9.m1.1.1.1.1.1.1.3"><times id="S4.Ex9.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex9.m1.1.1.1.1.1.1.3.1"></times><ci id="S4.Ex9.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex9.m1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="S4.Ex9.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex9.m1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S4.Ex9.m1.1.1.1.1.1.1.3.4.cmml" xref="S4.Ex9.m1.1.1.1.1.1.1.3.4">𝑤</ci></apply></apply></apply><apply id="S4.Ex9.m1.2.2.2.cmml" xref="S4.Ex9.m1.2.2.2"><times id="S4.Ex9.m1.2.2.2.2.cmml" xref="S4.Ex9.m1.2.2.2.2"></times><ci id="S4.Ex9.m1.2.2.2.3.cmml" xref="S4.Ex9.m1.2.2.2.3">MLP</ci><apply id="S4.Ex9.m1.2.2.2.1.1.1.cmml" xref="S4.Ex9.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.Ex9.m1.2.2.2.1.1.1.1.cmml" xref="S4.Ex9.m1.2.2.2.1.1">subscript</csymbol><ci id="S4.Ex9.m1.2.2.2.1.1.1.2.cmml" xref="S4.Ex9.m1.2.2.2.1.1.1.2">𝐡</ci><ci id="S4.Ex9.m1.2.2.2.1.1.1.3.cmml" xref="S4.Ex9.m1.2.2.2.1.1.1.3">ICL</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex9.m1.2c">f(e^{new})=\rm MLP(\mathbf{h}_{ICL})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex9.m1.2d">italic_f ( italic_e start_POSTSUPERSCRIPT italic_n italic_e italic_w end_POSTSUPERSCRIPT ) = roman_MLP ( bold_h start_POSTSUBSCRIPT roman_ICL end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS2.p1.6">For different anomaly types, we can build multiple ICL templates by using a few labeled samples for each type. The reprogrammed vector of <math alttext="e^{new}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.6.m1.1"><semantics id="S4.SS3.SSS2.p1.6.m1.1a"><msup id="S4.SS3.SSS2.p1.6.m1.1.1" xref="S4.SS3.SSS2.p1.6.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p1.6.m1.1.1.2" xref="S4.SS3.SSS2.p1.6.m1.1.1.2.cmml">e</mi><mrow id="S4.SS3.SSS2.p1.6.m1.1.1.3" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.cmml"><mi id="S4.SS3.SSS2.p1.6.m1.1.1.3.2" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.2.cmml">n</mi><mo id="S4.SS3.SSS2.p1.6.m1.1.1.3.1" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p1.6.m1.1.1.3.3" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.3.cmml">e</mi><mo id="S4.SS3.SSS2.p1.6.m1.1.1.3.1a" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p1.6.m1.1.1.3.4" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.4.cmml">w</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.6.m1.1b"><apply id="S4.SS3.SSS2.p1.6.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.6.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.6.m1.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p1.6.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p1.6.m1.1.1.2">𝑒</ci><apply id="S4.SS3.SSS2.p1.6.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p1.6.m1.1.1.3"><times id="S4.SS3.SSS2.p1.6.m1.1.1.3.1.cmml" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.1"></times><ci id="S4.SS3.SSS2.p1.6.m1.1.1.3.2.cmml" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.2">𝑛</ci><ci id="S4.SS3.SSS2.p1.6.m1.1.1.3.3.cmml" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.3">𝑒</ci><ci id="S4.SS3.SSS2.p1.6.m1.1.1.3.4.cmml" xref="S4.SS3.SSS2.p1.6.m1.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.6.m1.1c">e^{new}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.6.m1.1d">italic_e start_POSTSUPERSCRIPT italic_n italic_e italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> is embedded in these templates to generate the edge embedding and the anomaly probability of various anomaly types. Due to the causal attention mechanism of our backbone LLM, both the embedding of a few labeled edges and the intermediate embedding of ICL templates can be precomputed in advance. Once the reprogramed vector is generated, AnomalyLLM conducts constant operations to obtain the anomaly probability, leading to high efficiency. Next, we further analyze the complexity of AnomalyLLM to illustrate this character.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Complexity Analysis of AnomalyLLM</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Due to the limitations of space, we only analyze the inference complexity here. The complexity of model training is detailed in the Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS2" title="A.2. Detail of Prompt ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">A.2</span></a>. Given the well-optimized model, AnomalyLLM involve four parts to detect an edge <math alttext="e^{t}_{i,j}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.2"><semantics id="S4.SS4.p1.1.m1.2a"><msubsup id="S4.SS4.p1.1.m1.2.3" xref="S4.SS4.p1.1.m1.2.3.cmml"><mi id="S4.SS4.p1.1.m1.2.3.2.2" xref="S4.SS4.p1.1.m1.2.3.2.2.cmml">e</mi><mrow id="S4.SS4.p1.1.m1.2.2.2.4" xref="S4.SS4.p1.1.m1.2.2.2.3.cmml"><mi id="S4.SS4.p1.1.m1.1.1.1.1" xref="S4.SS4.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS4.p1.1.m1.2.2.2.4.1" xref="S4.SS4.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS4.p1.1.m1.2.2.2.2" xref="S4.SS4.p1.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS4.p1.1.m1.2.3.2.3" xref="S4.SS4.p1.1.m1.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.2b"><apply id="S4.SS4.p1.1.m1.2.3.cmml" xref="S4.SS4.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.2.3.1.cmml" xref="S4.SS4.p1.1.m1.2.3">subscript</csymbol><apply id="S4.SS4.p1.1.m1.2.3.2.cmml" xref="S4.SS4.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.2.3.2.1.cmml" xref="S4.SS4.p1.1.m1.2.3">superscript</csymbol><ci id="S4.SS4.p1.1.m1.2.3.2.2.cmml" xref="S4.SS4.p1.1.m1.2.3.2.2">𝑒</ci><ci id="S4.SS4.p1.1.m1.2.3.2.3.cmml" xref="S4.SS4.p1.1.m1.2.3.2.3">𝑡</ci></apply><list id="S4.SS4.p1.1.m1.2.2.2.3.cmml" xref="S4.SS4.p1.1.m1.2.2.2.4"><ci id="S4.SS4.p1.1.m1.1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS4.p1.1.m1.2.2.2.2.cmml" xref="S4.SS4.p1.1.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.2c">e^{t}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.2d">italic_e start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, <em class="ltx_emph ltx_font_italic" id="S4.SS4.p1.1.1">i.e.</em>, subgraph construction, dynamic-aware embedding computation, reprogramming and ICL inference of LLM.</p>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.6">For subgraph construction, AnomalyLLM select <math alttext="K" class="ltx_Math" display="inline" id="S4.I2.i1.p1.1.m1.1"><semantics id="S4.I2.i1.p1.1.m1.1a"><mi id="S4.I2.i1.p1.1.m1.1.1" xref="S4.I2.i1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.1.m1.1b"><ci id="S4.I2.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.1.m1.1d">italic_K</annotation></semantics></math> related nodes for nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.2.m2.1"><semantics id="S4.I2.i1.p1.2.m2.1a"><msub id="S4.I2.i1.p1.2.m2.1.1" xref="S4.I2.i1.p1.2.m2.1.1.cmml"><mi id="S4.I2.i1.p1.2.m2.1.1.2" xref="S4.I2.i1.p1.2.m2.1.1.2.cmml">v</mi><mi id="S4.I2.i1.p1.2.m2.1.1.3" xref="S4.I2.i1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.2.m2.1b"><apply id="S4.I2.i1.p1.2.m2.1.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.2.m2.1.1.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.2.m2.1.1.2.cmml" xref="S4.I2.i1.p1.2.m2.1.1.2">𝑣</ci><ci id="S4.I2.i1.p1.2.m2.1.1.3.cmml" xref="S4.I2.i1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.2.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.3.m3.1"><semantics id="S4.I2.i1.p1.3.m3.1a"><msub id="S4.I2.i1.p1.3.m3.1.1" xref="S4.I2.i1.p1.3.m3.1.1.cmml"><mi id="S4.I2.i1.p1.3.m3.1.1.2" xref="S4.I2.i1.p1.3.m3.1.1.2.cmml">v</mi><mi id="S4.I2.i1.p1.3.m3.1.1.3" xref="S4.I2.i1.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.3.m3.1b"><apply id="S4.I2.i1.p1.3.m3.1.1.cmml" xref="S4.I2.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.3.m3.1.1.1.cmml" xref="S4.I2.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.3.m3.1.1.2.cmml" xref="S4.I2.i1.p1.3.m3.1.1.2">𝑣</ci><ci id="S4.I2.i1.p1.3.m3.1.1.3.cmml" xref="S4.I2.i1.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. Cause the diffusion matrix of <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.4.m4.1"><semantics id="S4.I2.i1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.I2.i1.p1.4.m4.1.1" xref="S4.I2.i1.p1.4.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.4.m4.1b"><ci id="S4.I2.i1.p1.4.m4.1.1.cmml" xref="S4.I2.i1.p1.4.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.4.m4.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.4.m4.1d">caligraphic_G</annotation></semantics></math> at all timestamps can be precomputed, the complexity of this part is <math alttext="O(\Gamma\times K)" class="ltx_Math" display="inline" id="S4.I2.i1.p1.5.m5.1"><semantics id="S4.I2.i1.p1.5.m5.1a"><mrow id="S4.I2.i1.p1.5.m5.1.1" xref="S4.I2.i1.p1.5.m5.1.1.cmml"><mi id="S4.I2.i1.p1.5.m5.1.1.3" xref="S4.I2.i1.p1.5.m5.1.1.3.cmml">O</mi><mo id="S4.I2.i1.p1.5.m5.1.1.2" xref="S4.I2.i1.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i1.p1.5.m5.1.1.1.1" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.cmml"><mo id="S4.I2.i1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i1.p1.5.m5.1.1.1.1.1" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S4.I2.i1.p1.5.m5.1.1.1.1.1.2" mathvariant="normal" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.2.cmml">Γ</mi><mo id="S4.I2.i1.p1.5.m5.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.1.cmml">×</mo><mi id="S4.I2.i1.p1.5.m5.1.1.1.1.1.3" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.3.cmml">K</mi></mrow><mo id="S4.I2.i1.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.5.m5.1b"><apply id="S4.I2.i1.p1.5.m5.1.1.cmml" xref="S4.I2.i1.p1.5.m5.1.1"><times id="S4.I2.i1.p1.5.m5.1.1.2.cmml" xref="S4.I2.i1.p1.5.m5.1.1.2"></times><ci id="S4.I2.i1.p1.5.m5.1.1.3.cmml" xref="S4.I2.i1.p1.5.m5.1.1.3">𝑂</ci><apply id="S4.I2.i1.p1.5.m5.1.1.1.1.1.cmml" xref="S4.I2.i1.p1.5.m5.1.1.1.1"><times id="S4.I2.i1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.1"></times><ci id="S4.I2.i1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.2">Γ</ci><ci id="S4.I2.i1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S4.I2.i1.p1.5.m5.1.1.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.5.m5.1c">O(\Gamma\times K)</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.5.m5.1d">italic_O ( roman_Γ × italic_K )</annotation></semantics></math> where <math alttext="\Gamma" class="ltx_Math" display="inline" id="S4.I2.i1.p1.6.m6.1"><semantics id="S4.I2.i1.p1.6.m6.1a"><mi id="S4.I2.i1.p1.6.m6.1.1" mathvariant="normal" xref="S4.I2.i1.p1.6.m6.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.6.m6.1b"><ci id="S4.I2.i1.p1.6.m6.1.1.cmml" xref="S4.I2.i1.p1.6.m6.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.6.m6.1c">\Gamma</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.6.m6.1d">roman_Γ</annotation></semantics></math> is the temporal window size.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.9">For dynamic-aware embedding, AnomalyLLM takes the nodes in the subgraphs as input and compute the <math alttext="\mathbf{z}_{\mathrm{diff}}(v_{i})" class="ltx_Math" display="inline" id="S4.I2.i2.p1.1.m1.1"><semantics id="S4.I2.i2.p1.1.m1.1a"><mrow id="S4.I2.i2.p1.1.m1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.cmml"><msub id="S4.I2.i2.p1.1.m1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.3.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.3.2" xref="S4.I2.i2.p1.1.m1.1.1.3.2.cmml">𝐳</mi><mi id="S4.I2.i2.p1.1.m1.1.1.3.3" xref="S4.I2.i2.p1.1.m1.1.1.3.3.cmml">diff</mi></msub><mo id="S4.I2.i2.p1.1.m1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.1.m1.1.1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S4.I2.i2.p1.1.m1.1.1.1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.I2.i2.p1.1.m1.1.1.1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.1.m1.1b"><apply id="S4.I2.i2.p1.1.m1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1"><times id="S4.I2.i2.p1.1.m1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.2"></times><apply id="S4.I2.i2.p1.1.m1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.2">𝐳</ci><ci id="S4.I2.i2.p1.1.m1.1.1.3.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3">diff</ci></apply><apply id="S4.I2.i2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.2">𝑣</ci><ci id="S4.I2.i2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.1.m1.1c">\mathbf{z}_{\mathrm{diff}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.1.m1.1d">bold_z start_POSTSUBSCRIPT roman_diff end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="\mathbf{z}_{\mathrm{dist}}(v_{i})" class="ltx_Math" display="inline" id="S4.I2.i2.p1.2.m2.1"><semantics id="S4.I2.i2.p1.2.m2.1a"><mrow id="S4.I2.i2.p1.2.m2.1.1" xref="S4.I2.i2.p1.2.m2.1.1.cmml"><msub id="S4.I2.i2.p1.2.m2.1.1.3" xref="S4.I2.i2.p1.2.m2.1.1.3.cmml"><mi id="S4.I2.i2.p1.2.m2.1.1.3.2" xref="S4.I2.i2.p1.2.m2.1.1.3.2.cmml">𝐳</mi><mi id="S4.I2.i2.p1.2.m2.1.1.3.3" xref="S4.I2.i2.p1.2.m2.1.1.3.3.cmml">dist</mi></msub><mo id="S4.I2.i2.p1.2.m2.1.1.2" xref="S4.I2.i2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.2.m2.1.1.1.1" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.I2.i2.p1.2.m2.1.1.1.1.1" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.2.m2.1.1.1.1.1.2" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.2.cmml">v</mi><mi id="S4.I2.i2.p1.2.m2.1.1.1.1.1.3" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.I2.i2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.2.m2.1b"><apply id="S4.I2.i2.p1.2.m2.1.1.cmml" xref="S4.I2.i2.p1.2.m2.1.1"><times id="S4.I2.i2.p1.2.m2.1.1.2.cmml" xref="S4.I2.i2.p1.2.m2.1.1.2"></times><apply id="S4.I2.i2.p1.2.m2.1.1.3.cmml" xref="S4.I2.i2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.I2.i2.p1.2.m2.1.1.3.1.cmml" xref="S4.I2.i2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.I2.i2.p1.2.m2.1.1.3.2.cmml" xref="S4.I2.i2.p1.2.m2.1.1.3.2">𝐳</ci><ci id="S4.I2.i2.p1.2.m2.1.1.3.3.cmml" xref="S4.I2.i2.p1.2.m2.1.1.3.3">dist</ci></apply><apply id="S4.I2.i2.p1.2.m2.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.I2.i2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.2">𝑣</ci><ci id="S4.I2.i2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.2.m2.1c">\mathbf{z}_{\mathrm{dist}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.2.m2.1d">bold_z start_POSTSUBSCRIPT roman_dist end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="\mathbf{z}_{\mathrm{temp}}(v_{i})" class="ltx_Math" display="inline" id="S4.I2.i2.p1.3.m3.1"><semantics id="S4.I2.i2.p1.3.m3.1a"><mrow id="S4.I2.i2.p1.3.m3.1.1" xref="S4.I2.i2.p1.3.m3.1.1.cmml"><msub id="S4.I2.i2.p1.3.m3.1.1.3" xref="S4.I2.i2.p1.3.m3.1.1.3.cmml"><mi id="S4.I2.i2.p1.3.m3.1.1.3.2" xref="S4.I2.i2.p1.3.m3.1.1.3.2.cmml">𝐳</mi><mi id="S4.I2.i2.p1.3.m3.1.1.3.3" xref="S4.I2.i2.p1.3.m3.1.1.3.3.cmml">temp</mi></msub><mo id="S4.I2.i2.p1.3.m3.1.1.2" xref="S4.I2.i2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.3.m3.1.1.1.1" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S4.I2.i2.p1.3.m3.1.1.1.1.1" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.3.m3.1.1.1.1.1.2" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.2.cmml">v</mi><mi id="S4.I2.i2.p1.3.m3.1.1.1.1.1.3" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.I2.i2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.3.m3.1b"><apply id="S4.I2.i2.p1.3.m3.1.1.cmml" xref="S4.I2.i2.p1.3.m3.1.1"><times id="S4.I2.i2.p1.3.m3.1.1.2.cmml" xref="S4.I2.i2.p1.3.m3.1.1.2"></times><apply id="S4.I2.i2.p1.3.m3.1.1.3.cmml" xref="S4.I2.i2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.I2.i2.p1.3.m3.1.1.3.1.cmml" xref="S4.I2.i2.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.I2.i2.p1.3.m3.1.1.3.2.cmml" xref="S4.I2.i2.p1.3.m3.1.1.3.2">𝐳</ci><ci id="S4.I2.i2.p1.3.m3.1.1.3.3.cmml" xref="S4.I2.i2.p1.3.m3.1.1.3.3">temp</ci></apply><apply id="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.I2.i2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.2">𝑣</ci><ci id="S4.I2.i2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.3.m3.1c">\mathbf{z}_{\mathrm{temp}}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.3.m3.1d">bold_z start_POSTSUBSCRIPT roman_temp end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> for each node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.I2.i2.p1.4.m4.1"><semantics id="S4.I2.i2.p1.4.m4.1a"><msub id="S4.I2.i2.p1.4.m4.1.1" xref="S4.I2.i2.p1.4.m4.1.1.cmml"><mi id="S4.I2.i2.p1.4.m4.1.1.2" xref="S4.I2.i2.p1.4.m4.1.1.2.cmml">v</mi><mi id="S4.I2.i2.p1.4.m4.1.1.3" xref="S4.I2.i2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.4.m4.1b"><apply id="S4.I2.i2.p1.4.m4.1.1.cmml" xref="S4.I2.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.4.m4.1.1.1.cmml" xref="S4.I2.i2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I2.i2.p1.4.m4.1.1.2.cmml" xref="S4.I2.i2.p1.4.m4.1.1.2">𝑣</ci><ci id="S4.I2.i2.p1.4.m4.1.1.3.cmml" xref="S4.I2.i2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.4.m4.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as the node features. The complexity of this part is <math alttext="O(3d)" class="ltx_Math" display="inline" id="S4.I2.i2.p1.5.m5.1"><semantics id="S4.I2.i2.p1.5.m5.1a"><mrow id="S4.I2.i2.p1.5.m5.1.1" xref="S4.I2.i2.p1.5.m5.1.1.cmml"><mi id="S4.I2.i2.p1.5.m5.1.1.3" xref="S4.I2.i2.p1.5.m5.1.1.3.cmml">O</mi><mo id="S4.I2.i2.p1.5.m5.1.1.2" xref="S4.I2.i2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.5.m5.1.1.1.1" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.5.m5.1.1.1.1.1" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.cmml"><mn id="S4.I2.i2.p1.5.m5.1.1.1.1.1.2" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.2.cmml">3</mn><mo id="S4.I2.i2.p1.5.m5.1.1.1.1.1.1" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.I2.i2.p1.5.m5.1.1.1.1.1.3" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="S4.I2.i2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.5.m5.1b"><apply id="S4.I2.i2.p1.5.m5.1.1.cmml" xref="S4.I2.i2.p1.5.m5.1.1"><times id="S4.I2.i2.p1.5.m5.1.1.2.cmml" xref="S4.I2.i2.p1.5.m5.1.1.2"></times><ci id="S4.I2.i2.p1.5.m5.1.1.3.cmml" xref="S4.I2.i2.p1.5.m5.1.1.3">𝑂</ci><apply id="S4.I2.i2.p1.5.m5.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.5.m5.1.1.1.1"><times id="S4.I2.i2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.1"></times><cn id="S4.I2.i2.p1.5.m5.1.1.1.1.1.2.cmml" type="integer" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.2">3</cn><ci id="S4.I2.i2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.5.m5.1.1.1.1.1.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.5.m5.1c">O(3d)</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.5.m5.1d">italic_O ( 3 italic_d )</annotation></semantics></math>. Then, the sequence of node features is fed to the Transformer block to obtain node embeddings, with the complexity of <math alttext="O((2(K+1)\Gamma)^{2}d+2(K+1)\Gamma d^{2})" class="ltx_Math" display="inline" id="S4.I2.i2.p1.6.m6.1"><semantics id="S4.I2.i2.p1.6.m6.1a"><mrow id="S4.I2.i2.p1.6.m6.1.1" xref="S4.I2.i2.p1.6.m6.1.1.cmml"><mi id="S4.I2.i2.p1.6.m6.1.1.3" xref="S4.I2.i2.p1.6.m6.1.1.3.cmml">O</mi><mo id="S4.I2.i2.p1.6.m6.1.1.2" xref="S4.I2.i2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.cmml"><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.cmml"><msup id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.cmml"><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2a" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.4" mathvariant="normal" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.4.cmml">Γ</mi></mrow><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.3" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.3.cmml">+</mo><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.cmml"><mn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.3" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.3.cmml">2</mn><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.2" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.2" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.2.cmml">K</mi><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.1" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.1.cmml">+</mo><mn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.3" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.2a" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.4" mathvariant="normal" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.4.cmml">Γ</mi><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.2b" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.2.cmml">⁢</mo><msup id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.cmml"><mi id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.2" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.2.cmml">d</mi><mn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.3" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.I2.i2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.6.m6.1b"><apply id="S4.I2.i2.p1.6.m6.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1"><times id="S4.I2.i2.p1.6.m6.1.1.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.2"></times><ci id="S4.I2.i2.p1.6.m6.1.1.3.cmml" xref="S4.I2.i2.p1.6.m6.1.1.3">𝑂</ci><apply id="S4.I2.i2.p1.6.m6.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1"><plus id="S4.I2.i2.p1.6.m6.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.3"></plus><apply id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1"><times id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.2"></times><apply id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1"><times id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2"></times><cn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.3">2</cn><apply id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐾</ci><cn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.4">Γ</ci></apply><cn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.1.3">2</cn></apply><ci id="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2"><times id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.2"></times><cn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.3">2</cn><apply id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1"><plus id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.1"></plus><ci id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.2">𝐾</ci><cn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.1.1.1.3">1</cn></apply><ci id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.4.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.4">Γ</ci><apply id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.1.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5">superscript</csymbol><ci id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.2.cmml" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.2">𝑑</ci><cn id="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.3.cmml" type="integer" xref="S4.I2.i2.p1.6.m6.1.1.1.1.1.2.5.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.6.m6.1c">O((2(K+1)\Gamma)^{2}d+2(K+1)\Gamma d^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.6.m6.1d">italic_O ( ( 2 ( italic_K + 1 ) roman_Γ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + 2 ( italic_K + 1 ) roman_Γ italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. A GNN layer and average pooling layer of subgraphs is conducted on these embeddings to generate the dynamic-aware embedding <math alttext="\textbf{r}_{i,j}" class="ltx_Math" display="inline" id="S4.I2.i2.p1.7.m7.2"><semantics id="S4.I2.i2.p1.7.m7.2a"><msub id="S4.I2.i2.p1.7.m7.2.3" xref="S4.I2.i2.p1.7.m7.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I2.i2.p1.7.m7.2.3.2" xref="S4.I2.i2.p1.7.m7.2.3.2a.cmml">r</mtext><mrow id="S4.I2.i2.p1.7.m7.2.2.2.4" xref="S4.I2.i2.p1.7.m7.2.2.2.3.cmml"><mi id="S4.I2.i2.p1.7.m7.1.1.1.1" xref="S4.I2.i2.p1.7.m7.1.1.1.1.cmml">i</mi><mo id="S4.I2.i2.p1.7.m7.2.2.2.4.1" xref="S4.I2.i2.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S4.I2.i2.p1.7.m7.2.2.2.2" xref="S4.I2.i2.p1.7.m7.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.7.m7.2b"><apply id="S4.I2.i2.p1.7.m7.2.3.cmml" xref="S4.I2.i2.p1.7.m7.2.3"><csymbol cd="ambiguous" id="S4.I2.i2.p1.7.m7.2.3.1.cmml" xref="S4.I2.i2.p1.7.m7.2.3">subscript</csymbol><ci id="S4.I2.i2.p1.7.m7.2.3.2a.cmml" xref="S4.I2.i2.p1.7.m7.2.3.2"><mtext class="ltx_mathvariant_bold" id="S4.I2.i2.p1.7.m7.2.3.2.cmml" xref="S4.I2.i2.p1.7.m7.2.3.2">r</mtext></ci><list id="S4.I2.i2.p1.7.m7.2.2.2.3.cmml" xref="S4.I2.i2.p1.7.m7.2.2.2.4"><ci id="S4.I2.i2.p1.7.m7.1.1.1.1.cmml" xref="S4.I2.i2.p1.7.m7.1.1.1.1">𝑖</ci><ci id="S4.I2.i2.p1.7.m7.2.2.2.2.cmml" xref="S4.I2.i2.p1.7.m7.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.7.m7.2c">\textbf{r}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.7.m7.2d">r start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and the complexity is <math alttext="O((K+1)^{2}\Gamma d)" class="ltx_Math" display="inline" id="S4.I2.i2.p1.8.m8.1"><semantics id="S4.I2.i2.p1.8.m8.1a"><mrow id="S4.I2.i2.p1.8.m8.1.1" xref="S4.I2.i2.p1.8.m8.1.1.cmml"><mi id="S4.I2.i2.p1.8.m8.1.1.3" xref="S4.I2.i2.p1.8.m8.1.1.3.cmml">O</mi><mo id="S4.I2.i2.p1.8.m8.1.1.2" xref="S4.I2.i2.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.8.m8.1.1.1.1" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.8.m8.1.1.1.1.1" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.cmml"><msup id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.cmml"><mrow id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mo id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.I2.i2.p1.8.m8.1.1.1.1.1.2" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.I2.i2.p1.8.m8.1.1.1.1.1.3" mathvariant="normal" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.3.cmml">Γ</mi><mo id="S4.I2.i2.p1.8.m8.1.1.1.1.1.2a" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.I2.i2.p1.8.m8.1.1.1.1.1.4" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="S4.I2.i2.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.8.m8.1b"><apply id="S4.I2.i2.p1.8.m8.1.1.cmml" xref="S4.I2.i2.p1.8.m8.1.1"><times id="S4.I2.i2.p1.8.m8.1.1.2.cmml" xref="S4.I2.i2.p1.8.m8.1.1.2"></times><ci id="S4.I2.i2.p1.8.m8.1.1.3.cmml" xref="S4.I2.i2.p1.8.m8.1.1.3">𝑂</ci><apply id="S4.I2.i2.p1.8.m8.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1"><times id="S4.I2.i2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.2"></times><apply id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1">superscript</csymbol><apply id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1"><plus id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.2">𝐾</ci><cn id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.1.1.1.3">1</cn></apply><cn id="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.1.3">2</cn></apply><ci id="S4.I2.i2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.3">Γ</ci><ci id="S4.I2.i2.p1.8.m8.1.1.1.1.1.4.cmml" xref="S4.I2.i2.p1.8.m8.1.1.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.8.m8.1c">O((K+1)^{2}\Gamma d)</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.8.m8.1d">italic_O ( ( italic_K + 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_Γ italic_d )</annotation></semantics></math>. Therefore, the complexity of this part is <math alttext="O((K+1)^{2}\Gamma^{2}d+(K+1)\Gamma d^{2})" class="ltx_Math" display="inline" id="S4.I2.i2.p1.9.m9.1"><semantics id="S4.I2.i2.p1.9.m9.1a"><mrow id="S4.I2.i2.p1.9.m9.1.1" xref="S4.I2.i2.p1.9.m9.1.1.cmml"><mi id="S4.I2.i2.p1.9.m9.1.1.3" xref="S4.I2.i2.p1.9.m9.1.1.3.cmml">O</mi><mo id="S4.I2.i2.p1.9.m9.1.1.2" xref="S4.I2.i2.p1.9.m9.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.9.m9.1.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.9.m9.1.1.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.cmml"><mrow id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.cmml"><msup id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.cmml"><mrow id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.cmml"><mi id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.2.cmml">Γ</mi><mn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.3" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.3.cmml">2</mn></msup><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.2a" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.4" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.3" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.3.cmml">+</mo><mrow id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.cmml"><mrow id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.2" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.2.cmml">K</mi><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.1" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.1.cmml">+</mo><mn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.3" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.2" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.3" mathvariant="normal" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.3.cmml">Γ</mi><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.2a" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.2.cmml">⁢</mo><msup id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.cmml"><mi id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.2" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.2.cmml">d</mi><mn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.3" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.I2.i2.p1.9.m9.1.1.1.1.3" stretchy="false" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.9.m9.1b"><apply id="S4.I2.i2.p1.9.m9.1.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1"><times id="S4.I2.i2.p1.9.m9.1.1.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.2"></times><ci id="S4.I2.i2.p1.9.m9.1.1.3.cmml" xref="S4.I2.i2.p1.9.m9.1.1.3">𝑂</ci><apply id="S4.I2.i2.p1.9.m9.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1"><plus id="S4.I2.i2.p1.9.m9.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.3"></plus><apply id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1"><times id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.2"></times><apply id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1"><plus id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.2">𝐾</ci><cn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><cn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.2">Γ</ci><cn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.3.3">2</cn></apply><ci id="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.4.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.1.4">𝑑</ci></apply><apply id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2"><times id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.2"></times><apply id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1"><plus id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.1"></plus><ci id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.2">𝐾</ci><cn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.1.1.1.3">1</cn></apply><ci id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.3.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.3">Γ</ci><apply id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.1.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4">superscript</csymbol><ci id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.2.cmml" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.2">𝑑</ci><cn id="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S4.I2.i2.p1.9.m9.1.1.1.1.1.2.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.9.m9.1c">O((K+1)^{2}\Gamma^{2}d+(K+1)\Gamma d^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.9.m9.1d">italic_O ( ( italic_K + 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_Γ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + ( italic_K + 1 ) roman_Γ italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.3">AnomalyLLM utilizes self attention to reprogram <math alttext="\textbf{r}_{i,j}" class="ltx_Math" display="inline" id="S4.I2.i3.p1.1.m1.2"><semantics id="S4.I2.i3.p1.1.m1.2a"><msub id="S4.I2.i3.p1.1.m1.2.3" xref="S4.I2.i3.p1.1.m1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I2.i3.p1.1.m1.2.3.2" xref="S4.I2.i3.p1.1.m1.2.3.2a.cmml">r</mtext><mrow id="S4.I2.i3.p1.1.m1.2.2.2.4" xref="S4.I2.i3.p1.1.m1.2.2.2.3.cmml"><mi id="S4.I2.i3.p1.1.m1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.I2.i3.p1.1.m1.2.2.2.4.1" xref="S4.I2.i3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.I2.i3.p1.1.m1.2.2.2.2" xref="S4.I2.i3.p1.1.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.1.m1.2b"><apply id="S4.I2.i3.p1.1.m1.2.3.cmml" xref="S4.I2.i3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.2.3.1.cmml" xref="S4.I2.i3.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I2.i3.p1.1.m1.2.3.2a.cmml" xref="S4.I2.i3.p1.1.m1.2.3.2"><mtext class="ltx_mathvariant_bold" id="S4.I2.i3.p1.1.m1.2.3.2.cmml" xref="S4.I2.i3.p1.1.m1.2.3.2">r</mtext></ci><list id="S4.I2.i3.p1.1.m1.2.2.2.3.cmml" xref="S4.I2.i3.p1.1.m1.2.2.2.4"><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.I2.i3.p1.1.m1.2.2.2.2.cmml" xref="S4.I2.i3.p1.1.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.1.m1.2c">\textbf{r}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i3.p1.1.m1.2d">r start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and generate <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.I2.i3.p1.3.1">m</span>. The complexity is <math alttext="O(V^{\prime}d+V^{\prime}d^{2})=O(V^{\prime}d^{2})" class="ltx_Math" display="inline" id="S4.I2.i3.p1.3.m3.2"><semantics id="S4.I2.i3.p1.3.m3.2a"><mrow id="S4.I2.i3.p1.3.m3.2.2" xref="S4.I2.i3.p1.3.m3.2.2.cmml"><mrow id="S4.I2.i3.p1.3.m3.1.1.1" xref="S4.I2.i3.p1.3.m3.1.1.1.cmml"><mi id="S4.I2.i3.p1.3.m3.1.1.1.3" xref="S4.I2.i3.p1.3.m3.1.1.1.3.cmml">O</mi><mo id="S4.I2.i3.p1.3.m3.1.1.1.2" xref="S4.I2.i3.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i3.p1.3.m3.1.1.1.1.1" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S4.I2.i3.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.cmml"><mrow id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.cmml"><msup id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.cmml"><mi id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.2" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.2.cmml">V</mi><mo id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.3" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.3.cmml">′</mo></msup><mo id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.1" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.3" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.3.cmml">d</mi></mrow><mo id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.1" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.cmml"><msup id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.cmml"><mi id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.2" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.2.cmml">V</mi><mo id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.3" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.3.cmml">′</mo></msup><mo id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.1" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.cmml"><mi id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.2" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.2.cmml">d</mi><mn id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.3" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.I2.i3.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I2.i3.p1.3.m3.2.2.3" xref="S4.I2.i3.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S4.I2.i3.p1.3.m3.2.2.2" xref="S4.I2.i3.p1.3.m3.2.2.2.cmml"><mi id="S4.I2.i3.p1.3.m3.2.2.2.3" xref="S4.I2.i3.p1.3.m3.2.2.2.3.cmml">O</mi><mo id="S4.I2.i3.p1.3.m3.2.2.2.2" xref="S4.I2.i3.p1.3.m3.2.2.2.2.cmml">⁢</mo><mrow id="S4.I2.i3.p1.3.m3.2.2.2.1.1" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.cmml"><mo id="S4.I2.i3.p1.3.m3.2.2.2.1.1.2" stretchy="false" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.cmml"><msup id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.cmml"><mi id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.2" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.2.cmml">V</mi><mo id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.3" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.3.cmml">′</mo></msup><mo id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.1" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.cmml"><mi id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.2" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.2.cmml">d</mi><mn id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.3" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S4.I2.i3.p1.3.m3.2.2.2.1.1.3" stretchy="false" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.3.m3.2b"><apply id="S4.I2.i3.p1.3.m3.2.2.cmml" xref="S4.I2.i3.p1.3.m3.2.2"><eq id="S4.I2.i3.p1.3.m3.2.2.3.cmml" xref="S4.I2.i3.p1.3.m3.2.2.3"></eq><apply id="S4.I2.i3.p1.3.m3.1.1.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1"><times id="S4.I2.i3.p1.3.m3.1.1.1.2.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.2"></times><ci id="S4.I2.i3.p1.3.m3.1.1.1.3.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.3">𝑂</ci><apply id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1"><plus id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.1"></plus><apply id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2"><times id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.1"></times><apply id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.2">𝑉</ci><ci id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.3.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.2.3">′</ci></apply><ci id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3"><times id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.1"></times><apply id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.2">𝑉</ci><ci id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.2.3">′</ci></apply><apply id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.2.cmml" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.2">𝑑</ci><cn id="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply><apply id="S4.I2.i3.p1.3.m3.2.2.2.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2"><times id="S4.I2.i3.p1.3.m3.2.2.2.2.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.2"></times><ci id="S4.I2.i3.p1.3.m3.2.2.2.3.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.3">𝑂</ci><apply id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1"><times id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.1.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.1"></times><apply id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.1.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2">superscript</csymbol><ci id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.2.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.2">𝑉</ci><ci id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.3.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.2.3">′</ci></apply><apply id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.1.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3">superscript</csymbol><ci id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.2.cmml" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.2">𝑑</ci><cn id="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S4.I2.i3.p1.3.m3.2.2.2.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.3.m3.2c">O(V^{\prime}d+V^{\prime}d^{2})=O(V^{\prime}d^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i3.p1.3.m3.2d">italic_O ( italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_d + italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = italic_O ( italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.4">Due to the causal attention of LLM, the hidden states of the ICL template are the same except for the last ¡Edge¿ embedding <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.I2.i4.p1.4.1">h</span>. Thus, for the inference of LLM, AnomalyLLM precomputes and stores the intermediate hidden state of ICL template, and directly conducts <math alttext="O(Y)" class="ltx_Math" display="inline" id="S4.I2.i4.p1.2.m2.1"><semantics id="S4.I2.i4.p1.2.m2.1a"><mrow id="S4.I2.i4.p1.2.m2.1.2" xref="S4.I2.i4.p1.2.m2.1.2.cmml"><mi id="S4.I2.i4.p1.2.m2.1.2.2" xref="S4.I2.i4.p1.2.m2.1.2.2.cmml">O</mi><mo id="S4.I2.i4.p1.2.m2.1.2.1" xref="S4.I2.i4.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.I2.i4.p1.2.m2.1.2.3.2" xref="S4.I2.i4.p1.2.m2.1.2.cmml"><mo id="S4.I2.i4.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.I2.i4.p1.2.m2.1.2.cmml">(</mo><mi id="S4.I2.i4.p1.2.m2.1.1" xref="S4.I2.i4.p1.2.m2.1.1.cmml">Y</mi><mo id="S4.I2.i4.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.I2.i4.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.2.m2.1b"><apply id="S4.I2.i4.p1.2.m2.1.2.cmml" xref="S4.I2.i4.p1.2.m2.1.2"><times id="S4.I2.i4.p1.2.m2.1.2.1.cmml" xref="S4.I2.i4.p1.2.m2.1.2.1"></times><ci id="S4.I2.i4.p1.2.m2.1.2.2.cmml" xref="S4.I2.i4.p1.2.m2.1.2.2">𝑂</ci><ci id="S4.I2.i4.p1.2.m2.1.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.2.m2.1c">O(Y)</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.2.m2.1d">italic_O ( italic_Y )</annotation></semantics></math> feed-forward operations to obtain <math alttext="\mathbf{h}" class="ltx_Math" display="inline" id="S4.I2.i4.p1.3.m3.1"><semantics id="S4.I2.i4.p1.3.m3.1a"><mi id="S4.I2.i4.p1.3.m3.1.1" xref="S4.I2.i4.p1.3.m3.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.3.m3.1b"><ci id="S4.I2.i4.p1.3.m3.1.1.cmml" xref="S4.I2.i4.p1.3.m3.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.3.m3.1c">\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.3.m3.1d">bold_h</annotation></semantics></math>, where <math alttext="Y" class="ltx_Math" display="inline" id="S4.I2.i4.p1.4.m4.1"><semantics id="S4.I2.i4.p1.4.m4.1a"><mi id="S4.I2.i4.p1.4.m4.1.1" xref="S4.I2.i4.p1.4.m4.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.4.m4.1b"><ci id="S4.I2.i4.p1.4.m4.1.1.cmml" xref="S4.I2.i4.p1.4.m4.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.4.m4.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.4.m4.1d">italic_Y</annotation></semantics></math> is the number of Transformer layers in LLM.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS4.p1.8">According to the analysis, the complexity of detecting <math alttext="e^{t}_{i,j}" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m1.2"><semantics id="S4.SS4.p1.2.m1.2a"><msubsup id="S4.SS4.p1.2.m1.2.3" xref="S4.SS4.p1.2.m1.2.3.cmml"><mi id="S4.SS4.p1.2.m1.2.3.2.2" xref="S4.SS4.p1.2.m1.2.3.2.2.cmml">e</mi><mrow id="S4.SS4.p1.2.m1.2.2.2.4" xref="S4.SS4.p1.2.m1.2.2.2.3.cmml"><mi id="S4.SS4.p1.2.m1.1.1.1.1" xref="S4.SS4.p1.2.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS4.p1.2.m1.2.2.2.4.1" xref="S4.SS4.p1.2.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS4.p1.2.m1.2.2.2.2" xref="S4.SS4.p1.2.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS4.p1.2.m1.2.3.2.3" xref="S4.SS4.p1.2.m1.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m1.2b"><apply id="S4.SS4.p1.2.m1.2.3.cmml" xref="S4.SS4.p1.2.m1.2.3"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m1.2.3.1.cmml" xref="S4.SS4.p1.2.m1.2.3">subscript</csymbol><apply id="S4.SS4.p1.2.m1.2.3.2.cmml" xref="S4.SS4.p1.2.m1.2.3"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m1.2.3.2.1.cmml" xref="S4.SS4.p1.2.m1.2.3">superscript</csymbol><ci id="S4.SS4.p1.2.m1.2.3.2.2.cmml" xref="S4.SS4.p1.2.m1.2.3.2.2">𝑒</ci><ci id="S4.SS4.p1.2.m1.2.3.2.3.cmml" xref="S4.SS4.p1.2.m1.2.3.2.3">𝑡</ci></apply><list id="S4.SS4.p1.2.m1.2.2.2.3.cmml" xref="S4.SS4.p1.2.m1.2.2.2.4"><ci id="S4.SS4.p1.2.m1.1.1.1.1.cmml" xref="S4.SS4.p1.2.m1.1.1.1.1">𝑖</ci><ci id="S4.SS4.p1.2.m1.2.2.2.2.cmml" xref="S4.SS4.p1.2.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m1.2c">e^{t}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m1.2d">italic_e start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the summarization of the four parts. Note that <math alttext="\Gamma" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m2.1"><semantics id="S4.SS4.p1.3.m2.1a"><mi id="S4.SS4.p1.3.m2.1.1" mathvariant="normal" xref="S4.SS4.p1.3.m2.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m2.1b"><ci id="S4.SS4.p1.3.m2.1.1.cmml" xref="S4.SS4.p1.3.m2.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m2.1c">\Gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m2.1d">roman_Γ</annotation></semantics></math>, <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m3.1"><semantics id="S4.SS4.p1.4.m3.1a"><mi id="S4.SS4.p1.4.m3.1.1" xref="S4.SS4.p1.4.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m3.1b"><ci id="S4.SS4.p1.4.m3.1.1.cmml" xref="S4.SS4.p1.4.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m3.1d">italic_K</annotation></semantics></math>, <math alttext="d" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m4.1"><semantics id="S4.SS4.p1.5.m4.1a"><mi id="S4.SS4.p1.5.m4.1.1" xref="S4.SS4.p1.5.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m4.1b"><ci id="S4.SS4.p1.5.m4.1.1.cmml" xref="S4.SS4.p1.5.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m4.1d">italic_d</annotation></semantics></math>, <math alttext="V^{\prime}" class="ltx_Math" display="inline" id="S4.SS4.p1.6.m5.1"><semantics id="S4.SS4.p1.6.m5.1a"><msup id="S4.SS4.p1.6.m5.1.1" xref="S4.SS4.p1.6.m5.1.1.cmml"><mi id="S4.SS4.p1.6.m5.1.1.2" xref="S4.SS4.p1.6.m5.1.1.2.cmml">V</mi><mo id="S4.SS4.p1.6.m5.1.1.3" xref="S4.SS4.p1.6.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m5.1b"><apply id="S4.SS4.p1.6.m5.1.1.cmml" xref="S4.SS4.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m5.1.1.1.cmml" xref="S4.SS4.p1.6.m5.1.1">superscript</csymbol><ci id="S4.SS4.p1.6.m5.1.1.2.cmml" xref="S4.SS4.p1.6.m5.1.1.2">𝑉</ci><ci id="S4.SS4.p1.6.m5.1.1.3.cmml" xref="S4.SS4.p1.6.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m5.1c">V^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.6.m5.1d">italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="L" class="ltx_Math" display="inline" id="S4.SS4.p1.7.m6.1"><semantics id="S4.SS4.p1.7.m6.1a"><mi id="S4.SS4.p1.7.m6.1.1" xref="S4.SS4.p1.7.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m6.1b"><ci id="S4.SS4.p1.7.m6.1.1.cmml" xref="S4.SS4.p1.7.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.7.m6.1d">italic_L</annotation></semantics></math> are constant for AnomalyLLM, the inference complexity to detect <math alttext="e^{t}_{i,j}" class="ltx_Math" display="inline" id="S4.SS4.p1.8.m7.2"><semantics id="S4.SS4.p1.8.m7.2a"><msubsup id="S4.SS4.p1.8.m7.2.3" xref="S4.SS4.p1.8.m7.2.3.cmml"><mi id="S4.SS4.p1.8.m7.2.3.2.2" xref="S4.SS4.p1.8.m7.2.3.2.2.cmml">e</mi><mrow id="S4.SS4.p1.8.m7.2.2.2.4" xref="S4.SS4.p1.8.m7.2.2.2.3.cmml"><mi id="S4.SS4.p1.8.m7.1.1.1.1" xref="S4.SS4.p1.8.m7.1.1.1.1.cmml">i</mi><mo id="S4.SS4.p1.8.m7.2.2.2.4.1" xref="S4.SS4.p1.8.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS4.p1.8.m7.2.2.2.2" xref="S4.SS4.p1.8.m7.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS4.p1.8.m7.2.3.2.3" xref="S4.SS4.p1.8.m7.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m7.2b"><apply id="S4.SS4.p1.8.m7.2.3.cmml" xref="S4.SS4.p1.8.m7.2.3"><csymbol cd="ambiguous" id="S4.SS4.p1.8.m7.2.3.1.cmml" xref="S4.SS4.p1.8.m7.2.3">subscript</csymbol><apply id="S4.SS4.p1.8.m7.2.3.2.cmml" xref="S4.SS4.p1.8.m7.2.3"><csymbol cd="ambiguous" id="S4.SS4.p1.8.m7.2.3.2.1.cmml" xref="S4.SS4.p1.8.m7.2.3">superscript</csymbol><ci id="S4.SS4.p1.8.m7.2.3.2.2.cmml" xref="S4.SS4.p1.8.m7.2.3.2.2">𝑒</ci><ci id="S4.SS4.p1.8.m7.2.3.2.3.cmml" xref="S4.SS4.p1.8.m7.2.3.2.3">𝑡</ci></apply><list id="S4.SS4.p1.8.m7.2.2.2.3.cmml" xref="S4.SS4.p1.8.m7.2.2.2.4"><ci id="S4.SS4.p1.8.m7.1.1.1.1.cmml" xref="S4.SS4.p1.8.m7.1.1.1.1">𝑖</ci><ci id="S4.SS4.p1.8.m7.2.2.2.2.cmml" xref="S4.SS4.p1.8.m7.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m7.2c">e^{t}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.8.m7.2d">italic_e start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is also a constant.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span> Performance comparison results of few-shot anomaly detection on multiple anomaly types.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.1.1.1.2" rowspan="2"><span class="ltx_text" id="S5.T1.1.1.1.2.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T1.1.1.1.3">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T1.1.1.1.4">5-shot</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T1.1.1.1.5">10-shot</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.2.2">
<td class="ltx_td ltx_align_center" id="S5.T1.1.2.2.1">CDA</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.2.2.2">LPL</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.2.2.3">HHL</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.2.2.4">CDA</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.2.2.5">LPL</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.2.2.6">HHL</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.2.2.7">CDA</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.2.2.8">LPL</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.2.2.9">HHL</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.1.3.3.1">StrGNN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.3.2">0.5891</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.3.3">0.5756</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.3.3.4">0.5974</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.3.5">0.6018</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.3.6">0.6041</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.3.3.7">0.6122</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.3.8">0.6222</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.3.9">0.6329</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.3.10">0.6402</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.4.4.1" rowspan="6"><span class="ltx_text" id="S5.T1.1.4.4.1.1">BlogCataLog</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.4.4.2">AddGraph</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.4.3">0.5994</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.4.4">0.6023</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.4.4.5">0.5988</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.4.6">0.6097</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.4.7">0.6033</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.4.4.8">0.6104</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.4.9">0.6216</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.4.10">0.6238</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.4.11">0.6172</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.5.5.1">Deep Walk</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.5.2">0.6102</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.5.3">0.6073</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.5.5.4">0.6202</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.5.5">0.6113</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.5.6">0.6122</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.5.5.7">0.6196</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.5.8">0.6155</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.5.9">0.6176</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.5.10">0.6154</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.6.6.1">TGN</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.6.2">0.6732</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.6.3">0.6699</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.6.6.4">0.6919</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.6.5">0.7112</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.6.6">0.7023</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.6.6.7">0.7118</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.6.8">0.7263</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.6.9">0.7387</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.6.10">0.7311</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.7.7.1">GDN</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.7.2">0.6733</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.7.3">0.6795</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.7.7.4">0.6609</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.7.5">0.6997</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.7.6">0.7051</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.7.7.7">0.7121</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.7.8">0.7321</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.7.9">0.7311</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.7.10">0.7319</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.8.8.1">SAD</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.8.8.2">0.6841</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.8.8.3">0.6792</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.8.8.4">0.6411</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.8.8.5">0.7002</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.8.8.6">0.7018</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.8.8.7">0.6988</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.8.8.8">0.7342</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.8.8.9">0.7216</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.8.8.10">0.7265</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.9.9.1">TADDY</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.9.2">0.6892</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.9.3">0.6983</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.9.9.4">0.6891</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.9.5">0.7148</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.9.6">0.7186</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.9.9.7">0.7177</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.9.8">0.7258</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.9.9">0.7326</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.9.10">0.7334</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.10.10.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.1.1">AnomalyLLM</span></th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.10.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.2.1">0.8288</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.10.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.3.1">0.8334</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.10.10.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.4.1">0.8255</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.10.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.5.1">0.8331</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.10.6"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.6.1">0.8319</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.10.10.7"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.7.1">0.8407</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.10.8"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.8.1">0.8402</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.10.9"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.9.1">0.8456</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.10.10"><span class="ltx_text ltx_font_bold" id="S5.T1.1.10.10.10.1">0.8447</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.1.11.11.1"><span class="ltx_text" id="S5.T1.1.11.11.1.1">UCI</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.1.11.11.2">StrGNN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.11.11.3">0.6143</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.11.11.4">0.5956</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.11.11.5">0.5722</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.11.11.6">0.6113</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.11.11.7">0.7132</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.11.11.8">0.6512</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.11.11.9">0.6442</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.11.11.10">0.6724</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.11.11.11">0.6249</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.12.12.1" rowspan="6"><span class="ltx_text" id="S5.T1.1.12.12.1.1">Message</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.12.12.2">AddGraph</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.12.12.3">0.5842</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.12.12.4">0.5466</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.12.12.5">0.5647</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.12.12.6">0.6018</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.12.12.7">0.6667</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.12.12.8">0.6321</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.12.12.9">0.4642</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.12.12.10">0.5728</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.12.12.11">0.7001</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.13.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.13.13.1">Deep Walk</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.13.13.2">0.6198</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.13.13.3">0.6187</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.13.13.4">0.6142</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.13.13.5">0.6256</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.13.13.6">0.6263</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.13.13.7">0.6176</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.13.13.8">0.6255</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.13.13.9">0.6209</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.13.13.10">0.6197</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.14.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.14.14.1">TGN</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.14.14.2">0.6521</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.14.14.3">0.6535</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.14.14.4">0.6643</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.14.14.5">0.7098</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.14.14.6">0.7193</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.14.14.7">0.7155</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.14.14.8">0.7335</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.14.14.9">0.7365</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.14.14.10">0.7324</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.15.15.1">GDN</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.15.15.2">0.6577</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.15.15.3">0.6818</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.15.15.4">0.6611</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.15.15.5">0.7201</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.15.15.6">0.7289</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.15.15.7">0.7255</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.15.15.8">0.7493</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.15.15.9">0.7511</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.15.15.10">0.7546</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.16.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.16.16.1">SAD</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.16.16.2">0.6703</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.16.16.3">0.6587</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.16.16.4">0.6693</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.16.16.5">0.7102</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.16.16.6">0.7146</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.16.16.7">0.7194</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.16.16.8">0.7416</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.16.16.9">0.7453</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.16.16.10">0.7406</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.17.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.17.17.1">TADDY</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.17.17.2">0.6992</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.17.17.3">0.7078</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.17.17.4">0.6132</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.17.17.5">0.7204</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.17.17.6">0.7237</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.17.17.7">0.7218</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.17.17.8">0.7255</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.17.17.9">0.7278</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.17.17.10">0.7243</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T1.1.18.18.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.1.1">AnomalyLLM</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.1.18.18.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.2.1">0.8414</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.1.18.18.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.3.1">0.8358</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.1.18.18.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.4.1">0.8368</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.1.18.18.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.5.1">0.8446</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.1.18.18.6"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.6.1">0.8459</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.1.18.18.7"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.7.1">0.8424</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.1.18.18.8"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.8.1">0.8488</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.1.18.18.9"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.9.1">0.8546</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.1.18.18.10"><span class="ltx_text ltx_font_bold" id="S5.T1.1.18.18.10.1">0.8442</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we conducted extensive experiments on AnomalyLLM to answer the following research questions:</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Q1:</span> What is the performance of AnomalyLLM in detecting different types of anomaly with few labeled anomaly edges for each type?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">Q2:</span> How efficient of AnomalyLLM in model alignment and anomaly detection?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">Q3:</span> What are the influences of the proposed modules and different backbone LLMs?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">Q4:</span> What is the performance of AnomalyLLM on real-world anomaly edge detection task?</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.p1.2">Besides, we also studied the sensitivity of key parameters and the performance comparison on unsupervised anomaly edge detection. Due to the space limit, the results of these experiments are illustrated in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS5" title="A.5. Sensitivity Analysis ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">A.5</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS6" title="A.6. Unsupervised Anomaly Detection ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">A.6</span></a>. All the code and data are available at <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.p1.2.1">https://github.com/AnomalyLLM/AnomalyLLM</span>.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experimental Settings</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We briefly introduce the experimental settings below. The detailed experimental settings can be found in the Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS4" title="A.4. Experiment Setting ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">A.4</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1. </span>Data Descriptions.</h4>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.2">We use four public dynamic graph datasets to evaluate the performance of AnomalyLLM. The main experiments are conducted on two widely-used benchmark datasets, <em class="ltx_emph ltx_font_italic" id="S5.SS1.SSS1.p1.2.1">i.e.</em>, UCI Messages <cite class="ltx_cite ltx_citemacro_citep">(Opsahl and Panzarasa, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib27" title="">2009</a>)</cite> and Blogcatalog<cite class="ltx_cite ltx_citemacro_citep">(Tang and Liu, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib35" title="">2009</a>)</cite>. To evaluate the performance of AnomalyLLM on real-world anomaly detection task and test the capability of AnomalyLLM, we also employ two datasets with real anomaly, <em class="ltx_emph ltx_font_italic" id="S5.SS1.SSS1.p1.2.2">i.e.</em> T-Finance<cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib33" title="">2022</a>)</cite> and T-Social<cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib33" title="">2022</a>)</cite>, which have over <math alttext="21" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.1.m1.1"><semantics id="S5.SS1.SSS1.p1.1.m1.1a"><mn id="S5.SS1.SSS1.p1.1.m1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.1.m1.1b"><cn id="S5.SS1.SSS1.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.1.m1.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.1.m1.1c">21</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.1.m1.1d">21</annotation></semantics></math> million and <math alttext="73" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.2.m2.1"><semantics id="S5.SS1.SSS1.p1.2.m2.1a"><mn id="S5.SS1.SSS1.p1.2.m2.1.1" xref="S5.SS1.SSS1.p1.2.m2.1.1.cmml">73</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.2.m2.1b"><cn id="S5.SS1.SSS1.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.2.m2.1.1">73</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.2.m2.1c">73</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.2.m2.1d">73</annotation></semantics></math> million edges respectively.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2. </span>Experimental Protocol.</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.3">In this paper, we utilize both synthetic anomaly and real anomaly to evaluate the performance of AnomalyLLM. Existing dynamic graphs either have no labeled anomaly edges or only have one anomaly type. To verify the ability of AnomalyLLM on various anomaly types, we follow the experiments of <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib22" title="">2023</a>)</cite> and generate three kinds of systematic anomaly types, <em class="ltx_emph ltx_font_italic" id="S5.SS1.SSS2.p1.3.1">i.e.</em>, Contextual Dissimilarity Anomaly(CDA), Long-Path Links (LPL) and Hub-Hub Links(HHL) for UCI Messages and Blogcatalog datasets. The details of anomaly generation are described in Appendix  <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS4" title="A.4. Experiment Setting ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">A.4</span></a>. For dynamic graphs having labeled anomaly, such as T-Finance and T-Social, we directly used the real anomaly label to conduct the experiments. In our experiments, we employ all nodes and edges to pretrain the dynamic-aware encoders and align them to the backbone LLMs. For anomaly detection, only a few labeled edges are available. We build <math alttext="1" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.p1.1.m1.1a"><mn id="S5.SS1.SSS2.p1.1.m1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.1.m1.1b"><cn id="S5.SS1.SSS2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS1.SSS2.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.1.m1.1d">1</annotation></semantics></math>-shot, <math alttext="5" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.2.m2.1"><semantics id="S5.SS1.SSS2.p1.2.m2.1a"><mn id="S5.SS1.SSS2.p1.2.m2.1.1" xref="S5.SS1.SSS2.p1.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.2.m2.1b"><cn id="S5.SS1.SSS2.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS2.p1.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.2.m2.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.2.m2.1d">5</annotation></semantics></math>-shot and <math alttext="10" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.3.m3.1"><semantics id="S5.SS1.SSS2.p1.3.m3.1a"><mn id="S5.SS1.SSS2.p1.3.m3.1.1" xref="S5.SS1.SSS2.p1.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.3.m3.1b"><cn id="S5.SS1.SSS2.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS1.SSS2.p1.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.3.m3.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.3.m3.1d">10</annotation></semantics></math>-shot labeled edges for each anomaly type to obtain the AUC results on other edges.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3. </span>Baselines.</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">We compare AnomalyLLM with seven baselines which can be categorized into three groups, <em class="ltx_emph ltx_font_italic" id="S5.SS1.SSS3.p1.1.1">i.e.</em>, general graph representation method, unsupervised anomaly detection methods, and semi-supervised anomaly detection methods. For the first group, we select <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.2">DeepWalk<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.2.1.1">(</span>Perozzi et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.2.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib30" title="">2014</a><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.2.3.3">)</span></cite></span> to generate the representations of edges. For unsupervised method, we employ the recent three works, <em class="ltx_emph ltx_font_italic" id="S5.SS1.SSS3.p1.1.3">i.e.</em> <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.4">StrGNN<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.4.1.1">(</span>Cai et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.4.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib3" title="">2021</a><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.4.3.3">)</span></cite></span>, <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.5">AddGraph<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.5.1.1">(</span>Zheng et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.5.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib48" title="">2019</a><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.5.3.3">)</span></cite></span>, and <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.6">TADDY<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.6.1.1">(</span>Liu et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.6.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib20" title="">2021b</a><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.6.3.3">)</span></cite></span>, as our baselines. For semi-supervised methods, we use <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.7">GDN<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.7.1.1">(</span>Ding et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.7.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib7" title="">2021</a><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.7.3.3">)</span></cite></span>, <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.8">TGN<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.8.1.1">(</span>Xu et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.8.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib42" title="">2020</a><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.8.3.3">)</span></cite></span>and <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.9">SAD<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.9.1.1">(</span>Tian et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.9.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib36" title="">2023</a><span class="ltx_text ltx_font_medium" id="S5.SS1.SSS3.p1.1.9.3.3">)</span></cite></span> for performance comparison. The details of how to use these methods on our tasks are specified in the Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.SS4.SSS3" title="A.4.3. Compared baselines. ‣ A.4. Experiment Setting ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">A.4.3</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.4. </span>Hyperparameters setting.</h4>
<div class="ltx_para" id="S5.SS1.SSS4.p1">
<p class="ltx_p" id="S5.SS1.SSS4.p1.10">For subgraph construction, we set the number <math alttext="k" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.1.m1.1"><semantics id="S5.SS1.SSS4.p1.1.m1.1a"><mi id="S5.SS1.SSS4.p1.1.m1.1.1" xref="S5.SS1.SSS4.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.1.m1.1b"><ci id="S5.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.1.m1.1d">italic_k</annotation></semantics></math> to be <math alttext="14" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.2.m2.1"><semantics id="S5.SS1.SSS4.p1.2.m2.1a"><mn id="S5.SS1.SSS4.p1.2.m2.1.1" xref="S5.SS1.SSS4.p1.2.m2.1.1.cmml">14</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.2.m2.1b"><cn id="S5.SS1.SSS4.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS4.p1.2.m2.1.1">14</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.2.m2.1c">14</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.2.m2.1d">14</annotation></semantics></math> and <math alttext="\Gamma" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.3.m3.1"><semantics id="S5.SS1.SSS4.p1.3.m3.1a"><mi id="S5.SS1.SSS4.p1.3.m3.1.1" mathvariant="normal" xref="S5.SS1.SSS4.p1.3.m3.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.3.m3.1b"><ci id="S5.SS1.SSS4.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.3.m3.1c">\Gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.3.m3.1d">roman_Γ</annotation></semantics></math> is <math alttext="4" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.4.m4.1"><semantics id="S5.SS1.SSS4.p1.4.m4.1a"><mn id="S5.SS1.SSS4.p1.4.m4.1.1" xref="S5.SS1.SSS4.p1.4.m4.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.4.m4.1b"><cn id="S5.SS1.SSS4.p1.4.m4.1.1.cmml" type="integer" xref="S5.SS1.SSS4.p1.4.m4.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.4.m4.1c">4</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.4.m4.1d">4</annotation></semantics></math>. For edge encoder, the embedding dimension <math alttext="d" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.5.m5.1"><semantics id="S5.SS1.SSS4.p1.5.m5.1a"><mi id="S5.SS1.SSS4.p1.5.m5.1.1" xref="S5.SS1.SSS4.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.5.m5.1b"><ci id="S5.SS1.SSS4.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.5.m5.1d">italic_d</annotation></semantics></math> is <math alttext="512" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.6.m6.1"><semantics id="S5.SS1.SSS4.p1.6.m6.1a"><mn id="S5.SS1.SSS4.p1.6.m6.1.1" xref="S5.SS1.SSS4.p1.6.m6.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.6.m6.1b"><cn id="S5.SS1.SSS4.p1.6.m6.1.1.cmml" type="integer" xref="S5.SS1.SSS4.p1.6.m6.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.6.m6.1c">512</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.6.m6.1d">512</annotation></semantics></math>. AnomalyLLM employs <math alttext="3" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.7.m7.1"><semantics id="S5.SS1.SSS4.p1.7.m7.1a"><mn id="S5.SS1.SSS4.p1.7.m7.1.1" xref="S5.SS1.SSS4.p1.7.m7.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.7.m7.1b"><cn id="S5.SS1.SSS4.p1.7.m7.1.1.cmml" type="integer" xref="S5.SS1.SSS4.p1.7.m7.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.7.m7.1c">3</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.7.m7.1d">3</annotation></semantics></math>-layers stack of Transformer. We train UCI Messages, BlogCatalog, T-Finance and T-Social datasets with <math alttext="150" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.8.m8.1"><semantics id="S5.SS1.SSS4.p1.8.m8.1a"><mn id="S5.SS1.SSS4.p1.8.m8.1.1" xref="S5.SS1.SSS4.p1.8.m8.1.1.cmml">150</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.8.m8.1b"><cn id="S5.SS1.SSS4.p1.8.m8.1.1.cmml" type="integer" xref="S5.SS1.SSS4.p1.8.m8.1.1">150</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.8.m8.1c">150</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.8.m8.1d">150</annotation></semantics></math> epochs.During the modality alignment, we fine-tune the encoder and anomaly detector for <math alttext="20" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.9.m9.1"><semantics id="S5.SS1.SSS4.p1.9.m9.1a"><mn id="S5.SS1.SSS4.p1.9.m9.1.1" xref="S5.SS1.SSS4.p1.9.m9.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.9.m9.1b"><cn id="S5.SS1.SSS4.p1.9.m9.1.1.cmml" type="integer" xref="S5.SS1.SSS4.p1.9.m9.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.9.m9.1c">20</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.9.m9.1d">20</annotation></semantics></math> epoch. All the experiments are conducted on the <math alttext="2\times" class="ltx_math_unparsed" display="inline" id="S5.SS1.SSS4.p1.10.m10.1"><semantics id="S5.SS1.SSS4.p1.10.m10.1a"><mrow id="S5.SS1.SSS4.p1.10.m10.1b"><mn id="S5.SS1.SSS4.p1.10.m10.1.1">2</mn><mo id="S5.SS1.SSS4.p1.10.m10.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.10.m10.1c">2\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.10.m10.1d">2 ×</annotation></semantics></math>Nvidia 3090Ti.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Performance Comparison</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.4">To answer <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.4.1">Q1</span>, we compare AnomalyLLM against seven baselines and summarize the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.T1" title="Table 1 ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>. Overall, AnomalyLLM outperforms all baselines on all datasets. Compared with the general representation learning method, <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.4.2">i.e.</em>, DeepWalk, AnomalyLLM achieve over <math alttext="20" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mn id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><cn id="S5.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">20</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">20</annotation></semantics></math>% AUC improvement proving that the constructed structural-temporal subgraphs capture the dynamics of graph. For unsupervised anomaly detection methods, TADDY is the strongest baseline due to the Transformer-GNN encoder. However, it is also inferior to AnomalyLLM which can be attributed to the generalization power of LLMs. As to the semi-supervised methods, such as GDN and SAD, AnomalyLLM demonstrates notable improvements. For example, the relative AUC value improvements on the UCI Message dataset for different anomaly type in the 5-shot setting are <math alttext="19\%" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mn id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">19</mn><mo id="S5.SS2.p1.2.m2.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1">percent</csymbol><cn id="S5.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1.2">19</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">19\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">19 %</annotation></semantics></math>, <math alttext="18.5\%" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mrow id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mn id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">18.5</mn><mo id="S5.SS2.p1.3.m3.1.1.1" xref="S5.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1.1">percent</csymbol><cn id="S5.SS2.p1.3.m3.1.1.2.cmml" type="float" xref="S5.SS2.p1.3.m3.1.1.2">18.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">18.5\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">18.5 %</annotation></semantics></math> and <math alttext="20.3\%" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.1"><semantics id="S5.SS2.p1.4.m4.1a"><mrow id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml"><mn id="S5.SS2.p1.4.m4.1.1.2" xref="S5.SS2.p1.4.m4.1.1.2.cmml">20.3</mn><mo id="S5.SS2.p1.4.m4.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><apply id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1"><csymbol cd="latexml" id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1">percent</csymbol><cn id="S5.SS2.p1.4.m4.1.1.2.cmml" type="float" xref="S5.SS2.p1.4.m4.1.1.2">20.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">20.3\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.1d">20.3 %</annotation></semantics></math>, respectively. This is because AnomalyLLM employ ICL to excel the useful information of few labeled data.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.4">For different anomaly types, AnomalyLLM achieves stable improvements on CDA, LPL and HHL. We pretrain the dynamic-aware graph encoder for each dataset and detect different types of anomaly by only replacing the embedding of few labeled anomaly edges of the ICL template. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.T1" title="Table 1 ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, the AUC of different anomaly types are over <math alttext="80" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mn id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><cn id="S5.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S5.SS2.p2.1.m1.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">80</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">80</annotation></semantics></math>% indicating that AnomalyLLM is anomaly type-agnostic. Moreover, with the increase of labeled samples, the performances of both AnomalyLLM and baseline methods are improved steadily. For example, compared to the 10-shot setting, the performance of SAD in the <math alttext="1" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.1"><semantics id="S5.SS2.p2.2.m2.1a"><mn id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><cn id="S5.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S5.SS2.p2.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.2.m2.1d">1</annotation></semantics></math>-shot setting significantly decreased, with their AUC dropping by approximately <math alttext="14" class="ltx_Math" display="inline" id="S5.SS2.p2.3.m3.1"><semantics id="S5.SS2.p2.3.m3.1a"><mn id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml">14</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b"><cn id="S5.SS2.p2.3.m3.1.1.cmml" type="integer" xref="S5.SS2.p2.3.m3.1.1">14</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">14</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.3.m3.1d">14</annotation></semantics></math>%. This is because SAD is designed to detect anomaly with hundreds of labeled data. Conversely, AnomalyLLM still achieves over <math alttext="0.82" class="ltx_Math" display="inline" id="S5.SS2.p2.4.m4.1"><semantics id="S5.SS2.p2.4.m4.1a"><mn id="S5.SS2.p2.4.m4.1.1" xref="S5.SS2.p2.4.m4.1.1.cmml">0.82</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m4.1b"><cn id="S5.SS2.p2.4.m4.1.1.cmml" type="float" xref="S5.SS2.p2.4.m4.1.1">0.82</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m4.1c">0.82</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.4.m4.1d">0.82</annotation></semantics></math> AUC on both two datasets. We attribute this to the effectiveness of ICL module which excites the advanced capabilities of LLMs.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Efficiency Experiments</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We study the efficiency of alignment and inference time to answer <span class="ltx_text ltx_font_bold" id="S5.SS3.p1.1.1">Q2</span> and prove that AnomalyLLM is flexible for different LLM backbones.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.2">For the compared baselines, the fine-tuning procedure need be conducted in few-shot anomaly detection. As shown in the left part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.F5" title="Figure 5 ‣ 5.3. Efficiency Experiments ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, the fine-tuning time increases linearly according to the number of edge sizes. For example, in <math alttext="10" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mn id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><cn id="S5.SS3.p2.1.m1.1.1.cmml" type="integer" xref="S5.SS3.p2.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">10</annotation></semantics></math>-shot anomaly detection of <math alttext="60,000" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.2"><semantics id="S5.SS3.p2.2.m2.2a"><mrow id="S5.SS3.p2.2.m2.2.3.2" xref="S5.SS3.p2.2.m2.2.3.1.cmml"><mn id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml">60</mn><mo id="S5.SS3.p2.2.m2.2.3.2.1" xref="S5.SS3.p2.2.m2.2.3.1.cmml">,</mo><mn id="S5.SS3.p2.2.m2.2.2" xref="S5.SS3.p2.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.2b"><list id="S5.SS3.p2.2.m2.2.3.1.cmml" xref="S5.SS3.p2.2.m2.2.3.2"><cn id="S5.SS3.p2.2.m2.1.1.cmml" type="integer" xref="S5.SS3.p2.2.m2.1.1">60</cn><cn id="S5.SS3.p2.2.m2.2.2.cmml" type="integer" xref="S5.SS3.p2.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.2c">60,000</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.2d">60 , 000</annotation></semantics></math> edges, the fine-tuning time of Taddy is over 10,000 seconds. As to AnomalyLLM, there has no fine-tuning procedure in few-shot anomaly detection. We can obtain the detection results of new anomaly types by only replacing the embedding of labeled edges in ICL template. The inference time of ICL detection is shown in the right part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.F5" title="Figure 5 ‣ 5.3. Efficiency Experiments ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>. We can observe that the inference time of AnomalyLLM is comparable with other baselines under different batch sizes. This is because of the causal attention mechanism of LLMs. In model inference, the embeddings of the front part of ICL template stay unchanged for different input edges. Thus, AnomalyLLM is efficient for model inference and fine-tuning free for few-shot anomaly detection.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.4">Furthermore, we study the alignment time that utilizes the pseudo label on BlogCatalog dataset to align the semantics of the neural language to dynamic graphs. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.T2" title="Table 2 ‣ 5.3. Efficiency Experiments ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, we count the alignment time of each epoch training by <math alttext="30000" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.1"><semantics id="S5.SS3.p3.1.m1.1a"><mn id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">30000</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><cn id="S5.SS3.p3.1.m1.1.1.cmml" type="integer" xref="S5.SS3.p3.1.m1.1.1">30000</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">30000</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.1d">30000</annotation></semantics></math> pseudo label edges. In our experience, the alignment procedure would be convergence in <math alttext="5" class="ltx_Math" display="inline" id="S5.SS3.p3.2.m2.1"><semantics id="S5.SS3.p3.2.m2.1a"><mn id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><cn id="S5.SS3.p3.2.m2.1.1.cmml" type="integer" xref="S5.SS3.p3.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.2.m2.1d">5</annotation></semantics></math> epoch for different LLM backbones. As illustrated, the total alignment time of <math alttext="30,000" class="ltx_Math" display="inline" id="S5.SS3.p3.3.m3.2"><semantics id="S5.SS3.p3.3.m3.2a"><mrow id="S5.SS3.p3.3.m3.2.3.2" xref="S5.SS3.p3.3.m3.2.3.1.cmml"><mn id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml">30</mn><mo id="S5.SS3.p3.3.m3.2.3.2.1" xref="S5.SS3.p3.3.m3.2.3.1.cmml">,</mo><mn id="S5.SS3.p3.3.m3.2.2" xref="S5.SS3.p3.3.m3.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.2b"><list id="S5.SS3.p3.3.m3.2.3.1.cmml" xref="S5.SS3.p3.3.m3.2.3.2"><cn id="S5.SS3.p3.3.m3.1.1.cmml" type="integer" xref="S5.SS3.p3.3.m3.1.1">30</cn><cn id="S5.SS3.p3.3.m3.2.2.cmml" type="integer" xref="S5.SS3.p3.3.m3.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.2c">30,000</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.3.m3.2d">30 , 000</annotation></semantics></math> edges is about <math alttext="1200" class="ltx_Math" display="inline" id="S5.SS3.p3.4.m4.1"><semantics id="S5.SS3.p3.4.m4.1a"><mn id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml">1200</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.1b"><cn id="S5.SS3.p3.4.m4.1.1.cmml" type="integer" xref="S5.SS3.p3.4.m4.1.1">1200</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.1c">1200</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.4.m4.1d">1200</annotation></semantics></math> seconds, which is acceptable for replacing the LLM backbone. Therefore, AnomalyLLM is simple and efficient to be updated with more powerful LLMs.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span> Alignment Fine-tuning Time of AnomalyLLM.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1.1">Pseudo Label Edges</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.2.1">Alignment Time per Epoch (Seconds)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.1">10,000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.2">76.2</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.1">30,000</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.2">250.7</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.3">
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.1">100,000</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.2">801.2</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.1.5.4.1">150,000</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.1.5.4.2">1203.2</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="186" id="S5.F5.g1" src="x5.png" width="399"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Inference time of AnomalyLLM </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Ablation Results:</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">To address <span class="ltx_text ltx_font_bold" id="S5.SS4.p1.1.1">Q3</span>, we compare AnomalyLLM with three ablations to analyze the effectiveness of the proposed components. We remove the proposed dynamic-aware encoder, the alignment training module and the ICL detection respectively, and obtain w/o encoder, w/o ICL and w/o ICL.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Ablation Results</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.1.1.1"></th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.1.1.2"></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.3.1">Anomaly Types</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.2.2.1"><span class="ltx_text" id="S5.T3.1.2.2.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.2.2.2"><span class="ltx_text" id="S5.T3.1.2.2.2.1">Method</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.2.2.3">CDA</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.2.2.4">LPL</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.2.2.5">HHL</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.3.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.3.3.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.3.3.2">w/o ICL</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.3.3">0.7406</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.3.4">0.7465</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.3.5">0.7328</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.4.4.1">UCI</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.4.4.2">w/o alignment</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.3">0.7849</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.4">0.7892</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.5">0.7994</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.5.5.1">Message</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.5.5.2">w/o encoder</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.5.3">0.7727</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.5.4">0.7883</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.5.5">0.7822</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.6.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.6.6.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.6.6.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.6.2.1">AnomalyLLM</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.6.3">0.8402</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.6.4">0.8456</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.6.5">0.8447</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.7.7">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.7.7.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.7.7.2">w/o ICL</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.7.7.3">0.7398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.7.7.4">0.7421</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.7.7.5">0.7396</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.8.8">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.8.8.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.8.8.2">w/o alignment</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.8.3">0.7767</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.8.4">0.7812</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.8.5">0.7726</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.9.9">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.9.9.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.9.9.2">w/o encoder</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.9.3">0.7821</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.9.4">0.7726</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.9.5">0.7732</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T3.1.10.10.1"><span class="ltx_text" id="S5.T3.1.10.10.1.1">BlogCatalog</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T3.1.10.10.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.10.10.2.1">AnomalyLLM</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.1.10.10.3">0.8488</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.1.10.10.4">0.8546</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.1.10.10.5">0.8442</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.2">The experiment is conducted on BlogCatalog dataset and the results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.T3" title="Table 3 ‣ 5.4. Ablation Results: ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>. We observe: (1) Comparing the results of AnomalyLLM with w/o encoder, we observe the edge construction by focusing on subgraph embeddings from both sides can extract useful information and capture the evolving properties of edges in dynamic graphs. For example, the AUC improves from <math alttext="0.7726" class="ltx_Math" display="inline" id="S5.SS4.p2.1.m1.1"><semantics id="S5.SS4.p2.1.m1.1a"><mn id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml">0.7726</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><cn id="S5.SS4.p2.1.m1.1.1.cmml" type="float" xref="S5.SS4.p2.1.m1.1.1">0.7726</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">0.7726</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.1.m1.1d">0.7726</annotation></semantics></math> to <math alttext="0.8546" class="ltx_Math" display="inline" id="S5.SS4.p2.2.m2.1"><semantics id="S5.SS4.p2.2.m2.1a"><mn id="S5.SS4.p2.2.m2.1.1" xref="S5.SS4.p2.2.m2.1.1.cmml">0.8546</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.2.m2.1b"><cn id="S5.SS4.p2.2.m2.1.1.cmml" type="float" xref="S5.SS4.p2.2.m2.1.1">0.8546</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.2.m2.1c">0.8546</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.2.m2.1d">0.8546</annotation></semantics></math> on UCI Message dataset. (2) From the results of w/o ICL and AnomalyLLM, we can conclude that the ICL’s capacity to efficiently utilize minimal labeled data is more effective than fine-tuning. (3) AnomalyLLM achieves the best performance compared to all ablations, which proves the effectiveness of the proposed techniques.</p>
</div>
<div class="ltx_para" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.1">Moreover, we also explore the performance of AnomalyLLM under different LLM backbones on BlogCatalog and UCI Message datasets. As illustrated in Figure  <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.F6" title="Figure 6 ‣ 5.4. Ablation Results: ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>, we assess the inference speed and AUC of various LLMs, including Llama-2-7B, vicuna-7B-v1.1, vicuna-7B-v1.3 and vicuna-7B-v1.5. We can observe that vicuna-7B-v1.5 achieves the best performance and has the fastest inference time. To balance the performance and efficiency, we choose vicuna-7B-v1.5 as the LLM backbone.</p>
</div>
<figure class="ltx_figure" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="145" id="S5.F6.g1" src="x6.png" width="398"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Performance of different LLM backbones</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5. </span>Performance on Real-World Labeled Dataset</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.4">To answer <span class="ltx_text ltx_font_bold" id="S5.SS5.p1.4.1">Q4</span>, we verify the performance of AnomalyLLM on two real-world datasets, <em class="ltx_emph ltx_font_italic" id="S5.SS5.p1.4.2">i.e.</em>, T-Finance and T-Social, which have over 100 million edges. The results are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#S5.T4" title="Table 4 ‣ 5.5. Performance on Real-World Labeled Dataset ‣ 5. Experiments ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>. Overall, AnomalyLLM outperforms all baselines on all datasets. Compared with the state-of-the-art supervised learning method, <em class="ltx_emph ltx_font_italic" id="S5.SS5.p1.4.3">i.e.</em>, TGN<cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib42" title="">2020</a>)</cite>, AnomalyLLM achieve over <math alttext="20.6" class="ltx_Math" display="inline" id="S5.SS5.p1.1.m1.1"><semantics id="S5.SS5.p1.1.m1.1a"><mn id="S5.SS5.p1.1.m1.1.1" xref="S5.SS5.p1.1.m1.1.1.cmml">20.6</mn><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.1.m1.1b"><cn id="S5.SS5.p1.1.m1.1.1.cmml" type="float" xref="S5.SS5.p1.1.m1.1.1">20.6</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.1.m1.1c">20.6</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.1.m1.1d">20.6</annotation></semantics></math>% AUC improvement. For semi-supervised methods, <em class="ltx_emph ltx_font_italic" id="S5.SS5.p1.4.4">i.e.</em>, GDN and SAD, AnomalyLLM demonstrates notable improvements. For example, compared to SAD, the relative AUC value improvements on the T-Social dataset for different shot settings are <math alttext="21\%" class="ltx_Math" display="inline" id="S5.SS5.p1.2.m2.1"><semantics id="S5.SS5.p1.2.m2.1a"><mrow id="S5.SS5.p1.2.m2.1.1" xref="S5.SS5.p1.2.m2.1.1.cmml"><mn id="S5.SS5.p1.2.m2.1.1.2" xref="S5.SS5.p1.2.m2.1.1.2.cmml">21</mn><mo id="S5.SS5.p1.2.m2.1.1.1" xref="S5.SS5.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.2.m2.1b"><apply id="S5.SS5.p1.2.m2.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS5.p1.2.m2.1.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1.1">percent</csymbol><cn id="S5.SS5.p1.2.m2.1.1.2.cmml" type="integer" xref="S5.SS5.p1.2.m2.1.1.2">21</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.2.m2.1c">21\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.2.m2.1d">21 %</annotation></semantics></math>, <math alttext="20.7\%" class="ltx_Math" display="inline" id="S5.SS5.p1.3.m3.1"><semantics id="S5.SS5.p1.3.m3.1a"><mrow id="S5.SS5.p1.3.m3.1.1" xref="S5.SS5.p1.3.m3.1.1.cmml"><mn id="S5.SS5.p1.3.m3.1.1.2" xref="S5.SS5.p1.3.m3.1.1.2.cmml">20.7</mn><mo id="S5.SS5.p1.3.m3.1.1.1" xref="S5.SS5.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.3.m3.1b"><apply id="S5.SS5.p1.3.m3.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS5.p1.3.m3.1.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1.1">percent</csymbol><cn id="S5.SS5.p1.3.m3.1.1.2.cmml" type="float" xref="S5.SS5.p1.3.m3.1.1.2">20.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.3.m3.1c">20.7\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.3.m3.1d">20.7 %</annotation></semantics></math> and <math alttext="18.8\%" class="ltx_Math" display="inline" id="S5.SS5.p1.4.m4.1"><semantics id="S5.SS5.p1.4.m4.1a"><mrow id="S5.SS5.p1.4.m4.1.1" xref="S5.SS5.p1.4.m4.1.1.cmml"><mn id="S5.SS5.p1.4.m4.1.1.2" xref="S5.SS5.p1.4.m4.1.1.2.cmml">18.8</mn><mo id="S5.SS5.p1.4.m4.1.1.1" xref="S5.SS5.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.4.m4.1b"><apply id="S5.SS5.p1.4.m4.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1"><csymbol cd="latexml" id="S5.SS5.p1.4.m4.1.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1.1">percent</csymbol><cn id="S5.SS5.p1.4.m4.1.1.2.cmml" type="float" xref="S5.SS5.p1.4.m4.1.1.2">18.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.4.m4.1c">18.8\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.4.m4.1d">18.8 %</annotation></semantics></math>, respectively. These results indicate AnomalyLLM is potential to be used in large-scale dynamic graphs.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Performance on Real-World Labeled Dataset</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.1.1.2">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.3">1-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.4">5-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.5">10-shot</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.2.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.2.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.2.1.2">AddGraph</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.3">0.6126</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.4">0.6149</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.5">0.6277</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.3.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.3.2.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.3.2.2">TGN</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.3">0.6646</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.4">0.6701</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.5">0.6865</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.4.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.4.3.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.4.3.2">GDN</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.3">0.6672</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.4">0.6689</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.5">0.6898</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.5.4.1"><span class="ltx_text" id="S5.T4.1.5.4.1.1">T-Finance</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.5.4.2">SAD</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.5.4.3">0.6724</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.5.4.4">0.6754</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.5.4.5">0.6876</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.6.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.6.5.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.6.5.2.1">AnomalyLLM</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.6.5.3.1">0.8018</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.6.5.4.1">0.8056</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S5.T4.1.6.5.5.1">0.8087</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.7.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.7.6.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.7.6.2">AddGraph</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.7.6.3">0.6116</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.7.6.4">0.6245</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.7.6.5">0.6221</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.8.7">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.8.7.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.8.7.2">TGN</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.8.7.3">0.6706</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.8.7.4">0.6754</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.8.7.5">0.6887</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.9.8">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.9.8.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.9.8.2">GDN</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.9.8.3">0.6694</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.9.8.4">0.6782</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.9.8.5">0.6908</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.10.9.1"><span class="ltx_text" id="S5.T4.1.10.9.1.1">T-Social</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.10.9.2">SAD</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.10.9.3">0.6779</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.10.9.4">0.6746</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.10.9.5">0.6805</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.11.10">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T4.1.11.10.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T4.1.11.10.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.11.10.2.1">AnomalyLLM</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.11.10.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.11.10.3.1">0.8101</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.11.10.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.11.10.4.1">0.8187</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.11.10.5"><span class="ltx_text ltx_font_bold" id="S5.T4.1.11.10.5.1">0.8206</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we are the first to integrate LLMs with dynamic graph anomaly detection, addressing the challenge of few-shot anomaly edge detection. AnomalyLLM leverages LLMs to effectively understand and represent the evolving relationships in dynamic graphs. We introduce a novel approach that reprograms the edge embedding to align the semantics between dynamic graph and LLMs. Moreover, an ICL strategy is designed to enable efficient and accurate detection of various anomaly types with a few labeled samples. Extensive experiments across multiple datasets demonstrate that AnomalyLLM not only significantly outperforms existing methods in few-shot settings but also sets a new benchmark in the field.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Balzarotti et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2008)</span>
<span class="ltx_bibblock">
Davide Balzarotti, Marco
Cova, Vika Felmetsger, Nenad Jovanovic,
Engin Kirda, Christopher Kruegel, and
Giovanni Vigna. 2008.

</span>
<span class="ltx_bibblock">Saner: Composing static and dynamic analysis to
validate sanitization in web applications. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">2008
IEEE Symposium on Security and Privacy (sp 2008)</em>. IEEE,
387–401.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Lei Cai, Zhengzhang Chen,
Chen Luo, Jiaping Gui,
Jingchao Ni, Ding Li, and
Haifeng Chen. 2021.

</span>
<span class="ltx_bibblock">Structural temporal graph neural networks for
anomaly detection in dynamic graphs. In
<em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 30th ACM international
conference on Information &amp; Knowledge Management</em>.
3747–3756.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Songgaojun Deng, Huzefa
Rangwala, and Yue Ning.
2019.

</span>
<span class="ltx_bibblock">Learning dynamic context graphs for predicting
social events. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 25th ACM
SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>.
1007–1016.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Kaize Ding, Jundong Li,
Rohit Bhanushali, and Huan Liu.
2019.

</span>
<span class="ltx_bibblock">Deep anomaly detection on attributed networks. In
<em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 2019 SIAM International
Conference on Data Mining</em>. SIAM, 594–602.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Kaize Ding, Jianling
Wang, Jundong Li, Kai Shu,
Chenghao Liu, and Huan Liu.
2020.

</span>
<span class="ltx_bibblock">Graph prototypical networks for few-shot learning
on attributed networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Proceedings of the 29th
ACM International Conference on Information &amp; Knowledge Management</em>.
295–304.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Kaize Ding, Qinghai Zhou,
Hanghang Tong, and Huan Liu.
2021.

</span>
<span class="ltx_bibblock">Few-shot network anomaly detection via
cross-network meta-learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the
Web Conference 2021</em>. 2448–2456.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2020a)</span>
<span class="ltx_bibblock">
Dongsheng Duan, Lingling
Tong, Yangxi Li, Jie Lu,
Lei Shi, and Cheng Zhang.
2020a.

</span>
<span class="ltx_bibblock">Aane: Anomaly aware network embedding for anomalous
link detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">2020 IEEE International
Conference on Data Mining (ICDM)</em>. IEEE, 1002–1007.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2020b)</span>
<span class="ltx_bibblock">
Dongsheng Duan, Lingling
Tong, Yangxi Li, Jie Lu,
Lei Shi, and Cheng Zhang.
2020b.

</span>
<span class="ltx_bibblock">AANE: Anomaly Aware Network Embedding For
Anomalous Link Detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">20th IEEE
International Conference on Data Mining, ICDM</em>.
1002–1007.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fifty et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Christopher Fifty, Jure
Leskovec, and Sebastian Thrun.
2023.

</span>
<span class="ltx_bibblock">In-Context Learning for Few-Shot Molecular Property
Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">arXiv preprint arXiv:2310.08863</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grover and Leskovec (2016)</span>
<span class="ltx_bibblock">
Aditya Grover and Jure
Leskovec. 2016.

</span>
<span class="ltx_bibblock">node2vec: Scalable Feature Learning for Networks.
In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 22nd ACM SIGKDD Conference on
Knowledge Discovery and Data Mining</em>. 855–864.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhichun Guo, Chuxu Zhang,
Wenhao Yu, John Herr,
Olaf Wiest, Meng Jiang, and
Nitesh V Chawla. 2021.

</span>
<span class="ltx_bibblock">Few-shot graph learning for molecular property
prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the web conference
2021</em>. 2559–2567.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shibo Hao, Yi Gu,
Haodi Ma, Joshua Jiahua Hong,
Zhen Wang, Daisy Zhe Wang, and
Zhiting Hu. 2023.

</span>
<span class="ltx_bibblock">Reasoning with language model is planning with
world model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">arXiv preprint arXiv:2305.14992</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xuanwen Huang, Yang Yang,
Yang Wang, Chunping Wang,
Zhisheng Zhang, Jiarong Xu,
Lei Chen, and Michalis Vazirgiannis.
2022.

</span>
<span class="ltx_bibblock">Dgraph: A large-scale financial dataset for graph
anomaly detection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Advances in Neural Information Processing
Systems</em> 35 (2022),
22765–22777.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Ming Jin, Shiyu Wang,
Lintao Ma, Zhixuan Chu,
James Y Zhang, Xiaoming Shi,
Pin-Yu Chen, Yuxuan Liang,
Yuan-Fang Li, Shirui Pan,
et al<span class="ltx_text" id="bib.bib15.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Time-llm: Time series forecasting by reprogramming
large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.4.1">arXiv preprint arXiv:2310.01728</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">John et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Wolfgang John, Guido
Marchetto, Felicián Németh,
Pontus Skoldstrom, Rebecca Steinert,
Catalin Meirosu, Ioanna Papafili, and
Kostas Pentikousis. 2017.

</span>
<span class="ltx_bibblock">Service provider devops.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">IEEE Communications Magazine</em>
55, 1 (2017),
204–211.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kondor and Lafferty (2002)</span>
<span class="ltx_bibblock">
Risi Kondor and John D.
Lafferty. 2002.

</span>
<span class="ltx_bibblock">Diffusion Kernels on Graphs and Other Discrete
Input Spaces. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Machine Learning, Proceedings of
the Nineteenth International Conference (ICML 2002)</em>.
315–322.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ruirui Li, Xian Wu,
Xian Wu, and Wei Wang.
2020.

</span>
<span class="ltx_bibblock">Few-shot learning for new user recommendation in
location-based social networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of
The Web Conference 2020</em>. 2472–2478.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jiaying Liu, Feng Xia,
Xu Feng, Jing Ren, and
Huan Liu. 2022.

</span>
<span class="ltx_bibblock">Deep graph learning for anomalous citation
detection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">IEEE Transactions on Neural Networks and
Learning Systems</em> 33, 6
(2022), 2543–2557.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Yixin Liu, Shirui Pan,
Yu Guang Wang, Fei Xiong,
Liang Wang, Qingfeng Chen, and
Vincent CS Lee. 2021b.

</span>
<span class="ltx_bibblock">Anomaly detection in dynamic graphs via
transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">IEEE Transactions on Knowledge and Data
Engineering</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Zemin Liu, Yuan Fang,
Chenghao Liu, and Steven CH Hoi.
2021a.

</span>
<span class="ltx_bibblock">Relative and absolute location embedding for
few-shot node classification on graph. In
<em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the AAAI conference on artificial
intelligence</em>, Vol. 35. 4267–4275.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhen Liu, Wenbo Zuo,
Dongning Zhang, and Xiaodong Feng.
2023.

</span>
<span class="ltx_bibblock">RGSE: Robust Graph Structure Embedding for
Anomalous Link Detection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">IEEE Transactions on Big Data</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Mingxuan Lu, Zhichao Han,
Susie Xi Rao, Zitao Zhang,
Yang Zhao, Yinan Shan,
Ramesh Raghunathan, Ce Zhang, and
Jiawei Jiang. 2022.

</span>
<span class="ltx_bibblock">BRIGHT-Graph Neural Networks in Real-Time Fraud
Detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 31st ACM
International Conference on Information &amp; Knowledge Management</em>.
3342–3351.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiaoxiao Ma, Jia Wu,
Shan Xue, Jian Yang,
Chuan Zhou, Quan Z Sheng,
Hui Xiong, and Leman Akoglu.
2021.

</span>
<span class="ltx_bibblock">A comprehensive survey on graph anomaly detection
with deep learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">IEEE Transactions on Knowledge and Data
Engineering</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xuying Meng, Suhang Wang,
Zhimin Liang, Di Yao,
Jihua Zhou, and Yujun Zhang.
2021.

</span>
<span class="ltx_bibblock">Semi-supervised anomaly detection in dynamic
communication networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Information Sciences</em> 571
(2021), 527–542.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miz et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Volodymyr Miz, Benjamin
Ricaud, Kirell Benzi, and Pierre
Vandergheynst. 2019.

</span>
<span class="ltx_bibblock">Anomaly detection in the dynamics of web and social
networks using associative memory. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">The World
Wide Web Conference</em>. 1290–1299.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Opsahl and Panzarasa (2009)</span>
<span class="ltx_bibblock">
Tore Opsahl and Pietro
Panzarasa. 2009.

</span>
<span class="ltx_bibblock">Clustering in weighted networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Social networks</em> 31,
2 (2009), 155–163.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Page et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (1998)</span>
<span class="ltx_bibblock">
Lawrence Page, Sergey
Brin, Rajeev Motwani, and Terry
Winograd. 1998.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">The pagerank citation ranking: Bring order
to the web</em>.

</span>
<span class="ltx_bibblock">Technical Report. Technical
report, stanford University.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pawelczyk et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Martin Pawelczyk, Seth
Neel, and Himabindu Lakkaraju.
2023.

</span>
<span class="ltx_bibblock">In-context unlearning: Language models as few shot
unlearners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">arXiv preprint arXiv:2310.07579</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perozzi et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Bryan Perozzi, Rami
Al-Rfou, and Steven Skiena.
2014.

</span>
<span class="ltx_bibblock">Deepwalk: Online learning of social
representations. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">Proceedings of the 20th ACM
SIGKDD international conference on Knowledge discovery and data mining</em>.
701–710.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ranshous et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Stephen Ranshous, Steve
Harenberg, Kshitij Sharma, and Nagiza F
Samatova. 2016.

</span>
<span class="ltx_bibblock">A scalable approach for outlier detection in edge
streams using sketch-based approximations. In
<em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of the 2016 SIAM international
conference on data mining</em>. SIAM, 189–197.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xiangguo Sun, Hong Cheng,
Jia Li, Bo Liu, and
Jihong Guan. 2023.

</span>
<span class="ltx_bibblock">All in One: Multi-Task Prompting for Graph Neural
Networks.

</span>
<span class="ltx_bibblock">(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jianheng Tang, Jiajin Li,
Ziqi Gao, and Jia Li.
2022.

</span>
<span class="ltx_bibblock">Rethinking graph neural networks for anomaly
detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">International Conference on Machine
Learning</em>. PMLR, 21076–21089.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jiabin Tang, Yuhao Yang,
Wei Wei, Lei Shi, Lixin
Su, Suqi Cheng, Dawei Yin, and
Chao Huang. 2023.

</span>
<span class="ltx_bibblock">Graphgpt: Graph instruction tuning for large
language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">arXiv preprint arXiv:2310.13023</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Liu (2009)</span>
<span class="ltx_bibblock">
Lei Tang and Huan Liu.
2009.

</span>
<span class="ltx_bibblock">Relational learning via latent social dimensions.
In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the 15th ACM SIGKDD international
conference on Knowledge discovery and data mining</em>.
817–826.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Sheng Tian, Jihai Dong,
Jintang Li, Wenlong Zhao,
Xiaolong Xu, Bowen Song,
Changhua Meng, Tianyi Zhang,
Liang Chen, et al<span class="ltx_text" id="bib.bib36.3.1">.</span>
2023.

</span>
<span class="ltx_bibblock">SAD: Semi-Supervised Anomaly Detection on Dynamic
Graphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.4.1">arXiv preprint arXiv:2305.13573</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Daixin Wang, Jianbin Lin,
Peng Cui, Quanhui Jia,
Zhen Wang, Yanming Fang,
Quan Yu, Jun Zhou,
Shuang Yang, and Yuan Qi.
2019.

</span>
<span class="ltx_bibblock">A semi-supervised graph attentive network for
financial fraud detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">2019 IEEE
International Conference on Data Mining (ICDM)</em>. IEEE,
598–607.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Qiao (2019)</span>
<span class="ltx_bibblock">
Huan Wang and Chunming
Qiao. 2019.

</span>
<span class="ltx_bibblock">A nodes’ evolution diversity inspired method to
detect anomalies in dynamic social networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">IEEE Transactions on Knowledge and Data
Engineering</em> 32, 10
(2019), 1868–1880.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Wei Wei, Chao Huang,
Lianghao Xia, Yong Xu,
Jiashu Zhao, and Dawei Yin.
2022.

</span>
<span class="ltx_bibblock">Contrastive meta learning with behavior
multiplicity for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of
the fifteenth ACM international conference on web search and data mining</em>.
1120–1128.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wi et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Seongil Wi, Sijae Woo,
Joyce Jiyoung Whang, and Sooel Son.
2022.

</span>
<span class="ltx_bibblock">HiddenCPG: large-scale vulnerable clone detection
using subgraph isomorphism of code property graphs. In
<em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the ACM Web Conference 2022</em>.
755–766.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shiwen Wu, Fei Sun,
Wentao Zhang, Xu Xie, and
Bin Cui. 2022.

</span>
<span class="ltx_bibblock">Graph neural networks in recommender systems: a
survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Comput. Surveys</em> 55,
5 (2022), 1–37.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Da Xu, Chuanwei Ruan,
Evren Korpeoglu, Sushant Kumar, and
Kannan Achan. 2020.

</span>
<span class="ltx_bibblock">Inductive representation learning on temporal
graphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">arXiv preprint arXiv:2002.07962</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xiongxiao Xu, Kaize Ding,
Canyu Chen, and Kai Shu.
2023.

</span>
<span class="ltx_bibblock">MetaGAD: Learning to Meta Transfer for Few-shot
Graph Anomaly Detection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">arXiv preprint arXiv:2305.10668</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Chenming Yang, Liang
Zhou, Hui Wen, Zhiheng Zhou, and
Yue Wu. 2020.

</span>
<span class="ltx_bibblock">H-vgrae: A hierarchical stochastic spatial-temporal
embedding method for robust anomaly detection in dynamic networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">arXiv preprint arXiv:2007.06903</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Ruosong Ye, Caiqi Zhang,
Runhui Wang, Shuyuan Xu, and
Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">Natural language is all a graph needs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">arXiv preprint arXiv:2308.07134</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Wenchao Yu, Wei Cheng,
Charu C Aggarwal, Kai Zhang,
Haifeng Chen, and Wei Wang.
2018.

</span>
<span class="ltx_bibblock">Netwalk: A flexible deep embedding approach for
anomaly detection in dynamic networks. In
<em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">Proceedings of the 24th ACM SIGKDD international
conference on knowledge discovery &amp; data mining</em>.
2672–2681.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Lifan Zhao, Shuming Kong,
and Yanyan Shen. 2023.

</span>
<span class="ltx_bibblock">DoubleAdapt: A Meta-learning Approach to
Incremental Learning for Stock Trend Forecasting. In
<em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Proceedings of the 29th ACM SIGKDD Conference on
Knowledge Discovery and Data Mining</em>. 3492–3503.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Li Zheng, Zhenpeng Li,
Jian Li, Zhao Li, and
Jun Gao. 2019.

</span>
<span class="ltx_bibblock">AddGraph: Anomaly Detection in Dynamic Graph Using
Attention-based Temporal GCN.. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">IJCAI</em>,
Vol. 3. 7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yifan Zhu, Fangpeng Cong,
Dan Zhang, Wenwen Gong,
Qika Lin, Wenzheng Feng,
Yuxiao Dong, and Jie Tang.
2023.

</span>
<span class="ltx_bibblock">WinGNN: Dynamic Graph Neural Networks with Random
Gradient Aggregation Window. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Proceedings of the
29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>.
3650–3662.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1. </span>Detail of Dynamic Encoder</h3>
<section class="ltx_subsubsection" id="A1.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.1. </span>Calculation of Diffusion Matrix</h4>
<div class="ltx_para" id="A1.SS1.SSS1.p1">
<p class="ltx_p" id="A1.SS1.SSS1.p1.6">Given the adjacency matrix <math alttext="\mathbf{A}^{t}\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.1.m1.1"><semantics id="A1.SS1.SSS1.p1.1.m1.1a"><mrow id="A1.SS1.SSS1.p1.1.m1.1.1" xref="A1.SS1.SSS1.p1.1.m1.1.1.cmml"><msup id="A1.SS1.SSS1.p1.1.m1.1.1.2" xref="A1.SS1.SSS1.p1.1.m1.1.1.2.cmml"><mi id="A1.SS1.SSS1.p1.1.m1.1.1.2.2" xref="A1.SS1.SSS1.p1.1.m1.1.1.2.2.cmml">𝐀</mi><mi id="A1.SS1.SSS1.p1.1.m1.1.1.2.3" xref="A1.SS1.SSS1.p1.1.m1.1.1.2.3.cmml">t</mi></msup><mo id="A1.SS1.SSS1.p1.1.m1.1.1.1" xref="A1.SS1.SSS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="A1.SS1.SSS1.p1.1.m1.1.1.3" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.cmml"><mi id="A1.SS1.SSS1.p1.1.m1.1.1.3.2" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS1.SSS1.p1.1.m1.1.1.3.3" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.3.cmml"><mi id="A1.SS1.SSS1.p1.1.m1.1.1.3.3.2" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.3.2.cmml">n</mi><mo id="A1.SS1.SSS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.SSS1.p1.1.m1.1.1.3.3.3" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.1.m1.1b"><apply id="A1.SS1.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1"><in id="A1.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.1"></in><apply id="A1.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.1.m1.1.1.2.1.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.2">superscript</csymbol><ci id="A1.SS1.SSS1.p1.1.m1.1.1.2.2.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.2.2">𝐀</ci><ci id="A1.SS1.SSS1.p1.1.m1.1.1.2.3.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.2.3">𝑡</ci></apply><apply id="A1.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.1.m1.1.1.3.1.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS1.SSS1.p1.1.m1.1.1.3.2.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="A1.SS1.SSS1.p1.1.m1.1.1.3.3.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.3"><times id="A1.SS1.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.3.1"></times><ci id="A1.SS1.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.3.2">𝑛</ci><ci id="A1.SS1.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.1.m1.1c">\mathbf{A}^{t}\in\mathbb{R}^{n\times n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.1.m1.1d">bold_A start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> at timestamp <math alttext="t" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.2.m2.1"><semantics id="A1.SS1.SSS1.p1.2.m2.1a"><mi id="A1.SS1.SSS1.p1.2.m2.1.1" xref="A1.SS1.SSS1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.2.m2.1b"><ci id="A1.SS1.SSS1.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.2.m2.1d">italic_t</annotation></semantics></math>, we calculate the diffusion matrix <math alttext="\mathbf{D}^{t}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.3.m3.1"><semantics id="A1.SS1.SSS1.p1.3.m3.1a"><mrow id="A1.SS1.SSS1.p1.3.m3.1.1" xref="A1.SS1.SSS1.p1.3.m3.1.1.cmml"><msup id="A1.SS1.SSS1.p1.3.m3.1.1.2" xref="A1.SS1.SSS1.p1.3.m3.1.1.2.cmml"><mi id="A1.SS1.SSS1.p1.3.m3.1.1.2.2" xref="A1.SS1.SSS1.p1.3.m3.1.1.2.2.cmml">𝐃</mi><mi id="A1.SS1.SSS1.p1.3.m3.1.1.2.3" xref="A1.SS1.SSS1.p1.3.m3.1.1.2.3.cmml">t</mi></msup><mo id="A1.SS1.SSS1.p1.3.m3.1.1.1" xref="A1.SS1.SSS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="A1.SS1.SSS1.p1.3.m3.1.1.3" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.cmml"><mi id="A1.SS1.SSS1.p1.3.m3.1.1.3.2" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS1.SSS1.p1.3.m3.1.1.3.3" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.3.cmml"><mi id="A1.SS1.SSS1.p1.3.m3.1.1.3.3.2" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.3.2.cmml">N</mi><mo id="A1.SS1.SSS1.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.SSS1.p1.3.m3.1.1.3.3.3" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.3.m3.1b"><apply id="A1.SS1.SSS1.p1.3.m3.1.1.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1"><in id="A1.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.1"></in><apply id="A1.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.3.m3.1.1.2.1.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.2">superscript</csymbol><ci id="A1.SS1.SSS1.p1.3.m3.1.1.2.2.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.2.2">𝐃</ci><ci id="A1.SS1.SSS1.p1.3.m3.1.1.2.3.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.2.3">𝑡</ci></apply><apply id="A1.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.3.m3.1.1.3.1.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="A1.SS1.SSS1.p1.3.m3.1.1.3.2.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="A1.SS1.SSS1.p1.3.m3.1.1.3.3.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.3"><times id="A1.SS1.SSS1.p1.3.m3.1.1.3.3.1.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.3.1"></times><ci id="A1.SS1.SSS1.p1.3.m3.1.1.3.3.2.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.3.2">𝑁</ci><ci id="A1.SS1.SSS1.p1.3.m3.1.1.3.3.3.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.3.m3.1c">\mathbf{D}^{t}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.3.m3.1d">bold_D start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> to select related nodes for the target edge. For brevity, we ignore the superscript <math alttext="t" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.4.m4.1"><semantics id="A1.SS1.SSS1.p1.4.m4.1a"><mi id="A1.SS1.SSS1.p1.4.m4.1.1" xref="A1.SS1.SSS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.4.m4.1b"><ci id="A1.SS1.SSS1.p1.4.m4.1.1.cmml" xref="A1.SS1.SSS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.4.m4.1d">italic_t</annotation></semantics></math>, and the diffusion matrix <math alttext="\mathbf{D}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.5.m5.1"><semantics id="A1.SS1.SSS1.p1.5.m5.1a"><mi id="A1.SS1.SSS1.p1.5.m5.1.1" xref="A1.SS1.SSS1.p1.5.m5.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.5.m5.1b"><ci id="A1.SS1.SSS1.p1.5.m5.1.1.cmml" xref="A1.SS1.SSS1.p1.5.m5.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.5.m5.1c">\mathbf{D}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.5.m5.1d">bold_D</annotation></semantics></math> can be calculated according to the adjacency matrix <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.6.m6.1"><semantics id="A1.SS1.SSS1.p1.6.m6.1a"><mi id="A1.SS1.SSS1.p1.6.m6.1.1" xref="A1.SS1.SSS1.p1.6.m6.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.6.m6.1b"><ci id="A1.SS1.SSS1.p1.6.m6.1.1.cmml" xref="A1.SS1.SSS1.p1.6.m6.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.6.m6.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.6.m6.1d">bold_A</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{D}=\sum_{m=0}^{\infty}\theta_{m}\mathbf{T}^{m}," class="ltx_Math" display="block" id="A1.Ex10.m1.1"><semantics id="A1.Ex10.m1.1a"><mrow id="A1.Ex10.m1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.cmml"><mrow id="A1.Ex10.m1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.1.1.1.1.2" xref="A1.Ex10.m1.1.1.1.1.2.cmml">𝐃</mi><mo id="A1.Ex10.m1.1.1.1.1.1" rspace="0.111em" xref="A1.Ex10.m1.1.1.1.1.1.cmml">=</mo><mrow id="A1.Ex10.m1.1.1.1.1.3" xref="A1.Ex10.m1.1.1.1.1.3.cmml"><munderover id="A1.Ex10.m1.1.1.1.1.3.1" xref="A1.Ex10.m1.1.1.1.1.3.1.cmml"><mo id="A1.Ex10.m1.1.1.1.1.3.1.2.2" movablelimits="false" xref="A1.Ex10.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.Ex10.m1.1.1.1.1.3.1.2.3" xref="A1.Ex10.m1.1.1.1.1.3.1.2.3.cmml"><mi id="A1.Ex10.m1.1.1.1.1.3.1.2.3.2" xref="A1.Ex10.m1.1.1.1.1.3.1.2.3.2.cmml">m</mi><mo id="A1.Ex10.m1.1.1.1.1.3.1.2.3.1" xref="A1.Ex10.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.Ex10.m1.1.1.1.1.3.1.2.3.3" xref="A1.Ex10.m1.1.1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="A1.Ex10.m1.1.1.1.1.3.1.3" mathvariant="normal" xref="A1.Ex10.m1.1.1.1.1.3.1.3.cmml">∞</mi></munderover><mrow id="A1.Ex10.m1.1.1.1.1.3.2" xref="A1.Ex10.m1.1.1.1.1.3.2.cmml"><msub id="A1.Ex10.m1.1.1.1.1.3.2.2" xref="A1.Ex10.m1.1.1.1.1.3.2.2.cmml"><mi id="A1.Ex10.m1.1.1.1.1.3.2.2.2" xref="A1.Ex10.m1.1.1.1.1.3.2.2.2.cmml">θ</mi><mi id="A1.Ex10.m1.1.1.1.1.3.2.2.3" xref="A1.Ex10.m1.1.1.1.1.3.2.2.3.cmml">m</mi></msub><mo id="A1.Ex10.m1.1.1.1.1.3.2.1" xref="A1.Ex10.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msup id="A1.Ex10.m1.1.1.1.1.3.2.3" xref="A1.Ex10.m1.1.1.1.1.3.2.3.cmml"><mi id="A1.Ex10.m1.1.1.1.1.3.2.3.2" xref="A1.Ex10.m1.1.1.1.1.3.2.3.2.cmml">𝐓</mi><mi id="A1.Ex10.m1.1.1.1.1.3.2.3.3" xref="A1.Ex10.m1.1.1.1.1.3.2.3.3.cmml">m</mi></msup></mrow></mrow></mrow><mo id="A1.Ex10.m1.1.1.1.2" xref="A1.Ex10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex10.m1.1b"><apply id="A1.Ex10.m1.1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1"><eq id="A1.Ex10.m1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1"></eq><ci id="A1.Ex10.m1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.1.1.1.1.2">𝐃</ci><apply id="A1.Ex10.m1.1.1.1.1.3.cmml" xref="A1.Ex10.m1.1.1.1.1.3"><apply id="A1.Ex10.m1.1.1.1.1.3.1.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.1.1.1.1.3.1.1.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1">superscript</csymbol><apply id="A1.Ex10.m1.1.1.1.1.3.1.2.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.1.1.1.1.3.1.2.1.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1">subscript</csymbol><sum id="A1.Ex10.m1.1.1.1.1.3.1.2.2.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1.2.2"></sum><apply id="A1.Ex10.m1.1.1.1.1.3.1.2.3.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1.2.3"><eq id="A1.Ex10.m1.1.1.1.1.3.1.2.3.1.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="A1.Ex10.m1.1.1.1.1.3.1.2.3.2.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1.2.3.2">𝑚</ci><cn id="A1.Ex10.m1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.Ex10.m1.1.1.1.1.3.1.2.3.3">0</cn></apply></apply><infinity id="A1.Ex10.m1.1.1.1.1.3.1.3.cmml" xref="A1.Ex10.m1.1.1.1.1.3.1.3"></infinity></apply><apply id="A1.Ex10.m1.1.1.1.1.3.2.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2"><times id="A1.Ex10.m1.1.1.1.1.3.2.1.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.1"></times><apply id="A1.Ex10.m1.1.1.1.1.3.2.2.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.1.1.1.1.3.2.2.1.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="A1.Ex10.m1.1.1.1.1.3.2.2.2.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.2.2">𝜃</ci><ci id="A1.Ex10.m1.1.1.1.1.3.2.2.3.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.2.3">𝑚</ci></apply><apply id="A1.Ex10.m1.1.1.1.1.3.2.3.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.1.1.1.1.3.2.3.1.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.3">superscript</csymbol><ci id="A1.Ex10.m1.1.1.1.1.3.2.3.2.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.3.2">𝐓</ci><ci id="A1.Ex10.m1.1.1.1.1.3.2.3.3.cmml" xref="A1.Ex10.m1.1.1.1.1.3.2.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex10.m1.1c">\mathbf{D}=\sum_{m=0}^{\infty}\theta_{m}\mathbf{T}^{m},</annotation><annotation encoding="application/x-llamapun" id="A1.Ex10.m1.1d">bold_D = ∑ start_POSTSUBSCRIPT italic_m = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT bold_T start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS1.p1.21">where <math alttext="\mathbf{T}\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.7.m1.1"><semantics id="A1.SS1.SSS1.p1.7.m1.1a"><mrow id="A1.SS1.SSS1.p1.7.m1.1.1" xref="A1.SS1.SSS1.p1.7.m1.1.1.cmml"><mi id="A1.SS1.SSS1.p1.7.m1.1.1.2" xref="A1.SS1.SSS1.p1.7.m1.1.1.2.cmml">𝐓</mi><mo id="A1.SS1.SSS1.p1.7.m1.1.1.1" xref="A1.SS1.SSS1.p1.7.m1.1.1.1.cmml">∈</mo><msup id="A1.SS1.SSS1.p1.7.m1.1.1.3" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.cmml"><mi id="A1.SS1.SSS1.p1.7.m1.1.1.3.2" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS1.SSS1.p1.7.m1.1.1.3.3" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.3.cmml"><mi id="A1.SS1.SSS1.p1.7.m1.1.1.3.3.2" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.3.2.cmml">n</mi><mo id="A1.SS1.SSS1.p1.7.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.SSS1.p1.7.m1.1.1.3.3.3" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.7.m1.1b"><apply id="A1.SS1.SSS1.p1.7.m1.1.1.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1"><in id="A1.SS1.SSS1.p1.7.m1.1.1.1.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.1"></in><ci id="A1.SS1.SSS1.p1.7.m1.1.1.2.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.2">𝐓</ci><apply id="A1.SS1.SSS1.p1.7.m1.1.1.3.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.7.m1.1.1.3.1.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.3">superscript</csymbol><ci id="A1.SS1.SSS1.p1.7.m1.1.1.3.2.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.2">ℝ</ci><apply id="A1.SS1.SSS1.p1.7.m1.1.1.3.3.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.3"><times id="A1.SS1.SSS1.p1.7.m1.1.1.3.3.1.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.3.1"></times><ci id="A1.SS1.SSS1.p1.7.m1.1.1.3.3.2.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.3.2">𝑛</ci><ci id="A1.SS1.SSS1.p1.7.m1.1.1.3.3.3.cmml" xref="A1.SS1.SSS1.p1.7.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.7.m1.1c">\mathbf{T}\in\mathbb{R}^{n\times n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.7.m1.1d">bold_T ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> is the generalized transition matrix and <math alttext="\theta_{m}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.8.m2.1"><semantics id="A1.SS1.SSS1.p1.8.m2.1a"><msub id="A1.SS1.SSS1.p1.8.m2.1.1" xref="A1.SS1.SSS1.p1.8.m2.1.1.cmml"><mi id="A1.SS1.SSS1.p1.8.m2.1.1.2" xref="A1.SS1.SSS1.p1.8.m2.1.1.2.cmml">θ</mi><mi id="A1.SS1.SSS1.p1.8.m2.1.1.3" xref="A1.SS1.SSS1.p1.8.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.8.m2.1b"><apply id="A1.SS1.SSS1.p1.8.m2.1.1.cmml" xref="A1.SS1.SSS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.8.m2.1.1.1.cmml" xref="A1.SS1.SSS1.p1.8.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS1.p1.8.m2.1.1.2.cmml" xref="A1.SS1.SSS1.p1.8.m2.1.1.2">𝜃</ci><ci id="A1.SS1.SSS1.p1.8.m2.1.1.3.cmml" xref="A1.SS1.SSS1.p1.8.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.8.m2.1c">\theta_{m}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.8.m2.1d">italic_θ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> is the weighting coefficient indicating the ratio of global-local information. It requires that <math alttext="\sum_{m=0}^{\infty}\theta_{m}=1,\theta_{m}\in[0,1]" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.9.m3.4"><semantics id="A1.SS1.SSS1.p1.9.m3.4a"><mrow id="A1.SS1.SSS1.p1.9.m3.4.4.2" xref="A1.SS1.SSS1.p1.9.m3.4.4.3.cmml"><mrow id="A1.SS1.SSS1.p1.9.m3.3.3.1.1" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.cmml"><mrow id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.cmml"><msubsup id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.cmml"><mo id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.2" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.cmml"><mi id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.2" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.2.cmml">m</mi><mo id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.1" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.3" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.3.cmml">0</mn></mrow><mi id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.3" mathvariant="normal" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.3.cmml">∞</mi></msubsup><msub id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.cmml"><mi id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.2" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.2.cmml">θ</mi><mi id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.3" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.3.cmml">m</mi></msub></mrow><mo id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.1" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.1.cmml">=</mo><mn id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.3" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.3.cmml">1</mn></mrow><mo id="A1.SS1.SSS1.p1.9.m3.4.4.2.3" xref="A1.SS1.SSS1.p1.9.m3.4.4.3a.cmml">,</mo><mrow id="A1.SS1.SSS1.p1.9.m3.4.4.2.2" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.cmml"><msub id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.cmml"><mi id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.2" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.2.cmml">θ</mi><mi id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.3" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.3.cmml">m</mi></msub><mo id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.1" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.1.cmml">∈</mo><mrow id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.2" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.1.cmml"><mo id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.2.1" stretchy="false" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.1.cmml">[</mo><mn id="A1.SS1.SSS1.p1.9.m3.1.1" xref="A1.SS1.SSS1.p1.9.m3.1.1.cmml">0</mn><mo id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.2.2" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.1.cmml">,</mo><mn id="A1.SS1.SSS1.p1.9.m3.2.2" xref="A1.SS1.SSS1.p1.9.m3.2.2.cmml">1</mn><mo id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.2.3" stretchy="false" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.9.m3.4b"><apply id="A1.SS1.SSS1.p1.9.m3.4.4.3.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.9.m3.4.4.3a.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.3">formulae-sequence</csymbol><apply id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1"><eq id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.1"></eq><apply id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2"><apply id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1">superscript</csymbol><apply id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1">subscript</csymbol><sum id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.2"></sum><apply id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3"><eq id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.1"></eq><ci id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.2">𝑚</ci><cn id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.2.3.3">0</cn></apply></apply><infinity id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.3.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.1.3"></infinity></apply><apply id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2">subscript</csymbol><ci id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.2">𝜃</ci><ci id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.3.cmml" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.2.2.3">𝑚</ci></apply></apply><cn id="A1.SS1.SSS1.p1.9.m3.3.3.1.1.3.cmml" type="integer" xref="A1.SS1.SSS1.p1.9.m3.3.3.1.1.3">1</cn></apply><apply id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2"><in id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.1"></in><apply id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.2.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.2">𝜃</ci><ci id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.3.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.2.3">𝑚</ci></apply><interval closure="closed" id="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.1.cmml" xref="A1.SS1.SSS1.p1.9.m3.4.4.2.2.3.2"><cn id="A1.SS1.SSS1.p1.9.m3.1.1.cmml" type="integer" xref="A1.SS1.SSS1.p1.9.m3.1.1">0</cn><cn id="A1.SS1.SSS1.p1.9.m3.2.2.cmml" type="integer" xref="A1.SS1.SSS1.p1.9.m3.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.9.m3.4c">\sum_{m=0}^{\infty}\theta_{m}=1,\theta_{m}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.9.m3.4d">∑ start_POSTSUBSCRIPT italic_m = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = 1 , italic_θ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math> and the eigenvalues <math alttext="\lambda_{r}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.10.m4.1"><semantics id="A1.SS1.SSS1.p1.10.m4.1a"><msub id="A1.SS1.SSS1.p1.10.m4.1.1" xref="A1.SS1.SSS1.p1.10.m4.1.1.cmml"><mi id="A1.SS1.SSS1.p1.10.m4.1.1.2" xref="A1.SS1.SSS1.p1.10.m4.1.1.2.cmml">λ</mi><mi id="A1.SS1.SSS1.p1.10.m4.1.1.3" xref="A1.SS1.SSS1.p1.10.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.10.m4.1b"><apply id="A1.SS1.SSS1.p1.10.m4.1.1.cmml" xref="A1.SS1.SSS1.p1.10.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.10.m4.1.1.1.cmml" xref="A1.SS1.SSS1.p1.10.m4.1.1">subscript</csymbol><ci id="A1.SS1.SSS1.p1.10.m4.1.1.2.cmml" xref="A1.SS1.SSS1.p1.10.m4.1.1.2">𝜆</ci><ci id="A1.SS1.SSS1.p1.10.m4.1.1.3.cmml" xref="A1.SS1.SSS1.p1.10.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.10.m4.1c">\lambda_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.10.m4.1d">italic_λ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.11.m5.1"><semantics id="A1.SS1.SSS1.p1.11.m5.1a"><mi id="A1.SS1.SSS1.p1.11.m5.1.1" xref="A1.SS1.SSS1.p1.11.m5.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.11.m5.1b"><ci id="A1.SS1.SSS1.p1.11.m5.1.1.cmml" xref="A1.SS1.SSS1.p1.11.m5.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.11.m5.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.11.m5.1d">bold_T</annotation></semantics></math> are bounded by <math alttext="\lambda_{r}\in[0,1]" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.12.m6.2"><semantics id="A1.SS1.SSS1.p1.12.m6.2a"><mrow id="A1.SS1.SSS1.p1.12.m6.2.3" xref="A1.SS1.SSS1.p1.12.m6.2.3.cmml"><msub id="A1.SS1.SSS1.p1.12.m6.2.3.2" xref="A1.SS1.SSS1.p1.12.m6.2.3.2.cmml"><mi id="A1.SS1.SSS1.p1.12.m6.2.3.2.2" xref="A1.SS1.SSS1.p1.12.m6.2.3.2.2.cmml">λ</mi><mi id="A1.SS1.SSS1.p1.12.m6.2.3.2.3" xref="A1.SS1.SSS1.p1.12.m6.2.3.2.3.cmml">r</mi></msub><mo id="A1.SS1.SSS1.p1.12.m6.2.3.1" xref="A1.SS1.SSS1.p1.12.m6.2.3.1.cmml">∈</mo><mrow id="A1.SS1.SSS1.p1.12.m6.2.3.3.2" xref="A1.SS1.SSS1.p1.12.m6.2.3.3.1.cmml"><mo id="A1.SS1.SSS1.p1.12.m6.2.3.3.2.1" stretchy="false" xref="A1.SS1.SSS1.p1.12.m6.2.3.3.1.cmml">[</mo><mn id="A1.SS1.SSS1.p1.12.m6.1.1" xref="A1.SS1.SSS1.p1.12.m6.1.1.cmml">0</mn><mo id="A1.SS1.SSS1.p1.12.m6.2.3.3.2.2" xref="A1.SS1.SSS1.p1.12.m6.2.3.3.1.cmml">,</mo><mn id="A1.SS1.SSS1.p1.12.m6.2.2" xref="A1.SS1.SSS1.p1.12.m6.2.2.cmml">1</mn><mo id="A1.SS1.SSS1.p1.12.m6.2.3.3.2.3" stretchy="false" xref="A1.SS1.SSS1.p1.12.m6.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.12.m6.2b"><apply id="A1.SS1.SSS1.p1.12.m6.2.3.cmml" xref="A1.SS1.SSS1.p1.12.m6.2.3"><in id="A1.SS1.SSS1.p1.12.m6.2.3.1.cmml" xref="A1.SS1.SSS1.p1.12.m6.2.3.1"></in><apply id="A1.SS1.SSS1.p1.12.m6.2.3.2.cmml" xref="A1.SS1.SSS1.p1.12.m6.2.3.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.12.m6.2.3.2.1.cmml" xref="A1.SS1.SSS1.p1.12.m6.2.3.2">subscript</csymbol><ci id="A1.SS1.SSS1.p1.12.m6.2.3.2.2.cmml" xref="A1.SS1.SSS1.p1.12.m6.2.3.2.2">𝜆</ci><ci id="A1.SS1.SSS1.p1.12.m6.2.3.2.3.cmml" xref="A1.SS1.SSS1.p1.12.m6.2.3.2.3">𝑟</ci></apply><interval closure="closed" id="A1.SS1.SSS1.p1.12.m6.2.3.3.1.cmml" xref="A1.SS1.SSS1.p1.12.m6.2.3.3.2"><cn id="A1.SS1.SSS1.p1.12.m6.1.1.cmml" type="integer" xref="A1.SS1.SSS1.p1.12.m6.1.1">0</cn><cn id="A1.SS1.SSS1.p1.12.m6.2.2.cmml" type="integer" xref="A1.SS1.SSS1.p1.12.m6.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.12.m6.2c">\lambda_{r}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.12.m6.2d">italic_λ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math> to guarantee convergence. Different instantiations of diffusion matrix can be computed by applying specific definitions of <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.13.m7.1"><semantics id="A1.SS1.SSS1.p1.13.m7.1a"><mi id="A1.SS1.SSS1.p1.13.m7.1.1" xref="A1.SS1.SSS1.p1.13.m7.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.13.m7.1b"><ci id="A1.SS1.SSS1.p1.13.m7.1.1.cmml" xref="A1.SS1.SSS1.p1.13.m7.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.13.m7.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.13.m7.1d">bold_T</annotation></semantics></math> and <math alttext="\theta" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.14.m8.1"><semantics id="A1.SS1.SSS1.p1.14.m8.1a"><mi id="A1.SS1.SSS1.p1.14.m8.1.1" xref="A1.SS1.SSS1.p1.14.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.14.m8.1b"><ci id="A1.SS1.SSS1.p1.14.m8.1.1.cmml" xref="A1.SS1.SSS1.p1.14.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.14.m8.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.14.m8.1d">italic_θ</annotation></semantics></math>. For instance, Personalized PageRank (PPR) <cite class="ltx_cite ltx_citemacro_citep">(Page et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib28" title="">1998</a>)</cite> chooses <math alttext="\mathbf{T}=\mathbf{A}\mathbf{S}^{-1}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.15.m9.1"><semantics id="A1.SS1.SSS1.p1.15.m9.1a"><mrow id="A1.SS1.SSS1.p1.15.m9.1.1" xref="A1.SS1.SSS1.p1.15.m9.1.1.cmml"><mi id="A1.SS1.SSS1.p1.15.m9.1.1.2" xref="A1.SS1.SSS1.p1.15.m9.1.1.2.cmml">𝐓</mi><mo id="A1.SS1.SSS1.p1.15.m9.1.1.1" xref="A1.SS1.SSS1.p1.15.m9.1.1.1.cmml">=</mo><msup id="A1.SS1.SSS1.p1.15.m9.1.1.3" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.cmml"><mi id="A1.SS1.SSS1.p1.15.m9.1.1.3.2" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.2.cmml">𝐀𝐒</mi><mrow id="A1.SS1.SSS1.p1.15.m9.1.1.3.3" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.3.cmml"><mo id="A1.SS1.SSS1.p1.15.m9.1.1.3.3a" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.3.cmml">−</mo><mn id="A1.SS1.SSS1.p1.15.m9.1.1.3.3.2" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.15.m9.1b"><apply id="A1.SS1.SSS1.p1.15.m9.1.1.cmml" xref="A1.SS1.SSS1.p1.15.m9.1.1"><eq id="A1.SS1.SSS1.p1.15.m9.1.1.1.cmml" xref="A1.SS1.SSS1.p1.15.m9.1.1.1"></eq><ci id="A1.SS1.SSS1.p1.15.m9.1.1.2.cmml" xref="A1.SS1.SSS1.p1.15.m9.1.1.2">𝐓</ci><apply id="A1.SS1.SSS1.p1.15.m9.1.1.3.cmml" xref="A1.SS1.SSS1.p1.15.m9.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.15.m9.1.1.3.1.cmml" xref="A1.SS1.SSS1.p1.15.m9.1.1.3">superscript</csymbol><ci id="A1.SS1.SSS1.p1.15.m9.1.1.3.2.cmml" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.2">𝐀𝐒</ci><apply id="A1.SS1.SSS1.p1.15.m9.1.1.3.3.cmml" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.3"><minus id="A1.SS1.SSS1.p1.15.m9.1.1.3.3.1.cmml" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.3"></minus><cn id="A1.SS1.SSS1.p1.15.m9.1.1.3.3.2.cmml" type="integer" xref="A1.SS1.SSS1.p1.15.m9.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.15.m9.1c">\mathbf{T}=\mathbf{A}\mathbf{S}^{-1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.15.m9.1d">bold_T = bold_AS start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\theta_{m}=\alpha(1-\alpha)^{m}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.16.m10.1"><semantics id="A1.SS1.SSS1.p1.16.m10.1a"><mrow id="A1.SS1.SSS1.p1.16.m10.1.1" xref="A1.SS1.SSS1.p1.16.m10.1.1.cmml"><msub id="A1.SS1.SSS1.p1.16.m10.1.1.3" xref="A1.SS1.SSS1.p1.16.m10.1.1.3.cmml"><mi id="A1.SS1.SSS1.p1.16.m10.1.1.3.2" xref="A1.SS1.SSS1.p1.16.m10.1.1.3.2.cmml">θ</mi><mi id="A1.SS1.SSS1.p1.16.m10.1.1.3.3" xref="A1.SS1.SSS1.p1.16.m10.1.1.3.3.cmml">m</mi></msub><mo id="A1.SS1.SSS1.p1.16.m10.1.1.2" xref="A1.SS1.SSS1.p1.16.m10.1.1.2.cmml">=</mo><mrow id="A1.SS1.SSS1.p1.16.m10.1.1.1" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.cmml"><mi id="A1.SS1.SSS1.p1.16.m10.1.1.1.3" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.3.cmml">α</mi><mo id="A1.SS1.SSS1.p1.16.m10.1.1.1.2" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.2.cmml">⁢</mo><msup id="A1.SS1.SSS1.p1.16.m10.1.1.1.1" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.cmml"><mrow id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.cmml"><mo id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.cmml"><mn id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.2" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.1" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.3" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.3" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.3.cmml">m</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.16.m10.1b"><apply id="A1.SS1.SSS1.p1.16.m10.1.1.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1"><eq id="A1.SS1.SSS1.p1.16.m10.1.1.2.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.2"></eq><apply id="A1.SS1.SSS1.p1.16.m10.1.1.3.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.16.m10.1.1.3.1.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.3">subscript</csymbol><ci id="A1.SS1.SSS1.p1.16.m10.1.1.3.2.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.3.2">𝜃</ci><ci id="A1.SS1.SSS1.p1.16.m10.1.1.3.3.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.3.3">𝑚</ci></apply><apply id="A1.SS1.SSS1.p1.16.m10.1.1.1.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1"><times id="A1.SS1.SSS1.p1.16.m10.1.1.1.2.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.2"></times><ci id="A1.SS1.SSS1.p1.16.m10.1.1.1.3.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.3">𝛼</ci><apply id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.2.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1">superscript</csymbol><apply id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1"><minus id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.1"></minus><cn id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.2">1</cn><ci id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.1.1.1.3">𝛼</ci></apply><ci id="A1.SS1.SSS1.p1.16.m10.1.1.1.1.3.cmml" xref="A1.SS1.SSS1.p1.16.m10.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.16.m10.1c">\theta_{m}=\alpha(1-\alpha)^{m}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.16.m10.1d">italic_θ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = italic_α ( 1 - italic_α ) start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\mathbf{S}\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.17.m11.1"><semantics id="A1.SS1.SSS1.p1.17.m11.1a"><mrow id="A1.SS1.SSS1.p1.17.m11.1.1" xref="A1.SS1.SSS1.p1.17.m11.1.1.cmml"><mi id="A1.SS1.SSS1.p1.17.m11.1.1.2" xref="A1.SS1.SSS1.p1.17.m11.1.1.2.cmml">𝐒</mi><mo id="A1.SS1.SSS1.p1.17.m11.1.1.1" xref="A1.SS1.SSS1.p1.17.m11.1.1.1.cmml">∈</mo><msup id="A1.SS1.SSS1.p1.17.m11.1.1.3" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.cmml"><mi id="A1.SS1.SSS1.p1.17.m11.1.1.3.2" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS1.SSS1.p1.17.m11.1.1.3.3" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.3.cmml"><mi id="A1.SS1.SSS1.p1.17.m11.1.1.3.3.2" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.3.2.cmml">n</mi><mo id="A1.SS1.SSS1.p1.17.m11.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.SSS1.p1.17.m11.1.1.3.3.3" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.17.m11.1b"><apply id="A1.SS1.SSS1.p1.17.m11.1.1.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1"><in id="A1.SS1.SSS1.p1.17.m11.1.1.1.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.1"></in><ci id="A1.SS1.SSS1.p1.17.m11.1.1.2.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.2">𝐒</ci><apply id="A1.SS1.SSS1.p1.17.m11.1.1.3.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.17.m11.1.1.3.1.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.3">superscript</csymbol><ci id="A1.SS1.SSS1.p1.17.m11.1.1.3.2.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.2">ℝ</ci><apply id="A1.SS1.SSS1.p1.17.m11.1.1.3.3.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.3"><times id="A1.SS1.SSS1.p1.17.m11.1.1.3.3.1.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.3.1"></times><ci id="A1.SS1.SSS1.p1.17.m11.1.1.3.3.2.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.3.2">𝑛</ci><ci id="A1.SS1.SSS1.p1.17.m11.1.1.3.3.3.cmml" xref="A1.SS1.SSS1.p1.17.m11.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.17.m11.1c">\mathbf{S}\in\mathbb{R}^{n\times n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.17.m11.1d">bold_S ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> is the diagonal degree matrix and <math alttext="\alpha\in(0,1)" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.18.m12.2"><semantics id="A1.SS1.SSS1.p1.18.m12.2a"><mrow id="A1.SS1.SSS1.p1.18.m12.2.3" xref="A1.SS1.SSS1.p1.18.m12.2.3.cmml"><mi id="A1.SS1.SSS1.p1.18.m12.2.3.2" xref="A1.SS1.SSS1.p1.18.m12.2.3.2.cmml">α</mi><mo id="A1.SS1.SSS1.p1.18.m12.2.3.1" xref="A1.SS1.SSS1.p1.18.m12.2.3.1.cmml">∈</mo><mrow id="A1.SS1.SSS1.p1.18.m12.2.3.3.2" xref="A1.SS1.SSS1.p1.18.m12.2.3.3.1.cmml"><mo id="A1.SS1.SSS1.p1.18.m12.2.3.3.2.1" stretchy="false" xref="A1.SS1.SSS1.p1.18.m12.2.3.3.1.cmml">(</mo><mn id="A1.SS1.SSS1.p1.18.m12.1.1" xref="A1.SS1.SSS1.p1.18.m12.1.1.cmml">0</mn><mo id="A1.SS1.SSS1.p1.18.m12.2.3.3.2.2" xref="A1.SS1.SSS1.p1.18.m12.2.3.3.1.cmml">,</mo><mn id="A1.SS1.SSS1.p1.18.m12.2.2" xref="A1.SS1.SSS1.p1.18.m12.2.2.cmml">1</mn><mo id="A1.SS1.SSS1.p1.18.m12.2.3.3.2.3" stretchy="false" xref="A1.SS1.SSS1.p1.18.m12.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.18.m12.2b"><apply id="A1.SS1.SSS1.p1.18.m12.2.3.cmml" xref="A1.SS1.SSS1.p1.18.m12.2.3"><in id="A1.SS1.SSS1.p1.18.m12.2.3.1.cmml" xref="A1.SS1.SSS1.p1.18.m12.2.3.1"></in><ci id="A1.SS1.SSS1.p1.18.m12.2.3.2.cmml" xref="A1.SS1.SSS1.p1.18.m12.2.3.2">𝛼</ci><interval closure="open" id="A1.SS1.SSS1.p1.18.m12.2.3.3.1.cmml" xref="A1.SS1.SSS1.p1.18.m12.2.3.3.2"><cn id="A1.SS1.SSS1.p1.18.m12.1.1.cmml" type="integer" xref="A1.SS1.SSS1.p1.18.m12.1.1">0</cn><cn id="A1.SS1.SSS1.p1.18.m12.2.2.cmml" type="integer" xref="A1.SS1.SSS1.p1.18.m12.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.18.m12.2c">\alpha\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.18.m12.2d">italic_α ∈ ( 0 , 1 )</annotation></semantics></math> is the teleport probability. Another popular example of diffusion matrix is the heat kernal <cite class="ltx_cite ltx_citemacro_citep">(Kondor and Lafferty, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib17" title="">2002</a>)</cite>, which chooses <math alttext="\mathbf{T}=\mathbf{A}\mathbf{S}^{-1}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.19.m13.1"><semantics id="A1.SS1.SSS1.p1.19.m13.1a"><mrow id="A1.SS1.SSS1.p1.19.m13.1.1" xref="A1.SS1.SSS1.p1.19.m13.1.1.cmml"><mi id="A1.SS1.SSS1.p1.19.m13.1.1.2" xref="A1.SS1.SSS1.p1.19.m13.1.1.2.cmml">𝐓</mi><mo id="A1.SS1.SSS1.p1.19.m13.1.1.1" xref="A1.SS1.SSS1.p1.19.m13.1.1.1.cmml">=</mo><msup id="A1.SS1.SSS1.p1.19.m13.1.1.3" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.cmml"><mi id="A1.SS1.SSS1.p1.19.m13.1.1.3.2" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.2.cmml">𝐀𝐒</mi><mrow id="A1.SS1.SSS1.p1.19.m13.1.1.3.3" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.3.cmml"><mo id="A1.SS1.SSS1.p1.19.m13.1.1.3.3a" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.3.cmml">−</mo><mn id="A1.SS1.SSS1.p1.19.m13.1.1.3.3.2" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.19.m13.1b"><apply id="A1.SS1.SSS1.p1.19.m13.1.1.cmml" xref="A1.SS1.SSS1.p1.19.m13.1.1"><eq id="A1.SS1.SSS1.p1.19.m13.1.1.1.cmml" xref="A1.SS1.SSS1.p1.19.m13.1.1.1"></eq><ci id="A1.SS1.SSS1.p1.19.m13.1.1.2.cmml" xref="A1.SS1.SSS1.p1.19.m13.1.1.2">𝐓</ci><apply id="A1.SS1.SSS1.p1.19.m13.1.1.3.cmml" xref="A1.SS1.SSS1.p1.19.m13.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.19.m13.1.1.3.1.cmml" xref="A1.SS1.SSS1.p1.19.m13.1.1.3">superscript</csymbol><ci id="A1.SS1.SSS1.p1.19.m13.1.1.3.2.cmml" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.2">𝐀𝐒</ci><apply id="A1.SS1.SSS1.p1.19.m13.1.1.3.3.cmml" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.3"><minus id="A1.SS1.SSS1.p1.19.m13.1.1.3.3.1.cmml" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.3"></minus><cn id="A1.SS1.SSS1.p1.19.m13.1.1.3.3.2.cmml" type="integer" xref="A1.SS1.SSS1.p1.19.m13.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.19.m13.1c">\mathbf{T}=\mathbf{A}\mathbf{S}^{-1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.19.m13.1d">bold_T = bold_AS start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\theta_{m}=e^{-\beta}\beta^{m}/m!" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.20.m14.1"><semantics id="A1.SS1.SSS1.p1.20.m14.1a"><mrow id="A1.SS1.SSS1.p1.20.m14.1.1" xref="A1.SS1.SSS1.p1.20.m14.1.1.cmml"><msub id="A1.SS1.SSS1.p1.20.m14.1.1.2" xref="A1.SS1.SSS1.p1.20.m14.1.1.2.cmml"><mi id="A1.SS1.SSS1.p1.20.m14.1.1.2.2" xref="A1.SS1.SSS1.p1.20.m14.1.1.2.2.cmml">θ</mi><mi id="A1.SS1.SSS1.p1.20.m14.1.1.2.3" xref="A1.SS1.SSS1.p1.20.m14.1.1.2.3.cmml">m</mi></msub><mo id="A1.SS1.SSS1.p1.20.m14.1.1.1" xref="A1.SS1.SSS1.p1.20.m14.1.1.1.cmml">=</mo><mrow id="A1.SS1.SSS1.p1.20.m14.1.1.3" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.cmml"><mrow id="A1.SS1.SSS1.p1.20.m14.1.1.3.2" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.cmml"><msup id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.cmml"><mi id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.2" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.2.cmml">e</mi><mrow id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3.cmml"><mo id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3a" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3.cmml">−</mo><mi id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3.2" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3.2.cmml">β</mi></mrow></msup><mo id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.1" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.1.cmml">⁢</mo><msup id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.cmml"><mi id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.2" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.2.cmml">β</mi><mi id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.3" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.3.cmml">m</mi></msup></mrow><mo id="A1.SS1.SSS1.p1.20.m14.1.1.3.1" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.1.cmml">/</mo><mrow id="A1.SS1.SSS1.p1.20.m14.1.1.3.3" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.3.cmml"><mi id="A1.SS1.SSS1.p1.20.m14.1.1.3.3.2" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.3.2.cmml">m</mi><mo id="A1.SS1.SSS1.p1.20.m14.1.1.3.3.1" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.3.1.cmml">!</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.20.m14.1b"><apply id="A1.SS1.SSS1.p1.20.m14.1.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1"><eq id="A1.SS1.SSS1.p1.20.m14.1.1.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.1"></eq><apply id="A1.SS1.SSS1.p1.20.m14.1.1.2.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.20.m14.1.1.2.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS1.p1.20.m14.1.1.2.2.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.2.2">𝜃</ci><ci id="A1.SS1.SSS1.p1.20.m14.1.1.2.3.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.2.3">𝑚</ci></apply><apply id="A1.SS1.SSS1.p1.20.m14.1.1.3.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3"><divide id="A1.SS1.SSS1.p1.20.m14.1.1.3.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.1"></divide><apply id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2"><times id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.1"></times><apply id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2">superscript</csymbol><ci id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.2.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.2">𝑒</ci><apply id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3"><minus id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3"></minus><ci id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3.2.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.2.3.2">𝛽</ci></apply></apply><apply id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3">superscript</csymbol><ci id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.2.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.2">𝛽</ci><ci id="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.3.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.2.3.3">𝑚</ci></apply></apply><apply id="A1.SS1.SSS1.p1.20.m14.1.1.3.3.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.3"><factorial id="A1.SS1.SSS1.p1.20.m14.1.1.3.3.1.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.3.1"></factorial><ci id="A1.SS1.SSS1.p1.20.m14.1.1.3.3.2.cmml" xref="A1.SS1.SSS1.p1.20.m14.1.1.3.3.2">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.20.m14.1c">\theta_{m}=e^{-\beta}\beta^{m}/m!</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.20.m14.1d">italic_θ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = italic_e start_POSTSUPERSCRIPT - italic_β end_POSTSUPERSCRIPT italic_β start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT / italic_m !</annotation></semantics></math>, where <math alttext="\beta" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.21.m15.1"><semantics id="A1.SS1.SSS1.p1.21.m15.1a"><mi id="A1.SS1.SSS1.p1.21.m15.1.1" xref="A1.SS1.SSS1.p1.21.m15.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.21.m15.1b"><ci id="A1.SS1.SSS1.p1.21.m15.1.1.cmml" xref="A1.SS1.SSS1.p1.21.m15.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.21.m15.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.21.m15.1d">italic_β</annotation></semantics></math> is the diffusion time. The solutions to PPR and heat kernel can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{D}^{\text{PPR}}=\alpha(\mathbf{I}_{n}-(1-\alpha)\mathbf{S}^{-1/2}%
\mathbf{A}\mathbf{S}^{-1/2})^{-1}," class="ltx_Math" display="block" id="A1.Ex11.m1.1"><semantics id="A1.Ex11.m1.1a"><mrow id="A1.Ex11.m1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.cmml"><mrow id="A1.Ex11.m1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.cmml"><msup id="A1.Ex11.m1.1.1.1.1.3" xref="A1.Ex11.m1.1.1.1.1.3.cmml"><mi id="A1.Ex11.m1.1.1.1.1.3.2" xref="A1.Ex11.m1.1.1.1.1.3.2.cmml">𝐃</mi><mtext id="A1.Ex11.m1.1.1.1.1.3.3" xref="A1.Ex11.m1.1.1.1.1.3.3a.cmml">PPR</mtext></msup><mo id="A1.Ex11.m1.1.1.1.1.2" xref="A1.Ex11.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.Ex11.m1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.cmml"><mi id="A1.Ex11.m1.1.1.1.1.1.3" xref="A1.Ex11.m1.1.1.1.1.1.3.cmml">α</mi><mo id="A1.Ex11.m1.1.1.1.1.1.2" xref="A1.Ex11.m1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A1.Ex11.m1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐈</mi><mi id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></msub><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐒</mi><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3a" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">−</mo><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">1</mn><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml">/</mo><mn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">2</mn></mrow></mrow></msup><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">𝐀𝐒</mi><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3a" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">−</mo><mrow id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml"><mn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.2" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.2.cmml">1</mn><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.1" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.1.cmml">/</mo><mn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.3" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.3.cmml">2</mn></mrow></mrow></msup></mrow></mrow><mo id="A1.Ex11.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A1.Ex11.m1.1.1.1.1.1.1.3" xref="A1.Ex11.m1.1.1.1.1.1.1.3.cmml"><mo id="A1.Ex11.m1.1.1.1.1.1.1.3a" xref="A1.Ex11.m1.1.1.1.1.1.1.3.cmml">−</mo><mn id="A1.Ex11.m1.1.1.1.1.1.1.3.2" xref="A1.Ex11.m1.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup></mrow></mrow><mo id="A1.Ex11.m1.1.1.1.2" xref="A1.Ex11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex11.m1.1b"><apply id="A1.Ex11.m1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1"><eq id="A1.Ex11.m1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.1.1.2"></eq><apply id="A1.Ex11.m1.1.1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.1.1.3.1.cmml" xref="A1.Ex11.m1.1.1.1.1.3">superscript</csymbol><ci id="A1.Ex11.m1.1.1.1.1.3.2.cmml" xref="A1.Ex11.m1.1.1.1.1.3.2">𝐃</ci><ci id="A1.Ex11.m1.1.1.1.1.3.3a.cmml" xref="A1.Ex11.m1.1.1.1.1.3.3"><mtext id="A1.Ex11.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.Ex11.m1.1.1.1.1.3.3">PPR</mtext></ci></apply><apply id="A1.Ex11.m1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1"><times id="A1.Ex11.m1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.2"></times><ci id="A1.Ex11.m1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.3">𝛼</ci><apply id="A1.Ex11.m1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1"><minus id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.2">𝐈</ci><ci id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐒</ci><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3"></minus><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2"><divide id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.1"></divide><cn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" type="integer" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">1</cn><cn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">2</cn></apply></apply></apply><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.2">𝐀𝐒</ci><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3"><minus id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3"></minus><apply id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2"><divide id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.1"></divide><cn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.2.cmml" type="integer" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.2">1</cn><cn id="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.3.cmml" type="integer" xref="A1.Ex11.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.3">2</cn></apply></apply></apply></apply></apply><apply id="A1.Ex11.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.3"><minus id="A1.Ex11.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1.3"></minus><cn id="A1.Ex11.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.Ex11.m1.1.1.1.1.1.1.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex11.m1.1c">\mathbf{D}^{\text{PPR}}=\alpha(\mathbf{I}_{n}-(1-\alpha)\mathbf{S}^{-1/2}%
\mathbf{A}\mathbf{S}^{-1/2})^{-1},</annotation><annotation encoding="application/x-llamapun" id="A1.Ex11.m1.1d">bold_D start_POSTSUPERSCRIPT PPR end_POSTSUPERSCRIPT = italic_α ( bold_I start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT - ( 1 - italic_α ) bold_S start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT bold_AS start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{D}^{\text{heat}}=\exp(\beta\mathbf{A}\mathbf{S}^{-1}-\beta)." class="ltx_Math" display="block" id="A1.Ex12.m1.2"><semantics id="A1.Ex12.m1.2a"><mrow id="A1.Ex12.m1.2.2.1" xref="A1.Ex12.m1.2.2.1.1.cmml"><mrow id="A1.Ex12.m1.2.2.1.1" xref="A1.Ex12.m1.2.2.1.1.cmml"><msup id="A1.Ex12.m1.2.2.1.1.3" xref="A1.Ex12.m1.2.2.1.1.3.cmml"><mi id="A1.Ex12.m1.2.2.1.1.3.2" xref="A1.Ex12.m1.2.2.1.1.3.2.cmml">𝐃</mi><mtext id="A1.Ex12.m1.2.2.1.1.3.3" xref="A1.Ex12.m1.2.2.1.1.3.3a.cmml">heat</mtext></msup><mo id="A1.Ex12.m1.2.2.1.1.2" xref="A1.Ex12.m1.2.2.1.1.2.cmml">=</mo><mrow id="A1.Ex12.m1.2.2.1.1.1.1" xref="A1.Ex12.m1.2.2.1.1.1.2.cmml"><mi id="A1.Ex12.m1.1.1" xref="A1.Ex12.m1.1.1.cmml">exp</mi><mo id="A1.Ex12.m1.2.2.1.1.1.1a" xref="A1.Ex12.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="A1.Ex12.m1.2.2.1.1.1.1.1" xref="A1.Ex12.m1.2.2.1.1.1.2.cmml"><mo id="A1.Ex12.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex12.m1.2.2.1.1.1.2.cmml">(</mo><mrow id="A1.Ex12.m1.2.2.1.1.1.1.1.1" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.2" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.2.cmml">β</mi><mo id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.1" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.2" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">𝐀𝐒</mi><mrow id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3.cmml"><mo id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3a" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">−</mo><mn id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3.2" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3.2.cmml">1</mn></mrow></msup></mrow><mo id="A1.Ex12.m1.2.2.1.1.1.1.1.1.1" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.Ex12.m1.2.2.1.1.1.1.1.1.3" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="A1.Ex12.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex12.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex12.m1.2.2.1.2" lspace="0em" xref="A1.Ex12.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex12.m1.2b"><apply id="A1.Ex12.m1.2.2.1.1.cmml" xref="A1.Ex12.m1.2.2.1"><eq id="A1.Ex12.m1.2.2.1.1.2.cmml" xref="A1.Ex12.m1.2.2.1.1.2"></eq><apply id="A1.Ex12.m1.2.2.1.1.3.cmml" xref="A1.Ex12.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.2.2.1.1.3.1.cmml" xref="A1.Ex12.m1.2.2.1.1.3">superscript</csymbol><ci id="A1.Ex12.m1.2.2.1.1.3.2.cmml" xref="A1.Ex12.m1.2.2.1.1.3.2">𝐃</ci><ci id="A1.Ex12.m1.2.2.1.1.3.3a.cmml" xref="A1.Ex12.m1.2.2.1.1.3.3"><mtext id="A1.Ex12.m1.2.2.1.1.3.3.cmml" mathsize="70%" xref="A1.Ex12.m1.2.2.1.1.3.3">heat</mtext></ci></apply><apply id="A1.Ex12.m1.2.2.1.1.1.2.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1"><exp id="A1.Ex12.m1.1.1.cmml" xref="A1.Ex12.m1.1.1"></exp><apply id="A1.Ex12.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1"><minus id="A1.Ex12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2"><times id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.1"></times><ci id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.2">𝛽</ci><apply id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.2">𝐀𝐒</ci><apply id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3"><minus id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3.1.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3"></minus><cn id="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3.2.cmml" type="integer" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.2.3.3.2">1</cn></apply></apply></apply><ci id="A1.Ex12.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex12.m1.2.2.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex12.m1.2c">\mathbf{D}^{\text{heat}}=\exp(\beta\mathbf{A}\mathbf{S}^{-1}-\beta).</annotation><annotation encoding="application/x-llamapun" id="A1.Ex12.m1.2d">bold_D start_POSTSUPERSCRIPT heat end_POSTSUPERSCRIPT = roman_exp ( italic_β bold_AS start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT - italic_β ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.2. </span>Node Encoding</h4>
<div class="ltx_para" id="A1.SS1.SSS2.p1">
<p class="ltx_p" id="A1.SS1.SSS2.p1.7">For each node <math alttext="v_{m}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.1.m1.1"><semantics id="A1.SS1.SSS2.p1.1.m1.1a"><msubsup id="A1.SS1.SSS2.p1.1.m1.1.1" xref="A1.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="A1.SS1.SSS2.p1.1.m1.1.1.2.2" xref="A1.SS1.SSS2.p1.1.m1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p1.1.m1.1.1.2.3" xref="A1.SS1.SSS2.p1.1.m1.1.1.2.3.cmml">m</mi><mi id="A1.SS1.SSS2.p1.1.m1.1.1.3" xref="A1.SS1.SSS2.p1.1.m1.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.1.m1.1b"><apply id="A1.SS1.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.1.m1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p1.1.m1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p1.1.m1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1.2.3">𝑚</ci></apply><ci id="A1.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.1.m1.1c">v_{m}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> in every <math alttext="g_{i}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.2.m2.1"><semantics id="A1.SS1.SSS2.p1.2.m2.1a"><msubsup id="A1.SS1.SSS2.p1.2.m2.1.1" xref="A1.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="A1.SS1.SSS2.p1.2.m2.1.1.2.2" xref="A1.SS1.SSS2.p1.2.m2.1.1.2.2.cmml">g</mi><mi id="A1.SS1.SSS2.p1.2.m2.1.1.2.3" xref="A1.SS1.SSS2.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="A1.SS1.SSS2.p1.2.m2.1.1.3" xref="A1.SS1.SSS2.p1.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.2.m2.1b"><apply id="A1.SS1.SSS2.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.2.m2.1.1.2.1.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p1.2.m2.1.1.2.2.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1.2.2">𝑔</ci><ci id="A1.SS1.SSS2.p1.2.m2.1.1.2.3.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.2.m2.1c">g_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> within <math alttext="\mathcal{S}_{i,j}^{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.3.m3.2"><semantics id="A1.SS1.SSS2.p1.3.m3.2a"><msubsup id="A1.SS1.SSS2.p1.3.m3.2.3" xref="A1.SS1.SSS2.p1.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.SSS2.p1.3.m3.2.3.2.2" xref="A1.SS1.SSS2.p1.3.m3.2.3.2.2.cmml">𝒮</mi><mrow id="A1.SS1.SSS2.p1.3.m3.2.2.2.4" xref="A1.SS1.SSS2.p1.3.m3.2.2.2.3.cmml"><mi id="A1.SS1.SSS2.p1.3.m3.1.1.1.1" xref="A1.SS1.SSS2.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="A1.SS1.SSS2.p1.3.m3.2.2.2.4.1" xref="A1.SS1.SSS2.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="A1.SS1.SSS2.p1.3.m3.2.2.2.2" xref="A1.SS1.SSS2.p1.3.m3.2.2.2.2.cmml">j</mi></mrow><mi id="A1.SS1.SSS2.p1.3.m3.2.3.3" xref="A1.SS1.SSS2.p1.3.m3.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.3.m3.2b"><apply id="A1.SS1.SSS2.p1.3.m3.2.3.cmml" xref="A1.SS1.SSS2.p1.3.m3.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.3.m3.2.3.1.cmml" xref="A1.SS1.SSS2.p1.3.m3.2.3">superscript</csymbol><apply id="A1.SS1.SSS2.p1.3.m3.2.3.2.cmml" xref="A1.SS1.SSS2.p1.3.m3.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.3.m3.2.3.2.1.cmml" xref="A1.SS1.SSS2.p1.3.m3.2.3">subscript</csymbol><ci id="A1.SS1.SSS2.p1.3.m3.2.3.2.2.cmml" xref="A1.SS1.SSS2.p1.3.m3.2.3.2.2">𝒮</ci><list id="A1.SS1.SSS2.p1.3.m3.2.2.2.3.cmml" xref="A1.SS1.SSS2.p1.3.m3.2.2.2.4"><ci id="A1.SS1.SSS2.p1.3.m3.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.3.m3.1.1.1.1">𝑖</ci><ci id="A1.SS1.SSS2.p1.3.m3.2.2.2.2.cmml" xref="A1.SS1.SSS2.p1.3.m3.2.2.2.2">𝑗</ci></list></apply><ci id="A1.SS1.SSS2.p1.3.m3.2.3.3.cmml" xref="A1.SS1.SSS2.p1.3.m3.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.3.m3.2c">\mathcal{S}_{i,j}^{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.3.m3.2d">caligraphic_S start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, the node encoding is calculated by <math alttext="\mathbf{z}_{m}=\mathbf{z}_{\text{diff}}(v^{\tau}_{m})+\mathbf{z}_{\text{dist}}%
(v^{\tau}_{m})+\mathbf{z}_{\text{temp}}(v^{\tau}_{m})" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.4.m4.3"><semantics id="A1.SS1.SSS2.p1.4.m4.3a"><mrow id="A1.SS1.SSS2.p1.4.m4.3.3" xref="A1.SS1.SSS2.p1.4.m4.3.3.cmml"><msub id="A1.SS1.SSS2.p1.4.m4.3.3.5" xref="A1.SS1.SSS2.p1.4.m4.3.3.5.cmml"><mi id="A1.SS1.SSS2.p1.4.m4.3.3.5.2" xref="A1.SS1.SSS2.p1.4.m4.3.3.5.2.cmml">𝐳</mi><mi id="A1.SS1.SSS2.p1.4.m4.3.3.5.3" xref="A1.SS1.SSS2.p1.4.m4.3.3.5.3.cmml">m</mi></msub><mo id="A1.SS1.SSS2.p1.4.m4.3.3.4" xref="A1.SS1.SSS2.p1.4.m4.3.3.4.cmml">=</mo><mrow id="A1.SS1.SSS2.p1.4.m4.3.3.3" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.cmml"><mrow id="A1.SS1.SSS2.p1.4.m4.1.1.1.1" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.cmml"><msub id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.cmml"><mi id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.2" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.2.cmml">𝐳</mi><mtext id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.3" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.3a.cmml">diff</mtext></msub><mo id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.2" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.cmml"><mo id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.2" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.3" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.3.cmml">m</mi><mi id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.3" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msubsup><mo id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.SSS2.p1.4.m4.3.3.3.4" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.4.cmml">+</mo><mrow id="A1.SS1.SSS2.p1.4.m4.2.2.2.2" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.cmml"><msub id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.cmml"><mi id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.2" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.2.cmml">𝐳</mi><mtext id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.3" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.3a.cmml">dist</mtext></msub><mo id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.2" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.cmml"><mo id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.2" stretchy="false" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.cmml"><mi id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.2" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.3" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.3.cmml">m</mi><mi id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.3" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.3.cmml">τ</mi></msubsup><mo id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.3" stretchy="false" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.SSS2.p1.4.m4.3.3.3.4a" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.4.cmml">+</mo><mrow id="A1.SS1.SSS2.p1.4.m4.3.3.3.3" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.cmml"><msub id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.cmml"><mi id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.2" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.2.cmml">𝐳</mi><mtext id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.3" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.3a.cmml">temp</mtext></msub><mo id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.2" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.2.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.cmml"><mo id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.2" stretchy="false" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.cmml">(</mo><msubsup id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.cmml"><mi id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.2" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.3" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.3.cmml">m</mi><mi id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.3" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.3.cmml">τ</mi></msubsup><mo id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.3" stretchy="false" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.4.m4.3b"><apply id="A1.SS1.SSS2.p1.4.m4.3.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3"><eq id="A1.SS1.SSS2.p1.4.m4.3.3.4.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.4"></eq><apply id="A1.SS1.SSS2.p1.4.m4.3.3.5.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.5"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.3.3.5.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.5">subscript</csymbol><ci id="A1.SS1.SSS2.p1.4.m4.3.3.5.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.5.2">𝐳</ci><ci id="A1.SS1.SSS2.p1.4.m4.3.3.5.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.5.3">𝑚</ci></apply><apply id="A1.SS1.SSS2.p1.4.m4.3.3.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3"><plus id="A1.SS1.SSS2.p1.4.m4.3.3.3.4.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.4"></plus><apply id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1"><times id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.2"></times><apply id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3">subscript</csymbol><ci id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.2">𝐳</ci><ci id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.3a.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.3"><mtext id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.3.3">diff</mtext></ci></apply><apply id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1">subscript</csymbol><apply id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1">superscript</csymbol><ci id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><ci id="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply><apply id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2"><times id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.2"></times><apply id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3">subscript</csymbol><ci id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.2">𝐳</ci><ci id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.3a.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.3"><mtext id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.3.cmml" mathsize="70%" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.3.3">dist</mtext></ci></apply><apply id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1">subscript</csymbol><apply id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1">superscript</csymbol><ci id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.2.3">𝜏</ci></apply><ci id="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.2.2.2.2.1.1.1.3">𝑚</ci></apply></apply><apply id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3"><times id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.2"></times><apply id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3">subscript</csymbol><ci id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.2">𝐳</ci><ci id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.3a.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.3"><mtext id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.3.cmml" mathsize="70%" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.3.3">temp</mtext></ci></apply><apply id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1">subscript</csymbol><apply id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1">superscript</csymbol><ci id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.2.3">𝜏</ci></apply><ci id="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.4.m4.3.3.3.3.1.1.1.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.4.m4.3c">\mathbf{z}_{m}=\mathbf{z}_{\text{diff}}(v^{\tau}_{m})+\mathbf{z}_{\text{dist}}%
(v^{\tau}_{m})+\mathbf{z}_{\text{temp}}(v^{\tau}_{m})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.4.m4.3d">bold_z start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = bold_z start_POSTSUBSCRIPT diff end_POSTSUBSCRIPT ( italic_v start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) + bold_z start_POSTSUBSCRIPT dist end_POSTSUBSCRIPT ( italic_v start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) + bold_z start_POSTSUBSCRIPT temp end_POSTSUBSCRIPT ( italic_v start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\mathbf{z}_{\text{diff}}(v^{\tau}_{m})" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.5.m5.1"><semantics id="A1.SS1.SSS2.p1.5.m5.1a"><mrow id="A1.SS1.SSS2.p1.5.m5.1.1" xref="A1.SS1.SSS2.p1.5.m5.1.1.cmml"><msub id="A1.SS1.SSS2.p1.5.m5.1.1.3" xref="A1.SS1.SSS2.p1.5.m5.1.1.3.cmml"><mi id="A1.SS1.SSS2.p1.5.m5.1.1.3.2" xref="A1.SS1.SSS2.p1.5.m5.1.1.3.2.cmml">𝐳</mi><mtext id="A1.SS1.SSS2.p1.5.m5.1.1.3.3" xref="A1.SS1.SSS2.p1.5.m5.1.1.3.3a.cmml">diff</mtext></msub><mo id="A1.SS1.SSS2.p1.5.m5.1.1.2" xref="A1.SS1.SSS2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p1.5.m5.1.1.1.1" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.cmml"><mo id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.cmml">(</mo><msubsup id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.2" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.3" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.3.cmml">m</mi><mi id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.3" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.3.cmml">τ</mi></msubsup><mo id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.5.m5.1b"><apply id="A1.SS1.SSS2.p1.5.m5.1.1.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1"><times id="A1.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.2"></times><apply id="A1.SS1.SSS2.p1.5.m5.1.1.3.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.5.m5.1.1.3.1.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="A1.SS1.SSS2.p1.5.m5.1.1.3.2.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.3.2">𝐳</ci><ci id="A1.SS1.SSS2.p1.5.m5.1.1.3.3a.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.3.3"><mtext id="A1.SS1.SSS2.p1.5.m5.1.1.3.3.cmml" mathsize="70%" xref="A1.SS1.SSS2.p1.5.m5.1.1.3.3">diff</mtext></ci></apply><apply id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1">subscript</csymbol><apply id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1">superscript</csymbol><ci id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.2.3">𝜏</ci></apply><ci id="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.5.m5.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.5.m5.1c">\mathbf{z}_{\text{diff}}(v^{\tau}_{m})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.5.m5.1d">bold_z start_POSTSUBSCRIPT diff end_POSTSUBSCRIPT ( italic_v start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="\mathbf{z}_{\text{dist}}(v^{\tau}_{m})" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.6.m6.1"><semantics id="A1.SS1.SSS2.p1.6.m6.1a"><mrow id="A1.SS1.SSS2.p1.6.m6.1.1" xref="A1.SS1.SSS2.p1.6.m6.1.1.cmml"><msub id="A1.SS1.SSS2.p1.6.m6.1.1.3" xref="A1.SS1.SSS2.p1.6.m6.1.1.3.cmml"><mi id="A1.SS1.SSS2.p1.6.m6.1.1.3.2" xref="A1.SS1.SSS2.p1.6.m6.1.1.3.2.cmml">𝐳</mi><mtext id="A1.SS1.SSS2.p1.6.m6.1.1.3.3" xref="A1.SS1.SSS2.p1.6.m6.1.1.3.3a.cmml">dist</mtext></msub><mo id="A1.SS1.SSS2.p1.6.m6.1.1.2" xref="A1.SS1.SSS2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p1.6.m6.1.1.1.1" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.cmml"><mo id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.cmml">(</mo><msubsup id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.2" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.3" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.3.cmml">m</mi><mi id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.3" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.3.cmml">τ</mi></msubsup><mo id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.6.m6.1b"><apply id="A1.SS1.SSS2.p1.6.m6.1.1.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1"><times id="A1.SS1.SSS2.p1.6.m6.1.1.2.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.2"></times><apply id="A1.SS1.SSS2.p1.6.m6.1.1.3.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.6.m6.1.1.3.1.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.3">subscript</csymbol><ci id="A1.SS1.SSS2.p1.6.m6.1.1.3.2.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.3.2">𝐳</ci><ci id="A1.SS1.SSS2.p1.6.m6.1.1.3.3a.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.3.3"><mtext id="A1.SS1.SSS2.p1.6.m6.1.1.3.3.cmml" mathsize="70%" xref="A1.SS1.SSS2.p1.6.m6.1.1.3.3">dist</mtext></ci></apply><apply id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1">subscript</csymbol><apply id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1">superscript</csymbol><ci id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.2.3">𝜏</ci></apply><ci id="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.6.m6.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.6.m6.1c">\mathbf{z}_{\text{dist}}(v^{\tau}_{m})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.6.m6.1d">bold_z start_POSTSUBSCRIPT dist end_POSTSUBSCRIPT ( italic_v start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="\mathbf{z}_{\text{temp}}(v^{\tau}_{m})" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.7.m7.1"><semantics id="A1.SS1.SSS2.p1.7.m7.1a"><mrow id="A1.SS1.SSS2.p1.7.m7.1.1" xref="A1.SS1.SSS2.p1.7.m7.1.1.cmml"><msub id="A1.SS1.SSS2.p1.7.m7.1.1.3" xref="A1.SS1.SSS2.p1.7.m7.1.1.3.cmml"><mi id="A1.SS1.SSS2.p1.7.m7.1.1.3.2" xref="A1.SS1.SSS2.p1.7.m7.1.1.3.2.cmml">𝐳</mi><mtext id="A1.SS1.SSS2.p1.7.m7.1.1.3.3" xref="A1.SS1.SSS2.p1.7.m7.1.1.3.3a.cmml">temp</mtext></msub><mo id="A1.SS1.SSS2.p1.7.m7.1.1.2" xref="A1.SS1.SSS2.p1.7.m7.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p1.7.m7.1.1.1.1" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.cmml"><mo id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.2" stretchy="false" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.cmml">(</mo><msubsup id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.2" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.3" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.3.cmml">m</mi><mi id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.3" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.3.cmml">τ</mi></msubsup><mo id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.3" stretchy="false" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.7.m7.1b"><apply id="A1.SS1.SSS2.p1.7.m7.1.1.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1"><times id="A1.SS1.SSS2.p1.7.m7.1.1.2.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.2"></times><apply id="A1.SS1.SSS2.p1.7.m7.1.1.3.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.7.m7.1.1.3.1.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.3">subscript</csymbol><ci id="A1.SS1.SSS2.p1.7.m7.1.1.3.2.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.3.2">𝐳</ci><ci id="A1.SS1.SSS2.p1.7.m7.1.1.3.3a.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.3.3"><mtext id="A1.SS1.SSS2.p1.7.m7.1.1.3.3.cmml" mathsize="70%" xref="A1.SS1.SSS2.p1.7.m7.1.1.3.3">temp</mtext></ci></apply><apply id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1">subscript</csymbol><apply id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1">superscript</csymbol><ci id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.2.3">𝜏</ci></apply><ci id="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.7.m7.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.7.m7.1c">\mathbf{z}_{\text{temp}}(v^{\tau}_{m})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.7.m7.1d">bold_z start_POSTSUBSCRIPT temp end_POSTSUBSCRIPT ( italic_v start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the diffusion-based spatial encoding, the distance-based spatial encoding, and the relative temporal information, respectively. Here we introduce the calculation of the three encoding terms in detail.</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS2.p2">
<p class="ltx_p" id="A1.SS1.SSS2.p2.5"><span class="ltx_text ltx_font_bold" id="A1.SS1.SSS2.p2.5.1">Diffusion-based Spatial Encoding.</span>
To encode the global information of each node, diffusion-based spatial encoding is designed based on the diffusion matrix. Specifically, we first calculate the edge connectivity vector <math alttext="\mathbf{d}_{e^{t}_{i,j}}=\mathbf{d}_{i}+\mathbf{d}_{j}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.1.m1.2"><semantics id="A1.SS1.SSS2.p2.1.m1.2a"><mrow id="A1.SS1.SSS2.p2.1.m1.2.3" xref="A1.SS1.SSS2.p2.1.m1.2.3.cmml"><msub id="A1.SS1.SSS2.p2.1.m1.2.3.2" xref="A1.SS1.SSS2.p2.1.m1.2.3.2.cmml"><mi id="A1.SS1.SSS2.p2.1.m1.2.3.2.2" xref="A1.SS1.SSS2.p2.1.m1.2.3.2.2.cmml">𝐝</mi><msubsup id="A1.SS1.SSS2.p2.1.m1.2.2.2" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.cmml"><mi id="A1.SS1.SSS2.p2.1.m1.2.2.2.4.2" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.4.2.cmml">e</mi><mrow id="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.4" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.3.cmml"><mi id="A1.SS1.SSS2.p2.1.m1.1.1.1.1.1.1" xref="A1.SS1.SSS2.p2.1.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.4.1" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.2" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mi id="A1.SS1.SSS2.p2.1.m1.2.2.2.4.3" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.4.3.cmml">t</mi></msubsup></msub><mo id="A1.SS1.SSS2.p2.1.m1.2.3.1" xref="A1.SS1.SSS2.p2.1.m1.2.3.1.cmml">=</mo><mrow id="A1.SS1.SSS2.p2.1.m1.2.3.3" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.cmml"><msub id="A1.SS1.SSS2.p2.1.m1.2.3.3.2" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.2.cmml"><mi id="A1.SS1.SSS2.p2.1.m1.2.3.3.2.2" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.2.2.cmml">𝐝</mi><mi id="A1.SS1.SSS2.p2.1.m1.2.3.3.2.3" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.2.3.cmml">i</mi></msub><mo id="A1.SS1.SSS2.p2.1.m1.2.3.3.1" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.1.cmml">+</mo><msub id="A1.SS1.SSS2.p2.1.m1.2.3.3.3" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.3.cmml"><mi id="A1.SS1.SSS2.p2.1.m1.2.3.3.3.2" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.3.2.cmml">𝐝</mi><mi id="A1.SS1.SSS2.p2.1.m1.2.3.3.3.3" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.1.m1.2b"><apply id="A1.SS1.SSS2.p2.1.m1.2.3.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3"><eq id="A1.SS1.SSS2.p2.1.m1.2.3.1.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.1"></eq><apply id="A1.SS1.SSS2.p2.1.m1.2.3.2.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.1.m1.2.3.2.1.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.2">subscript</csymbol><ci id="A1.SS1.SSS2.p2.1.m1.2.3.2.2.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.2.2">𝐝</ci><apply id="A1.SS1.SSS2.p2.1.m1.2.2.2.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.1.m1.2.2.2.3.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.2.2">subscript</csymbol><apply id="A1.SS1.SSS2.p2.1.m1.2.2.2.4.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.1.m1.2.2.2.4.1.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.2.2">superscript</csymbol><ci id="A1.SS1.SSS2.p2.1.m1.2.2.2.4.2.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.4.2">𝑒</ci><ci id="A1.SS1.SSS2.p2.1.m1.2.2.2.4.3.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.4.3">𝑡</ci></apply><list id="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.4"><ci id="A1.SS1.SSS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p2.1.m1.1.1.1.1.1.1">𝑖</ci><ci id="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.2.2.2.2.2">𝑗</ci></list></apply></apply><apply id="A1.SS1.SSS2.p2.1.m1.2.3.3.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3"><plus id="A1.SS1.SSS2.p2.1.m1.2.3.3.1.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.1"></plus><apply id="A1.SS1.SSS2.p2.1.m1.2.3.3.2.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.2"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.1.m1.2.3.3.2.1.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.2">subscript</csymbol><ci id="A1.SS1.SSS2.p2.1.m1.2.3.3.2.2.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.2.2">𝐝</ci><ci id="A1.SS1.SSS2.p2.1.m1.2.3.3.2.3.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.2.3">𝑖</ci></apply><apply id="A1.SS1.SSS2.p2.1.m1.2.3.3.3.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.1.m1.2.3.3.3.1.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.3">subscript</csymbol><ci id="A1.SS1.SSS2.p2.1.m1.2.3.3.3.2.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.3.2">𝐝</ci><ci id="A1.SS1.SSS2.p2.1.m1.2.3.3.3.3.cmml" xref="A1.SS1.SSS2.p2.1.m1.2.3.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.1.m1.2c">\mathbf{d}_{e^{t}_{i,j}}=\mathbf{d}_{i}+\mathbf{d}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.1.m1.2d">bold_d start_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT = bold_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + bold_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. Then, for each node <math alttext="v_{m}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.2.m2.1"><semantics id="A1.SS1.SSS2.p2.2.m2.1a"><msubsup id="A1.SS1.SSS2.p2.2.m2.1.1" xref="A1.SS1.SSS2.p2.2.m2.1.1.cmml"><mi id="A1.SS1.SSS2.p2.2.m2.1.1.2.2" xref="A1.SS1.SSS2.p2.2.m2.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p2.2.m2.1.1.2.3" xref="A1.SS1.SSS2.p2.2.m2.1.1.2.3.cmml">m</mi><mi id="A1.SS1.SSS2.p2.2.m2.1.1.3" xref="A1.SS1.SSS2.p2.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.2.m2.1b"><apply id="A1.SS1.SSS2.p2.2.m2.1.1.cmml" xref="A1.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="A1.SS1.SSS2.p2.2.m2.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="A1.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.2.m2.1.1.2.1.cmml" xref="A1.SS1.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p2.2.m2.1.1.2.2.cmml" xref="A1.SS1.SSS2.p2.2.m2.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p2.2.m2.1.1.2.3.cmml" xref="A1.SS1.SSS2.p2.2.m2.1.1.2.3">𝑚</ci></apply><ci id="A1.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="A1.SS1.SSS2.p2.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.2.m2.1c">v_{m}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> in <math alttext="g_{i}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.3.m3.1"><semantics id="A1.SS1.SSS2.p2.3.m3.1a"><msubsup id="A1.SS1.SSS2.p2.3.m3.1.1" xref="A1.SS1.SSS2.p2.3.m3.1.1.cmml"><mi id="A1.SS1.SSS2.p2.3.m3.1.1.2.2" xref="A1.SS1.SSS2.p2.3.m3.1.1.2.2.cmml">g</mi><mi id="A1.SS1.SSS2.p2.3.m3.1.1.2.3" xref="A1.SS1.SSS2.p2.3.m3.1.1.2.3.cmml">i</mi><mi id="A1.SS1.SSS2.p2.3.m3.1.1.3" xref="A1.SS1.SSS2.p2.3.m3.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.3.m3.1b"><apply id="A1.SS1.SSS2.p2.3.m3.1.1.cmml" xref="A1.SS1.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.3.m3.1.1.1.cmml" xref="A1.SS1.SSS2.p2.3.m3.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p2.3.m3.1.1.2.cmml" xref="A1.SS1.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.3.m3.1.1.2.1.cmml" xref="A1.SS1.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p2.3.m3.1.1.2.2.cmml" xref="A1.SS1.SSS2.p2.3.m3.1.1.2.2">𝑔</ci><ci id="A1.SS1.SSS2.p2.3.m3.1.1.2.3.cmml" xref="A1.SS1.SSS2.p2.3.m3.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.SSS2.p2.3.m3.1.1.3.cmml" xref="A1.SS1.SSS2.p2.3.m3.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.3.m3.1c">g_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.3.m3.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>, we sort all nodes of <math alttext="g_{i}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.4.m4.1"><semantics id="A1.SS1.SSS2.p2.4.m4.1a"><msubsup id="A1.SS1.SSS2.p2.4.m4.1.1" xref="A1.SS1.SSS2.p2.4.m4.1.1.cmml"><mi id="A1.SS1.SSS2.p2.4.m4.1.1.2.2" xref="A1.SS1.SSS2.p2.4.m4.1.1.2.2.cmml">g</mi><mi id="A1.SS1.SSS2.p2.4.m4.1.1.2.3" xref="A1.SS1.SSS2.p2.4.m4.1.1.2.3.cmml">i</mi><mi id="A1.SS1.SSS2.p2.4.m4.1.1.3" xref="A1.SS1.SSS2.p2.4.m4.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.4.m4.1b"><apply id="A1.SS1.SSS2.p2.4.m4.1.1.cmml" xref="A1.SS1.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.4.m4.1.1.1.cmml" xref="A1.SS1.SSS2.p2.4.m4.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p2.4.m4.1.1.2.cmml" xref="A1.SS1.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.4.m4.1.1.2.1.cmml" xref="A1.SS1.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p2.4.m4.1.1.2.2.cmml" xref="A1.SS1.SSS2.p2.4.m4.1.1.2.2">𝑔</ci><ci id="A1.SS1.SSS2.p2.4.m4.1.1.2.3.cmml" xref="A1.SS1.SSS2.p2.4.m4.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.SSS2.p2.4.m4.1.1.3.cmml" xref="A1.SS1.SSS2.p2.4.m4.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.4.m4.1c">g_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.4.m4.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> accroding to their corresponding value in <math alttext="\mathbf{d}_{e^{t}_{i,j}}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.5.m5.2"><semantics id="A1.SS1.SSS2.p2.5.m5.2a"><msub id="A1.SS1.SSS2.p2.5.m5.2.3" xref="A1.SS1.SSS2.p2.5.m5.2.3.cmml"><mi id="A1.SS1.SSS2.p2.5.m5.2.3.2" xref="A1.SS1.SSS2.p2.5.m5.2.3.2.cmml">𝐝</mi><msubsup id="A1.SS1.SSS2.p2.5.m5.2.2.2" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.cmml"><mi id="A1.SS1.SSS2.p2.5.m5.2.2.2.4.2" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.4.2.cmml">e</mi><mrow id="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.4" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.3.cmml"><mi id="A1.SS1.SSS2.p2.5.m5.1.1.1.1.1.1" xref="A1.SS1.SSS2.p2.5.m5.1.1.1.1.1.1.cmml">i</mi><mo id="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.4.1" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.3.cmml">,</mo><mi id="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.2" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.2.cmml">j</mi></mrow><mi id="A1.SS1.SSS2.p2.5.m5.2.2.2.4.3" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.4.3.cmml">t</mi></msubsup></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.5.m5.2b"><apply id="A1.SS1.SSS2.p2.5.m5.2.3.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.5.m5.2.3.1.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.3">subscript</csymbol><ci id="A1.SS1.SSS2.p2.5.m5.2.3.2.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.3.2">𝐝</ci><apply id="A1.SS1.SSS2.p2.5.m5.2.2.2.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.5.m5.2.2.2.3.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.2.2">subscript</csymbol><apply id="A1.SS1.SSS2.p2.5.m5.2.2.2.4.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p2.5.m5.2.2.2.4.1.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.2.2">superscript</csymbol><ci id="A1.SS1.SSS2.p2.5.m5.2.2.2.4.2.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.4.2">𝑒</ci><ci id="A1.SS1.SSS2.p2.5.m5.2.2.2.4.3.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.4.3">𝑡</ci></apply><list id="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.4"><ci id="A1.SS1.SSS2.p2.5.m5.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p2.5.m5.1.1.1.1.1.1">𝑖</ci><ci id="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS2.p2.5.m5.2.2.2.2.2.2">𝑗</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.5.m5.2c">\mathbf{d}_{e^{t}_{i,j}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.5.m5.2d">bold_d start_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{\text{diff}}(z_{m})=linear(rank(\mathbf{d}_{e^{t}_{i,j}}[idx(v^{%
\tau}_{m})]))\in\mathbb{R}^{d_{enc}}," class="ltx_Math" display="block" id="A1.Ex13.m1.3"><semantics id="A1.Ex13.m1.3a"><mrow id="A1.Ex13.m1.3.3.1" xref="A1.Ex13.m1.3.3.1.1.cmml"><mrow id="A1.Ex13.m1.3.3.1.1" xref="A1.Ex13.m1.3.3.1.1.cmml"><mrow id="A1.Ex13.m1.3.3.1.1.1" xref="A1.Ex13.m1.3.3.1.1.1.cmml"><msub id="A1.Ex13.m1.3.3.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.1.3.cmml"><mi id="A1.Ex13.m1.3.3.1.1.1.3.2" xref="A1.Ex13.m1.3.3.1.1.1.3.2.cmml">𝐳</mi><mtext id="A1.Ex13.m1.3.3.1.1.1.3.3" xref="A1.Ex13.m1.3.3.1.1.1.3.3a.cmml">diff</mtext></msub><mo id="A1.Ex13.m1.3.3.1.1.1.2" xref="A1.Ex13.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.3.3.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A1.Ex13.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="A1.Ex13.m1.3.3.1.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.cmml">z</mi><mi id="A1.Ex13.m1.3.3.1.1.1.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="A1.Ex13.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex13.m1.3.3.1.1.4" xref="A1.Ex13.m1.3.3.1.1.4.cmml">=</mo><mrow id="A1.Ex13.m1.3.3.1.1.2" xref="A1.Ex13.m1.3.3.1.1.2.cmml"><mi id="A1.Ex13.m1.3.3.1.1.2.3" xref="A1.Ex13.m1.3.3.1.1.2.3.cmml">l</mi><mo id="A1.Ex13.m1.3.3.1.1.2.2" xref="A1.Ex13.m1.3.3.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.4" xref="A1.Ex13.m1.3.3.1.1.2.4.cmml">i</mi><mo id="A1.Ex13.m1.3.3.1.1.2.2a" xref="A1.Ex13.m1.3.3.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.5" xref="A1.Ex13.m1.3.3.1.1.2.5.cmml">n</mi><mo id="A1.Ex13.m1.3.3.1.1.2.2b" xref="A1.Ex13.m1.3.3.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.6" xref="A1.Ex13.m1.3.3.1.1.2.6.cmml">e</mi><mo id="A1.Ex13.m1.3.3.1.1.2.2c" xref="A1.Ex13.m1.3.3.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.7" xref="A1.Ex13.m1.3.3.1.1.2.7.cmml">a</mi><mo id="A1.Ex13.m1.3.3.1.1.2.2d" xref="A1.Ex13.m1.3.3.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.8" xref="A1.Ex13.m1.3.3.1.1.2.8.cmml">r</mi><mo id="A1.Ex13.m1.3.3.1.1.2.2e" xref="A1.Ex13.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.3.3.1.1.2.1.1" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.cmml"><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.2" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.Ex13.m1.3.3.1.1.2.1.1.1" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.cmml"><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.3.cmml">r</mi><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.2" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.4" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.4.cmml">a</mi><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.2a" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.5" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.5.cmml">n</mi><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.2b" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.6" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.6.cmml">k</mi><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.2c" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><msub id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3.2" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3.2.cmml">𝐝</mi><msubsup id="A1.Ex13.m1.2.2.2" xref="A1.Ex13.m1.2.2.2.cmml"><mi id="A1.Ex13.m1.2.2.2.4.2" xref="A1.Ex13.m1.2.2.2.4.2.cmml">e</mi><mrow id="A1.Ex13.m1.2.2.2.2.2.4" xref="A1.Ex13.m1.2.2.2.2.2.3.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A1.Ex13.m1.2.2.2.2.2.4.1" xref="A1.Ex13.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.Ex13.m1.2.2.2.2.2.2" xref="A1.Ex13.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mi id="A1.Ex13.m1.2.2.2.4.3" xref="A1.Ex13.m1.2.2.2.4.3.cmml">t</mi></msubsup></msub><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.2" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.4" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.4.cmml">d</mi><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2a" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.5" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.5.cmml">x</mi><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2b" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi><mi id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msubsup><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex13.m1.3.3.1.1.2.1.1.3" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex13.m1.3.3.1.1.5" xref="A1.Ex13.m1.3.3.1.1.5.cmml">∈</mo><msup id="A1.Ex13.m1.3.3.1.1.6" xref="A1.Ex13.m1.3.3.1.1.6.cmml"><mi id="A1.Ex13.m1.3.3.1.1.6.2" xref="A1.Ex13.m1.3.3.1.1.6.2.cmml">ℝ</mi><msub id="A1.Ex13.m1.3.3.1.1.6.3" xref="A1.Ex13.m1.3.3.1.1.6.3.cmml"><mi id="A1.Ex13.m1.3.3.1.1.6.3.2" xref="A1.Ex13.m1.3.3.1.1.6.3.2.cmml">d</mi><mrow id="A1.Ex13.m1.3.3.1.1.6.3.3" xref="A1.Ex13.m1.3.3.1.1.6.3.3.cmml"><mi id="A1.Ex13.m1.3.3.1.1.6.3.3.2" xref="A1.Ex13.m1.3.3.1.1.6.3.3.2.cmml">e</mi><mo id="A1.Ex13.m1.3.3.1.1.6.3.3.1" xref="A1.Ex13.m1.3.3.1.1.6.3.3.1.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.6.3.3.3" xref="A1.Ex13.m1.3.3.1.1.6.3.3.3.cmml">n</mi><mo id="A1.Ex13.m1.3.3.1.1.6.3.3.1a" xref="A1.Ex13.m1.3.3.1.1.6.3.3.1.cmml">⁢</mo><mi id="A1.Ex13.m1.3.3.1.1.6.3.3.4" xref="A1.Ex13.m1.3.3.1.1.6.3.3.4.cmml">c</mi></mrow></msub></msup></mrow><mo id="A1.Ex13.m1.3.3.1.2" xref="A1.Ex13.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex13.m1.3b"><apply id="A1.Ex13.m1.3.3.1.1.cmml" xref="A1.Ex13.m1.3.3.1"><and id="A1.Ex13.m1.3.3.1.1a.cmml" xref="A1.Ex13.m1.3.3.1"></and><apply id="A1.Ex13.m1.3.3.1.1b.cmml" xref="A1.Ex13.m1.3.3.1"><eq id="A1.Ex13.m1.3.3.1.1.4.cmml" xref="A1.Ex13.m1.3.3.1.1.4"></eq><apply id="A1.Ex13.m1.3.3.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1"><times id="A1.Ex13.m1.3.3.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.2"></times><apply id="A1.Ex13.m1.3.3.1.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.1.3.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.1.3.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.3.2">𝐳</ci><ci id="A1.Ex13.m1.3.3.1.1.1.3.3a.cmml" xref="A1.Ex13.m1.3.3.1.1.1.3.3"><mtext id="A1.Ex13.m1.3.3.1.1.1.3.3.cmml" mathsize="70%" xref="A1.Ex13.m1.3.3.1.1.1.3.3">diff</mtext></ci></apply><apply id="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2">𝑧</ci><ci id="A1.Ex13.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.3">𝑚</ci></apply></apply><apply id="A1.Ex13.m1.3.3.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2"><times id="A1.Ex13.m1.3.3.1.1.2.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2.2"></times><ci id="A1.Ex13.m1.3.3.1.1.2.3.cmml" xref="A1.Ex13.m1.3.3.1.1.2.3">𝑙</ci><ci id="A1.Ex13.m1.3.3.1.1.2.4.cmml" xref="A1.Ex13.m1.3.3.1.1.2.4">𝑖</ci><ci id="A1.Ex13.m1.3.3.1.1.2.5.cmml" xref="A1.Ex13.m1.3.3.1.1.2.5">𝑛</ci><ci id="A1.Ex13.m1.3.3.1.1.2.6.cmml" xref="A1.Ex13.m1.3.3.1.1.2.6">𝑒</ci><ci id="A1.Ex13.m1.3.3.1.1.2.7.cmml" xref="A1.Ex13.m1.3.3.1.1.2.7">𝑎</ci><ci id="A1.Ex13.m1.3.3.1.1.2.8.cmml" xref="A1.Ex13.m1.3.3.1.1.2.8">𝑟</ci><apply id="A1.Ex13.m1.3.3.1.1.2.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1"><times id="A1.Ex13.m1.3.3.1.1.2.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.2"></times><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.3">𝑟</ci><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.4.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.4">𝑎</ci><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.5.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.5">𝑛</ci><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.6.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.6">𝑘</ci><apply id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1"><times id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.2"></times><apply id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.3.2">𝐝</ci><apply id="A1.Ex13.m1.2.2.2.cmml" xref="A1.Ex13.m1.2.2.2"><csymbol cd="ambiguous" id="A1.Ex13.m1.2.2.2.3.cmml" xref="A1.Ex13.m1.2.2.2">subscript</csymbol><apply id="A1.Ex13.m1.2.2.2.4.cmml" xref="A1.Ex13.m1.2.2.2"><csymbol cd="ambiguous" id="A1.Ex13.m1.2.2.2.4.1.cmml" xref="A1.Ex13.m1.2.2.2">superscript</csymbol><ci id="A1.Ex13.m1.2.2.2.4.2.cmml" xref="A1.Ex13.m1.2.2.2.4.2">𝑒</ci><ci id="A1.Ex13.m1.2.2.2.4.3.cmml" xref="A1.Ex13.m1.2.2.2.4.3">𝑡</ci></apply><list id="A1.Ex13.m1.2.2.2.2.2.3.cmml" xref="A1.Ex13.m1.2.2.2.2.2.4"><ci id="A1.Ex13.m1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1">𝑖</ci><ci id="A1.Ex13.m1.2.2.2.2.2.2.cmml" xref="A1.Ex13.m1.2.2.2.2.2.2">𝑗</ci></list></apply></apply><apply id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1"><times id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2"></times><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3">𝑖</ci><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.4">𝑑</ci><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.5.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.5">𝑥</ci><apply id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><ci id="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></apply></apply></apply><apply id="A1.Ex13.m1.3.3.1.1c.cmml" xref="A1.Ex13.m1.3.3.1"><in id="A1.Ex13.m1.3.3.1.1.5.cmml" xref="A1.Ex13.m1.3.3.1.1.5"></in><share href="https://arxiv.org/html/2405.07626v2#A1.Ex13.m1.3.3.1.1.2.cmml" id="A1.Ex13.m1.3.3.1.1d.cmml" xref="A1.Ex13.m1.3.3.1"></share><apply id="A1.Ex13.m1.3.3.1.1.6.cmml" xref="A1.Ex13.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.6.1.cmml" xref="A1.Ex13.m1.3.3.1.1.6">superscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.6.2.cmml" xref="A1.Ex13.m1.3.3.1.1.6.2">ℝ</ci><apply id="A1.Ex13.m1.3.3.1.1.6.3.cmml" xref="A1.Ex13.m1.3.3.1.1.6.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.6.3.1.cmml" xref="A1.Ex13.m1.3.3.1.1.6.3">subscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.6.3.2.cmml" xref="A1.Ex13.m1.3.3.1.1.6.3.2">𝑑</ci><apply id="A1.Ex13.m1.3.3.1.1.6.3.3.cmml" xref="A1.Ex13.m1.3.3.1.1.6.3.3"><times id="A1.Ex13.m1.3.3.1.1.6.3.3.1.cmml" xref="A1.Ex13.m1.3.3.1.1.6.3.3.1"></times><ci id="A1.Ex13.m1.3.3.1.1.6.3.3.2.cmml" xref="A1.Ex13.m1.3.3.1.1.6.3.3.2">𝑒</ci><ci id="A1.Ex13.m1.3.3.1.1.6.3.3.3.cmml" xref="A1.Ex13.m1.3.3.1.1.6.3.3.3">𝑛</ci><ci id="A1.Ex13.m1.3.3.1.1.6.3.3.4.cmml" xref="A1.Ex13.m1.3.3.1.1.6.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex13.m1.3c">\mathbf{z}_{\text{diff}}(z_{m})=linear(rank(\mathbf{d}_{e^{t}_{i,j}}[idx(v^{%
\tau}_{m})]))\in\mathbb{R}^{d_{enc}},</annotation><annotation encoding="application/x-llamapun" id="A1.Ex13.m1.3d">bold_z start_POSTSUBSCRIPT diff end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) = italic_l italic_i italic_n italic_e italic_a italic_r ( italic_r italic_a italic_n italic_k ( bold_d start_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_i italic_d italic_x ( italic_v start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) ] ) ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS2.p2.8">where <math alttext="idx(\cdot)" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.6.m1.1"><semantics id="A1.SS1.SSS2.p2.6.m1.1a"><mrow id="A1.SS1.SSS2.p2.6.m1.1.2" xref="A1.SS1.SSS2.p2.6.m1.1.2.cmml"><mi id="A1.SS1.SSS2.p2.6.m1.1.2.2" xref="A1.SS1.SSS2.p2.6.m1.1.2.2.cmml">i</mi><mo id="A1.SS1.SSS2.p2.6.m1.1.2.1" xref="A1.SS1.SSS2.p2.6.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.6.m1.1.2.3" xref="A1.SS1.SSS2.p2.6.m1.1.2.3.cmml">d</mi><mo id="A1.SS1.SSS2.p2.6.m1.1.2.1a" xref="A1.SS1.SSS2.p2.6.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.6.m1.1.2.4" xref="A1.SS1.SSS2.p2.6.m1.1.2.4.cmml">x</mi><mo id="A1.SS1.SSS2.p2.6.m1.1.2.1b" xref="A1.SS1.SSS2.p2.6.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p2.6.m1.1.2.5.2" xref="A1.SS1.SSS2.p2.6.m1.1.2.cmml"><mo id="A1.SS1.SSS2.p2.6.m1.1.2.5.2.1" stretchy="false" xref="A1.SS1.SSS2.p2.6.m1.1.2.cmml">(</mo><mo id="A1.SS1.SSS2.p2.6.m1.1.1" lspace="0em" rspace="0em" xref="A1.SS1.SSS2.p2.6.m1.1.1.cmml">⋅</mo><mo id="A1.SS1.SSS2.p2.6.m1.1.2.5.2.2" stretchy="false" xref="A1.SS1.SSS2.p2.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.6.m1.1b"><apply id="A1.SS1.SSS2.p2.6.m1.1.2.cmml" xref="A1.SS1.SSS2.p2.6.m1.1.2"><times id="A1.SS1.SSS2.p2.6.m1.1.2.1.cmml" xref="A1.SS1.SSS2.p2.6.m1.1.2.1"></times><ci id="A1.SS1.SSS2.p2.6.m1.1.2.2.cmml" xref="A1.SS1.SSS2.p2.6.m1.1.2.2">𝑖</ci><ci id="A1.SS1.SSS2.p2.6.m1.1.2.3.cmml" xref="A1.SS1.SSS2.p2.6.m1.1.2.3">𝑑</ci><ci id="A1.SS1.SSS2.p2.6.m1.1.2.4.cmml" xref="A1.SS1.SSS2.p2.6.m1.1.2.4">𝑥</ci><ci id="A1.SS1.SSS2.p2.6.m1.1.1.cmml" xref="A1.SS1.SSS2.p2.6.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.6.m1.1c">idx(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.6.m1.1d">italic_i italic_d italic_x ( ⋅ )</annotation></semantics></math>, <math alttext="rank(\cdot)" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.7.m2.1"><semantics id="A1.SS1.SSS2.p2.7.m2.1a"><mrow id="A1.SS1.SSS2.p2.7.m2.1.2" xref="A1.SS1.SSS2.p2.7.m2.1.2.cmml"><mi id="A1.SS1.SSS2.p2.7.m2.1.2.2" xref="A1.SS1.SSS2.p2.7.m2.1.2.2.cmml">r</mi><mo id="A1.SS1.SSS2.p2.7.m2.1.2.1" xref="A1.SS1.SSS2.p2.7.m2.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.7.m2.1.2.3" xref="A1.SS1.SSS2.p2.7.m2.1.2.3.cmml">a</mi><mo id="A1.SS1.SSS2.p2.7.m2.1.2.1a" xref="A1.SS1.SSS2.p2.7.m2.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.7.m2.1.2.4" xref="A1.SS1.SSS2.p2.7.m2.1.2.4.cmml">n</mi><mo id="A1.SS1.SSS2.p2.7.m2.1.2.1b" xref="A1.SS1.SSS2.p2.7.m2.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.7.m2.1.2.5" xref="A1.SS1.SSS2.p2.7.m2.1.2.5.cmml">k</mi><mo id="A1.SS1.SSS2.p2.7.m2.1.2.1c" xref="A1.SS1.SSS2.p2.7.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p2.7.m2.1.2.6.2" xref="A1.SS1.SSS2.p2.7.m2.1.2.cmml"><mo id="A1.SS1.SSS2.p2.7.m2.1.2.6.2.1" stretchy="false" xref="A1.SS1.SSS2.p2.7.m2.1.2.cmml">(</mo><mo id="A1.SS1.SSS2.p2.7.m2.1.1" lspace="0em" rspace="0em" xref="A1.SS1.SSS2.p2.7.m2.1.1.cmml">⋅</mo><mo id="A1.SS1.SSS2.p2.7.m2.1.2.6.2.2" stretchy="false" xref="A1.SS1.SSS2.p2.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.7.m2.1b"><apply id="A1.SS1.SSS2.p2.7.m2.1.2.cmml" xref="A1.SS1.SSS2.p2.7.m2.1.2"><times id="A1.SS1.SSS2.p2.7.m2.1.2.1.cmml" xref="A1.SS1.SSS2.p2.7.m2.1.2.1"></times><ci id="A1.SS1.SSS2.p2.7.m2.1.2.2.cmml" xref="A1.SS1.SSS2.p2.7.m2.1.2.2">𝑟</ci><ci id="A1.SS1.SSS2.p2.7.m2.1.2.3.cmml" xref="A1.SS1.SSS2.p2.7.m2.1.2.3">𝑎</ci><ci id="A1.SS1.SSS2.p2.7.m2.1.2.4.cmml" xref="A1.SS1.SSS2.p2.7.m2.1.2.4">𝑛</ci><ci id="A1.SS1.SSS2.p2.7.m2.1.2.5.cmml" xref="A1.SS1.SSS2.p2.7.m2.1.2.5">𝑘</ci><ci id="A1.SS1.SSS2.p2.7.m2.1.1.cmml" xref="A1.SS1.SSS2.p2.7.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.7.m2.1c">rank(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.7.m2.1d">italic_r italic_a italic_n italic_k ( ⋅ )</annotation></semantics></math> and <math alttext="linear(\cdot)" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.8.m3.1"><semantics id="A1.SS1.SSS2.p2.8.m3.1a"><mrow id="A1.SS1.SSS2.p2.8.m3.1.2" xref="A1.SS1.SSS2.p2.8.m3.1.2.cmml"><mi id="A1.SS1.SSS2.p2.8.m3.1.2.2" xref="A1.SS1.SSS2.p2.8.m3.1.2.2.cmml">l</mi><mo id="A1.SS1.SSS2.p2.8.m3.1.2.1" xref="A1.SS1.SSS2.p2.8.m3.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.8.m3.1.2.3" xref="A1.SS1.SSS2.p2.8.m3.1.2.3.cmml">i</mi><mo id="A1.SS1.SSS2.p2.8.m3.1.2.1a" xref="A1.SS1.SSS2.p2.8.m3.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.8.m3.1.2.4" xref="A1.SS1.SSS2.p2.8.m3.1.2.4.cmml">n</mi><mo id="A1.SS1.SSS2.p2.8.m3.1.2.1b" xref="A1.SS1.SSS2.p2.8.m3.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.8.m3.1.2.5" xref="A1.SS1.SSS2.p2.8.m3.1.2.5.cmml">e</mi><mo id="A1.SS1.SSS2.p2.8.m3.1.2.1c" xref="A1.SS1.SSS2.p2.8.m3.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.8.m3.1.2.6" xref="A1.SS1.SSS2.p2.8.m3.1.2.6.cmml">a</mi><mo id="A1.SS1.SSS2.p2.8.m3.1.2.1d" xref="A1.SS1.SSS2.p2.8.m3.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p2.8.m3.1.2.7" xref="A1.SS1.SSS2.p2.8.m3.1.2.7.cmml">r</mi><mo id="A1.SS1.SSS2.p2.8.m3.1.2.1e" xref="A1.SS1.SSS2.p2.8.m3.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p2.8.m3.1.2.8.2" xref="A1.SS1.SSS2.p2.8.m3.1.2.cmml"><mo id="A1.SS1.SSS2.p2.8.m3.1.2.8.2.1" stretchy="false" xref="A1.SS1.SSS2.p2.8.m3.1.2.cmml">(</mo><mo id="A1.SS1.SSS2.p2.8.m3.1.1" lspace="0em" rspace="0em" xref="A1.SS1.SSS2.p2.8.m3.1.1.cmml">⋅</mo><mo id="A1.SS1.SSS2.p2.8.m3.1.2.8.2.2" stretchy="false" xref="A1.SS1.SSS2.p2.8.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.8.m3.1b"><apply id="A1.SS1.SSS2.p2.8.m3.1.2.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.2"><times id="A1.SS1.SSS2.p2.8.m3.1.2.1.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.2.1"></times><ci id="A1.SS1.SSS2.p2.8.m3.1.2.2.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.2.2">𝑙</ci><ci id="A1.SS1.SSS2.p2.8.m3.1.2.3.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.2.3">𝑖</ci><ci id="A1.SS1.SSS2.p2.8.m3.1.2.4.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.2.4">𝑛</ci><ci id="A1.SS1.SSS2.p2.8.m3.1.2.5.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.2.5">𝑒</ci><ci id="A1.SS1.SSS2.p2.8.m3.1.2.6.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.2.6">𝑎</ci><ci id="A1.SS1.SSS2.p2.8.m3.1.2.7.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.2.7">𝑟</ci><ci id="A1.SS1.SSS2.p2.8.m3.1.1.cmml" xref="A1.SS1.SSS2.p2.8.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.8.m3.1c">linear(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.8.m3.1d">italic_l italic_i italic_n italic_e italic_a italic_r ( ⋅ )</annotation></semantics></math> denote the index enquiring function, ranking function and learnable linear mapping, respectively.</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS2.p3">
<p class="ltx_p" id="A1.SS1.SSS2.p3.4"><span class="ltx_text ltx_font_bold" id="A1.SS1.SSS2.p3.4.1">Distance-based Spatial Encoding.</span>
The distance-based spatial encoding captures the local information of each node. For each node <math alttext="v_{m}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p3.1.m1.1"><semantics id="A1.SS1.SSS2.p3.1.m1.1a"><msubsup id="A1.SS1.SSS2.p3.1.m1.1.1" xref="A1.SS1.SSS2.p3.1.m1.1.1.cmml"><mi id="A1.SS1.SSS2.p3.1.m1.1.1.2.2" xref="A1.SS1.SSS2.p3.1.m1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p3.1.m1.1.1.2.3" xref="A1.SS1.SSS2.p3.1.m1.1.1.2.3.cmml">m</mi><mi id="A1.SS1.SSS2.p3.1.m1.1.1.3" xref="A1.SS1.SSS2.p3.1.m1.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p3.1.m1.1b"><apply id="A1.SS1.SSS2.p3.1.m1.1.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.1.m1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p3.1.m1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p3.1.m1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.2.3">𝑚</ci></apply><ci id="A1.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p3.1.m1.1c">v_{m}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p3.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> in the node set of a subgraph <math alttext="g_{i}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p3.2.m2.1"><semantics id="A1.SS1.SSS2.p3.2.m2.1a"><msubsup id="A1.SS1.SSS2.p3.2.m2.1.1" xref="A1.SS1.SSS2.p3.2.m2.1.1.cmml"><mi id="A1.SS1.SSS2.p3.2.m2.1.1.2.2" xref="A1.SS1.SSS2.p3.2.m2.1.1.2.2.cmml">g</mi><mi id="A1.SS1.SSS2.p3.2.m2.1.1.2.3" xref="A1.SS1.SSS2.p3.2.m2.1.1.2.3.cmml">i</mi><mi id="A1.SS1.SSS2.p3.2.m2.1.1.3" xref="A1.SS1.SSS2.p3.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p3.2.m2.1b"><apply id="A1.SS1.SSS2.p3.2.m2.1.1.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.2.m2.1.1.2.1.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p3.2.m2.1.1.2.2.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1.2.2">𝑔</ci><ci id="A1.SS1.SSS2.p3.2.m2.1.1.2.3.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p3.2.m2.1c">g_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p3.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>, the distance to the target edge is encoded, which is further decomposed into the minimum value of the relative distances to <math alttext="v_{i}^{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p3.3.m3.1"><semantics id="A1.SS1.SSS2.p3.3.m3.1a"><msubsup id="A1.SS1.SSS2.p3.3.m3.1.1" xref="A1.SS1.SSS2.p3.3.m3.1.1.cmml"><mi id="A1.SS1.SSS2.p3.3.m3.1.1.2.2" xref="A1.SS1.SSS2.p3.3.m3.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p3.3.m3.1.1.2.3" xref="A1.SS1.SSS2.p3.3.m3.1.1.2.3.cmml">i</mi><mi id="A1.SS1.SSS2.p3.3.m3.1.1.3" xref="A1.SS1.SSS2.p3.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p3.3.m3.1b"><apply id="A1.SS1.SSS2.p3.3.m3.1.1.cmml" xref="A1.SS1.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="A1.SS1.SSS2.p3.3.m3.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="A1.SS1.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.3.m3.1.1.2.1.cmml" xref="A1.SS1.SSS2.p3.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p3.3.m3.1.1.2.2.cmml" xref="A1.SS1.SSS2.p3.3.m3.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p3.3.m3.1.1.2.3.cmml" xref="A1.SS1.SSS2.p3.3.m3.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="A1.SS1.SSS2.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p3.3.m3.1c">v_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p3.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="v_{j}^{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p3.4.m4.1"><semantics id="A1.SS1.SSS2.p3.4.m4.1a"><msubsup id="A1.SS1.SSS2.p3.4.m4.1.1" xref="A1.SS1.SSS2.p3.4.m4.1.1.cmml"><mi id="A1.SS1.SSS2.p3.4.m4.1.1.2.2" xref="A1.SS1.SSS2.p3.4.m4.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p3.4.m4.1.1.2.3" xref="A1.SS1.SSS2.p3.4.m4.1.1.2.3.cmml">j</mi><mi id="A1.SS1.SSS2.p3.4.m4.1.1.3" xref="A1.SS1.SSS2.p3.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p3.4.m4.1b"><apply id="A1.SS1.SSS2.p3.4.m4.1.1.cmml" xref="A1.SS1.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.4.m4.1.1.1.cmml" xref="A1.SS1.SSS2.p3.4.m4.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p3.4.m4.1.1.2.cmml" xref="A1.SS1.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.4.m4.1.1.2.1.cmml" xref="A1.SS1.SSS2.p3.4.m4.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p3.4.m4.1.1.2.2.cmml" xref="A1.SS1.SSS2.p3.4.m4.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p3.4.m4.1.1.2.3.cmml" xref="A1.SS1.SSS2.p3.4.m4.1.1.2.3">𝑗</ci></apply><ci id="A1.SS1.SSS2.p3.4.m4.1.1.3.cmml" xref="A1.SS1.SSS2.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p3.4.m4.1c">v_{j}^{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p3.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. Specifically, the distance-based spatial encoding is calculated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{\text{dist}}=linear(min(dist(v_{m}^{\tau},v_{i}^{t}),dist(v_{m}^{%
\tau},v_{j}^{t})))\in\mathbb{R}^{d_{enc}}," class="ltx_Math" display="block" id="A1.Ex14.m1.1"><semantics id="A1.Ex14.m1.1a"><mrow id="A1.Ex14.m1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.cmml"><mrow id="A1.Ex14.m1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.cmml"><msub id="A1.Ex14.m1.1.1.1.1.3" xref="A1.Ex14.m1.1.1.1.1.3.cmml"><mi id="A1.Ex14.m1.1.1.1.1.3.2" xref="A1.Ex14.m1.1.1.1.1.3.2.cmml">𝐳</mi><mtext id="A1.Ex14.m1.1.1.1.1.3.3" xref="A1.Ex14.m1.1.1.1.1.3.3a.cmml">dist</mtext></msub><mo id="A1.Ex14.m1.1.1.1.1.4" xref="A1.Ex14.m1.1.1.1.1.4.cmml">=</mo><mrow id="A1.Ex14.m1.1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.3" xref="A1.Ex14.m1.1.1.1.1.1.3.cmml">l</mi><mo id="A1.Ex14.m1.1.1.1.1.1.2" xref="A1.Ex14.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.4" xref="A1.Ex14.m1.1.1.1.1.1.4.cmml">i</mi><mo id="A1.Ex14.m1.1.1.1.1.1.2a" xref="A1.Ex14.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.5" xref="A1.Ex14.m1.1.1.1.1.1.5.cmml">n</mi><mo id="A1.Ex14.m1.1.1.1.1.1.2b" xref="A1.Ex14.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.6" xref="A1.Ex14.m1.1.1.1.1.1.6.cmml">e</mi><mo id="A1.Ex14.m1.1.1.1.1.1.2c" xref="A1.Ex14.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.7" xref="A1.Ex14.m1.1.1.1.1.1.7.cmml">a</mi><mo id="A1.Ex14.m1.1.1.1.1.1.2d" xref="A1.Ex14.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.8" xref="A1.Ex14.m1.1.1.1.1.1.8.cmml">r</mi><mo id="A1.Ex14.m1.1.1.1.1.1.2e" xref="A1.Ex14.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex14.m1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex14.m1.1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.4" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.5" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.5.cmml">i</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.3a" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.6" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.6.cmml">n</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.3b" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">d</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.5" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml">i</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3a" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.6" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.6.cmml">s</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3b" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.7" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.7.cmml">t</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3c" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">m</mi><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.4" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">v</mi><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msubsup><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.4" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.4" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.4.cmml">d</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.5" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.5.cmml">i</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3a" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.6" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.6.cmml">s</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3b" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.7" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.7.cmml">t</mi><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3c" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msubsup id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">v</mi><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml">m</mi><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">τ</mi></msubsup><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.4" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msubsup id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.2" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.3.cmml">j</mi><mi id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.5" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex14.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex14.m1.1.1.1.1.5" xref="A1.Ex14.m1.1.1.1.1.5.cmml">∈</mo><msup id="A1.Ex14.m1.1.1.1.1.6" xref="A1.Ex14.m1.1.1.1.1.6.cmml"><mi id="A1.Ex14.m1.1.1.1.1.6.2" xref="A1.Ex14.m1.1.1.1.1.6.2.cmml">ℝ</mi><msub id="A1.Ex14.m1.1.1.1.1.6.3" xref="A1.Ex14.m1.1.1.1.1.6.3.cmml"><mi id="A1.Ex14.m1.1.1.1.1.6.3.2" xref="A1.Ex14.m1.1.1.1.1.6.3.2.cmml">d</mi><mrow id="A1.Ex14.m1.1.1.1.1.6.3.3" xref="A1.Ex14.m1.1.1.1.1.6.3.3.cmml"><mi id="A1.Ex14.m1.1.1.1.1.6.3.3.2" xref="A1.Ex14.m1.1.1.1.1.6.3.3.2.cmml">e</mi><mo id="A1.Ex14.m1.1.1.1.1.6.3.3.1" xref="A1.Ex14.m1.1.1.1.1.6.3.3.1.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.6.3.3.3" xref="A1.Ex14.m1.1.1.1.1.6.3.3.3.cmml">n</mi><mo id="A1.Ex14.m1.1.1.1.1.6.3.3.1a" xref="A1.Ex14.m1.1.1.1.1.6.3.3.1.cmml">⁢</mo><mi id="A1.Ex14.m1.1.1.1.1.6.3.3.4" xref="A1.Ex14.m1.1.1.1.1.6.3.3.4.cmml">c</mi></mrow></msub></msup></mrow><mo id="A1.Ex14.m1.1.1.1.2" xref="A1.Ex14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex14.m1.1b"><apply id="A1.Ex14.m1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1"><and id="A1.Ex14.m1.1.1.1.1a.cmml" xref="A1.Ex14.m1.1.1.1"></and><apply id="A1.Ex14.m1.1.1.1.1b.cmml" xref="A1.Ex14.m1.1.1.1"><eq id="A1.Ex14.m1.1.1.1.1.4.cmml" xref="A1.Ex14.m1.1.1.1.1.4"></eq><apply id="A1.Ex14.m1.1.1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.3.1.cmml" xref="A1.Ex14.m1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex14.m1.1.1.1.1.3.2.cmml" xref="A1.Ex14.m1.1.1.1.1.3.2">𝐳</ci><ci id="A1.Ex14.m1.1.1.1.1.3.3a.cmml" xref="A1.Ex14.m1.1.1.1.1.3.3"><mtext id="A1.Ex14.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.Ex14.m1.1.1.1.1.3.3">dist</mtext></ci></apply><apply id="A1.Ex14.m1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1"><times id="A1.Ex14.m1.1.1.1.1.1.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.2"></times><ci id="A1.Ex14.m1.1.1.1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.3">𝑙</ci><ci id="A1.Ex14.m1.1.1.1.1.1.4.cmml" xref="A1.Ex14.m1.1.1.1.1.1.4">𝑖</ci><ci id="A1.Ex14.m1.1.1.1.1.1.5.cmml" xref="A1.Ex14.m1.1.1.1.1.1.5">𝑛</ci><ci id="A1.Ex14.m1.1.1.1.1.1.6.cmml" xref="A1.Ex14.m1.1.1.1.1.1.6">𝑒</ci><ci id="A1.Ex14.m1.1.1.1.1.1.7.cmml" xref="A1.Ex14.m1.1.1.1.1.1.7">𝑎</ci><ci id="A1.Ex14.m1.1.1.1.1.1.8.cmml" xref="A1.Ex14.m1.1.1.1.1.1.8">𝑟</ci><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1"><times id="A1.Ex14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.3"></times><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.4">𝑚</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.5.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.5">𝑖</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.6.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.6">𝑛</ci><interval closure="open" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2"><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.3"></times><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.4">𝑑</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.5">𝑖</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.6.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.6">𝑠</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.7.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.7">𝑡</ci><interval closure="open" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑣</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2"><times id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.3"></times><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.4">𝑑</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.5.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.5">𝑖</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.6.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.6">𝑠</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.7.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.7">𝑡</ci><interval closure="open" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2"><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1">superscript</csymbol><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1">subscript</csymbol><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2">𝑣</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.3">𝑚</ci></apply><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3">𝜏</ci></apply><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2">superscript</csymbol><apply id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.2">𝑣</ci><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></interval></apply></apply></apply><apply id="A1.Ex14.m1.1.1.1.1c.cmml" xref="A1.Ex14.m1.1.1.1"><in id="A1.Ex14.m1.1.1.1.1.5.cmml" xref="A1.Ex14.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2405.07626v2#A1.Ex14.m1.1.1.1.1.1.cmml" id="A1.Ex14.m1.1.1.1.1d.cmml" xref="A1.Ex14.m1.1.1.1"></share><apply id="A1.Ex14.m1.1.1.1.1.6.cmml" xref="A1.Ex14.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.6.1.cmml" xref="A1.Ex14.m1.1.1.1.1.6">superscript</csymbol><ci id="A1.Ex14.m1.1.1.1.1.6.2.cmml" xref="A1.Ex14.m1.1.1.1.1.6.2">ℝ</ci><apply id="A1.Ex14.m1.1.1.1.1.6.3.cmml" xref="A1.Ex14.m1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.1.1.6.3.1.cmml" xref="A1.Ex14.m1.1.1.1.1.6.3">subscript</csymbol><ci id="A1.Ex14.m1.1.1.1.1.6.3.2.cmml" xref="A1.Ex14.m1.1.1.1.1.6.3.2">𝑑</ci><apply id="A1.Ex14.m1.1.1.1.1.6.3.3.cmml" xref="A1.Ex14.m1.1.1.1.1.6.3.3"><times id="A1.Ex14.m1.1.1.1.1.6.3.3.1.cmml" xref="A1.Ex14.m1.1.1.1.1.6.3.3.1"></times><ci id="A1.Ex14.m1.1.1.1.1.6.3.3.2.cmml" xref="A1.Ex14.m1.1.1.1.1.6.3.3.2">𝑒</ci><ci id="A1.Ex14.m1.1.1.1.1.6.3.3.3.cmml" xref="A1.Ex14.m1.1.1.1.1.6.3.3.3">𝑛</ci><ci id="A1.Ex14.m1.1.1.1.1.6.3.3.4.cmml" xref="A1.Ex14.m1.1.1.1.1.6.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex14.m1.1c">\mathbf{z}_{\text{dist}}=linear(min(dist(v_{m}^{\tau},v_{i}^{t}),dist(v_{m}^{%
\tau},v_{j}^{t})))\in\mathbb{R}^{d_{enc}},</annotation><annotation encoding="application/x-llamapun" id="A1.Ex14.m1.1d">bold_z start_POSTSUBSCRIPT dist end_POSTSUBSCRIPT = italic_l italic_i italic_n italic_e italic_a italic_r ( italic_m italic_i italic_n ( italic_d italic_i italic_s italic_t ( italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) , italic_d italic_i italic_s italic_t ( italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) ) ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS2.p3.6">where <math alttext="linear(\cdot)" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p3.5.m1.1"><semantics id="A1.SS1.SSS2.p3.5.m1.1a"><mrow id="A1.SS1.SSS2.p3.5.m1.1.2" xref="A1.SS1.SSS2.p3.5.m1.1.2.cmml"><mi id="A1.SS1.SSS2.p3.5.m1.1.2.2" xref="A1.SS1.SSS2.p3.5.m1.1.2.2.cmml">l</mi><mo id="A1.SS1.SSS2.p3.5.m1.1.2.1" xref="A1.SS1.SSS2.p3.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.5.m1.1.2.3" xref="A1.SS1.SSS2.p3.5.m1.1.2.3.cmml">i</mi><mo id="A1.SS1.SSS2.p3.5.m1.1.2.1a" xref="A1.SS1.SSS2.p3.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.5.m1.1.2.4" xref="A1.SS1.SSS2.p3.5.m1.1.2.4.cmml">n</mi><mo id="A1.SS1.SSS2.p3.5.m1.1.2.1b" xref="A1.SS1.SSS2.p3.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.5.m1.1.2.5" xref="A1.SS1.SSS2.p3.5.m1.1.2.5.cmml">e</mi><mo id="A1.SS1.SSS2.p3.5.m1.1.2.1c" xref="A1.SS1.SSS2.p3.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.5.m1.1.2.6" xref="A1.SS1.SSS2.p3.5.m1.1.2.6.cmml">a</mi><mo id="A1.SS1.SSS2.p3.5.m1.1.2.1d" xref="A1.SS1.SSS2.p3.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.5.m1.1.2.7" xref="A1.SS1.SSS2.p3.5.m1.1.2.7.cmml">r</mi><mo id="A1.SS1.SSS2.p3.5.m1.1.2.1e" xref="A1.SS1.SSS2.p3.5.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p3.5.m1.1.2.8.2" xref="A1.SS1.SSS2.p3.5.m1.1.2.cmml"><mo id="A1.SS1.SSS2.p3.5.m1.1.2.8.2.1" stretchy="false" xref="A1.SS1.SSS2.p3.5.m1.1.2.cmml">(</mo><mo id="A1.SS1.SSS2.p3.5.m1.1.1" lspace="0em" rspace="0em" xref="A1.SS1.SSS2.p3.5.m1.1.1.cmml">⋅</mo><mo id="A1.SS1.SSS2.p3.5.m1.1.2.8.2.2" stretchy="false" xref="A1.SS1.SSS2.p3.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p3.5.m1.1b"><apply id="A1.SS1.SSS2.p3.5.m1.1.2.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.2"><times id="A1.SS1.SSS2.p3.5.m1.1.2.1.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.2.1"></times><ci id="A1.SS1.SSS2.p3.5.m1.1.2.2.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.2.2">𝑙</ci><ci id="A1.SS1.SSS2.p3.5.m1.1.2.3.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.2.3">𝑖</ci><ci id="A1.SS1.SSS2.p3.5.m1.1.2.4.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.2.4">𝑛</ci><ci id="A1.SS1.SSS2.p3.5.m1.1.2.5.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.2.5">𝑒</ci><ci id="A1.SS1.SSS2.p3.5.m1.1.2.6.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.2.6">𝑎</ci><ci id="A1.SS1.SSS2.p3.5.m1.1.2.7.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.2.7">𝑟</ci><ci id="A1.SS1.SSS2.p3.5.m1.1.1.cmml" xref="A1.SS1.SSS2.p3.5.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p3.5.m1.1c">linear(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p3.5.m1.1d">italic_l italic_i italic_n italic_e italic_a italic_r ( ⋅ )</annotation></semantics></math> is the learnable linear mapping and <math alttext="dist(\cdot)" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p3.6.m2.1"><semantics id="A1.SS1.SSS2.p3.6.m2.1a"><mrow id="A1.SS1.SSS2.p3.6.m2.1.2" xref="A1.SS1.SSS2.p3.6.m2.1.2.cmml"><mi id="A1.SS1.SSS2.p3.6.m2.1.2.2" xref="A1.SS1.SSS2.p3.6.m2.1.2.2.cmml">d</mi><mo id="A1.SS1.SSS2.p3.6.m2.1.2.1" xref="A1.SS1.SSS2.p3.6.m2.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.6.m2.1.2.3" xref="A1.SS1.SSS2.p3.6.m2.1.2.3.cmml">i</mi><mo id="A1.SS1.SSS2.p3.6.m2.1.2.1a" xref="A1.SS1.SSS2.p3.6.m2.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.6.m2.1.2.4" xref="A1.SS1.SSS2.p3.6.m2.1.2.4.cmml">s</mi><mo id="A1.SS1.SSS2.p3.6.m2.1.2.1b" xref="A1.SS1.SSS2.p3.6.m2.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.6.m2.1.2.5" xref="A1.SS1.SSS2.p3.6.m2.1.2.5.cmml">t</mi><mo id="A1.SS1.SSS2.p3.6.m2.1.2.1c" xref="A1.SS1.SSS2.p3.6.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p3.6.m2.1.2.6.2" xref="A1.SS1.SSS2.p3.6.m2.1.2.cmml"><mo id="A1.SS1.SSS2.p3.6.m2.1.2.6.2.1" stretchy="false" xref="A1.SS1.SSS2.p3.6.m2.1.2.cmml">(</mo><mo id="A1.SS1.SSS2.p3.6.m2.1.1" lspace="0em" rspace="0em" xref="A1.SS1.SSS2.p3.6.m2.1.1.cmml">⋅</mo><mo id="A1.SS1.SSS2.p3.6.m2.1.2.6.2.2" stretchy="false" xref="A1.SS1.SSS2.p3.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p3.6.m2.1b"><apply id="A1.SS1.SSS2.p3.6.m2.1.2.cmml" xref="A1.SS1.SSS2.p3.6.m2.1.2"><times id="A1.SS1.SSS2.p3.6.m2.1.2.1.cmml" xref="A1.SS1.SSS2.p3.6.m2.1.2.1"></times><ci id="A1.SS1.SSS2.p3.6.m2.1.2.2.cmml" xref="A1.SS1.SSS2.p3.6.m2.1.2.2">𝑑</ci><ci id="A1.SS1.SSS2.p3.6.m2.1.2.3.cmml" xref="A1.SS1.SSS2.p3.6.m2.1.2.3">𝑖</ci><ci id="A1.SS1.SSS2.p3.6.m2.1.2.4.cmml" xref="A1.SS1.SSS2.p3.6.m2.1.2.4">𝑠</ci><ci id="A1.SS1.SSS2.p3.6.m2.1.2.5.cmml" xref="A1.SS1.SSS2.p3.6.m2.1.2.5">𝑡</ci><ci id="A1.SS1.SSS2.p3.6.m2.1.1.cmml" xref="A1.SS1.SSS2.p3.6.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p3.6.m2.1c">dist(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p3.6.m2.1d">italic_d italic_i italic_s italic_t ( ⋅ )</annotation></semantics></math> is the relative distance computing function.</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS2.p4">
<p class="ltx_p" id="A1.SS1.SSS2.p4.4"><span class="ltx_text ltx_font_bold" id="A1.SS1.SSS2.p4.4.1">Relative Temporal Encoding.</span>
This term aims to encode the temporal information of each node in the subgraph node set. Specifically, for each node <math alttext="v_{i}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p4.1.m1.1"><semantics id="A1.SS1.SSS2.p4.1.m1.1a"><msubsup id="A1.SS1.SSS2.p4.1.m1.1.1" xref="A1.SS1.SSS2.p4.1.m1.1.1.cmml"><mi id="A1.SS1.SSS2.p4.1.m1.1.1.2.2" xref="A1.SS1.SSS2.p4.1.m1.1.1.2.2.cmml">v</mi><mi id="A1.SS1.SSS2.p4.1.m1.1.1.2.3" xref="A1.SS1.SSS2.p4.1.m1.1.1.2.3.cmml">i</mi><mi id="A1.SS1.SSS2.p4.1.m1.1.1.3" xref="A1.SS1.SSS2.p4.1.m1.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p4.1.m1.1b"><apply id="A1.SS1.SSS2.p4.1.m1.1.1.cmml" xref="A1.SS1.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p4.1.m1.1.1.1.cmml" xref="A1.SS1.SSS2.p4.1.m1.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p4.1.m1.1.1.2.cmml" xref="A1.SS1.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p4.1.m1.1.1.2.1.cmml" xref="A1.SS1.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p4.1.m1.1.1.2.2.cmml" xref="A1.SS1.SSS2.p4.1.m1.1.1.2.2">𝑣</ci><ci id="A1.SS1.SSS2.p4.1.m1.1.1.2.3.cmml" xref="A1.SS1.SSS2.p4.1.m1.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.SSS2.p4.1.m1.1.1.3.cmml" xref="A1.SS1.SSS2.p4.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p4.1.m1.1c">v_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p4.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> in the node set of <math alttext="g_{i}^{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p4.2.m2.1"><semantics id="A1.SS1.SSS2.p4.2.m2.1a"><msubsup id="A1.SS1.SSS2.p4.2.m2.1.1" xref="A1.SS1.SSS2.p4.2.m2.1.1.cmml"><mi id="A1.SS1.SSS2.p4.2.m2.1.1.2.2" xref="A1.SS1.SSS2.p4.2.m2.1.1.2.2.cmml">g</mi><mi id="A1.SS1.SSS2.p4.2.m2.1.1.2.3" xref="A1.SS1.SSS2.p4.2.m2.1.1.2.3.cmml">i</mi><mi id="A1.SS1.SSS2.p4.2.m2.1.1.3" xref="A1.SS1.SSS2.p4.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p4.2.m2.1b"><apply id="A1.SS1.SSS2.p4.2.m2.1.1.cmml" xref="A1.SS1.SSS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p4.2.m2.1.1.1.cmml" xref="A1.SS1.SSS2.p4.2.m2.1.1">superscript</csymbol><apply id="A1.SS1.SSS2.p4.2.m2.1.1.2.cmml" xref="A1.SS1.SSS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p4.2.m2.1.1.2.1.cmml" xref="A1.SS1.SSS2.p4.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p4.2.m2.1.1.2.2.cmml" xref="A1.SS1.SSS2.p4.2.m2.1.1.2.2">𝑔</ci><ci id="A1.SS1.SSS2.p4.2.m2.1.1.2.3.cmml" xref="A1.SS1.SSS2.p4.2.m2.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.SSS2.p4.2.m2.1.1.3.cmml" xref="A1.SS1.SSS2.p4.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p4.2.m2.1c">g_{i}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p4.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>, the relative temporal encoding is defined as the difference between the occurring time <math alttext="t" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p4.3.m3.1"><semantics id="A1.SS1.SSS2.p4.3.m3.1a"><mi id="A1.SS1.SSS2.p4.3.m3.1.1" xref="A1.SS1.SSS2.p4.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p4.3.m3.1b"><ci id="A1.SS1.SSS2.p4.3.m3.1.1.cmml" xref="A1.SS1.SSS2.p4.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p4.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p4.3.m3.1d">italic_t</annotation></semantics></math> of target edge and the current time of timestamp <math alttext="\tau" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p4.4.m4.1"><semantics id="A1.SS1.SSS2.p4.4.m4.1a"><mi id="A1.SS1.SSS2.p4.4.m4.1.1" xref="A1.SS1.SSS2.p4.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p4.4.m4.1b"><ci id="A1.SS1.SSS2.p4.4.m4.1.1.cmml" xref="A1.SS1.SSS2.p4.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p4.4.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p4.4.m4.1d">italic_τ</annotation></semantics></math>. Therefore, relative temporal encoding is calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{\text{temp}}(v_{i}^{\tau})=linear(||t-\tau||)\in\mathbb{R}^{d_{enc%
}}," class="ltx_Math" display="block" id="A1.Ex15.m1.1"><semantics id="A1.Ex15.m1.1a"><mrow id="A1.Ex15.m1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.cmml"><mrow id="A1.Ex15.m1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.cmml"><mrow id="A1.Ex15.m1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.cmml"><msub id="A1.Ex15.m1.1.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.1.3.cmml"><mi id="A1.Ex15.m1.1.1.1.1.1.3.2" xref="A1.Ex15.m1.1.1.1.1.1.3.2.cmml">𝐳</mi><mtext id="A1.Ex15.m1.1.1.1.1.1.3.3" xref="A1.Ex15.m1.1.1.1.1.1.3.3a.cmml">temp</mtext></msub><mo id="A1.Ex15.m1.1.1.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex15.m1.1.1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex15.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A1.Ex15.m1.1.1.1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="A1.Ex15.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex15.m1.1.1.1.1.4" xref="A1.Ex15.m1.1.1.1.1.4.cmml">=</mo><mrow id="A1.Ex15.m1.1.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.2.cmml"><mi id="A1.Ex15.m1.1.1.1.1.2.3" xref="A1.Ex15.m1.1.1.1.1.2.3.cmml">l</mi><mo id="A1.Ex15.m1.1.1.1.1.2.2" xref="A1.Ex15.m1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex15.m1.1.1.1.1.2.4" xref="A1.Ex15.m1.1.1.1.1.2.4.cmml">i</mi><mo id="A1.Ex15.m1.1.1.1.1.2.2a" xref="A1.Ex15.m1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex15.m1.1.1.1.1.2.5" xref="A1.Ex15.m1.1.1.1.1.2.5.cmml">n</mi><mo id="A1.Ex15.m1.1.1.1.1.2.2b" xref="A1.Ex15.m1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex15.m1.1.1.1.1.2.6" xref="A1.Ex15.m1.1.1.1.1.2.6.cmml">e</mi><mo id="A1.Ex15.m1.1.1.1.1.2.2c" xref="A1.Ex15.m1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex15.m1.1.1.1.1.2.7" xref="A1.Ex15.m1.1.1.1.1.2.7.cmml">a</mi><mo id="A1.Ex15.m1.1.1.1.1.2.2d" xref="A1.Ex15.m1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A1.Ex15.m1.1.1.1.1.2.8" xref="A1.Ex15.m1.1.1.1.1.2.8.cmml">r</mi><mo id="A1.Ex15.m1.1.1.1.1.2.2e" xref="A1.Ex15.m1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.Ex15.m1.1.1.1.1.2.1.1" xref="A1.Ex15.m1.1.1.1.1.2.cmml"><mo id="A1.Ex15.m1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.2.cmml">(</mo><mrow id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.2.cmml"><mo id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.2" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.2.1.cmml">‖</mo><mrow id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.2.cmml">t</mi><mo id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">−</mo><mi id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.3" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A1.Ex15.m1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex15.m1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex15.m1.1.1.1.1.5" xref="A1.Ex15.m1.1.1.1.1.5.cmml">∈</mo><msup id="A1.Ex15.m1.1.1.1.1.6" xref="A1.Ex15.m1.1.1.1.1.6.cmml"><mi id="A1.Ex15.m1.1.1.1.1.6.2" xref="A1.Ex15.m1.1.1.1.1.6.2.cmml">ℝ</mi><msub id="A1.Ex15.m1.1.1.1.1.6.3" xref="A1.Ex15.m1.1.1.1.1.6.3.cmml"><mi id="A1.Ex15.m1.1.1.1.1.6.3.2" xref="A1.Ex15.m1.1.1.1.1.6.3.2.cmml">d</mi><mrow id="A1.Ex15.m1.1.1.1.1.6.3.3" xref="A1.Ex15.m1.1.1.1.1.6.3.3.cmml"><mi id="A1.Ex15.m1.1.1.1.1.6.3.3.2" xref="A1.Ex15.m1.1.1.1.1.6.3.3.2.cmml">e</mi><mo id="A1.Ex15.m1.1.1.1.1.6.3.3.1" xref="A1.Ex15.m1.1.1.1.1.6.3.3.1.cmml">⁢</mo><mi id="A1.Ex15.m1.1.1.1.1.6.3.3.3" xref="A1.Ex15.m1.1.1.1.1.6.3.3.3.cmml">n</mi><mo id="A1.Ex15.m1.1.1.1.1.6.3.3.1a" xref="A1.Ex15.m1.1.1.1.1.6.3.3.1.cmml">⁢</mo><mi id="A1.Ex15.m1.1.1.1.1.6.3.3.4" xref="A1.Ex15.m1.1.1.1.1.6.3.3.4.cmml">c</mi></mrow></msub></msup></mrow><mo id="A1.Ex15.m1.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex15.m1.1b"><apply id="A1.Ex15.m1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1"><and id="A1.Ex15.m1.1.1.1.1a.cmml" xref="A1.Ex15.m1.1.1.1"></and><apply id="A1.Ex15.m1.1.1.1.1b.cmml" xref="A1.Ex15.m1.1.1.1"><eq id="A1.Ex15.m1.1.1.1.1.4.cmml" xref="A1.Ex15.m1.1.1.1.1.4"></eq><apply id="A1.Ex15.m1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1"><times id="A1.Ex15.m1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.2"></times><apply id="A1.Ex15.m1.1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.3.2">𝐳</ci><ci id="A1.Ex15.m1.1.1.1.1.1.3.3a.cmml" xref="A1.Ex15.m1.1.1.1.1.1.3.3"><mtext id="A1.Ex15.m1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.Ex15.m1.1.1.1.1.1.3.3">temp</mtext></ci></apply><apply id="A1.Ex15.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.Ex15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="A1.Ex15.m1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.2"><times id="A1.Ex15.m1.1.1.1.1.2.2.cmml" xref="A1.Ex15.m1.1.1.1.1.2.2"></times><ci id="A1.Ex15.m1.1.1.1.1.2.3.cmml" xref="A1.Ex15.m1.1.1.1.1.2.3">𝑙</ci><ci id="A1.Ex15.m1.1.1.1.1.2.4.cmml" xref="A1.Ex15.m1.1.1.1.1.2.4">𝑖</ci><ci id="A1.Ex15.m1.1.1.1.1.2.5.cmml" xref="A1.Ex15.m1.1.1.1.1.2.5">𝑛</ci><ci id="A1.Ex15.m1.1.1.1.1.2.6.cmml" xref="A1.Ex15.m1.1.1.1.1.2.6">𝑒</ci><ci id="A1.Ex15.m1.1.1.1.1.2.7.cmml" xref="A1.Ex15.m1.1.1.1.1.2.7">𝑎</ci><ci id="A1.Ex15.m1.1.1.1.1.2.8.cmml" xref="A1.Ex15.m1.1.1.1.1.2.8">𝑟</ci><apply id="A1.Ex15.m1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1"><csymbol cd="latexml" id="A1.Ex15.m1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.2">norm</csymbol><apply id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1"><minus id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.1"></minus><ci id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.2">𝑡</ci><ci id="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.2.1.1.1.1.1.3">𝜏</ci></apply></apply></apply></apply><apply id="A1.Ex15.m1.1.1.1.1c.cmml" xref="A1.Ex15.m1.1.1.1"><in id="A1.Ex15.m1.1.1.1.1.5.cmml" xref="A1.Ex15.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2405.07626v2#A1.Ex15.m1.1.1.1.1.2.cmml" id="A1.Ex15.m1.1.1.1.1d.cmml" xref="A1.Ex15.m1.1.1.1"></share><apply id="A1.Ex15.m1.1.1.1.1.6.cmml" xref="A1.Ex15.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.6.1.cmml" xref="A1.Ex15.m1.1.1.1.1.6">superscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.6.2.cmml" xref="A1.Ex15.m1.1.1.1.1.6.2">ℝ</ci><apply id="A1.Ex15.m1.1.1.1.1.6.3.cmml" xref="A1.Ex15.m1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="A1.Ex15.m1.1.1.1.1.6.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.6.3">subscript</csymbol><ci id="A1.Ex15.m1.1.1.1.1.6.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.6.3.2">𝑑</ci><apply id="A1.Ex15.m1.1.1.1.1.6.3.3.cmml" xref="A1.Ex15.m1.1.1.1.1.6.3.3"><times id="A1.Ex15.m1.1.1.1.1.6.3.3.1.cmml" xref="A1.Ex15.m1.1.1.1.1.6.3.3.1"></times><ci id="A1.Ex15.m1.1.1.1.1.6.3.3.2.cmml" xref="A1.Ex15.m1.1.1.1.1.6.3.3.2">𝑒</ci><ci id="A1.Ex15.m1.1.1.1.1.6.3.3.3.cmml" xref="A1.Ex15.m1.1.1.1.1.6.3.3.3">𝑛</ci><ci id="A1.Ex15.m1.1.1.1.1.6.3.3.4.cmml" xref="A1.Ex15.m1.1.1.1.1.6.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex15.m1.1c">\mathbf{z}_{\text{temp}}(v_{i}^{\tau})=linear(||t-\tau||)\in\mathbb{R}^{d_{enc%
}},</annotation><annotation encoding="application/x-llamapun" id="A1.Ex15.m1.1d">bold_z start_POSTSUBSCRIPT temp end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) = italic_l italic_i italic_n italic_e italic_a italic_r ( | | italic_t - italic_τ | | ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS2.p4.5">where <math alttext="linear(\cdot)" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p4.5.m1.1"><semantics id="A1.SS1.SSS2.p4.5.m1.1a"><mrow id="A1.SS1.SSS2.p4.5.m1.1.2" xref="A1.SS1.SSS2.p4.5.m1.1.2.cmml"><mi id="A1.SS1.SSS2.p4.5.m1.1.2.2" xref="A1.SS1.SSS2.p4.5.m1.1.2.2.cmml">l</mi><mo id="A1.SS1.SSS2.p4.5.m1.1.2.1" xref="A1.SS1.SSS2.p4.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p4.5.m1.1.2.3" xref="A1.SS1.SSS2.p4.5.m1.1.2.3.cmml">i</mi><mo id="A1.SS1.SSS2.p4.5.m1.1.2.1a" xref="A1.SS1.SSS2.p4.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p4.5.m1.1.2.4" xref="A1.SS1.SSS2.p4.5.m1.1.2.4.cmml">n</mi><mo id="A1.SS1.SSS2.p4.5.m1.1.2.1b" xref="A1.SS1.SSS2.p4.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p4.5.m1.1.2.5" xref="A1.SS1.SSS2.p4.5.m1.1.2.5.cmml">e</mi><mo id="A1.SS1.SSS2.p4.5.m1.1.2.1c" xref="A1.SS1.SSS2.p4.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p4.5.m1.1.2.6" xref="A1.SS1.SSS2.p4.5.m1.1.2.6.cmml">a</mi><mo id="A1.SS1.SSS2.p4.5.m1.1.2.1d" xref="A1.SS1.SSS2.p4.5.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p4.5.m1.1.2.7" xref="A1.SS1.SSS2.p4.5.m1.1.2.7.cmml">r</mi><mo id="A1.SS1.SSS2.p4.5.m1.1.2.1e" xref="A1.SS1.SSS2.p4.5.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.SSS2.p4.5.m1.1.2.8.2" xref="A1.SS1.SSS2.p4.5.m1.1.2.cmml"><mo id="A1.SS1.SSS2.p4.5.m1.1.2.8.2.1" stretchy="false" xref="A1.SS1.SSS2.p4.5.m1.1.2.cmml">(</mo><mo id="A1.SS1.SSS2.p4.5.m1.1.1" lspace="0em" rspace="0em" xref="A1.SS1.SSS2.p4.5.m1.1.1.cmml">⋅</mo><mo id="A1.SS1.SSS2.p4.5.m1.1.2.8.2.2" stretchy="false" xref="A1.SS1.SSS2.p4.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p4.5.m1.1b"><apply id="A1.SS1.SSS2.p4.5.m1.1.2.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.2"><times id="A1.SS1.SSS2.p4.5.m1.1.2.1.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.2.1"></times><ci id="A1.SS1.SSS2.p4.5.m1.1.2.2.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.2.2">𝑙</ci><ci id="A1.SS1.SSS2.p4.5.m1.1.2.3.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.2.3">𝑖</ci><ci id="A1.SS1.SSS2.p4.5.m1.1.2.4.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.2.4">𝑛</ci><ci id="A1.SS1.SSS2.p4.5.m1.1.2.5.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.2.5">𝑒</ci><ci id="A1.SS1.SSS2.p4.5.m1.1.2.6.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.2.6">𝑎</ci><ci id="A1.SS1.SSS2.p4.5.m1.1.2.7.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.2.7">𝑟</ci><ci id="A1.SS1.SSS2.p4.5.m1.1.1.cmml" xref="A1.SS1.SSS2.p4.5.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p4.5.m1.1c">linear(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p4.5.m1.1d">italic_l italic_i italic_n italic_e italic_a italic_r ( ⋅ )</annotation></semantics></math> denotes the learnable linear mapping.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2. </span>Detail of Prompt</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">In this section, we provide the detail of our prompt, including the prompt to generate words related to dynamic graphs and the prompt of In-Context Learning.</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p2.1.1">Prompt to generate words related to dynamic graphs.</span> Please generate a list of words related to dynamic graphs. Dynamic graph data consists of nodes and edges, often representing networks that change over time. To align dynamic graph data with natural language vocabulary, it is essential to select words that can describe both the graph structure and its dynamic changes to form text prototypes. Please include words related to network topology, data fluidity, and time dependency.</p>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p3.1.1">Prompt of In-Context Learning.</span> As an AI trained in the few-shot learning approach, I have been provided with examples of both normal and anomaly edges. The anomalies are identified as Contextual Dissimilarity Anomalies, where we first utilize node2vec to obtain the representation of each node in the graph, and connect the pairs of nodes with the maximum Euclidean distance as anomaly edges. These examples serve as a reference for detecting similar patterns in new edges. Please note the following examples and their labels, indicating whether they are normal or anomaly: Example 1: ¡Edge¿ Label: Normal Example 2: ¡Edge¿ Label: Anomaly Example 3: ¡Edge¿ Label: Normal Example 4: ¡Edge¿ Label: Normal Example 5: ¡Edge¿ Label: Anomaly Example 6: ¡Edge¿ Label:Anomaly Example 7: ¡Edge¿ Label: Anomaly Example 8: ¡Edge¿ Label: Anomaly Example 9: ¡Edge¿ Label: Normal Example 10: ¡Edge¿ Label: Anomaly (Note: All the above examples are anomaly and represent the same type of anomaly.) Based on the pattern in the examples and samples provided, classify the sentiment of the following new edge. If the new edge is similar to the example edges, it should be considered anomaly. If it is dissimilar, it should be considered normal. New Example: ¡vector¿ Label:</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3. </span>Complexity Analysis of Training</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">For each edge <math alttext="e^{t}_{i,j}" class="ltx_Math" display="inline" id="A1.SS3.p1.1.m1.2"><semantics id="A1.SS3.p1.1.m1.2a"><msubsup id="A1.SS3.p1.1.m1.2.3" xref="A1.SS3.p1.1.m1.2.3.cmml"><mi id="A1.SS3.p1.1.m1.2.3.2.2" xref="A1.SS3.p1.1.m1.2.3.2.2.cmml">e</mi><mrow id="A1.SS3.p1.1.m1.2.2.2.4" xref="A1.SS3.p1.1.m1.2.2.2.3.cmml"><mi id="A1.SS3.p1.1.m1.1.1.1.1" xref="A1.SS3.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="A1.SS3.p1.1.m1.2.2.2.4.1" xref="A1.SS3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="A1.SS3.p1.1.m1.2.2.2.2" xref="A1.SS3.p1.1.m1.2.2.2.2.cmml">j</mi></mrow><mi id="A1.SS3.p1.1.m1.2.3.2.3" xref="A1.SS3.p1.1.m1.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.2b"><apply id="A1.SS3.p1.1.m1.2.3.cmml" xref="A1.SS3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.2.3.1.cmml" xref="A1.SS3.p1.1.m1.2.3">subscript</csymbol><apply id="A1.SS3.p1.1.m1.2.3.2.cmml" xref="A1.SS3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.2.3.2.1.cmml" xref="A1.SS3.p1.1.m1.2.3">superscript</csymbol><ci id="A1.SS3.p1.1.m1.2.3.2.2.cmml" xref="A1.SS3.p1.1.m1.2.3.2.2">𝑒</ci><ci id="A1.SS3.p1.1.m1.2.3.2.3.cmml" xref="A1.SS3.p1.1.m1.2.3.2.3">𝑡</ci></apply><list id="A1.SS3.p1.1.m1.2.2.2.3.cmml" xref="A1.SS3.p1.1.m1.2.2.2.4"><ci id="A1.SS3.p1.1.m1.1.1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1">𝑖</ci><ci id="A1.SS3.p1.1.m1.2.2.2.2.cmml" xref="A1.SS3.p1.1.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.2c">e^{t}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.1.m1.2d">italic_e start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, the complexity of training consists of four parts, <em class="ltx_emph ltx_font_italic" id="A1.SS3.p1.1.1">i.e.</em>, subgraph construction, dynamic-aware embedding computation, reprogramming and anomaly fine-tuning.</p>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.5">For the subgraph construction, based on the precomputed diffusion matrix, <math alttext="K" class="ltx_Math" display="inline" id="A1.I1.i1.p1.1.m1.1"><semantics id="A1.I1.i1.p1.1.m1.1a"><mi id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><ci id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.1.m1.1d">italic_K</annotation></semantics></math> related nodes should be selected for nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.2.m2.1"><semantics id="A1.I1.i1.p1.2.m2.1a"><msub id="A1.I1.i1.p1.2.m2.1.1" xref="A1.I1.i1.p1.2.m2.1.1.cmml"><mi id="A1.I1.i1.p1.2.m2.1.1.2" xref="A1.I1.i1.p1.2.m2.1.1.2.cmml">v</mi><mi id="A1.I1.i1.p1.2.m2.1.1.3" xref="A1.I1.i1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.2.m2.1b"><apply id="A1.I1.i1.p1.2.m2.1.1.cmml" xref="A1.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.1.1.1.cmml" xref="A1.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.2.m2.1.1.2.cmml" xref="A1.I1.i1.p1.2.m2.1.1.2">𝑣</ci><ci id="A1.I1.i1.p1.2.m2.1.1.3.cmml" xref="A1.I1.i1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.2.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.3.m3.1"><semantics id="A1.I1.i1.p1.3.m3.1a"><msub id="A1.I1.i1.p1.3.m3.1.1" xref="A1.I1.i1.p1.3.m3.1.1.cmml"><mi id="A1.I1.i1.p1.3.m3.1.1.2" xref="A1.I1.i1.p1.3.m3.1.1.2.cmml">v</mi><mi id="A1.I1.i1.p1.3.m3.1.1.3" xref="A1.I1.i1.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.3.m3.1b"><apply id="A1.I1.i1.p1.3.m3.1.1.cmml" xref="A1.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.3.m3.1.1.1.cmml" xref="A1.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.3.m3.1.1.2.cmml" xref="A1.I1.i1.p1.3.m3.1.1.2">𝑣</ci><ci id="A1.I1.i1.p1.3.m3.1.1.3.cmml" xref="A1.I1.i1.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. Therefore, the complexity is <math alttext="O(\Gamma\times K)" class="ltx_Math" display="inline" id="A1.I1.i1.p1.4.m4.1"><semantics id="A1.I1.i1.p1.4.m4.1a"><mrow id="A1.I1.i1.p1.4.m4.1.1" xref="A1.I1.i1.p1.4.m4.1.1.cmml"><mi id="A1.I1.i1.p1.4.m4.1.1.3" xref="A1.I1.i1.p1.4.m4.1.1.3.cmml">O</mi><mo id="A1.I1.i1.p1.4.m4.1.1.2" xref="A1.I1.i1.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="A1.I1.i1.p1.4.m4.1.1.1.1" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.cmml"><mo id="A1.I1.i1.p1.4.m4.1.1.1.1.2" stretchy="false" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i1.p1.4.m4.1.1.1.1.1" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.cmml"><mi id="A1.I1.i1.p1.4.m4.1.1.1.1.1.2" mathvariant="normal" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.2.cmml">Γ</mi><mo id="A1.I1.i1.p1.4.m4.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.1.cmml">×</mo><mi id="A1.I1.i1.p1.4.m4.1.1.1.1.1.3" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.3.cmml">K</mi></mrow><mo id="A1.I1.i1.p1.4.m4.1.1.1.1.3" stretchy="false" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.4.m4.1b"><apply id="A1.I1.i1.p1.4.m4.1.1.cmml" xref="A1.I1.i1.p1.4.m4.1.1"><times id="A1.I1.i1.p1.4.m4.1.1.2.cmml" xref="A1.I1.i1.p1.4.m4.1.1.2"></times><ci id="A1.I1.i1.p1.4.m4.1.1.3.cmml" xref="A1.I1.i1.p1.4.m4.1.1.3">𝑂</ci><apply id="A1.I1.i1.p1.4.m4.1.1.1.1.1.cmml" xref="A1.I1.i1.p1.4.m4.1.1.1.1"><times id="A1.I1.i1.p1.4.m4.1.1.1.1.1.1.cmml" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.1"></times><ci id="A1.I1.i1.p1.4.m4.1.1.1.1.1.2.cmml" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.2">Γ</ci><ci id="A1.I1.i1.p1.4.m4.1.1.1.1.1.3.cmml" xref="A1.I1.i1.p1.4.m4.1.1.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.4.m4.1c">O(\Gamma\times K)</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.4.m4.1d">italic_O ( roman_Γ × italic_K )</annotation></semantics></math> where <math alttext="\Gamma" class="ltx_Math" display="inline" id="A1.I1.i1.p1.5.m5.1"><semantics id="A1.I1.i1.p1.5.m5.1a"><mi id="A1.I1.i1.p1.5.m5.1.1" mathvariant="normal" xref="A1.I1.i1.p1.5.m5.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.5.m5.1b"><ci id="A1.I1.i1.p1.5.m5.1.1.cmml" xref="A1.I1.i1.p1.5.m5.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.5.m5.1c">\Gamma</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.5.m5.1d">roman_Γ</annotation></semantics></math> is the temporal window size.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.4">For dynamic-aware embedding, the complexity mainly comes from calculating node features, obtaining node embeddings via Transformer block and generating subgraph encoding via GNN, whose complexity is <math alttext="O(3\times d)" class="ltx_Math" display="inline" id="A1.I1.i2.p1.1.m1.1"><semantics id="A1.I1.i2.p1.1.m1.1a"><mrow id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml"><mi id="A1.I1.i2.p1.1.m1.1.1.3" xref="A1.I1.i2.p1.1.m1.1.1.3.cmml">O</mi><mo id="A1.I1.i2.p1.1.m1.1.1.2" xref="A1.I1.i2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.I1.i2.p1.1.m1.1.1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.cmml"><mo id="A1.I1.i2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.1.m1.1.1.1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.cmml"><mn id="A1.I1.i2.p1.1.m1.1.1.1.1.1.2" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml">3</mn><mo id="A1.I1.i2.p1.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml">×</mo><mi id="A1.I1.i2.p1.1.m1.1.1.1.1.1.3" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="A1.I1.i2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b"><apply id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1"><times id="A1.I1.i2.p1.1.m1.1.1.2.cmml" xref="A1.I1.i2.p1.1.m1.1.1.2"></times><ci id="A1.I1.i2.p1.1.m1.1.1.3.cmml" xref="A1.I1.i2.p1.1.m1.1.1.3">𝑂</ci><apply id="A1.I1.i2.p1.1.m1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.1"><times id="A1.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.1"></times><cn id="A1.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml" type="integer" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.2">3</cn><ci id="A1.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">O(3\times d)</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.1.m1.1d">italic_O ( 3 × italic_d )</annotation></semantics></math>, <math alttext="O((2(K+1)\Gamma)^{2}d+2(K+1)\Gamma d^{2})" class="ltx_Math" display="inline" id="A1.I1.i2.p1.2.m2.1"><semantics id="A1.I1.i2.p1.2.m2.1a"><mrow id="A1.I1.i2.p1.2.m2.1.1" xref="A1.I1.i2.p1.2.m2.1.1.cmml"><mi id="A1.I1.i2.p1.2.m2.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.3.cmml">O</mi><mo id="A1.I1.i2.p1.2.m2.1.1.2" xref="A1.I1.i2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.cmml"><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.cmml"><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml"><msup id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml"><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.2a" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.4" mathvariant="normal" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.4.cmml">Γ</mi></mrow><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.2" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.cmml"><mn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.3" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.3.cmml">2</mn><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.2" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.2" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.2.cmml">K</mi><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.1.cmml">+</mo><mn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.2a" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.4" mathvariant="normal" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.4.cmml">Γ</mi><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.2b" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.2.cmml">⁢</mo><msup id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.cmml"><mi id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.2" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.2.cmml">d</mi><mn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.3" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.3.cmml">2</mn></msup></mrow></mrow><mo id="A1.I1.i2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.2.m2.1b"><apply id="A1.I1.i2.p1.2.m2.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1"><times id="A1.I1.i2.p1.2.m2.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.2"></times><ci id="A1.I1.i2.p1.2.m2.1.1.3.cmml" xref="A1.I1.i2.p1.2.m2.1.1.3">𝑂</ci><apply id="A1.I1.i2.p1.2.m2.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1"><plus id="A1.I1.i2.p1.2.m2.1.1.1.1.1.3.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.3"></plus><apply id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1"><times id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.2"></times><apply id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1"><times id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.2"></times><cn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.3">2</cn><apply id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐾</ci><cn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.4">Γ</ci></apply><cn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3">2</cn></apply><ci id="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2"><times id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.2"></times><cn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.3">2</cn><apply id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1"><plus id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.1"></plus><ci id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.2">𝐾</ci><cn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.1.1.1.3">1</cn></apply><ci id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.4.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.4">Γ</ci><apply id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5">superscript</csymbol><ci id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.2">𝑑</ci><cn id="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.3.cmml" type="integer" xref="A1.I1.i2.p1.2.m2.1.1.1.1.1.2.5.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.2.m2.1c">O((2(K+1)\Gamma)^{2}d+2(K+1)\Gamma d^{2})</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.2.m2.1d">italic_O ( ( 2 ( italic_K + 1 ) roman_Γ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + 2 ( italic_K + 1 ) roman_Γ italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, and <math alttext="O(2(K+1)^{2}\Gamma d)" class="ltx_Math" display="inline" id="A1.I1.i2.p1.3.m3.1"><semantics id="A1.I1.i2.p1.3.m3.1a"><mrow id="A1.I1.i2.p1.3.m3.1.1" xref="A1.I1.i2.p1.3.m3.1.1.cmml"><mi id="A1.I1.i2.p1.3.m3.1.1.3" xref="A1.I1.i2.p1.3.m3.1.1.3.cmml">O</mi><mo id="A1.I1.i2.p1.3.m3.1.1.2" xref="A1.I1.i2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="A1.I1.i2.p1.3.m3.1.1.1.1" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.cmml"><mo id="A1.I1.i2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.3.m3.1.1.1.1.1" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.cmml"><mn id="A1.I1.i2.p1.3.m3.1.1.1.1.1.3" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml">2</mn><mo id="A1.I1.i2.p1.3.m3.1.1.1.1.1.2" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.2.cmml">⁢</mo><msup id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.cmml"><mrow id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mo id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A1.I1.i2.p1.3.m3.1.1.1.1.1.2a" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.I1.i2.p1.3.m3.1.1.1.1.1.4" mathvariant="normal" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.4.cmml">Γ</mi><mo id="A1.I1.i2.p1.3.m3.1.1.1.1.1.2b" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.I1.i2.p1.3.m3.1.1.1.1.1.5" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.5.cmml">d</mi></mrow><mo id="A1.I1.i2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.3.m3.1b"><apply id="A1.I1.i2.p1.3.m3.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1"><times id="A1.I1.i2.p1.3.m3.1.1.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.2"></times><ci id="A1.I1.i2.p1.3.m3.1.1.3.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3">𝑂</ci><apply id="A1.I1.i2.p1.3.m3.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1"><times id="A1.I1.i2.p1.3.m3.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.2"></times><cn id="A1.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.3">2</cn><apply id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1">superscript</csymbol><apply id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1"><plus id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1"></plus><ci id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.2">𝐾</ci><cn id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.3">1</cn></apply><cn id="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.1.3">2</cn></apply><ci id="A1.I1.i2.p1.3.m3.1.1.1.1.1.4.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.4">Γ</ci><ci id="A1.I1.i2.p1.3.m3.1.1.1.1.1.5.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1.1.1.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.3.m3.1c">O(2(K+1)^{2}\Gamma d)</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.3.m3.1d">italic_O ( 2 ( italic_K + 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_Γ italic_d )</annotation></semantics></math>, respectively. Therefore, the overall complexity of dynamic-aware embedding is <math alttext="O((K+1)^{2}\Gamma^{2}d+(K+1)\Gamma d^{2})" class="ltx_Math" display="inline" id="A1.I1.i2.p1.4.m4.1"><semantics id="A1.I1.i2.p1.4.m4.1a"><mrow id="A1.I1.i2.p1.4.m4.1.1" xref="A1.I1.i2.p1.4.m4.1.1.cmml"><mi id="A1.I1.i2.p1.4.m4.1.1.3" xref="A1.I1.i2.p1.4.m4.1.1.3.cmml">O</mi><mo id="A1.I1.i2.p1.4.m4.1.1.2" xref="A1.I1.i2.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="A1.I1.i2.p1.4.m4.1.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.cmml"><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.2" stretchy="false" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.4.m4.1.1.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.cmml"><mrow id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml"><msup id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.cmml"><mrow id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.2" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.cmml"><mi id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.2.cmml">Γ</mi><mn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.3" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.3.cmml">2</mn></msup><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.2a" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.4" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.3" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.cmml"><mrow id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.2" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.2.cmml">K</mi><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.1" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.1.cmml">+</mo><mn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.3" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.2" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.3" mathvariant="normal" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.cmml">Γ</mi><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.2a" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.2.cmml">⁢</mo><msup id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.cmml"><mi id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.2" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.2.cmml">d</mi><mn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.3" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.3.cmml">2</mn></msup></mrow></mrow><mo id="A1.I1.i2.p1.4.m4.1.1.1.1.3" stretchy="false" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.4.m4.1b"><apply id="A1.I1.i2.p1.4.m4.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1"><times id="A1.I1.i2.p1.4.m4.1.1.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.2"></times><ci id="A1.I1.i2.p1.4.m4.1.1.3.cmml" xref="A1.I1.i2.p1.4.m4.1.1.3">𝑂</ci><apply id="A1.I1.i2.p1.4.m4.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1"><plus id="A1.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.3"></plus><apply id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1"><times id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.2"></times><apply id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1"><plus id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2">𝐾</ci><cn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><cn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3">2</cn></apply><apply id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.2">Γ</ci><cn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.3.3">2</cn></apply><ci id="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.4.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.1.4">𝑑</ci></apply><apply id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2"><times id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.2"></times><apply id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1"><plus id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.1"></plus><ci id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.2">𝐾</ci><cn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.1.1.3">1</cn></apply><ci id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.3">Γ</ci><apply id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4">superscript</csymbol><ci id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.2">𝑑</ci><cn id="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.3.cmml" type="integer" xref="A1.I1.i2.p1.4.m4.1.1.1.1.1.2.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.4.m4.1c">O((K+1)^{2}\Gamma^{2}d+(K+1)\Gamma d^{2})</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.4.m4.1d">italic_O ( ( italic_K + 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_Γ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + ( italic_K + 1 ) roman_Γ italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1">The reprogramming is implemented by a Transformer, whose complexity is <math alttext="O(V^{\prime}d)+O(V^{\prime}d^{2})=O(V^{\prime}d^{2})" class="ltx_Math" display="inline" id="A1.I1.i3.p1.1.m1.3"><semantics id="A1.I1.i3.p1.1.m1.3a"><mrow id="A1.I1.i3.p1.1.m1.3.3" xref="A1.I1.i3.p1.1.m1.3.3.cmml"><mrow id="A1.I1.i3.p1.1.m1.2.2.2" xref="A1.I1.i3.p1.1.m1.2.2.2.cmml"><mrow id="A1.I1.i3.p1.1.m1.1.1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.1.1.cmml"><mi id="A1.I1.i3.p1.1.m1.1.1.1.1.3" xref="A1.I1.i3.p1.1.m1.1.1.1.1.3.cmml">O</mi><mo id="A1.I1.i3.p1.1.m1.1.1.1.1.2" xref="A1.I1.i3.p1.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.cmml"><msup id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml">V</mi><mo id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.3" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.3" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.I1.i3.p1.1.m1.2.2.2.3" xref="A1.I1.i3.p1.1.m1.2.2.2.3.cmml">+</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.2.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.cmml"><mi id="A1.I1.i3.p1.1.m1.2.2.2.2.3" xref="A1.I1.i3.p1.1.m1.2.2.2.2.3.cmml">O</mi><mo id="A1.I1.i3.p1.1.m1.2.2.2.2.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.cmml"><mo id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.2" stretchy="false" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.cmml"><msup id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.cmml"><mi id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.2.cmml">V</mi><mo id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.3" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.3.cmml">′</mo></msup><mo id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.1" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.cmml"><mi id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.2.cmml">d</mi><mn id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.3" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.3" stretchy="false" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.I1.i3.p1.1.m1.3.3.4" xref="A1.I1.i3.p1.1.m1.3.3.4.cmml">=</mo><mrow id="A1.I1.i3.p1.1.m1.3.3.3" xref="A1.I1.i3.p1.1.m1.3.3.3.cmml"><mi id="A1.I1.i3.p1.1.m1.3.3.3.3" xref="A1.I1.i3.p1.1.m1.3.3.3.3.cmml">O</mi><mo id="A1.I1.i3.p1.1.m1.3.3.3.2" xref="A1.I1.i3.p1.1.m1.3.3.3.2.cmml">⁢</mo><mrow id="A1.I1.i3.p1.1.m1.3.3.3.1.1" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.cmml"><mo id="A1.I1.i3.p1.1.m1.3.3.3.1.1.2" stretchy="false" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.cmml"><msup id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.cmml"><mi id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.2" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.2.cmml">V</mi><mo id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.3" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.3.cmml">′</mo></msup><mo id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.1" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.1.cmml">⁢</mo><msup id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.cmml"><mi id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.2" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.2.cmml">d</mi><mn id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.3" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="A1.I1.i3.p1.1.m1.3.3.3.1.1.3" stretchy="false" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.3b"><apply id="A1.I1.i3.p1.1.m1.3.3.cmml" xref="A1.I1.i3.p1.1.m1.3.3"><eq id="A1.I1.i3.p1.1.m1.3.3.4.cmml" xref="A1.I1.i3.p1.1.m1.3.3.4"></eq><apply id="A1.I1.i3.p1.1.m1.2.2.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2"><plus id="A1.I1.i3.p1.1.m1.2.2.2.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.3"></plus><apply id="A1.I1.i3.p1.1.m1.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1"><times id="A1.I1.i3.p1.1.m1.1.1.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.2"></times><ci id="A1.I1.i3.p1.1.m1.1.1.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.3">𝑂</ci><apply id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1"><times id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1"></times><apply id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.2">𝑉</ci><ci id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.1.1.3">𝑑</ci></apply></apply><apply id="A1.I1.i3.p1.1.m1.2.2.2.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2"><times id="A1.I1.i3.p1.1.m1.2.2.2.2.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2"></times><ci id="A1.I1.i3.p1.1.m1.2.2.2.2.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.3">𝑂</ci><apply id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1"><times id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.1"></times><apply id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.2">𝑉</ci><ci id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.2.3">′</ci></apply><apply id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.2">𝑑</ci><cn id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.3.cmml" type="integer" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.3.3">2</cn></apply></apply></apply></apply><apply id="A1.I1.i3.p1.1.m1.3.3.3.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3"><times id="A1.I1.i3.p1.1.m1.3.3.3.2.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.2"></times><ci id="A1.I1.i3.p1.1.m1.3.3.3.3.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.3">𝑂</ci><apply id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1"><times id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.1"></times><apply id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.1.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2">superscript</csymbol><ci id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.2.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.2">𝑉</ci><ci id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.3.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.2.3">′</ci></apply><apply id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.1.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3">superscript</csymbol><ci id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.2.cmml" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.2">𝑑</ci><cn id="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.3.cmml" type="integer" xref="A1.I1.i3.p1.1.m1.3.3.3.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.3c">O(V^{\prime}d)+O(V^{\prime}d^{2})=O(V^{\prime}d^{2})</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.1.m1.3d">italic_O ( italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_d ) + italic_O ( italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = italic_O ( italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.2">As for the anomaly fine-tuning, the instruction templates as well as the edge representation vector are feed to the large language model, with the complexity of <math alttext="O(YL^{2}d+YLd^{2})" class="ltx_Math" display="inline" id="A1.I1.i4.p1.1.m1.1"><semantics id="A1.I1.i4.p1.1.m1.1a"><mrow id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml"><mi id="A1.I1.i4.p1.1.m1.1.1.3" xref="A1.I1.i4.p1.1.m1.1.1.3.cmml">O</mi><mo id="A1.I1.i4.p1.1.m1.1.1.2" xref="A1.I1.i4.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.I1.i4.p1.1.m1.1.1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.cmml"><mo id="A1.I1.i4.p1.1.m1.1.1.1.1.2" stretchy="false" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i4.p1.1.m1.1.1.1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.cmml"><mrow id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.2" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.2.cmml">Y</mi><mo id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.1" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.2" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.2.cmml">L</mi><mn id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.3" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.3.cmml">2</mn></msup><mo id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.1a" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.4" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.4.cmml">d</mi></mrow><mo id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.2" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.2.cmml">Y</mi><mo id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.1" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.3" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.3.cmml">L</mi><mo id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.1a" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.cmml"><mi id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.2" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.2.cmml">d</mi><mn id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.3" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.3.cmml">2</mn></msup></mrow></mrow><mo id="A1.I1.i4.p1.1.m1.1.1.1.1.3" stretchy="false" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.1b"><apply id="A1.I1.i4.p1.1.m1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1"><times id="A1.I1.i4.p1.1.m1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.2"></times><ci id="A1.I1.i4.p1.1.m1.1.1.3.cmml" xref="A1.I1.i4.p1.1.m1.1.1.3">𝑂</ci><apply id="A1.I1.i4.p1.1.m1.1.1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1"><plus id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1"></plus><apply id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2"><times id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.1"></times><ci id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.2">𝑌</ci><apply id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3">superscript</csymbol><ci id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.2">𝐿</ci><cn id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.3.3">2</cn></apply><ci id="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.4.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.2.4">𝑑</ci></apply><apply id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3"><times id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.1"></times><ci id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.2">𝑌</ci><ci id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.3">𝐿</ci><apply id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4">superscript</csymbol><ci id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.2">𝑑</ci><cn id="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.3.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.3.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.1c">O(YL^{2}d+YLd^{2})</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.1.m1.1d">italic_O ( italic_Y italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + italic_Y italic_L italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="Y" class="ltx_Math" display="inline" id="A1.I1.i4.p1.2.m2.1"><semantics id="A1.I1.i4.p1.2.m2.1a"><mi id="A1.I1.i4.p1.2.m2.1.1" xref="A1.I1.i4.p1.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.2.m2.1b"><ci id="A1.I1.i4.p1.2.m2.1.1.cmml" xref="A1.I1.i4.p1.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.2.m2.1d">italic_Y</annotation></semantics></math> denotes the number of layers in the large language model.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4. </span>Experiment Setting</h3>
<section class="ltx_subsubsection" id="A1.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.4.1. </span>Dataset Statistics</h4>
<div class="ltx_para" id="A1.SS4.SSS1.p1">
<p class="ltx_p" id="A1.SS4.SSS1.p1.1">Four datasets are used for the evaluation, including two widely used benchmarks, <em class="ltx_emph ltx_font_italic" id="A1.SS4.SSS1.p1.1.1">i.e.</em>, UCI Message and BlogCatalog, as well as two datasets with real anomalies, <em class="ltx_emph ltx_font_italic" id="A1.SS4.SSS1.p1.1.2">i.e.</em>, T-Finance and T-Social. The detailed statistics of these datasets are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.T5" title="Table 5 ‣ A.4.1. Dataset Statistics ‣ A.4. Experiment Setting ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>. The UCI message and BlogCatalog datasets are relatively small in scale. Specifically, UCI message contains only 1,899 nodes and 59,835 edges, and BlogCatalog has 5,196 nodes and 171,743 nodes. The T-Finance and T-Social datasets are larger in scale. T-Finance has 39,357 nodes and 21,222,543 edges. The largest dataset, T-Social, has 5,781,065 nodes and 73,105,508 edges. While the UCI Message and BlogCatalog datasets lack anomaly labels, the proportion of anomaly edges in T-Finance and T-Social is 4.58% and 3.01%, respectively. These datasets provide a diverse range of graph sizes, enabling comprehensive evaluation of the proposed method.</p>
</div>
<figure class="ltx_table" id="A1.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5. </span>Statistics of datasets</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T5.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T5.1.1.1.2">Node Number</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T5.1.1.1.3">Edge Number</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T5.1.1.1.4">Anomaly (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T5.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.1.2.1.1">UCI Message</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.1.2.1.2">1899</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.1.2.1.3">59835</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.1.2.1.4">-</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.3.2">
<td class="ltx_td ltx_align_left" id="A1.T5.1.3.2.1">BlogCatalog</td>
<td class="ltx_td ltx_align_center" id="A1.T5.1.3.2.2">5196</td>
<td class="ltx_td ltx_align_center" id="A1.T5.1.3.2.3">171743</td>
<td class="ltx_td ltx_align_center" id="A1.T5.1.3.2.4">-</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.4.3">
<td class="ltx_td ltx_align_left" id="A1.T5.1.4.3.1">T-Finance</td>
<td class="ltx_td ltx_align_center" id="A1.T5.1.4.3.2">39357</td>
<td class="ltx_td ltx_align_center" id="A1.T5.1.4.3.3">21222543</td>
<td class="ltx_td ltx_align_center" id="A1.T5.1.4.3.4">4.58</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T5.1.5.4.1">T-Social</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T5.1.5.4.2">5781065</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T5.1.5.4.3">73105508</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T5.1.5.4.4">3.01</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="A1.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.4.2. </span>Protocol</h4>
<div class="ltx_para" id="A1.SS4.SSS2.p1">
<p class="ltx_p" id="A1.SS4.SSS2.p1.1">Due to the lack of anomaly labels in UCI Message and BlogCatalog, three strategies are introduced to generate anomaly edges for evaluation, <em class="ltx_emph ltx_font_italic" id="A1.SS4.SSS2.p1.1.1">i.e.</em>, Contextual Dissimilarity Anomalies (CDA), Long-Path Links (LPL) and Hub-Hub Links (HHL). The first strategy, CDA, utilizes node2vec <cite class="ltx_cite ltx_citemacro_citep">(Grover and Leskovec, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib11" title="">2016</a>)</cite> to obtain the representation of each node in the graph, and connects the pairs of nodes with the maximum Euclidean distance as anomaly edges. Instead of considering Euclidean distance in the representation space, LPL calculates the topological distance <cite class="ltx_cite ltx_citemacro_citep">(Duan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib9" title="">2020b</a>)</cite> between nodes and connects the pairs of nodes with the farthest topological distance as the anomaly edges. The third strategy, HHL, connected pairs of hub nodes (<em class="ltx_emph ltx_font_italic" id="A1.SS4.SSS2.p1.1.2">i.e.</em>, nodes with large degrees) with few shared neighbors as anomaly edges.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.4.3. </span>Compared baselines.</h4>
<div class="ltx_para" id="A1.SS4.SSS3.p1">
<p class="ltx_p" id="A1.SS4.SSS3.p1.1">We compare AnomalyLLM with five state-of-the-art dynamic baselines representative works. The main ideas of these methods are listed as follows:</p>
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i1.p1">
<p class="ltx_p" id="A1.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i1.p1.1.1">StrGNN<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.I2.i1.p1.1.1.1.1">(</span>Cai et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="A1.I2.i1.p1.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib3" title="">2021</a><span class="ltx_text ltx_font_medium" id="A1.I2.i1.p1.1.1.3.3">)</span></cite></span> extracts the h-hop enclosing sub-graph of edges and leverages stacked GCN [19] and GRU to capture the spatial and temporal information. The learning model is trained in an end-to-end way with negative sampling from “context-dependent” noise distribution.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i2.p1">
<p class="ltx_p" id="A1.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i2.p1.1.1">AddGraph<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.I2.i2.p1.1.1.1.1">(</span>Zheng et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="A1.I2.i2.p1.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib48" title="">2019</a><span class="ltx_text ltx_font_medium" id="A1.I2.i2.p1.1.1.3.3">)</span></cite></span> further constructs an end-to-end neural network model to capture dynamic graphs’ spatial and temporal patterns.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i3.p1">
<p class="ltx_p" id="A1.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i3.p1.1.1">Deep Walk<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.I2.i3.p1.1.1.1.1">(</span>Perozzi et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="A1.I2.i3.p1.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib30" title="">2014</a><span class="ltx_text ltx_font_medium" id="A1.I2.i3.p1.1.1.3.3">)</span></cite></span> utilizes a method based on random walks for embedding graphs. Starting from a specified node, it creates random walks of a predetermined length and employs a technique similar to Skip-gram to acquire embeddings for graphs without attributes.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i4.p1">
<p class="ltx_p" id="A1.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i4.p1.1.1">TADDY<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.I2.i4.p1.1.1.1.1">(</span>Liu et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="A1.I2.i4.p1.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib20" title="">2021b</a><span class="ltx_text ltx_font_medium" id="A1.I2.i4.p1.1.1.3.3">)</span></cite></span> is a Transformer-based module that uses a transformer network to model spatial and temporal information simultaneously.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i5.p1">
<p class="ltx_p" id="A1.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i5.p1.1.1">TGN<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.I2.i5.p1.1.1.1.1">(</span>Xu et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="A1.I2.i5.p1.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib42" title="">2020</a><span class="ltx_text ltx_font_medium" id="A1.I2.i5.p1.1.1.3.3">)</span></cite></span> is a semi-supervised learning method that integrates memory modules with graph neural networks to capture dynamic behaviors in evolving graphs, enabling the learning of temporal interactions effectively.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i6.p1">
<p class="ltx_p" id="A1.I2.i6.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i6.p1.1.1">GDN<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.I2.i6.p1.1.1.1.1">(</span>Ding et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="A1.I2.i6.p1.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib7" title="">2021</a><span class="ltx_text ltx_font_medium" id="A1.I2.i6.p1.1.1.3.3">)</span></cite></span> adopts a deviation loss to train GNN and uses a cross-network meta-learning algorithm for few-shot node anomaly detection.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i7.p1">
<p class="ltx_p" id="A1.I2.i7.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i7.p1.1.1">SAD<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.I2.i7.p1.1.1.1.1">(</span>Tian et al<span class="ltx_text">.</span><span class="ltx_text ltx_font_medium" id="A1.I2.i7.p1.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#bib.bib36" title="">2023</a><span class="ltx_text ltx_font_medium" id="A1.I2.i7.p1.1.1.3.3">)</span></cite></span> is a semi-supervised module, which uses a combination of a time-equipped memory bank and a pseudo-label contrastive learning module to fully exploit the potential of large unlabeled samples and uncover underlying anomalies on evolving graph streams.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5. </span>Sensitivity Analysis</h3>
<div class="ltx_para" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.4">To analyze the impact of selecting different numbers of nodes in the Structural-Temporal Subgraph Sampler, we introduced varying numbers of nodes in the contrastive learning module to assess the sensitivity of AnomalyLLM.We ranged the number of nodes from <math alttext="2" class="ltx_Math" display="inline" id="A1.SS5.p1.1.m1.1"><semantics id="A1.SS5.p1.1.m1.1a"><mn id="A1.SS5.p1.1.m1.1.1" xref="A1.SS5.p1.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.1.m1.1b"><cn id="A1.SS5.p1.1.m1.1.1.cmml" type="integer" xref="A1.SS5.p1.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.1.m1.1d">2</annotation></semantics></math> to <math alttext="20" class="ltx_Math" display="inline" id="A1.SS5.p1.2.m2.1"><semantics id="A1.SS5.p1.2.m2.1a"><mn id="A1.SS5.p1.2.m2.1.1" xref="A1.SS5.p1.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.2.m2.1b"><cn id="A1.SS5.p1.2.m2.1.1.cmml" type="integer" xref="A1.SS5.p1.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.2.m2.1c">20</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.2.m2.1d">20</annotation></semantics></math> and then presented the average performance of these configurations on the BlogCatalog dataset in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.T6" title="Table 6 ‣ A.5. Sensitivity Analysis ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>. As the number of nodes increased, AnomalyLLM demonstrated a substantial performance enhancement. A similar observation was made on the UCI dataset. Notably, there was a significant performance boost when the node count reached <math alttext="10" class="ltx_Math" display="inline" id="A1.SS5.p1.3.m3.1"><semantics id="A1.SS5.p1.3.m3.1a"><mn id="A1.SS5.p1.3.m3.1.1" xref="A1.SS5.p1.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.3.m3.1b"><cn id="A1.SS5.p1.3.m3.1.1.cmml" type="integer" xref="A1.SS5.p1.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.3.m3.1c">10</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.3.m3.1d">10</annotation></semantics></math>, but performance exhibited a slight decline after reaching <math alttext="14" class="ltx_Math" display="inline" id="A1.SS5.p1.4.m4.1"><semantics id="A1.SS5.p1.4.m4.1a"><mn id="A1.SS5.p1.4.m4.1.1" xref="A1.SS5.p1.4.m4.1.1.cmml">14</mn><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.4.m4.1b"><cn id="A1.SS5.p1.4.m4.1.1.cmml" type="integer" xref="A1.SS5.p1.4.m4.1.1">14</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.4.m4.1c">14</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.4.m4.1d">14</annotation></semantics></math> nodes.</p>
</div>
<div class="ltx_para" id="A1.SS5.p2">
<p class="ltx_p" id="A1.SS5.p2.1">The rationale behind these results lies in the potential introduction of noise when selecting an excessive number of nodes to form a subgraph. Too many nodes can lead to subgraphs that are overly complex and include unnecessary information, thus interfering with the model’s ability to learn and generalize key information. Additionally, as the number of nodes increases, the computational time required by the model also increases. Therefore, the selection of the number of nodes needs to strike a balance between subgraph complexity and information quality to achieve optimal performance.</p>
</div>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6. </span>Sensitivity analysis of AnomalyLLM w.r.t. different numbers of nodes in each subgraph <math alttext="G_{i}^{t}" class="ltx_Math" display="inline" id="A1.T6.2.m1.1"><semantics id="A1.T6.2.m1.1b"><msubsup id="A1.T6.2.m1.1.1" xref="A1.T6.2.m1.1.1.cmml"><mi id="A1.T6.2.m1.1.1.2.2" xref="A1.T6.2.m1.1.1.2.2.cmml">G</mi><mi id="A1.T6.2.m1.1.1.2.3" xref="A1.T6.2.m1.1.1.2.3.cmml">i</mi><mi id="A1.T6.2.m1.1.1.3" xref="A1.T6.2.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.T6.2.m1.1c"><apply id="A1.T6.2.m1.1.1.cmml" xref="A1.T6.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.2.m1.1.1.1.cmml" xref="A1.T6.2.m1.1.1">superscript</csymbol><apply id="A1.T6.2.m1.1.1.2.cmml" xref="A1.T6.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.2.m1.1.1.2.1.cmml" xref="A1.T6.2.m1.1.1">subscript</csymbol><ci id="A1.T6.2.m1.1.1.2.2.cmml" xref="A1.T6.2.m1.1.1.2.2">𝐺</ci><ci id="A1.T6.2.m1.1.1.2.3.cmml" xref="A1.T6.2.m1.1.1.2.3">𝑖</ci></apply><ci id="A1.T6.2.m1.1.1.3.cmml" xref="A1.T6.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.2.m1.1d">G_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.2.m1.1e">italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> on the BlogCatalog.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T6.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T6.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.3.1.1.1">Number</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.3.1.1.2">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.3.1.1.3">6</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.3.1.1.4">10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.3.1.1.5">14</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.3.1.1.6">18</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.3.1.1.7">20</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.3.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.3.2.1.1">AUC</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.2.1.2">0.7624</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.2.1.3">0.7896</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.2.1.4">0.8389</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.2.1.5">0.8456</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.2.1.6">0.8412</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.2.1.7">0.8442</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7. </span>Performance comparison reported in AUC measure without relying on external labeled data</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T7.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T7.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.1.1.1"></th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.1.1.2"></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="A1.T7.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A1.T7.1.1.1.3.1">annomaly ratios</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.2.2.1"><span class="ltx_text" id="A1.T7.1.2.2.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.2.2.2"><span class="ltx_text" id="A1.T7.1.2.2.2.1">Method</span></th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.2.2.3">1%</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.2.2.4">5%</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.2.2.5">10%</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.3.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.3.3.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.3.3.2">TADDY</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.3.3.3">0.8388</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.3.3.4">0.8421</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.3.3.5">0.8844</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.4.4.1"><span class="ltx_text" id="A1.T7.1.4.4.1.1">BlogCatalog</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.4.4.2"><span class="ltx_text ltx_font_bold" id="A1.T7.1.4.4.2.1">AnomalyLLM</span></th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.4.3">0.8612</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.4.4">0.8651</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.4.5"><span class="ltx_text ltx_font_bold" id="A1.T7.1.4.4.5.1">0.9146</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.5.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.5.5.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.5.5.2">TADDY</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.5.5.3">0.8370</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.5.5.4">0.8398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.5.5.5">0.8912</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T7.1.6.6.1"><span class="ltx_text" id="A1.T7.1.6.6.1.1">uci</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T7.1.6.6.2"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.2.1">AnomalyLLM</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T7.1.6.6.3">0.8512</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T7.1.6.6.4">0.8633</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T7.1.6.6.5"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.5.1">0.9273</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6. </span>Unsupervised Anomaly Detection</h3>
<div class="ltx_para" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.1">In addressing <span class="ltx_text ltx_font_bold" id="A1.SS6.p1.1.1">Q1</span>, we benchmark AnomalyLLM against leading self-supervised anomaly detection algorithms on the UCI and BlogCatalog datasets, with findings summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.07626v2#A1.T7" title="Table 7 ‣ A.5. Sensitivity Analysis ‣ Appendix A Appendix ‣ AnomalyLLM: Few-shot Anomaly Edge Detection for Dynamic Graphs using Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>. Self-supervised methods for dynamic graphs, which operate without externally labeled data, hinge on capturing the temporal dynamics and nodal attribute changes to discern anomalies. These approaches conventionally employ synthetically generated anomalies for both training and evaluation phases.</p>
</div>
<div class="ltx_para" id="A1.SS6.p2">
<p class="ltx_p" id="A1.SS6.p2.6">Empirical insights reveal: (1) AnomalyLLM, post self-supervised training on unlabeled data, delineates an appreciable performance uplift. Specifically, in identifying contextual anomalies within the UCI dataset, AnomalyLLM exhibits a superior average AUC margin over the top-performing baseline by <math alttext="4.05\%" class="ltx_Math" display="inline" id="A1.SS6.p2.1.m1.1"><semantics id="A1.SS6.p2.1.m1.1a"><mrow id="A1.SS6.p2.1.m1.1.1" xref="A1.SS6.p2.1.m1.1.1.cmml"><mn id="A1.SS6.p2.1.m1.1.1.2" xref="A1.SS6.p2.1.m1.1.1.2.cmml">4.05</mn><mo id="A1.SS6.p2.1.m1.1.1.1" xref="A1.SS6.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.1.m1.1b"><apply id="A1.SS6.p2.1.m1.1.1.cmml" xref="A1.SS6.p2.1.m1.1.1"><csymbol cd="latexml" id="A1.SS6.p2.1.m1.1.1.1.cmml" xref="A1.SS6.p2.1.m1.1.1.1">percent</csymbol><cn id="A1.SS6.p2.1.m1.1.1.2.cmml" type="float" xref="A1.SS6.p2.1.m1.1.1.2">4.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.1.m1.1c">4.05\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.1.m1.1d">4.05 %</annotation></semantics></math> at <math alttext="1\%" class="ltx_Math" display="inline" id="A1.SS6.p2.2.m2.1"><semantics id="A1.SS6.p2.2.m2.1a"><mrow id="A1.SS6.p2.2.m2.1.1" xref="A1.SS6.p2.2.m2.1.1.cmml"><mn id="A1.SS6.p2.2.m2.1.1.2" xref="A1.SS6.p2.2.m2.1.1.2.cmml">1</mn><mo id="A1.SS6.p2.2.m2.1.1.1" xref="A1.SS6.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.2.m2.1b"><apply id="A1.SS6.p2.2.m2.1.1.cmml" xref="A1.SS6.p2.2.m2.1.1"><csymbol cd="latexml" id="A1.SS6.p2.2.m2.1.1.1.cmml" xref="A1.SS6.p2.2.m2.1.1.1">percent</csymbol><cn id="A1.SS6.p2.2.m2.1.1.2.cmml" type="integer" xref="A1.SS6.p2.2.m2.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.2.m2.1c">1\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.2.m2.1d">1 %</annotation></semantics></math> anomaly ratio, with this margin adjusting to <math alttext="2.78\%" class="ltx_Math" display="inline" id="A1.SS6.p2.3.m3.1"><semantics id="A1.SS6.p2.3.m3.1a"><mrow id="A1.SS6.p2.3.m3.1.1" xref="A1.SS6.p2.3.m3.1.1.cmml"><mn id="A1.SS6.p2.3.m3.1.1.2" xref="A1.SS6.p2.3.m3.1.1.2.cmml">2.78</mn><mo id="A1.SS6.p2.3.m3.1.1.1" xref="A1.SS6.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.3.m3.1b"><apply id="A1.SS6.p2.3.m3.1.1.cmml" xref="A1.SS6.p2.3.m3.1.1"><csymbol cd="latexml" id="A1.SS6.p2.3.m3.1.1.1.cmml" xref="A1.SS6.p2.3.m3.1.1.1">percent</csymbol><cn id="A1.SS6.p2.3.m3.1.1.2.cmml" type="float" xref="A1.SS6.p2.3.m3.1.1.2">2.78</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.3.m3.1c">2.78\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.3.m3.1d">2.78 %</annotation></semantics></math> and <math alttext="1.70\%" class="ltx_Math" display="inline" id="A1.SS6.p2.4.m4.1"><semantics id="A1.SS6.p2.4.m4.1a"><mrow id="A1.SS6.p2.4.m4.1.1" xref="A1.SS6.p2.4.m4.1.1.cmml"><mn id="A1.SS6.p2.4.m4.1.1.2" xref="A1.SS6.p2.4.m4.1.1.2.cmml">1.70</mn><mo id="A1.SS6.p2.4.m4.1.1.1" xref="A1.SS6.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.4.m4.1b"><apply id="A1.SS6.p2.4.m4.1.1.cmml" xref="A1.SS6.p2.4.m4.1.1"><csymbol cd="latexml" id="A1.SS6.p2.4.m4.1.1.1.cmml" xref="A1.SS6.p2.4.m4.1.1.1">percent</csymbol><cn id="A1.SS6.p2.4.m4.1.1.2.cmml" type="float" xref="A1.SS6.p2.4.m4.1.1.2">1.70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.4.m4.1c">1.70\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.4.m4.1d">1.70 %</annotation></semantics></math> for <math alttext="5\%" class="ltx_Math" display="inline" id="A1.SS6.p2.5.m5.1"><semantics id="A1.SS6.p2.5.m5.1a"><mrow id="A1.SS6.p2.5.m5.1.1" xref="A1.SS6.p2.5.m5.1.1.cmml"><mn id="A1.SS6.p2.5.m5.1.1.2" xref="A1.SS6.p2.5.m5.1.1.2.cmml">5</mn><mo id="A1.SS6.p2.5.m5.1.1.1" xref="A1.SS6.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.5.m5.1b"><apply id="A1.SS6.p2.5.m5.1.1.cmml" xref="A1.SS6.p2.5.m5.1.1"><csymbol cd="latexml" id="A1.SS6.p2.5.m5.1.1.1.cmml" xref="A1.SS6.p2.5.m5.1.1.1">percent</csymbol><cn id="A1.SS6.p2.5.m5.1.1.2.cmml" type="integer" xref="A1.SS6.p2.5.m5.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.5.m5.1c">5\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.5.m5.1d">5 %</annotation></semantics></math> and <math alttext="10\%" class="ltx_Math" display="inline" id="A1.SS6.p2.6.m6.1"><semantics id="A1.SS6.p2.6.m6.1a"><mrow id="A1.SS6.p2.6.m6.1.1" xref="A1.SS6.p2.6.m6.1.1.cmml"><mn id="A1.SS6.p2.6.m6.1.1.2" xref="A1.SS6.p2.6.m6.1.1.2.cmml">10</mn><mo id="A1.SS6.p2.6.m6.1.1.1" xref="A1.SS6.p2.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.6.m6.1b"><apply id="A1.SS6.p2.6.m6.1.1.cmml" xref="A1.SS6.p2.6.m6.1.1"><csymbol cd="latexml" id="A1.SS6.p2.6.m6.1.1.1.cmml" xref="A1.SS6.p2.6.m6.1.1.1">percent</csymbol><cn id="A1.SS6.p2.6.m6.1.1.2.cmml" type="integer" xref="A1.SS6.p2.6.m6.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.6.m6.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.6.m6.1d">10 %</annotation></semantics></math> anomaly ratios, respectively. Such advancements underscore the efficacy of pre-training across a heterogeneous anomaly landscape in fostering adaptable representation skills, thus bolstering generalization across varied anomaly contexts. Remarkably, these gains accrue under uniform unsupervised conditions. (2) In scenarios featuring randomly typed anomalies, AnomalyLLM consistently outperforms, a testament to its adeptness at leveraging contextual cues. This proficiency in assimilating temporal and structural nuances endows AnomalyLLM with heightened sensitivity to anomalies, underscoring its robustness and adaptability in anomaly detection tasks.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Aug 28 06:17:59 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
